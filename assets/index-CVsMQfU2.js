var lL=Object.defineProperty;var Hb=r=>{throw TypeError(r)};var uL=(r,e,t)=>e in r?lL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var St=(r,e,t)=>uL(r,typeof e!="symbol"?e+"":e,t),fd=(r,e,t)=>e.has(r)||Hb("Cannot "+t);var Rr=(r,e,t)=>(fd(r,e,"read from private field"),t?t.call(r):e.get(r)),gd=(r,e,t)=>e.has(r)?Hb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Cl=(r,e,t,n)=>(fd(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),pd=(r,e,t)=>(fd(r,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function la(r){"@babel/helpers - typeof";return la=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},la(r)}function cL(r,e){if(la(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(la(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function yT(r){var e=cL(r,"string");return la(e)=="symbol"?e:e+""}function Me(r,e,t){return(e=yT(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Yb(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Ge(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Yb(Object(t),!0).forEach(function(n){Me(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Yb(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function de(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Xb(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,yT(n.key),n)}}function fe(r,e,t){return e&&Xb(r.prototype,e),t&&Xb(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function rm(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function hL(r){if(Array.isArray(r))return rm(r)}function dL(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function w1(r,e){if(r){if(typeof r=="string")return rm(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?rm(r,e):void 0}}function fL(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yt(r){return hL(r)||dL(r)||w1(r)||fL()}function Rs(r){return Rs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rs(r)}function mT(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mT=function(){return!!r})()}function gL(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function pL(r,e){if(e&&(la(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gL(r)}function We(r,e,t){return e=Rs(e),pL(r,mT()?Reflect.construct(e,t||[],Rs(r).constructor):e.apply(r,t))}function im(r,e){return im=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},im(r,e)}function Ve(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&im(r,e)}function vL(r){if(Array.isArray(r))return r}function yL(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,i,a,s,o=[],l=!0,u=!1;try{if(a=(t=t.call(r)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=a.call(t)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&t.return!=null&&(s=t.return(),Object(s)!==s))return}finally{if(u)throw i}}return o}}function mL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qe(r,e){return vL(r)||yL(r,e)||w1(r,e)||mL()}var Nl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nl(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function bT(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}),t}var vd={exports:{}},Kb;function bL(){return Kb||(Kb=1,function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function a(l,u,c,h,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new i(c,h||l,d),g=t?t+u:u;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],f]:l._events[g].push(f):(l._events[g]=f,l._eventsCount++),l}function s(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],c,h;if(this._eventsCount===0)return u;for(h in c=this._events)e.call(c,h)&&u.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},o.prototype.listeners=function(u){var c=t?t+u:u,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,g=new Array(f);d<f;d++)g[d]=h[d].fn;return g},o.prototype.listenerCount=function(u){var c=t?t+u:u,h=this._events[c];return h?h.fn?1:h.length:0},o.prototype.emit=function(u,c,h,d,f,g){var v=t?t+u:u;if(!this._events[v])return!1;var p=this._events[v],y=arguments.length,m,w;if(p.fn){switch(p.once&&this.removeListener(u,p.fn,void 0,!0),y){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,c),!0;case 3:return p.fn.call(p.context,c,h),!0;case 4:return p.fn.call(p.context,c,h,d),!0;case 5:return p.fn.call(p.context,c,h,d,f),!0;case 6:return p.fn.call(p.context,c,h,d,f,g),!0}for(w=1,m=new Array(y-1);w<y;w++)m[w-1]=arguments[w];p.fn.apply(p.context,m)}else{var S=p.length,_;for(w=0;w<S;w++)switch(p[w].once&&this.removeListener(u,p[w].fn,void 0,!0),y){case 1:p[w].fn.call(p[w].context);break;case 2:p[w].fn.call(p[w].context,c);break;case 3:p[w].fn.call(p[w].context,c,h);break;case 4:p[w].fn.call(p[w].context,c,h,d);break;default:if(!m)for(_=1,m=new Array(y-1);_<y;_++)m[_-1]=arguments[_];p[w].fn.apply(p[w].context,m)}}return!0},o.prototype.on=function(u,c,h){return a(this,u,c,h,!1)},o.prototype.once=function(u,c,h){return a(this,u,c,h,!0)},o.prototype.removeListener=function(u,c,h,d){var f=t?t+u:u;if(!this._events[f])return this;if(!c)return s(this,f),this;var g=this._events[f];if(g.fn)g.fn===c&&(!d||g.once)&&(!h||g.context===h)&&s(this,f);else{for(var v=0,p=[],y=g.length;v<y;v++)(g[v].fn!==c||d&&!g[v].once||h&&g[v].context!==h)&&p.push(g[v]);p.length?this._events[f]=p.length===1?p[0]:p:s(this,f)}return this},o.prototype.removeAllListeners=function(u){var c;return u?(c=t?t+u:u,this._events[c]&&s(this,c)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,r.exports=o}(vd)),vd.exports}var wL=bL();const wT=nl(wL);var Ot=1e-6,tn=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function xT(){var r=new tn(9);return tn!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function xL(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r}function EL(r,e,t,n,i,a,s,o,l){var u=new tn(9);return u[0]=r,u[1]=e,u[2]=t,u[3]=n,u[4]=i,u[5]=a,u[6]=s,u[7]=o,u[8]=l,u}function gt(){var r=new tn(16);return tn!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function ET(r){var e=new tn(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Ls(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function ST(r,e,t,n,i,a,s,o,l,u,c,h,d,f,g,v){var p=new tn(16);return p[0]=r,p[1]=e,p[2]=t,p[3]=n,p[4]=i,p[5]=a,p[6]=s,p[7]=o,p[8]=l,p[9]=u,p[10]=c,p[11]=h,p[12]=d,p[13]=f,p[14]=g,p[15]=v,p}function am(r,e,t,n,i,a,s,o,l,u,c,h,d,f,g,v,p){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=a,r[5]=s,r[6]=o,r[7]=l,r[8]=u,r[9]=c,r[10]=h,r[11]=d,r[12]=f,r[13]=g,r[14]=v,r[15]=p,r}function ua(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function _T(r,e){if(r===e){var t=e[1],n=e[2],i=e[3],a=e[6],s=e[7],o=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=t,r[6]=e[9],r[7]=e[13],r[8]=n,r[9]=a,r[11]=e[14],r[12]=i,r[13]=s,r[14]=o}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function si(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],g=e[12],v=e[13],p=e[14],y=e[15],m=t*o-n*s,w=t*l-i*s,S=t*u-a*s,_=n*l-i*o,O=n*u-a*o,T=i*u-a*l,k=c*v-h*g,P=c*p-d*g,C=c*y-f*g,N=h*p-d*v,L=h*y-f*v,F=d*y-f*p,G=m*F-w*L+S*N+_*C-O*P+T*k;return G?(G=1/G,r[0]=(o*F-l*L+u*N)*G,r[1]=(i*L-n*F-a*N)*G,r[2]=(v*T-p*O+y*_)*G,r[3]=(d*O-h*T-f*_)*G,r[4]=(l*C-s*F-u*P)*G,r[5]=(t*F-i*C+a*P)*G,r[6]=(p*S-g*T-y*w)*G,r[7]=(c*T-d*S+f*w)*G,r[8]=(s*L-o*C+u*k)*G,r[9]=(n*C-t*L-a*k)*G,r[10]=(g*O-v*S+y*m)*G,r[11]=(h*S-c*O-f*m)*G,r[12]=(o*P-s*N-l*k)*G,r[13]=(t*N-n*P+i*k)*G,r[14]=(v*w-g*_-p*m)*G,r[15]=(c*_-h*w+d*m)*G,r):null}function SL(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],g=e[12],v=e[13],p=e[14],y=e[15];return r[0]=o*(d*y-f*p)-h*(l*y-u*p)+v*(l*f-u*d),r[1]=-(n*(d*y-f*p)-h*(i*y-a*p)+v*(i*f-a*d)),r[2]=n*(l*y-u*p)-o*(i*y-a*p)+v*(i*u-a*l),r[3]=-(n*(l*f-u*d)-o*(i*f-a*d)+h*(i*u-a*l)),r[4]=-(s*(d*y-f*p)-c*(l*y-u*p)+g*(l*f-u*d)),r[5]=t*(d*y-f*p)-c*(i*y-a*p)+g*(i*f-a*d),r[6]=-(t*(l*y-u*p)-s*(i*y-a*p)+g*(i*u-a*l)),r[7]=t*(l*f-u*d)-s*(i*f-a*d)+c*(i*u-a*l),r[8]=s*(h*y-f*v)-c*(o*y-u*v)+g*(o*f-u*h),r[9]=-(t*(h*y-f*v)-c*(n*y-a*v)+g*(n*f-a*h)),r[10]=t*(o*y-u*v)-s*(n*y-a*v)+g*(n*u-a*o),r[11]=-(t*(o*f-u*h)-s*(n*f-a*h)+c*(n*u-a*o)),r[12]=-(s*(h*p-d*v)-c*(o*p-l*v)+g*(o*d-l*h)),r[13]=t*(h*p-d*v)-c*(n*p-i*v)+g*(n*d-i*h),r[14]=-(t*(o*p-l*v)-s*(n*p-i*v)+g*(n*l-i*o)),r[15]=t*(o*d-l*h)-s*(n*d-i*h)+c*(n*l-i*o),r}function MT(r){var e=r[0],t=r[1],n=r[2],i=r[3],a=r[4],s=r[5],o=r[6],l=r[7],u=r[8],c=r[9],h=r[10],d=r[11],f=r[12],g=r[13],v=r[14],p=r[15],y=e*s-t*a,m=e*o-n*a,w=e*l-i*a,S=t*o-n*s,_=t*l-i*s,O=n*l-i*o,T=u*g-c*f,k=u*v-h*f,P=u*p-d*f,C=c*v-h*g,N=c*p-d*g,L=h*p-d*v;return y*L-m*N+w*C+S*P-_*k+O*T}function Ln(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],f=e[10],g=e[11],v=e[12],p=e[13],y=e[14],m=e[15],w=t[0],S=t[1],_=t[2],O=t[3];return r[0]=w*n+S*o+_*h+O*v,r[1]=w*i+S*l+_*d+O*p,r[2]=w*a+S*u+_*f+O*y,r[3]=w*s+S*c+_*g+O*m,w=t[4],S=t[5],_=t[6],O=t[7],r[4]=w*n+S*o+_*h+O*v,r[5]=w*i+S*l+_*d+O*p,r[6]=w*a+S*u+_*f+O*y,r[7]=w*s+S*c+_*g+O*m,w=t[8],S=t[9],_=t[10],O=t[11],r[8]=w*n+S*o+_*h+O*v,r[9]=w*i+S*l+_*d+O*p,r[10]=w*a+S*u+_*f+O*y,r[11]=w*s+S*c+_*g+O*m,w=t[12],S=t[13],_=t[14],O=t[15],r[12]=w*n+S*o+_*h+O*v,r[13]=w*i+S*l+_*d+O*p,r[14]=w*a+S*u+_*f+O*y,r[15]=w*s+S*c+_*g+O*m,r}function Ts(r,e,t){var n=t[0],i=t[1],a=t[2],s,o,l,u,c,h,d,f,g,v,p,y;return e===r?(r[12]=e[0]*n+e[4]*i+e[8]*a+e[12],r[13]=e[1]*n+e[5]*i+e[9]*a+e[13],r[14]=e[2]*n+e[6]*i+e[10]*a+e[14],r[15]=e[3]*n+e[7]*i+e[11]*a+e[15]):(s=e[0],o=e[1],l=e[2],u=e[3],c=e[4],h=e[5],d=e[6],f=e[7],g=e[8],v=e[9],p=e[10],y=e[11],r[0]=s,r[1]=o,r[2]=l,r[3]=u,r[4]=c,r[5]=h,r[6]=d,r[7]=f,r[8]=g,r[9]=v,r[10]=p,r[11]=y,r[12]=s*n+c*i+g*a+e[12],r[13]=o*n+h*i+v*a+e[13],r[14]=l*n+d*i+p*a+e[14],r[15]=u*n+f*i+y*a+e[15]),r}function OT(r,e,t){var n=t[0],i=t[1],a=t[2];return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r[8]=e[8]*a,r[9]=e[9]*a,r[10]=e[10]*a,r[11]=e[11]*a,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function _L(r,e,t,n){var i=n[0],a=n[1],s=n[2],o=Math.hypot(i,a,s),l,u,c,h,d,f,g,v,p,y,m,w,S,_,O,T,k,P,C,N,L,F,G,V;return o<Ot?null:(o=1/o,i*=o,a*=o,s*=o,l=Math.sin(t),u=Math.cos(t),c=1-u,h=e[0],d=e[1],f=e[2],g=e[3],v=e[4],p=e[5],y=e[6],m=e[7],w=e[8],S=e[9],_=e[10],O=e[11],T=i*i*c+u,k=a*i*c+s*l,P=s*i*c-a*l,C=i*a*c-s*l,N=a*a*c+u,L=s*a*c+i*l,F=i*s*c+a*l,G=a*s*c-i*l,V=s*s*c+u,r[0]=h*T+v*k+w*P,r[1]=d*T+p*k+S*P,r[2]=f*T+y*k+_*P,r[3]=g*T+m*k+O*P,r[4]=h*C+v*N+w*L,r[5]=d*C+p*N+S*L,r[6]=f*C+y*N+_*L,r[7]=g*C+m*N+O*L,r[8]=h*F+v*G+w*V,r[9]=d*F+p*G+S*V,r[10]=f*F+y*G+_*V,r[11]=g*F+m*G+O*V,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function kT(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=a*i+u*n,r[5]=s*i+c*n,r[6]=o*i+h*n,r[7]=l*i+d*n,r[8]=u*i-a*n,r[9]=c*i-s*n,r[10]=h*i-o*n,r[11]=d*i-l*n,r}function TT(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],o=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=a*i-u*n,r[1]=s*i-c*n,r[2]=o*i-h*n,r[3]=l*i-d*n,r[8]=a*n+u*i,r[9]=s*n+c*i,r[10]=o*n+h*i,r[11]=l*n+d*i,r}function ML(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],o=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=a*i+u*n,r[1]=s*i+c*n,r[2]=o*i+h*n,r[3]=l*i+d*n,r[4]=u*i-a*n,r[5]=c*i-s*n,r[6]=h*i-o*n,r[7]=d*i-l*n,r}function Yi(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function Ta(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function AT(r,e,t){var n=t[0],i=t[1],a=t[2],s=Math.hypot(n,i,a),o,l,u;return s<Ot?null:(s=1/s,n*=s,i*=s,a*=s,o=Math.sin(e),l=Math.cos(e),u=1-l,r[0]=n*n*u+l,r[1]=i*n*u+a*o,r[2]=a*n*u-i*o,r[3]=0,r[4]=n*i*u-a*o,r[5]=i*i*u+l,r[6]=a*i*u+n*o,r[7]=0,r[8]=n*a*u+i*o,r[9]=i*a*u-n*o,r[10]=a*a*u+l,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function PT(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n,r[6]=t,r[7]=0,r[8]=0,r[9]=-t,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function CT(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=0,r[2]=-t,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=t,r[9]=0,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function sm(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=t,r[2]=0,r[3]=0,r[4]=-t,r[5]=n,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function NT(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],o=n+n,l=i+i,u=a+a,c=n*o,h=n*l,d=n*u,f=i*l,g=i*u,v=a*u,p=s*o,y=s*l,m=s*u;return r[0]=1-(f+v),r[1]=h+m,r[2]=d-y,r[3]=0,r[4]=h-m,r[5]=1-(c+v),r[6]=g+p,r[7]=0,r[8]=d+y,r[9]=g-p,r[10]=1-(c+f),r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function OL(r,e){var t=new tn(3),n=-e[0],i=-e[1],a=-e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=n*n+i*i+a*a+s*s;return h>0?(t[0]=(o*s+c*n+l*a-u*i)*2/h,t[1]=(l*s+c*i+u*n-o*a)*2/h,t[2]=(u*s+c*a+o*i-l*n)*2/h):(t[0]=(o*s+c*n+l*a-u*i)*2,t[1]=(l*s+c*i+u*n-o*a)*2,t[2]=(u*s+c*a+o*i-l*n)*2),NT(r,e,t),r}function Wu(r,e){return r[0]=e[12],r[1]=e[13],r[2]=e[14],r}function Is(r,e){var t=e[0],n=e[1],i=e[2],a=e[4],s=e[5],o=e[6],l=e[8],u=e[9],c=e[10];return r[0]=Math.hypot(t,n,i),r[1]=Math.hypot(a,s,o),r[2]=Math.hypot(l,u,c),r}function Vu(r,e){var t=new tn(3);Is(t,e);var n=1/t[0],i=1/t[1],a=1/t[2],s=e[0]*n,o=e[1]*i,l=e[2]*a,u=e[4]*n,c=e[5]*i,h=e[6]*a,d=e[8]*n,f=e[9]*i,g=e[10]*a,v=s+c+g,p=0;return v>0?(p=Math.sqrt(v+1)*2,r[3]=.25*p,r[0]=(h-f)/p,r[1]=(d-l)/p,r[2]=(o-u)/p):s>c&&s>g?(p=Math.sqrt(1+s-c-g)*2,r[3]=(h-f)/p,r[0]=.25*p,r[1]=(o+u)/p,r[2]=(d+l)/p):c>g?(p=Math.sqrt(1+c-s-g)*2,r[3]=(d-l)/p,r[0]=(o+u)/p,r[1]=.25*p,r[2]=(h+f)/p):(p=Math.sqrt(1+g-s-c)*2,r[3]=(o-u)/p,r[0]=(d+l)/p,r[1]=(h+f)/p,r[2]=.25*p),r}function kL(r,e,t,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=i+i,u=a+a,c=s+s,h=i*l,d=i*u,f=i*c,g=a*u,v=a*c,p=s*c,y=o*l,m=o*u,w=o*c,S=n[0],_=n[1],O=n[2];return r[0]=(1-(g+p))*S,r[1]=(d+w)*S,r[2]=(f-m)*S,r[3]=0,r[4]=(d-w)*_,r[5]=(1-(h+p))*_,r[6]=(v+y)*_,r[7]=0,r[8]=(f+m)*O,r[9]=(v-y)*O,r[10]=(1-(h+g))*O,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function Ao(r,e,t,n,i){var a=e[0],s=e[1],o=e[2],l=e[3],u=a+a,c=s+s,h=o+o,d=a*u,f=a*c,g=a*h,v=s*c,p=s*h,y=o*h,m=l*u,w=l*c,S=l*h,_=n[0],O=n[1],T=n[2],k=i[0],P=i[1],C=i[2],N=(1-(v+y))*_,L=(f+S)*_,F=(g-w)*_,G=(f-S)*O,V=(1-(d+y))*O,U=(p+m)*O,$=(g+w)*T,j=(p-m)*T,Z=(1-(d+v))*T;return r[0]=N,r[1]=L,r[2]=F,r[3]=0,r[4]=G,r[5]=V,r[6]=U,r[7]=0,r[8]=$,r[9]=j,r[10]=Z,r[11]=0,r[12]=t[0]+k-(N*k+G*P+$*C),r[13]=t[1]+P-(L*k+V*P+j*C),r[14]=t[2]+C-(F*k+U*P+Z*C),r[15]=1,r}function x1(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t+t,o=n+n,l=i+i,u=t*s,c=n*s,h=n*o,d=i*s,f=i*o,g=i*l,v=a*s,p=a*o,y=a*l;return r[0]=1-h-g,r[1]=c+y,r[2]=d-p,r[3]=0,r[4]=c-y,r[5]=1-u-g,r[6]=f+v,r[7]=0,r[8]=d+p,r[9]=f-v,r[10]=1-u-h,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function TL(r,e,t,n,i,a,s){var o=1/(t-e),l=1/(i-n),u=1/(a-s);return r[0]=a*2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a*2*l,r[6]=0,r[7]=0,r[8]=(t+e)*o,r[9]=(i+n)*l,r[10]=(s+a)*u,r[11]=-1,r[12]=0,r[13]=0,r[14]=s*a*2*u,r[15]=0,r}function RT(r,e,t,n,i){var a=1/Math.tan(e/2),s;return r[0]=a/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(s=1/(n-i),r[10]=(i+n)*s,r[14]=2*i*n*s):(r[10]=-1,r[14]=-2*n),r}var AL=RT;function PL(r,e,t,n,i){var a=1/Math.tan(e/2),s;return r[0]=a/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(s=1/(n-i),r[10]=i*s,r[14]=i*n*s):(r[10]=-1,r[14]=-n),r}function CL(r,e,t,n){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),l=2/(s+o),u=2/(i+a);return r[0]=l,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=u,r[6]=0,r[7]=0,r[8]=-((s-o)*l*.5),r[9]=(i-a)*u*.5,r[10]=n/(t-n),r[11]=-1,r[12]=0,r[13]=0,r[14]=n*t/(t-n),r[15]=0,r}function LT(r,e,t,n,i,a,s){var o=1/(e-t),l=1/(n-i),u=1/(a-s);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*l,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*u,r[11]=0,r[12]=(e+t)*o,r[13]=(i+n)*l,r[14]=(s+a)*u,r[15]=1,r}var IT=LT;function DT(r,e,t,n,i,a,s){var o=1/(e-t),l=1/(n-i),u=1/(a-s);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*l,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=u,r[11]=0,r[12]=(e+t)*o,r[13]=(i+n)*l,r[14]=a*u,r[15]=1,r}function FT(r,e,t,n){var i,a,s,o,l,u,c,h,d,f,g=e[0],v=e[1],p=e[2],y=n[0],m=n[1],w=n[2],S=t[0],_=t[1],O=t[2];return Math.abs(g-S)<Ot&&Math.abs(v-_)<Ot&&Math.abs(p-O)<Ot?ua(r):(c=g-S,h=v-_,d=p-O,f=1/Math.hypot(c,h,d),c*=f,h*=f,d*=f,i=m*d-w*h,a=w*c-y*d,s=y*h-m*c,f=Math.hypot(i,a,s),f?(f=1/f,i*=f,a*=f,s*=f):(i=0,a=0,s=0),o=h*s-d*a,l=d*i-c*s,u=c*a-h*i,f=Math.hypot(o,l,u),f?(f=1/f,o*=f,l*=f,u*=f):(o=0,l=0,u=0),r[0]=i,r[1]=o,r[2]=c,r[3]=0,r[4]=a,r[5]=l,r[6]=h,r[7]=0,r[8]=s,r[9]=u,r[10]=d,r[11]=0,r[12]=-(i*g+a*v+s*p),r[13]=-(o*g+l*v+u*p),r[14]=-(c*g+h*v+d*p),r[15]=1,r)}function NL(r,e,t,n){var i=e[0],a=e[1],s=e[2],o=n[0],l=n[1],u=n[2],c=i-t[0],h=a-t[1],d=s-t[2],f=c*c+h*h+d*d;f>0&&(f=1/Math.sqrt(f),c*=f,h*=f,d*=f);var g=l*d-u*h,v=u*c-o*d,p=o*h-l*c;return f=g*g+v*v+p*p,f>0&&(f=1/Math.sqrt(f),g*=f,v*=f,p*=f),r[0]=g,r[1]=v,r[2]=p,r[3]=0,r[4]=h*p-d*v,r[5]=d*g-c*p,r[6]=c*v-h*g,r[7]=0,r[8]=c,r[9]=h,r[10]=d,r[11]=0,r[12]=i,r[13]=a,r[14]=s,r[15]=1,r}function RL(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function LL(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])}function IL(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r[9]=e[9]+t[9],r[10]=e[10]+t[10],r[11]=e[11]+t[11],r[12]=e[12]+t[12],r[13]=e[13]+t[13],r[14]=e[14]+t[14],r[15]=e[15]+t[15],r}function BT(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r[9]=e[9]-t[9],r[10]=e[10]-t[10],r[11]=e[11]-t[11],r[12]=e[12]-t[12],r[13]=e[13]-t[13],r[14]=e[14]-t[14],r[15]=e[15]-t[15],r}function DL(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r[9]=e[9]*t,r[10]=e[10]*t,r[11]=e[11]*t,r[12]=e[12]*t,r[13]=e[13]*t,r[14]=e[14]*t,r[15]=e[15]*t,r}function FL(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r[4]=e[4]+t[4]*n,r[5]=e[5]+t[5]*n,r[6]=e[6]+t[6]*n,r[7]=e[7]+t[7]*n,r[8]=e[8]+t[8]*n,r[9]=e[9]+t[9]*n,r[10]=e[10]+t[10]*n,r[11]=e[11]+t[11]*n,r[12]=e[12]+t[12]*n,r[13]=e[13]+t[13]*n,r[14]=e[14]+t[14]*n,r[15]=e[15]+t[15]*n,r}function om(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]}function BL(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=r[4],o=r[5],l=r[6],u=r[7],c=r[8],h=r[9],d=r[10],f=r[11],g=r[12],v=r[13],p=r[14],y=r[15],m=e[0],w=e[1],S=e[2],_=e[3],O=e[4],T=e[5],k=e[6],P=e[7],C=e[8],N=e[9],L=e[10],F=e[11],G=e[12],V=e[13],U=e[14],$=e[15];return Math.abs(t-m)<=Ot*Math.max(1,Math.abs(t),Math.abs(m))&&Math.abs(n-w)<=Ot*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(i-S)<=Ot*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(a-_)<=Ot*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(s-O)<=Ot*Math.max(1,Math.abs(s),Math.abs(O))&&Math.abs(o-T)<=Ot*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(l-k)<=Ot*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(u-P)<=Ot*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(c-C)<=Ot*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-N)<=Ot*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(d-L)<=Ot*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(f-F)<=Ot*Math.max(1,Math.abs(f),Math.abs(F))&&Math.abs(g-G)<=Ot*Math.max(1,Math.abs(g),Math.abs(G))&&Math.abs(v-V)<=Ot*Math.max(1,Math.abs(v),Math.abs(V))&&Math.abs(p-U)<=Ot*Math.max(1,Math.abs(p),Math.abs(U))&&Math.abs(y-$)<=Ot*Math.max(1,Math.abs(y),Math.abs($))}var zT=Ln,zL=BT;const jL=Object.freeze(Object.defineProperty({__proto__:null,add:IL,adjoint:SL,clone:ET,copy:Ls,create:gt,determinant:MT,equals:BL,exactEquals:om,frob:LL,fromQuat:x1,fromQuat2:OL,fromRotation:AT,fromRotationTranslation:NT,fromRotationTranslationScale:kL,fromRotationTranslationScaleOrigin:Ao,fromScaling:Ta,fromTranslation:Yi,fromValues:ST,fromXRotation:PT,fromYRotation:CT,fromZRotation:sm,frustum:TL,getRotation:Vu,getScaling:Is,getTranslation:Wu,identity:ua,invert:si,lookAt:FT,mul:zT,multiply:Ln,multiplyScalar:DL,multiplyScalarAndAdd:FL,ortho:IT,orthoNO:LT,orthoZO:DT,perspective:AL,perspectiveFromFieldOfView:CL,perspectiveNO:RT,perspectiveZO:PL,rotate:_L,rotateX:kT,rotateY:TT,rotateZ:ML,scale:OT,set:am,str:RL,sub:zL,subtract:BT,targetTo:NL,translate:Ts,transpose:_T},Symbol.toStringTag,{value:"Module"}));function Qe(){var r=new tn(3);return tn!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function xi(r){var e=new tn(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function Si(r){var e=r[0],t=r[1],n=r[2];return Math.hypot(e,t,n)}function mt(r,e,t){var n=new tn(3);return n[0]=r,n[1]=e,n[2]=t,n}function oi(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function Nn(r,e,t,n){return r[0]=e,r[1]=t,r[2]=n,r}function ia(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function lm(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function qL(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r}function $L(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r}function GL(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r}function Uu(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function WL(r,e){var t=e[0]-r[0],n=e[1]-r[1],i=e[2]-r[2];return Math.hypot(t,n,i)}function Da(r,e){var t=e[0],n=e[1],i=e[2],a=t*t+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r}function li(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function Cu(r,e,t){var n=e[0],i=e[1],a=e[2],s=t[0],o=t[1],l=t[2];return r[0]=i*l-a*o,r[1]=a*s-n*l,r[2]=n*o-i*s,r}function um(r,e,t,n){var i=e[0],a=e[1],s=e[2];return r[0]=i+n*(t[0]-i),r[1]=a+n*(t[1]-a),r[2]=s+n*(t[2]-s),r}function In(r,e,t){var n=e[0],i=e[1],a=e[2],s=t[3]*n+t[7]*i+t[11]*a+t[15];return s=s||1,r[0]=(t[0]*n+t[4]*i+t[8]*a+t[12])/s,r[1]=(t[1]*n+t[5]*i+t[9]*a+t[13])/s,r[2]=(t[2]*n+t[6]*i+t[10]*a+t[14])/s,r}function VL(r,e,t){var n=e[0],i=e[1],a=e[2];return r[0]=n*t[0]+i*t[3]+a*t[6],r[1]=n*t[1]+i*t[4]+a*t[7],r[2]=n*t[2]+i*t[5]+a*t[8],r}function UL(r,e,t){var n=t[0],i=t[1],a=t[2],s=t[3],o=e[0],l=e[1],u=e[2],c=i*u-a*l,h=a*o-n*u,d=n*l-i*o,f=i*d-a*h,g=a*c-n*d,v=n*h-i*c,p=s*2;return c*=p,h*=p,d*=p,f*=2,g*=2,v*=2,r[0]=o+c+f,r[1]=l+h+g,r[2]=u+d+v,r}function io(r,e){var t=r[0],n=r[1],i=r[2],a=e[0],s=e[1],o=e[2];return Math.abs(t-a)<=Ot*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(n-s)<=Ot*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-o)<=Ot*Math.max(1,Math.abs(i),Math.abs(o))}var HL=lm,Zb=WL,jT=Si;(function(){var r=Qe();return function(e,t,n,i,a,s){var o,l;for(t||(t=3),n||(n=0),i?l=Math.min(i*t+n,e.length):l=e.length,o=n;o<l;o+=t)r[0]=e[o],r[1]=e[o+1],r[2]=e[o+2],a(r,r,s),e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2];return e}})();function ui(){var r=new tn(4);return tn!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function mo(r,e,t,n){var i=new tn(4);return i[0]=r,i[1]=e,i[2]=t,i[3]=n,i}function YL(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function XL(r,e,t,n,i){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r}function KL(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t*t+n*n+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),r[0]=t*s,r[1]=n*s,r[2]=i*s,r[3]=a*s,r}function Ti(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3];return r[0]=t[0]*n+t[4]*i+t[8]*a+t[12]*s,r[1]=t[1]*n+t[5]*i+t[9]*a+t[13]*s,r[2]=t[2]*n+t[6]*i+t[10]*a+t[14]*s,r[3]=t[3]*n+t[7]*i+t[11]*a+t[15]*s,r}(function(){var r=ui();return function(e,t,n,i,a,s){var o,l;for(t||(t=4),n||(n=0),i?l=Math.min(i*t+n,e.length):l=e.length,o=n;o<l;o+=t)r[0]=e[o],r[1]=e[o+1],r[2]=e[o+2],r[3]=e[o+3],a(r,r,s),e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2],e[o+3]=r[3];return e}})();function on(){var r=new tn(4);return tn!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Ki(r,e,t){t=t*.5;var n=Math.sin(t);return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=Math.cos(t),r}function aa(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],o=t[0],l=t[1],u=t[2],c=t[3];return r[0]=n*c+s*o+i*u-a*l,r[1]=i*c+s*l+a*o-n*u,r[2]=a*c+s*u+n*l-i*o,r[3]=s*c-n*o-i*l-a*u,r}function yd(r,e,t,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=t[0],u=t[1],c=t[2],h=t[3],d,f,g,v,p;return f=i*l+a*u+s*c+o*h,f<0&&(f=-f,l=-l,u=-u,c=-c,h=-h),1-f>Ot?(d=Math.acos(f),g=Math.sin(d),v=Math.sin((1-n)*d)/g,p=Math.sin(n*d)/g):(v=1-n,p=n),r[0]=v*i+p*l,r[1]=v*a+p*u,r[2]=v*s+p*c,r[3]=v*o+p*h,r}function md(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t*t+n*n+i*i+a*a,o=s?1/s:0;return r[0]=-t*o,r[1]=-n*o,r[2]=-i*o,r[3]=a*o,r}function ZL(r,e){var t=e[0]+e[4]+e[8],n;if(t>0)n=Math.sqrt(t+1),r[3]=.5*n,n=.5/n,r[0]=(e[5]-e[7])*n,r[1]=(e[6]-e[2])*n,r[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[i*3+i]-e[a*3+a]-e[s*3+s]+1),r[i]=.5*n,n=.5/n,r[3]=(e[a*3+s]-e[s*3+a])*n,r[a]=(e[a*3+i]+e[i*3+a])*n,r[s]=(e[s*3+i]+e[i*3+s])*n}return r}function Rl(r,e,t,n){var i=.5*Math.PI/180;e*=i,t*=i,n*=i;var a=Math.sin(e),s=Math.cos(e),o=Math.sin(t),l=Math.cos(t),u=Math.sin(n),c=Math.cos(n);return r[0]=a*l*c-s*o*u,r[1]=s*o*c+a*l*u,r[2]=s*l*u-a*o*c,r[3]=s*l*c+a*o*u,r}var JL=mo,Ll=YL,Jb=XL,Qb=aa,Hu=KL;(function(){var r=Qe(),e=mt(1,0,0),t=mt(0,1,0);return function(n,i,a){var s=li(i,a);return s<-.999999?(Cu(r,e,i),jT(r)<1e-6&&Cu(r,t,i),Da(r,r),Ki(n,r,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Cu(r,i,a),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+s,Hu(n,n))}})();(function(){var r=on(),e=on();return function(t,n,i,a,s,o){return yd(r,n,s,o),yd(e,i,a,o),yd(t,r,e,2*o*(1-o)),t}})();(function(){var r=xT();return function(e,t,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-t[0],r[5]=-t[1],r[8]=-t[2],Hu(e,ZL(e,r))}})();function E1(){var r=new tn(2);return tn!=Float32Array&&(r[0]=0,r[1]=0),r}function QL(r,e){return r[0]=e[0],r[1]=e[1],r}function e3(r,e,t){return r[0]=e,r[1]=t,r}function t3(r,e){var t=e[0],n=e[1],i=t*t+n*n;return i>0&&(i=1/Math.sqrt(i)),r[0]=e[0]*i,r[1]=e[1]*i,r}function n3(r,e){return r[0]*e[0]+r[1]*e[1]}function r3(r,e){return r[0]===e[0]&&r[1]===e[1]}(function(){var r=E1();return function(e,t,n,i,a,s){var o,l;for(t||(t=2),n||(n=0),i?l=Math.min(i*t+n,e.length):l=e.length,o=n;o<l;o+=t)r[0]=e[o],r[1]=e[o+1],a(r,r,s),e[o]=r[0],e[o+1]=r[1];return e}})();var Fo=function(r){return r!==null&&typeof r!="function"&&isFinite(r.length)},i3=function(r,e){return Fo(r)?r.indexOf(e)>-1:!1},a3=function(r,e){if(!Fo(r))return r;for(var t=[],n=0;n<r.length;n++){var i=r[n];e(i,n)&&t.push(i)}return t},s3=function(r,e){return e===void 0&&(e=[]),a3(r,function(t){return!i3(e,t)})};function Te(r){return typeof r=="function"}function Le(r){return r==null}function pr(r){return Array.isArray(r)}const Yt=function(r){var e=typeof r;return r!==null&&e==="object"||e==="function"};function qT(r,e){if(r){var t;if(pr(r))for(var n=0,i=r.length;n<i&&(t=e(r[n],n),t!==!1);n++);else if(Yt(r)){for(var a in r)if(r.hasOwnProperty(a)&&(t=e(r[a],a),t===!1))break}}}var cm=function(r){return typeof r=="object"&&r!==null},o3={}.toString,$T=function(r,e){return o3.call(r)==="[object "+e+"]"},Ds=function(r){if(!cm(r)||!$T(r,"Object"))return!1;if(Object.getPrototypeOf(r)===null)return!0;for(var e=r;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e};function Yu(r){if(!Array.isArray(r))return-1/0;var e=r.length;if(!e)return-1/0;for(var t=r[0],n=1;n<e;n++)t=Math.max(t,r[n]);return t}const Xu=function(r){if(pr(r))return r.reduce(function(e,t){return Math.min(e,t)},r[0])};var l3=function(r,e,t){if(!pr(r)&&!Ds(r))return r;var n=t;return qT(r,function(i,a){n=e(n,i,a)}),n};function rt(r){return typeof r=="string"}function u3(r,e){e===void 0&&(e=new Map);var t=[];if(Array.isArray(r))for(var n=0,i=r.length;n<i;n++){var a=r[n];e.has(a)||(t.push(a),e.set(a,!0))}return t}var c3=Object.prototype.hasOwnProperty;function Ac(r,e){if(!e||!pr(r))return{};for(var t={},n=Te(e)?e:function(o){return o[e]},i,a=0;a<r.length;a++){var s=r[a];i=n(s),c3.call(t,i)?t[i].push(s):t[i]=[s]}return t}var Bt=function(r,e,t){return r<e?e:r>t?t:r};function _e(r){return typeof r=="number"}var h3=1e-5;function Po(r,e,t){return t===void 0&&(t=h3),r===e||Math.abs(r-e)<t}const d3=function(r,e){if(pr(r)){for(var t,n=-1/0,i=0;i<r.length;i++){var a=r[i],s=Te(e)?e(a):a[e];s>n&&(t=a,n=s)}return t}},f3=function(r,e){if(pr(r)){for(var t,n=1/0,i=0;i<r.length;i++){var a=r[i],s=Te(e)?e(a):a[e];s<n&&(t=a,n=s)}return t}};var GT=function(r,e){return(r%e+e)%e};const WT=function(r){return Le(r)?"":r.toString()};var g3=function(r){var e=WT(r);return e.charAt(0).toLowerCase()+e.substring(1)};function p3(r,e){return!r||!e?r:r.replace(/\\?\{([^{}]+)\}/g,function(t,n){return t.charAt(0)==="\\"?t.slice(1):e[n]===void 0?"":e[n]})}var Ku=function(r){var e=WT(r);return e.charAt(0).toUpperCase()+e.substring(1)},v3={}.toString,y3=function(r){return v3.call(r).replace(/^\[object /,"").replace(/]$/,"")},Zu=function(r){return $T(r,"Boolean")};function m3(r){return r instanceof Date}function b3(r){return r===null}var w3=Object.prototype,x3=function(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||w3;return r===t},Be=function(r){return r===void 0},ca=function(r){if(typeof r!="object"||r===null)return r;var e;if(pr(r)){e=[];for(var t=0,n=r.length;t<n;t++)typeof r[t]=="object"&&r[t]!=null?e[t]=ca(r[t]):e[t]=r[t]}else{e={};for(var i in r)typeof r[i]=="object"&&r[i]!=null?e[i]=ca(r[i]):e[i]=r[i]}return e};function rl(r,e,t){var n;return function(){var i=this,a=arguments,s=function(){n=null,t||r.apply(i,a)},o=t&&!n;clearTimeout(n),n=setTimeout(s,e),o&&r.apply(i,a)}}function E3(r){var e,t,n,i=r||1;function a(o,l){++e>i&&(n=t,s(1),++e),t[o]=l}function s(o){e=0,t=Object.create(null),o||(n=Object.create(null))}return s(),{clear:s,has:function(o){return t[o]!==void 0||n[o]!==void 0},get:function(o){var l=t[o];if(l!==void 0)return l;if((l=n[o])!==void 0)return a(o,l),l},set:function(o,l){t[o]!==void 0?t[o]=l:a(o,l)}}}var bd=new Map;function hm(r,e,t){t===void 0&&(t=128);var n=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var s=e?e.apply(this,i):i[0];bd.has(r)||bd.set(r,E3(t));var o=bd.get(r);if(o.has(s))return o.get(s);var l=r.apply(this,i);return o.set(s,l),l};return n}var S3=5;function _3(r,e){if(Object.hasOwn)return Object.hasOwn(r,e);if(r==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(r),e)}function VT(r,e,t,n){t=t||0,n=n||S3;for(var i in e)if(_3(e,i)){var a=e[i];a!==null&&Ds(a)?(Ds(r[i])||(r[i]={}),t<n?VT(r[i],a,t+1,n):r[i]=e[i]):pr(a)?(r[i]=[],r[i]=r[i].concat(a)):a!==void 0&&(r[i]=a)}}var $n=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n+=1)VT(r,e[n]);return r},M3=Object.prototype.hasOwnProperty;function ai(r){if(Le(r))return!0;if(Fo(r))return!r.length;var e=y3(r);if(e==="Map"||e==="Set")return!r.size;if(x3(r))return!Object.keys(r).length;for(var t in r)if(M3.call(r,t))return!1;return!0}var zt=function(r,e){if(r===e)return!0;if(!r||!e||rt(r)||rt(e))return!1;if(Fo(r)||Fo(e)){if(r.length!==e.length)return!1;for(var t=!0,n=0;n<r.length&&(t=zt(r[n],e[n]),!!t);n++);return t}if(cm(r)||cm(e)){var i=Object.keys(r),a=Object.keys(e);if(i.length!==a.length)return!1;for(var t=!0,n=0;n<i.length&&(t=zt(r[i[n]],e[i[n]]),!!t);n++);return t}return!1};const Bn=function(r,e,t){for(var n=0,i=rt(e)?e.split("."):e;r&&n<i.length;)r=r[i[n++]];return r===void 0||n<i.length?t:r},Bo=function(r,e,t){var n=r,i=rt(e)?e.split("."):e;return i.forEach(function(a,s){s<i.length-1?(Yt(n[a])||(n[a]=_e(i[s+1])?[]:{}),n=n[a]):n[a]=t}),r};var O3=Object.prototype.hasOwnProperty;const Ga=function(r,e){if(r===null||!Ds(r))return{};var t={};return qT(e,function(n){O3.call(r,n)&&(t[n]=r[n])}),t},S1=function(r,e){return l3(r,function(t,n,i){return e.includes(i)||(t[i]=n),t},{})},UT=function(r,e,t){var n,i,a,s,o=0;t||(t={});var l=function(){o=t.leading===!1?0:Date.now(),n=null,s=r.apply(i,a),n||(i=a=null)},u=function(){var c=Date.now();!o&&t.leading===!1&&(o=c);var h=e-(c-o);return i=this,a=arguments,h<=0||h>e?(n&&(clearTimeout(n),n=null),o=c,s=r.apply(i,a),n||(i=a=null)):!n&&t.trailing!==!1&&(n=setTimeout(l,h)),s};return u.cancel=function(){clearTimeout(n),o=0,n=i=a=null},u};var Il={};const k3=function(r){return r=r||"g",Il[r]?Il[r]+=1:Il[r]=1,r+Il[r]},wd=function(){},dm=function(r){return r};var fm=function(r,e){return fm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},fm(r,e)};function Xe(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");fm(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ce=function(){return ce=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},ce.apply(this,arguments)};function $t(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function Ye(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})}function il(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function q(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,a=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(o){s={error:o}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(s)throw s.error}}return a}function T3(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function Ee(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return r.concat(a||Array.prototype.slice.call(e))}function xd(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}var HT={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function A3(r,e,t){if(r[t].length>7){r[t].shift();for(var n=r[t],i=t;n.length;)e[t]="A",r.splice(i+=1,0,["C"].concat(n.splice(0,6)));r.splice(t,1)}}var Co={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function YT(r){return Array.isArray(r)&&r.every(function(e){var t=e[0].toLowerCase();return Co[t]===e.length-1&&"achlmqstvz".includes(t)})}function XT(r){return YT(r)&&r.every(function(e){var t=e[0];return t===t.toUpperCase()})}function KT(r){return XT(r)&&r.every(function(e){var t=e[0];return"ACLMQZ".includes(t)})}function ew(r){for(var e=r.pathValue[r.segmentStart],t=e.toLowerCase(),n=r.data;n.length>=Co[t]&&(t==="m"&&n.length>2?(r.segments.push([e].concat(n.splice(0,2))),t="l",e=e==="m"?"l":"L"):r.segments.push([e].concat(n.splice(0,Co[t]))),!!Co[t]););}function P3(r){var e=r.index,t=r.pathValue,n=t.charCodeAt(e);if(n===48){r.param=0,r.index+=1;return}if(n===49){r.param=1,r.index+=1;return}r.err='[path-util]: invalid Arc flag "'.concat(t[e],'", expecting 0 or 1 at index ').concat(e)}function C3(r){return r>=48&&r<=57||r===43||r===45||r===46}function hs(r){return r>=48&&r<=57}function N3(r){var e=r.max,t=r.pathValue,n=r.index,i=n,a=!1,s=!1,o=!1,l=!1,u;if(i>=e){r.err="[path-util]: Invalid path value at index ".concat(i,', "pathValue" is missing param');return}if(u=t.charCodeAt(i),(u===43||u===45)&&(i+=1,u=t.charCodeAt(i)),!hs(u)&&u!==46){r.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(t[i],'" is not a number');return}if(u!==46){if(a=u===48,i+=1,u=t.charCodeAt(i),a&&i<e&&u&&hs(u)){r.err="[path-util]: Invalid path value at index ".concat(n,', "').concat(t[n],'" illegal number');return}for(;i<e&&hs(t.charCodeAt(i));)i+=1,s=!0;u=t.charCodeAt(i)}if(u===46){for(l=!0,i+=1;hs(t.charCodeAt(i));)i+=1,o=!0;u=t.charCodeAt(i)}if(u===101||u===69){if(l&&!s&&!o){r.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(t[i],'" invalid float exponent');return}if(i+=1,u=t.charCodeAt(i),(u===43||u===45)&&(i+=1),i<e&&hs(t.charCodeAt(i)))for(;i<e&&hs(t.charCodeAt(i));)i+=1;else{r.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(t[i],'" invalid integer exponent');return}}r.index=i,r.param=+r.pathValue.slice(n,i)}function R3(r){var e=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return r===10||r===13||r===8232||r===8233||r===32||r===9||r===11||r===12||r===160||r>=5760&&e.includes(r)}function Nu(r){for(var e=r.pathValue,t=r.max;r.index<t&&R3(e.charCodeAt(r.index));)r.index+=1}function L3(r){switch(r|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function I3(r){return(r|32)===97}function D3(r){var e=r.max,t=r.pathValue,n=r.index,i=t.charCodeAt(n),a=Co[t[n].toLowerCase()];if(r.segmentStart=n,!L3(i)){r.err='[path-util]: Invalid path value "'.concat(t[n],'" is not a path command');return}if(r.index+=1,Nu(r),r.data=[],!a){ew(r);return}for(;;){for(var s=a;s>0;s-=1){if(I3(i)&&(s===3||s===4)?P3(r):N3(r),r.err.length)return;r.data.push(r.param),Nu(r),r.index<e&&t.charCodeAt(r.index)===44&&(r.index+=1,Nu(r))}if(r.index>=r.max||!C3(t.charCodeAt(r.index)))break}ew(r)}var F3=function(){function r(e){this.pathValue=e,this.segments=[],this.max=e.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return r}();function B3(r){if(YT(r))return[].concat(r);var e=new F3(r);for(Nu(e);e.index<e.max&&!e.err.length;)D3(e);return e.err?e.err:e.segments}function z3(r){if(XT(r))return[].concat(r);var e=B3(r),t=0,n=0,i=0,a=0;return e.map(function(s){var o=s.slice(1).map(Number),l=s[0],u=l.toUpperCase();if(l==="M")return t=o[0],n=o[1],i=t,a=n,["M",t,n];var c;if(l!==u)switch(u){case"A":c=[u,o[0],o[1],o[2],o[3],o[4],o[5]+t,o[6]+n];break;case"V":c=[u,o[0]+n];break;case"H":c=[u,o[0]+t];break;default:{var h=o.map(function(f,g){return f+(g%2?n:t)});c=[u].concat(h)}}else c=[u].concat(o);var d=c.length;switch(u){case"Z":t=i,n=a;break;case"H":t=c[1];break;case"V":n=c[1];break;default:t=c[d-2],n=c[d-1],u==="M"&&(i=t,a=n)}return c})}function j3(r,e){var t=r[0],n=e.x1,i=e.y1,a=e.x2,s=e.y2,o=r.slice(1).map(Number),l=r;if("TQ".includes(t)||(e.qx=null,e.qy=null),t==="H")l=["L",r[1],i];else if(t==="V")l=["L",n,r[1]];else if(t==="S"){var u=n*2-a,c=i*2-s;e.x1=u,e.y1=c,l=["C",u,c].concat(o)}else if(t==="T"){var h=n*2-e.qx,d=i*2-e.qy;e.qx=h,e.qy=d,l=["Q",h,d].concat(o)}else if(t==="Q"){var f=o[0],g=o[1];e.qx=f,e.qy=g}return l}function Ju(r){if(KT(r))return[].concat(r);for(var e=z3(r),t=ce({},HT),n=0;n<e.length;n+=1){e[n]=j3(e[n],t);var i=e[n],a=i.length;t.x1=+i[a-2],t.y1=+i[a-1],t.x2=+i[a-4]||t.x1,t.y2=+i[a-3]||t.y1}return e}function q3(r){return KT(r)&&r.every(function(e){var t=e[0];return"MC".includes(t)})}function Dl(r,e,t){var n=r*Math.cos(t)-e*Math.sin(t),i=r*Math.sin(t)+e*Math.cos(t);return{x:n,y:i}}function _1(r,e,t,n,i,a,s,o,l,u){var c=r,h=e,d=t,f=n,g=o,v=l,p=Math.PI*120/180,y=Math.PI/180*(+i||0),m=[],w,S,_,O,T;if(u)S=u[0],_=u[1],O=u[2],T=u[3];else{w=Dl(c,h,-y),c=w.x,h=w.y,w=Dl(g,v,-y),g=w.x,v=w.y;var k=(c-g)/2,P=(h-v)/2,C=k*k/(d*d)+P*P/(f*f);C>1&&(C=Math.sqrt(C),d*=C,f*=C);var N=d*d,L=f*f,F=(a===s?-1:1)*Math.sqrt(Math.abs((N*L-N*P*P-L*k*k)/(N*P*P+L*k*k)));O=F*d*P/f+(c+g)/2,T=F*-f*k/d+(h+v)/2,S=Math.asin(((h-T)/f*Math.pow(10,9)>>0)/Math.pow(10,9)),_=Math.asin(((v-T)/f*Math.pow(10,9)>>0)/Math.pow(10,9)),S=c<O?Math.PI-S:S,_=g<O?Math.PI-_:_,S<0&&(S=Math.PI*2+S),_<0&&(_=Math.PI*2+_),s&&S>_&&(S-=Math.PI*2),!s&&_>S&&(_-=Math.PI*2)}var G=_-S;if(Math.abs(G)>p){var V=_,U=g,$=v;_=S+p*(s&&_>S?1:-1),g=O+d*Math.cos(_),v=T+f*Math.sin(_),m=_1(g,v,d,f,i,0,s,U,$,[_,V,O,T])}G=_-S;var j=Math.cos(S),Z=Math.sin(S),ne=Math.cos(_),oe=Math.sin(_),le=Math.tan(G/4),Ce=4/3*d*le,K=4/3*f*le,W=[c,h],ee=[c+Ce*Z,h-K*j],he=[g+Ce*oe,v-K*ne],Se=[g,v];if(ee[0]=2*W[0]-ee[0],ee[1]=2*W[1]-ee[1],u)return ee.concat(he,Se,m);m=ee.concat(he,Se,m);for(var Ne=[],Ue=0,Tt=m.length;Ue<Tt;Ue+=1)Ne[Ue]=Ue%2?Dl(m[Ue-1],m[Ue],y).y:Dl(m[Ue],m[Ue+1],y).x;return Ne}function $3(r,e,t,n,i,a){var s=.3333333333333333,o=2/3;return[s*r+o*t,s*e+o*n,s*i+o*t,s*a+o*n,i,a]}function Ui(r,e,t){var n=r[0],i=r[1],a=e[0],s=e[1];return[n+(a-n)*t,i+(s-i)*t]}var tw=function(r,e,t,n){var i=.5,a=Ui([r,e],[t,n],i);return Ee(Ee([],a,!0),[t,n,t,n],!1)};function G3(r,e){var t=r[0],n=r.slice(1).map(Number),i=n[0],a=n[1],s,o=e.x1,l=e.y1,u=e.x,c=e.y;switch("TQ".includes(t)||(e.qx=null,e.qy=null),t){case"M":return e.x=i,e.y=a,r;case"A":return s=[o,l].concat(n),["C"].concat(_1(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9]));case"Q":return e.qx=i,e.qy=a,s=[o,l].concat(n),["C"].concat($3(s[0],s[1],s[2],s[3],s[4],s[5]));case"L":return["C"].concat(tw(o,l,i,a));case"Z":return o===u&&l===c?["C",o,l,u,c,u,c]:["C"].concat(tw(o,l,u,c))}return r}function gm(r,e){if(e===void 0&&(e=!1),q3(r)){var t=[].concat(r);return e?[t,[]]:t}for(var n=Ju(r),i=ce({},HT),a=[],s="",o=n.length,l,u,c=[],h=0;h<o;h+=1){n[h]&&(s=n[h][0]),a[h]=s;var d=G3(n[h],i);n[h]=d,A3(n,a,h),o=n.length,s==="Z"&&c.push(h),l=n[h],u=l.length,i.x1=+l[u-2],i.y1=+l[u-1],i.x2=+l[u-4]||i.x1,i.y2=+l[u-3]||i.y1}return e?[n,c]:n}function W3(r){return r.map(function(e){return Array.isArray(e)?[].concat(e):e})}function V3(r){var e=r.slice(1).map(function(t,n,i){return n?i[n-1].slice(-2).concat(t.slice(1)):r[0].slice(1).concat(t.slice(1))}).map(function(t){return t.map(function(n,i){return t[t.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(e[0].slice(0,2))].concat(e.map(function(t){return["C"].concat(t.slice(2))}))}function Xn(r,e){return Math.sqrt((r[0]-e[0])*(r[0]-e[0])+(r[1]-e[1])*(r[1]-e[1]))}function pm(r,e,t,n,i){var a=Xn([r,e],[t,n]),s={x:0,y:0};if(typeof i=="number")if(i<=0)s={x:r,y:e};else if(i>=a)s={x:t,y:n};else{var o=Ui([r,e],[t,n],i/a),l=o[0],u=o[1];s={x:l,y:u}}return{length:a,point:s,min:{x:Math.min(r,t),y:Math.min(e,n)},max:{x:Math.max(r,t),y:Math.max(e,n)}}}function nw(r,e){var t=r.x,n=r.y,i=e.x,a=e.y,s=t*i+n*a,o=Math.sqrt((Math.pow(t,2)+Math.pow(n,2))*(Math.pow(i,2)+Math.pow(a,2))),l=t*a-n*i<0?-1:1,u=l*Math.acos(s/o);return u}function U3(r,e,t,n,i,a,s,o,l,u){var c=Math.abs,h=Math.sin,d=Math.cos,f=Math.sqrt,g=Math.PI,v=c(t),p=c(n),y=(i%360+360)%360,m=y*(g/180);if(r===o&&e===l)return{x:r,y:e};if(v===0||p===0)return pm(r,e,o,l,u).point;var w=(r-o)/2,S=(e-l)/2,_={x:d(m)*w+h(m)*S,y:-h(m)*w+d(m)*S},O=Math.pow(_.x,2)/Math.pow(v,2)+Math.pow(_.y,2)/Math.pow(p,2);O>1&&(v*=f(O),p*=f(O));var T=Math.pow(v,2)*Math.pow(p,2)-Math.pow(v,2)*Math.pow(_.y,2)-Math.pow(p,2)*Math.pow(_.x,2),k=Math.pow(v,2)*Math.pow(_.y,2)+Math.pow(p,2)*Math.pow(_.x,2),P=T/k;P=P<0?0:P;var C=(a!==s?1:-1)*f(P),N={x:C*(v*_.y/p),y:C*(-(p*_.x)/v)},L={x:d(m)*N.x-h(m)*N.y+(r+o)/2,y:h(m)*N.x+d(m)*N.y+(e+l)/2},F={x:(_.x-N.x)/v,y:(_.y-N.y)/p},G=nw({x:1,y:0},F),V={x:(-_.x-N.x)/v,y:(-_.y-N.y)/p},U=nw(F,V);!s&&U>0?U-=2*g:s&&U<0&&(U+=2*g),U%=2*g;var $=G+U*u,j=v*d($),Z=p*h($),ne={x:d(m)*j-h(m)*Z+L.x,y:h(m)*j+d(m)*Z+L.y};return ne}function H3(r,e,t,n,i,a,s,o,l,u,c){var h,d=c.bbox,f=d===void 0?!0:d,g=c.length,v=g===void 0?!0:g,p=c.sampleSize,y=p===void 0?30:p,m=typeof u=="number",w=r,S=e,_=0,O=[w,S,_],T=[w,S],k=0,P={x:0,y:0},C=[{x:w,y:S}];m&&u<=0&&(P={x:w,y:S});for(var N=0;N<=y;N+=1){if(k=N/y,h=U3(r,e,t,n,i,a,s,o,l,k),w=h.x,S=h.y,f&&C.push({x:w,y:S}),v&&(_+=Xn(T,[w,S])),T=[w,S],m&&_>=u&&u>O[2]){var L=(_-u)/(_-O[2]);P={x:T[0]*(1-L)+O[0]*L,y:T[1]*(1-L)+O[1]*L}}O=[w,S,_]}return m&&u>=_&&(P={x:o,y:l}),{length:_,point:P,min:{x:Math.min.apply(null,C.map(function(F){return F.x})),y:Math.min.apply(null,C.map(function(F){return F.y}))},max:{x:Math.max.apply(null,C.map(function(F){return F.x})),y:Math.max.apply(null,C.map(function(F){return F.y}))}}}function Y3(r,e,t,n,i,a,s,o,l){var u=1-l;return{x:Math.pow(u,3)*r+3*Math.pow(u,2)*l*t+3*u*Math.pow(l,2)*i+Math.pow(l,3)*s,y:Math.pow(u,3)*e+3*Math.pow(u,2)*l*n+3*u*Math.pow(l,2)*a+Math.pow(l,3)*o}}function ZT(r,e,t,n,i,a,s,o,l,u){var c,h=u.bbox,d=h===void 0?!0:h,f=u.length,g=f===void 0?!0:f,v=u.sampleSize,p=v===void 0?10:v,y=typeof l=="number",m=r,w=e,S=0,_=[m,w,S],O=[m,w],T=0,k={x:0,y:0},P=[{x:m,y:w}];y&&l<=0&&(k={x:m,y:w});for(var C=0;C<=p;C+=1){if(T=C/p,c=Y3(r,e,t,n,i,a,s,o,T),m=c.x,w=c.y,d&&P.push({x:m,y:w}),g&&(S+=Xn(O,[m,w])),O=[m,w],y&&S>=l&&l>_[2]){var N=(S-l)/(S-_[2]);k={x:O[0]*(1-N)+_[0]*N,y:O[1]*(1-N)+_[1]*N}}_=[m,w,S]}return y&&l>=S&&(k={x:s,y:o}),{length:S,point:k,min:{x:Math.min.apply(null,P.map(function(L){return L.x})),y:Math.min.apply(null,P.map(function(L){return L.y}))},max:{x:Math.max.apply(null,P.map(function(L){return L.x})),y:Math.max.apply(null,P.map(function(L){return L.y}))}}}function X3(r,e,t,n,i,a,s){var o=1-s;return{x:Math.pow(o,2)*r+2*o*s*t+Math.pow(s,2)*i,y:Math.pow(o,2)*e+2*o*s*n+Math.pow(s,2)*a}}function K3(r,e,t,n,i,a,s,o){var l,u=o.bbox,c=u===void 0?!0:u,h=o.length,d=h===void 0?!0:h,f=o.sampleSize,g=f===void 0?10:f,v=typeof s=="number",p=r,y=e,m=0,w=[p,y,m],S=[p,y],_=0,O={x:0,y:0},T=[{x:p,y}];v&&s<=0&&(O={x:p,y});for(var k=0;k<=g;k+=1){if(_=k/g,l=X3(r,e,t,n,i,a,_),p=l.x,y=l.y,c&&T.push({x:p,y}),d&&(m+=Xn(S,[p,y])),S=[p,y],v&&m>=s&&s>w[2]){var P=(m-s)/(m-w[2]);O={x:S[0]*(1-P)+w[0]*P,y:S[1]*(1-P)+w[1]*P}}w=[p,y,m]}return v&&s>=m&&(O={x:i,y:a}),{length:m,point:O,min:{x:Math.min.apply(null,T.map(function(C){return C.x})),y:Math.min.apply(null,T.map(function(C){return C.y}))},max:{x:Math.max.apply(null,T.map(function(C){return C.x})),y:Math.max.apply(null,T.map(function(C){return C.y}))}}}function JT(r,e,t){for(var n,i,a,s,o,l,u=Ju(r),c=typeof e=="number",h,d=[],f,g=0,v=0,p=0,y=0,m,w=[],S=[],_=0,O={x:0,y:0},T=O,k=O,P=O,C=0,N=0,L=u.length;N<L;N+=1)m=u[N],f=m[0],h=f==="M",d=h?d:[g,v].concat(m.slice(1)),h?(p=m[1],y=m[2],O={x:p,y},T=O,_=0,c&&e<.001&&(P=O)):f==="L"?(n=pm(d[0],d[1],d[2],d[3],(e||0)-C),_=n.length,O=n.min,T=n.max,k=n.point):f==="A"?(i=H3(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],(e||0)-C,t||{}),_=i.length,O=i.min,T=i.max,k=i.point):f==="C"?(a=ZT(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],(e||0)-C,t||{}),_=a.length,O=a.min,T=a.max,k=a.point):f==="Q"?(s=K3(d[0],d[1],d[2],d[3],d[4],d[5],(e||0)-C,t||{}),_=s.length,O=s.min,T=s.max,k=s.point):f==="Z"&&(d=[g,v,p,y],o=pm(d[0],d[1],d[2],d[3],(e||0)-C),_=o.length,O=o.min,T=o.max,k=o.point),c&&C<e&&C+_>=e&&(P=k),S.push(T),w.push(O),C+=_,l=f!=="Z"?m.slice(-2):[p,y],g=l[0],v=l[1];return c&&e>=C&&(P={x:g,y:v}),{length:C,point:P,min:{x:Math.min.apply(null,w.map(function(F){return F.x})),y:Math.min.apply(null,w.map(function(F){return F.y}))},max:{x:Math.max.apply(null,S.map(function(F){return F.x})),y:Math.max.apply(null,S.map(function(F){return F.y}))}}}function Z3(r,e){return JT(r,void 0,ce(ce({},e),{bbox:!1,length:!0})).length}function J3(r){var e=r.length,t=e-1;return r.map(function(n,i){return r.map(function(a,s){var o=i+s,l;return s===0||r[o]&&r[o][0]==="M"?(l=r[o],["M"].concat(l.slice(-2))):(o>=e&&(o-=t),r[o])})})}function Q3(r,e){var t=r.length-1,n=[],i=0,a=0,s=J3(r);return s.forEach(function(o,l){r.slice(1).forEach(function(u,c){a+=Xn(r[(l+c)%t].slice(-2),e[c%t].slice(-2))}),n[l]=a,a=0}),i=n.indexOf(Math.min.apply(null,n)),s[i]}function eI(r,e,t,n,i,a,s,o){return 3*((o-e)*(t+i)-(s-r)*(n+a)+n*(r-i)-t*(e-a)+o*(i+r/3)-s*(a+e/3))/20}function tI(r){var e=0,t=0,n=0;return gm(r).map(function(i){var a;switch(i[0]){case"M":return e=i[1],t=i[2],0;default:var s=i.slice(1),o=s[0],l=s[1],u=s[2],c=s[3],h=s[4],d=s[5];return n=eI(e,t,o,l,u,c,h,d),a=i.slice(-2),e=a[0],t=a[1],n}}).reduce(function(i,a){return i+a},0)}function rw(r){return tI(r)>=0}function nI(r,e,t){return JT(r,e,ce(ce({},t),{bbox:!1,length:!0})).point}function rI(r,e){e===void 0&&(e=.5);var t=r.slice(0,2),n=r.slice(2,4),i=r.slice(4,6),a=r.slice(6,8),s=Ui(t,n,e),o=Ui(n,i,e),l=Ui(i,a,e),u=Ui(s,o,e),c=Ui(o,l,e),h=Ui(u,c,e);return[["C"].concat(s,u,h),["C"].concat(c,l,a)]}function iw(r){return r.map(function(e,t,n){var i=t&&n[t-1].slice(-2).concat(e.slice(1)),a=t?ZT(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,s;return t?s=a?rI(i):[e,e]:s=[e],{s:e,ss:s,l:a}})}function QT(r,e,t){var n=iw(r),i=iw(e),a=n.length,s=i.length,o=n.filter(function(p){return p.l}).length,l=i.filter(function(p){return p.l}).length,u=n.filter(function(p){return p.l}).reduce(function(p,y){var m=y.l;return p+m},0)/o||0,c=i.filter(function(p){return p.l}).reduce(function(p,y){var m=y.l;return p+m},0)/l||0,h=t||Math.max(a,s),d=[u,c],f=[h-a,h-s],g=0,v=[n,i].map(function(p,y){return p.l===h?p.map(function(m){return m.s}):p.map(function(m,w){return g=w&&f[y]&&m.l>=d[y],f[y]-=g?1:0,g?m.ss:[m.s]}).flat()});return v[0].length===v[1].length?v:QT(v[0],v[1],h)}function vm(r){var e=document.createElement("div");e.innerHTML=r;var t=e.childNodes[0];return t&&e.contains(t)&&e.removeChild(t),t}function iI(r,e){for(;!{}.hasOwnProperty.call(r,e)&&(r=Rs(r))!==null;);return r}function ym(){return ym=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(r,e,t){var n=iI(r,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?r:t):i.value}},ym.apply(null,arguments)}function aw(r,e,t,n){var i=ym(Rs(r.prototype),e,t);return typeof i=="function"?function(a){return i.apply(t,a)}:i}function Pi(r,e,t,n){var i=r-t,a=e-n;return Math.sqrt(i*i+a*a)}function eA(r,e){var t=Math.min.apply(Math,Ee([],q(r),!1)),n=Math.min.apply(Math,Ee([],q(e),!1)),i=Math.max.apply(Math,Ee([],q(r),!1)),a=Math.max.apply(Math,Ee([],q(e),!1));return{x:t,y:n,width:i-t,height:a-n}}function aI(r,e,t){return Math.atan(-e/r*Math.tan(t))}function sI(r,e,t){return Math.atan(e/(r*Math.tan(t)))}function oI(r,e,t,n,i,a){return t*Math.cos(i)*Math.cos(a)-n*Math.sin(i)*Math.sin(a)+r}function lI(r,e,t,n,i,a){return t*Math.sin(i)*Math.cos(a)+n*Math.cos(i)*Math.sin(a)+e}function uI(r,e,t,n,i,a,s){for(var o=aI(t,n,i),l=1/0,u=-1/0,c=[a,s],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var d=o+h;a<s?a<d&&d<s&&c.push(d):s<d&&d<a&&c.push(d)}for(var h=0;h<c.length;h++){var f=oI(r,e,t,n,i,c[h]);f<l&&(l=f),f>u&&(u=f)}for(var g=sI(t,n,i),v=1/0,p=-1/0,y=[a,s],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var m=g+h;a<s?a<m&&m<s&&y.push(m):s<m&&m<a&&y.push(m)}for(var h=0;h<y.length;h++){var w=lI(r,e,t,n,i,y[h]);w<v&&(v=w),w>p&&(p=w)}return{x:l,y:v,width:u-l,height:p-v}}var cI=1e-4;function tA(r,e,t,n,i,a){var s=-1,o=1/0,l=[t,n],u=20;a&&a>200&&(u=a/10);for(var c=1/u,h=c/10,d=0;d<=u;d++){var f=d*c,g=[i.apply(void 0,Ee([],q(r.concat([f])),!1)),i.apply(void 0,Ee([],q(e.concat([f])),!1))],v=Pi(l[0],l[1],g[0],g[1]);v<o&&(s=f,o=v)}if(s===0)return{x:r[0],y:e[0]};if(s===1){var p=r.length;return{x:r[p-1],y:e[p-1]}}o=1/0;for(var d=0;d<32&&!(h<cI);d++){var y=s-h,m=s+h,g=[i.apply(void 0,Ee([],q(r.concat([y])),!1)),i.apply(void 0,Ee([],q(e.concat([y])),!1))],v=Pi(l[0],l[1],g[0],g[1]);if(y>=0&&v<o)s=y,o=v;else{var w=[i.apply(void 0,Ee([],q(r.concat([m])),!1)),i.apply(void 0,Ee([],q(e.concat([m])),!1))],S=Pi(l[0],l[1],w[0],w[1]);m<=1&&S<o?(s=m,o=S):h*=.5}}return{x:i.apply(void 0,Ee([],q(r.concat([s])),!1)),y:i.apply(void 0,Ee([],q(e.concat([s])),!1))}}function nA(r,e,t,n){return Pi(r,e,t,n)}function rA(r,e,t,n,i){return{x:(1-i)*r+i*t,y:(1-i)*e+i*n}}function hI(r,e,t,n,i,a){var s=[t-r,n-e];if(r3(s,[0,0]))return Math.sqrt((i-r)*(i-r)+(a-e)*(a-e));var o=[-s[1],s[0]];t3(o,o);var l=[i-r,a-e];return Math.abs(n3(l,o))}function mm(r,e,t,n,i){var a=1-i;return a*a*a*r+3*e*i*a*a+3*t*i*i*a+n*i*i*i}function sw(r,e,t,n){var i=-3*r+9*e-9*t+3*n,a=6*r-12*e+6*t,s=3*e-3*r,o=[],l,u,c;if(Po(i,0))Po(a,0)||(l=-s/a,l>=0&&l<=1&&o.push(l));else{var h=a*a-4*i*s;Po(h,0)?o.push(-a/(2*i)):h>0&&(c=Math.sqrt(h),l=(-a+c)/(2*i),u=(-a-c)/(2*i),l>=0&&l<=1&&o.push(l),u>=0&&u<=1&&o.push(u))}return o}function dI(r,e,t,n,i,a,s,o){for(var l=[r,s],u=[e,o],c=sw(r,t,i,s),h=sw(e,n,a,o),d=0;d<c.length;d++)l.push(mm(r,t,i,s,c[d]));for(var d=0;d<h.length;d++)u.push(mm(e,n,a,o,h[d]));return eA(l,u)}function fI(r,e,t,n,i,a,s,o,l,u,c){return tA([r,t,i,s],[e,n,a,o],l,u,mm,c)}function ow(r,e,t,n,i,a,s,o,l,u,c){var h=fI(r,e,t,n,i,a,s,o,l,u,c);return Pi(h.x,h.y,l,u)}function gI(r){if(r.length<2)return 0;for(var e=0,t=0;t<r.length-1;t++){var n=r[t],i=r[t+1];e+=Pi(n[0],n[1],i[0],i[1])}return e}function pI(r){return gI(r)}function bm(r,e,t,n){var i=1-n;return i*i*r+2*n*i*e+n*n*t}function lw(r,e,t){var n=r+t-2*e;if(Po(n,0))return[.5];var i=(r-e)/n;return i<=1&&i>=0?[i]:[]}function vI(r,e,t,n,i,a){var s=lw(r,t,i)[0],o=lw(e,n,a)[0],l=[r,i],u=[e,a];return s!==void 0&&l.push(bm(r,t,i,s)),o!==void 0&&u.push(bm(e,n,a,o)),eA(l,u)}function yI(r,e,t,n,i,a,s,o){return tA([r,t,i],[e,n,a],s,o,bm)}function mI(r,e,t,n,i,a,s,o){var l=yI(r,e,t,n,i,a,s,o);return Pi(l.x,l.y,s,o)}function _n(){_n=function(){return e};var r,e={},t=Object.prototype,n=t.hasOwnProperty,i=Object.defineProperty||function(U,$,j){U[$]=j.value},a=typeof Symbol=="function"?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(U,$,j){return Object.defineProperty(U,$,{value:j,enumerable:!0,configurable:!0,writable:!0}),U[$]}try{u({},"")}catch{u=function(j,Z,ne){return j[Z]=ne}}function c(U,$,j,Z){var ne=$&&$.prototype instanceof y?$:y,oe=Object.create(ne.prototype),le=new G(Z||[]);return i(oe,"_invoke",{value:C(U,j,le)}),oe}function h(U,$,j){try{return{type:"normal",arg:U.call($,j)}}catch(Z){return{type:"throw",arg:Z}}}e.wrap=c;var d="suspendedStart",f="suspendedYield",g="executing",v="completed",p={};function y(){}function m(){}function w(){}var S={};u(S,s,function(){return this});var _=Object.getPrototypeOf,O=_&&_(_(V([])));O&&O!==t&&n.call(O,s)&&(S=O);var T=w.prototype=y.prototype=Object.create(S);function k(U){["next","throw","return"].forEach(function($){u(U,$,function(j){return this._invoke($,j)})})}function P(U,$){function j(ne,oe,le,Ce){var K=h(U[ne],U,oe);if(K.type!=="throw"){var W=K.arg,ee=W.value;return ee&&la(ee)=="object"&&n.call(ee,"__await")?$.resolve(ee.__await).then(function(he){j("next",he,le,Ce)},function(he){j("throw",he,le,Ce)}):$.resolve(ee).then(function(he){W.value=he,le(W)},function(he){return j("throw",he,le,Ce)})}Ce(K.arg)}var Z;i(this,"_invoke",{value:function(oe,le){function Ce(){return new $(function(K,W){j(oe,le,K,W)})}return Z=Z?Z.then(Ce,Ce):Ce()}})}function C(U,$,j){var Z=d;return function(ne,oe){if(Z===g)throw Error("Generator is already running");if(Z===v){if(ne==="throw")throw oe;return{value:r,done:!0}}for(j.method=ne,j.arg=oe;;){var le=j.delegate;if(le){var Ce=N(le,j);if(Ce){if(Ce===p)continue;return Ce}}if(j.method==="next")j.sent=j._sent=j.arg;else if(j.method==="throw"){if(Z===d)throw Z=v,j.arg;j.dispatchException(j.arg)}else j.method==="return"&&j.abrupt("return",j.arg);Z=g;var K=h(U,$,j);if(K.type==="normal"){if(Z=j.done?v:f,K.arg===p)continue;return{value:K.arg,done:j.done}}K.type==="throw"&&(Z=v,j.method="throw",j.arg=K.arg)}}}function N(U,$){var j=$.method,Z=U.iterator[j];if(Z===r)return $.delegate=null,j==="throw"&&U.iterator.return&&($.method="return",$.arg=r,N(U,$),$.method==="throw")||j!=="return"&&($.method="throw",$.arg=new TypeError("The iterator does not provide a '"+j+"' method")),p;var ne=h(Z,U.iterator,$.arg);if(ne.type==="throw")return $.method="throw",$.arg=ne.arg,$.delegate=null,p;var oe=ne.arg;return oe?oe.done?($[U.resultName]=oe.value,$.next=U.nextLoc,$.method!=="return"&&($.method="next",$.arg=r),$.delegate=null,p):oe:($.method="throw",$.arg=new TypeError("iterator result is not an object"),$.delegate=null,p)}function L(U){var $={tryLoc:U[0]};1 in U&&($.catchLoc=U[1]),2 in U&&($.finallyLoc=U[2],$.afterLoc=U[3]),this.tryEntries.push($)}function F(U){var $=U.completion||{};$.type="normal",delete $.arg,U.completion=$}function G(U){this.tryEntries=[{tryLoc:"root"}],U.forEach(L,this),this.reset(!0)}function V(U){if(U||U===""){var $=U[s];if($)return $.call(U);if(typeof U.next=="function")return U;if(!isNaN(U.length)){var j=-1,Z=function ne(){for(;++j<U.length;)if(n.call(U,j))return ne.value=U[j],ne.done=!1,ne;return ne.value=r,ne.done=!0,ne};return Z.next=Z}}throw new TypeError(la(U)+" is not iterable")}return m.prototype=w,i(T,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:m,configurable:!0}),m.displayName=u(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(U){var $=typeof U=="function"&&U.constructor;return!!$&&($===m||($.displayName||$.name)==="GeneratorFunction")},e.mark=function(U){return Object.setPrototypeOf?Object.setPrototypeOf(U,w):(U.__proto__=w,u(U,l,"GeneratorFunction")),U.prototype=Object.create(T),U},e.awrap=function(U){return{__await:U}},k(P.prototype),u(P.prototype,o,function(){return this}),e.AsyncIterator=P,e.async=function(U,$,j,Z,ne){ne===void 0&&(ne=Promise);var oe=new P(c(U,$,j,Z),ne);return e.isGeneratorFunction($)?oe:oe.next().then(function(le){return le.done?le.value:oe.next()})},k(T),u(T,l,"Generator"),u(T,s,function(){return this}),u(T,"toString",function(){return"[object Generator]"}),e.keys=function(U){var $=Object(U),j=[];for(var Z in $)j.push(Z);return j.reverse(),function ne(){for(;j.length;){var oe=j.pop();if(oe in $)return ne.value=oe,ne.done=!1,ne}return ne.done=!0,ne}},e.values=V,G.prototype={constructor:G,reset:function($){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(F),!$)for(var j in this)j.charAt(0)==="t"&&n.call(this,j)&&!isNaN(+j.slice(1))&&(this[j]=r)},stop:function(){this.done=!0;var $=this.tryEntries[0].completion;if($.type==="throw")throw $.arg;return this.rval},dispatchException:function($){if(this.done)throw $;var j=this;function Z(W,ee){return le.type="throw",le.arg=$,j.next=W,ee&&(j.method="next",j.arg=r),!!ee}for(var ne=this.tryEntries.length-1;ne>=0;--ne){var oe=this.tryEntries[ne],le=oe.completion;if(oe.tryLoc==="root")return Z("end");if(oe.tryLoc<=this.prev){var Ce=n.call(oe,"catchLoc"),K=n.call(oe,"finallyLoc");if(Ce&&K){if(this.prev<oe.catchLoc)return Z(oe.catchLoc,!0);if(this.prev<oe.finallyLoc)return Z(oe.finallyLoc)}else if(Ce){if(this.prev<oe.catchLoc)return Z(oe.catchLoc,!0)}else{if(!K)throw Error("try statement without catch or finally");if(this.prev<oe.finallyLoc)return Z(oe.finallyLoc)}}}},abrupt:function($,j){for(var Z=this.tryEntries.length-1;Z>=0;--Z){var ne=this.tryEntries[Z];if(ne.tryLoc<=this.prev&&n.call(ne,"finallyLoc")&&this.prev<ne.finallyLoc){var oe=ne;break}}oe&&($==="break"||$==="continue")&&oe.tryLoc<=j&&j<=oe.finallyLoc&&(oe=null);var le=oe?oe.completion:{};return le.type=$,le.arg=j,oe?(this.method="next",this.next=oe.finallyLoc,p):this.complete(le)},complete:function($,j){if($.type==="throw")throw $.arg;return $.type==="break"||$.type==="continue"?this.next=$.arg:$.type==="return"?(this.rval=this.arg=$.arg,this.method="return",this.next="end"):$.type==="normal"&&j&&(this.next=j),p},finish:function($){for(var j=this.tryEntries.length-1;j>=0;--j){var Z=this.tryEntries[j];if(Z.finallyLoc===$)return this.complete(Z.completion,Z.afterLoc),F(Z),p}},catch:function($){for(var j=this.tryEntries.length-1;j>=0;--j){var Z=this.tryEntries[j];if(Z.tryLoc===$){var ne=Z.completion;if(ne.type==="throw"){var oe=ne.arg;F(Z)}return oe}}throw Error("illegal catch attempt")},delegateYield:function($,j,Z){return this.delegate={iterator:V($),resultName:j,nextLoc:Z},this.method==="next"&&(this.arg=r),p}},e}function uw(r,e,t,n,i,a,s){try{var o=r[a](s),l=o.value}catch(u){return void t(u)}o.done?e(l):Promise.resolve(l).then(n,i)}function ha(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var a=r.apply(e,t);function s(l){uw(a,n,i,s,o,"next",l)}function o(l){uw(a,n,i,s,o,"throw",l)}s(void 0)})}}function Aa(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=w1(r))||e){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(u){throw u},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,s=!0,o=!1;return{s:function(){t=t.call(r)},n:function(){var u=t.next();return s=u.done,u},e:function(u){o=!0,a=u},f:function(){try{s||t.return==null||t.return()}finally{if(o)throw a}}}}function bI(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}function Ja(r,e){if(r==null)return{};var t,n,i=bI(r,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);for(n=0;n<a.length;n++)t=a[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}/*!
 * @antv/g-lite
 * @description A core module for rendering engine implements DOM API.
 * @version 2.2.16
 * @date 1/23/2025, 8:31:51 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var wI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},iA={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(wI,function(){function t(_,O,T,k,P){n(_,O,T||0,k||_.length-1,P||a)}function n(_,O,T,k,P){for(;k>T;){if(k-T>600){var C=k-T+1,N=O-T+1,L=Math.log(C),F=.5*Math.exp(2*L/3),G=.5*Math.sqrt(L*F*(C-F)/C)*(N-C/2<0?-1:1),V=Math.max(T,Math.floor(O-N*F/C+G)),U=Math.min(k,Math.floor(O+(C-N)*F/C+G));n(_,O,V,U,P)}var $=_[O],j=T,Z=k;for(i(_,T,O),P(_[k],$)>0&&i(_,T,k);j<Z;){for(i(_,j,Z),j++,Z--;P(_[j],$)<0;)j++;for(;P(_[Z],$)>0;)Z--}P(_[T],$)===0?i(_,T,Z):(Z++,i(_,Z,k)),Z<=O&&(T=Z+1),O<=Z&&(k=Z-1)}}function i(_,O,T){var k=_[O];_[O]=_[T],_[T]=k}function a(_,O){return _<O?-1:_>O?1:0}var s=function(O){O===void 0&&(O=9),this._maxEntries=Math.max(4,O),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};s.prototype.all=function(){return this._all(this.data,[])},s.prototype.search=function(O){var T=this.data,k=[];if(!m(O,T))return k;for(var P=this.toBBox,C=[];T;){for(var N=0;N<T.children.length;N++){var L=T.children[N],F=T.leaf?P(L):L;m(O,F)&&(T.leaf?k.push(L):y(O,F)?this._all(L,k):C.push(L))}T=C.pop()}return k},s.prototype.collides=function(O){var T=this.data;if(!m(O,T))return!1;for(var k=[];T;){for(var P=0;P<T.children.length;P++){var C=T.children[P],N=T.leaf?this.toBBox(C):C;if(m(O,N)){if(T.leaf||y(O,N))return!0;k.push(C)}}T=k.pop()}return!1},s.prototype.load=function(O){if(!(O&&O.length))return this;if(O.length<this._minEntries){for(var T=0;T<O.length;T++)this.insert(O[T]);return this}var k=this._build(O.slice(),0,O.length-1,0);if(!this.data.children.length)this.data=k;else if(this.data.height===k.height)this._splitRoot(this.data,k);else{if(this.data.height<k.height){var P=this.data;this.data=k,k=P}this._insert(k,this.data.height-k.height-1,!0)}return this},s.prototype.insert=function(O){return O&&this._insert(O,this.data.height-1),this},s.prototype.clear=function(){return this.data=w([]),this},s.prototype.remove=function(O,T){if(!O)return this;for(var k=this.data,P=this.toBBox(O),C=[],N=[],L,F,G;k||C.length;){if(k||(k=C.pop(),F=C[C.length-1],L=N.pop(),G=!0),k.leaf){var V=o(O,k.children,T);if(V!==-1)return k.children.splice(V,1),C.push(k),this._condense(C),this}!G&&!k.leaf&&y(k,P)?(C.push(k),N.push(L),L=0,F=k,k=k.children[0]):F?(L++,k=F.children[L],G=!1):k=null}return this},s.prototype.toBBox=function(O){return O},s.prototype.compareMinX=function(O,T){return O.minX-T.minX},s.prototype.compareMinY=function(O,T){return O.minY-T.minY},s.prototype.toJSON=function(){return this.data},s.prototype.fromJSON=function(O){return this.data=O,this},s.prototype._all=function(O,T){for(var k=[];O;)O.leaf?T.push.apply(T,O.children):k.push.apply(k,O.children),O=k.pop();return T},s.prototype._build=function(O,T,k,P){var C=k-T+1,N=this._maxEntries,L;if(C<=N)return L=w(O.slice(T,k+1)),l(L,this.toBBox),L;P||(P=Math.ceil(Math.log(C)/Math.log(N)),N=Math.ceil(C/Math.pow(N,P-1))),L=w([]),L.leaf=!1,L.height=P;var F=Math.ceil(C/N),G=F*Math.ceil(Math.sqrt(N));S(O,T,k,G,this.compareMinX);for(var V=T;V<=k;V+=G){var U=Math.min(V+G-1,k);S(O,V,U,F,this.compareMinY);for(var $=V;$<=U;$+=F){var j=Math.min($+F-1,U);L.children.push(this._build(O,$,j,P-1))}}return l(L,this.toBBox),L},s.prototype._chooseSubtree=function(O,T,k,P){for(;P.push(T),!(T.leaf||P.length-1===k);){for(var C=1/0,N=1/0,L=void 0,F=0;F<T.children.length;F++){var G=T.children[F],V=f(G),U=v(O,G)-V;U<N?(N=U,C=V<C?V:C,L=G):U===N&&V<C&&(C=V,L=G)}T=L||T.children[0]}return T},s.prototype._insert=function(O,T,k){var P=k?O:this.toBBox(O),C=[],N=this._chooseSubtree(P,this.data,T,C);for(N.children.push(O),c(N,P);T>=0&&C[T].children.length>this._maxEntries;)this._split(C,T),T--;this._adjustParentBBoxes(P,C,T)},s.prototype._split=function(O,T){var k=O[T],P=k.children.length,C=this._minEntries;this._chooseSplitAxis(k,C,P);var N=this._chooseSplitIndex(k,C,P),L=w(k.children.splice(N,k.children.length-N));L.height=k.height,L.leaf=k.leaf,l(k,this.toBBox),l(L,this.toBBox),T?O[T-1].children.push(L):this._splitRoot(k,L)},s.prototype._splitRoot=function(O,T){this.data=w([O,T]),this.data.height=O.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},s.prototype._chooseSplitIndex=function(O,T,k){for(var P,C=1/0,N=1/0,L=T;L<=k-T;L++){var F=u(O,0,L,this.toBBox),G=u(O,L,k,this.toBBox),V=p(F,G),U=f(F)+f(G);V<C?(C=V,P=L,N=U<N?U:N):V===C&&U<N&&(N=U,P=L)}return P||k-T},s.prototype._chooseSplitAxis=function(O,T,k){var P=O.leaf?this.compareMinX:h,C=O.leaf?this.compareMinY:d,N=this._allDistMargin(O,T,k,P),L=this._allDistMargin(O,T,k,C);N<L&&O.children.sort(P)},s.prototype._allDistMargin=function(O,T,k,P){O.children.sort(P);for(var C=this.toBBox,N=u(O,0,T,C),L=u(O,k-T,k,C),F=g(N)+g(L),G=T;G<k-T;G++){var V=O.children[G];c(N,O.leaf?C(V):V),F+=g(N)}for(var U=k-T-1;U>=T;U--){var $=O.children[U];c(L,O.leaf?C($):$),F+=g(L)}return F},s.prototype._adjustParentBBoxes=function(O,T,k){for(var P=k;P>=0;P--)c(T[P],O)},s.prototype._condense=function(O){for(var T=O.length-1,k=void 0;T>=0;T--)O[T].children.length===0?T>0?(k=O[T-1].children,k.splice(k.indexOf(O[T]),1)):this.clear():l(O[T],this.toBBox)};function o(_,O,T){if(!T)return O.indexOf(_);for(var k=0;k<O.length;k++)if(T(_,O[k]))return k;return-1}function l(_,O){u(_,0,_.children.length,O,_)}function u(_,O,T,k,P){P||(P=w(null)),P.minX=1/0,P.minY=1/0,P.maxX=-1/0,P.maxY=-1/0;for(var C=O;C<T;C++){var N=_.children[C];c(P,_.leaf?k(N):N)}return P}function c(_,O){return _.minX=Math.min(_.minX,O.minX),_.minY=Math.min(_.minY,O.minY),_.maxX=Math.max(_.maxX,O.maxX),_.maxY=Math.max(_.maxY,O.maxY),_}function h(_,O){return _.minX-O.minX}function d(_,O){return _.minY-O.minY}function f(_){return(_.maxX-_.minX)*(_.maxY-_.minY)}function g(_){return _.maxX-_.minX+(_.maxY-_.minY)}function v(_,O){return(Math.max(O.maxX,_.maxX)-Math.min(O.minX,_.minX))*(Math.max(O.maxY,_.maxY)-Math.min(O.minY,_.minY))}function p(_,O){var T=Math.max(_.minX,O.minX),k=Math.max(_.minY,O.minY),P=Math.min(_.maxX,O.maxX),C=Math.min(_.maxY,O.maxY);return Math.max(0,P-T)*Math.max(0,C-k)}function y(_,O){return _.minX<=O.minX&&_.minY<=O.minY&&O.maxX<=_.maxX&&O.maxY<=_.maxY}function m(_,O){return O.minX<=_.maxX&&O.minY<=_.maxY&&O.maxX>=_.minX&&O.maxY>=_.minY}function w(_){return{children:_,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function S(_,O,T,k,P){for(var C=[O,T];C.length;)if(T=C.pop(),O=C.pop(),!(T-O<=k)){var N=O+Math.ceil((T-O)/k/2)*k;t(_,N,O,T,P),C.push(O,N,N,T)}}return s})})(iA);var xI=iA.exports,re=function(r){return r.GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r}({}),Ru=function(r){return r[r.ZERO=0]="ZERO",r[r.NEGATIVE_ONE=1]="NEGATIVE_ONE",r}({}),ga=function(){function r(){de(this,r),this.plugins=[]}return fe(r,[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach(function(n){var i=t.context.renderingPlugins.indexOf(n);i>=0&&t.context.renderingPlugins.splice(i,1)})}}])}(),EI=function(){function r(e){de(this,r),this.clipSpaceNearZ=Ru.NEGATIVE_ONE,this.plugins=[],this.config=Ge({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},e)}return fe(r,[{key:"registerPlugin",value:function(t){var n=this.plugins.findIndex(function(i){return i===t});n===-1&&this.plugins.push(t)}},{key:"unregisterPlugin",value:function(t){var n=this.plugins.findIndex(function(i){return i===t});n>-1&&this.plugins.splice(n,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(t){return this.plugins.find(function(n){return n.name===t})}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(t){Object.assign(this.config,t)}}])}(),Ed=ia,ds=oi,SI=GL,_I=$L,cw=Uu,Sd=HL,pt=function(){function r(){de(this,r),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return fe(r,[{key:"update",value:function(t,n){ds(this.center,t),ds(this.halfExtents,n),Sd(this.min,this.center,this.halfExtents),Ed(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,n){Ed(this.center,n,t),cw(this.center,this.center,.5),Sd(this.halfExtents,n,t),cw(this.halfExtents,this.halfExtents,.5),ds(this.min,t),ds(this.max,n)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(t){if(!r.isEmpty(t)){if(r.isEmpty(this)){this.setMinMax(t.getMin(),t.getMax());return}var n=this.center,i=n[0],a=n[1],s=n[2],o=this.halfExtents,l=o[0],u=o[1],c=o[2],h=i-l,d=i+l,f=a-u,g=a+u,v=s-c,p=s+c,y=t.center,m=y[0],w=y[1],S=y[2],_=t.halfExtents,O=_[0],T=_[1],k=_[2],P=m-O,C=m+O,N=w-T,L=w+T,F=S-k,G=S+k;P<h&&(h=P),C>d&&(d=C),N<f&&(f=N),L>g&&(g=L),F<v&&(v=F),G>p&&(p=G),n[0]=(h+d)*.5,n[1]=(f+g)*.5,n[2]=(v+p)*.5,o[0]=(d-h)*.5,o[1]=(g-f)*.5,o[2]=(p-v)*.5,this.min[0]=h,this.min[1]=f,this.min[2]=v,this.max[0]=d,this.max[1]=g,this.max[2]=p}}},{key:"setFromTransformedAABB",value:function(t,n){var i=this.center,a=this.halfExtents,s=t.center,o=t.halfExtents,l=n[0],u=n[4],c=n[8],h=n[1],d=n[5],f=n[9],g=n[2],v=n[6],p=n[10],y=Math.abs(l),m=Math.abs(u),w=Math.abs(c),S=Math.abs(h),_=Math.abs(d),O=Math.abs(f),T=Math.abs(g),k=Math.abs(v),P=Math.abs(p);i[0]=n[12]+l*s[0]+u*s[1]+c*s[2],i[1]=n[13]+h*s[0]+d*s[1]+f*s[2],i[2]=n[14]+g*s[0]+v*s[1]+p*s[2],a[0]=y*o[0]+m*o[1]+w*o[2],a[1]=S*o[0]+_*o[1]+O*o[2],a[2]=T*o[0]+k*o[1]+P*o[2],Sd(this.min,i,a),Ed(this.max,i,a)}},{key:"intersects",value:function(t){var n=this.getMax(),i=this.getMin(),a=t.getMax(),s=t.getMin();return i[0]<=a[0]&&n[0]>=s[0]&&i[1]<=a[1]&&n[1]>=s[1]&&i[2]<=a[2]&&n[2]>=s[2]}},{key:"intersection",value:function(t){if(!this.intersects(t))return null;var n=new r,i=SI([0,0,0],this.getMin(),t.getMin()),a=_I([0,0,0],this.getMax(),t.getMax());return n.setMinMax(i,a),n}},{key:"getNegativeFarPoint",value:function(t){return t.pnVertexFlag===273?ds([0,0,0],this.min):t.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:t.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:t.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:t.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:t.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:t.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(t){return t.pnVertexFlag===273?ds([0,0,0],this.max):t.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:t.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:t.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:t.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:t.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:t.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(t){return!t||t.halfExtents[0]===0&&t.halfExtents[1]===0&&t.halfExtents[2]===0}}])}(),MI=function(){function r(e,t){de(this,r),this.distance=e||0,this.normal=t||mt(0,1,0),this.updatePNVertexFlag()}return fe(r,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return li(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/jT(this.normal);Uu(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,n,i){var a=this.distanceToPoint(t),s=this.distanceToPoint(n),o=a/(a-s),l=o>=0&&o<=1;return l&&i&&um(i,t,n,o),l}}])}(),fs=function(r){return r[r.OUTSIDE=4294967295]="OUTSIDE",r[r.INSIDE=0]="INSIDE",r[r.INDETERMINATE=2147483647]="INDETERMINATE",r}({}),OI=function(){function r(e){if(de(this,r),this.planes=[],e)this.planes=e;else for(var t=0;t<6;t++)this.planes.push(new MI)}return fe(r,[{key:"extractFromVPMatrix",value:function(t){var n=qe(t,16),i=n[0],a=n[1],s=n[2],o=n[3],l=n[4],u=n[5],c=n[6],h=n[7],d=n[8],f=n[9],g=n[10],v=n[11],p=n[12],y=n[13],m=n[14],w=n[15];Nn(this.planes[0].normal,o-i,h-l,v-d),this.planes[0].distance=w-p,Nn(this.planes[1].normal,o+i,h+l,v+d),this.planes[1].distance=w+p,Nn(this.planes[2].normal,o+a,h+u,v+f),this.planes[2].distance=w+y,Nn(this.planes[3].normal,o-a,h-u,v-f),this.planes[3].distance=w-y,Nn(this.planes[4].normal,o-s,h-c,v-g),this.planes[4].distance=w-m,Nn(this.planes[5].normal,o+s,h+c,v+g),this.planes[5].distance=w+m,this.planes.forEach(function(S){S.normalize(),S.updatePNVertexFlag()})}}])}(),En=function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;de(this,r),this.x=0,this.y=0,this.x=e,this.y=t}return fe(r,[{key:"clone",value:function(){return new r(this.x,this.y)}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y}}])}(),Fs=function(){function r(e,t,n,i){de(this,r),this.x=e,this.y=t,this.width=n,this.height=i,this.left=e,this.right=e+n,this.top=t,this.bottom=t+i}return fe(r,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(t){return new r(t.x,t.y,t.width,t.height)}},{key:"applyTransform",value:function(t,n){var i=mo(t.x,t.y,0,1),a=mo(t.x+t.width,t.y,0,1),s=mo(t.x,t.y+t.height,0,1),o=mo(t.x+t.width,t.y+t.height,0,1),l=ui(),u=ui(),c=ui(),h=ui();Ti(l,i,n),Ti(u,a,n),Ti(c,s,n),Ti(h,o,n);var d=Math.min(l[0],u[0],c[0],h[0]),f=Math.min(l[1],u[1],c[1],h[1]),g=Math.max(l[0],u[0],c[0],h[0]),v=Math.max(l[1],u[1],c[1],h[1]);return r.fromRect({x:d,y:f,width:g-d,height:v-f})}}])}(),st="Method not implemented.",gs="Use document.documentElement instead.",kI="Cannot append a destroyed element.";function As(r){return r===void 0?0:r>360||r<-360?r%360:r}var _d=Qe();function Fn(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return Array.isArray(r)&&r.length===3?n?xi(r):oi(_d,r):_e(r)?n?mt(r,e,t):Nn(_d,r,e,t):n?mt(r[0],r[1]||e,r[2]||t):Nn(_d,r[0],r[1]||e,r[2]||t)}var TI=Math.PI/180;function ot(r){return r*TI}var AI=180/Math.PI;function Kn(r){return r*AI}function PI(r){return 360*r}var Qu=Math.PI/2;function CI(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t*t,o=n*n,l=i*i,u=a*a,c=s+o+l+u,h=t*a-n*i;return h>.499995*c?(r[0]=Qu,r[1]=2*Math.atan2(n,t),r[2]=0):h<-.499995*c?(r[0]=-Qu,r[1]=2*Math.atan2(n,t),r[2]=0):(r[0]=Math.asin(2*(t*i-a*n)),r[1]=Math.atan2(2*(t*a+n*i),1-2*(l+u)),r[2]=Math.atan2(2*(t*n+i*a),1-2*(o+l))),r}function NI(r,e){var t,n,i=Is(Qe(),e),a=qe(i,3),s=a[0],o=a[1],l=a[2],u=Math.asin(-e[2]/s);return u<Qu?u>-Qu?(t=Math.atan2(e[6]/o,e[10]/l),n=Math.atan2(e[1]/s,e[0]/s)):(n=0,t=-Math.atan2(e[4]/o,e[5]/o)):(n=0,t=Math.atan2(e[4]/o,e[5]/o)),r[0]=t,r[1]=u,r[2]=n,r}function Md(r,e){return e.length===16?NI(r,e):CI(r,e)}function RI(r,e,t,n,i){var a=Math.cos(r),s=Math.sin(r);return EL(n*a,i*s,0,-n*s,i*a,0,e,t,1)}function LI(r,e,t,n,i,a,s){var o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,l=2*a,u=t-e,c=n-i,h=l/u,d=l/c,f=(t+e)/u,g=(n+i)/c,v,p,y=s-a,m=s*a;return o?(v=-s/y,p=-m/y):(v=-(s+a)/y,p=-2*m/y),r[0]=h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=d,r[6]=0,r[7]=0,r[8]=f,r[9]=g,r[10]=v,r[11]=-1,r[12]=0,r[13]=0,r[14]=p,r[15]=0,r}function hw(r){var e=r[0],t=r[1],n=r[3],i=r[4],a=Math.sqrt(e*e+t*t),s=Math.sqrt(n*n+i*i),o=e*i-t*n;if(o<0&&(e<i?a=-a:s=-s),a){var l=1/a;e*=l,t*=l}if(s){var u=1/s;n*=u,i*=u}var c=Math.atan2(t,e),h=Kn(c);return[r[6],r[7],a,s,h]}var ei=gt(),Lr=gt(),ao=ui(),De=[Qe(),Qe(),Qe()],dw=Qe();function II(r,e,t,n,i,a){if(!DI(ei,r)||(Ls(Lr,ei),Lr[3]=0,Lr[7]=0,Lr[11]=0,Lr[15]=1,Math.abs(MT(Lr))<1e-8))return!1;var s=ei[3],o=ei[7],l=ei[11],u=ei[12],c=ei[13],h=ei[14],d=ei[15];if(s!==0||o!==0||l!==0){ao[0]=s,ao[1]=o,ao[2]=l,ao[3]=d;var f=si(Lr,Lr);if(!f)return!1;_T(Lr,Lr),Ti(i,ao,Lr)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=c,e[2]=h,FI(De,ei),t[0]=Si(De[0]),Da(De[0],De[0]),n[0]=li(De[0],De[1]),Od(De[1],De[1],De[0],1,-n[0]),t[1]=Si(De[1]),Da(De[1],De[1]),n[0]/=t[1],n[1]=li(De[0],De[2]),Od(De[2],De[2],De[0],1,-n[1]),n[2]=li(De[1],De[2]),Od(De[2],De[2],De[1],1,-n[2]),t[2]=Si(De[2]),Da(De[2],De[2]),n[1]/=t[2],n[2]/=t[2],Cu(dw,De[1],De[2]),li(De[0],dw)<0)for(var g=0;g<3;g++)t[g]*=-1,De[g][0]*=-1,De[g][1]*=-1,De[g][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+De[0][0]-De[1][1]-De[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-De[0][0]+De[1][1]-De[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-De[0][0]-De[1][1]+De[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+De[0][0]+De[1][1]+De[2][2],0)),De[2][1]>De[1][2]&&(a[0]=-a[0]),De[0][2]>De[2][0]&&(a[1]=-a[1]),De[1][0]>De[0][1]&&(a[2]=-a[2]),!0}function DI(r,e){var t=e[15];if(t===0)return!1;for(var n=1/t,i=0;i<16;i++)r[i]=e[i]*n;return!0}function FI(r,e){r[0][0]=e[0],r[0][1]=e[1],r[0][2]=e[2],r[1][0]=e[4],r[1][1]=e[5],r[1][2]=e[6],r[2][0]=e[8],r[2][1]=e[9],r[2][2]=e[10]}function Od(r,e,t,n,i){r[0]=e[0]*n+t[0]*i,r[1]=e[1]*n+t[1]*i,r[2]=e[2]*n+t[2]*i}var at=function(r){return r[r.ORBITING=0]="ORBITING",r[r.EXPLORING=1]="EXPLORING",r[r.TRACKING=2]="TRACKING",r}({}),wm=function(r){return r[r.DEFAULT=0]="DEFAULT",r[r.ROTATIONAL=1]="ROTATIONAL",r[r.TRANSLATIONAL=2]="TRANSLATIONAL",r[r.CINEMATIC=3]="CINEMATIC",r}({}),Mr=function(r){return r[r.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",r[r.PERSPECTIVE=1]="PERSPECTIVE",r}({}),aA={UPDATED:"updated"},fw=2e-4,sA=function(){function r(){de(this,r),this.clipSpaceNearZ=Ru.NEGATIVE_ONE,this.eventEmitter=new wT,this.matrix=gt(),this.right=mt(1,0,0),this.up=mt(0,1,0),this.forward=mt(0,0,1),this.position=mt(0,0,1),this.focalPoint=mt(0,0,0),this.distanceVector=mt(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=gt(),this.projectionMatrixInverse=gt(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=at.EXPLORING,this.trackingMode=wm.DEFAULT,this.projectionMode=Mr.PERSPECTIVE,this.frustum=new OI,this.orthoMatrix=gt()}return fe(r,[{key:"isOrtho",value:function(){return this.projectionMode===Mr.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t}},{key:"setType",value:function(t,n){return this.type=t,this.type===at.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===at.TRACKING&&n!==void 0&&this.setTrackingMode(n),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==at.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this}},{key:"getViewTransform",value:function(){return si(gt(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(t,n){var i=Yi(gt(),[t,n,0]);this.jitteredProjectionMatrix=Ln(gt(),i,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setNear",value:function(t){return this.projectionMode===Mr.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this}},{key:"setFar",value:function(t){return this.projectionMode===Mr.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this}},{key:"setViewOffset",value:function(t,n,i,a,s,o){return this.aspect=t/n,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=a,this.view.width=s,this.view.height=o,this.projectionMode===Mr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Mr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===Mr.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Mr.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(t,n){var i=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),a=i.x,s=i.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(a,s),this.setFocalPoint(a,s),this.setZoom(t),this.rotate(0,0,o);var l=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),u=l.x,c=l.y,h=mt(u-a,c-s,0),d=li(h,this.right)/Si(this.right),f=li(h,this.up)/Si(this.up),g=this.getPosition(),v=qe(g,2),p=v[0],y=v[1],m=this.getFocalPoint(),w=qe(m,2),S=w[0],_=w[1];return this.setPosition(p-d,y-f),this.setFocalPoint(S-d,_-f),this}},{key:"setPerspective",value:function(t,n,i,a){var s;this.projectionMode=Mr.PERSPECTIVE,this.fov=i,this.near=t,this.far=n,this.aspect=a;var o=this.near*Math.tan(ot(.5*this.fov))/this.zoom,l=2*o,u=this.aspect*l,c=-.5*u;if((s=this.view)!==null&&s!==void 0&&s.enabled){var h=this.view.fullWidth,d=this.view.fullHeight;c+=this.view.offsetX*u/h,o-=this.view.offsetY*l/d,u*=this.view.width/h,l*=this.view.height/d}return LI(this.projectionMatrix,c,c+u,o-l,o,t,this.far,this.clipSpaceNearZ===Ru.ZERO),si(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(t,n,i,a,s,o){var l;this.projectionMode=Mr.ORTHOGRAPHIC,this.rright=n,this.left=t,this.top=i,this.bottom=a,this.near=s,this.far=o;var u=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),h=(this.rright+this.left)/2,d=(this.top+this.bottom)/2,f=h-u,g=h+u,v=d+c,p=d-c;if((l=this.view)!==null&&l!==void 0&&l.enabled){var y=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;f+=y*this.view.offsetX,g=f+y*this.view.width,v-=m*this.view.offsetY,p=v-m*this.view.height}return this.clipSpaceNearZ===Ru.NEGATIVE_ONE?IT(this.projectionMatrix,f,g,v,p,s,o):DT(this.projectionMatrix,f,g,v,p,s,o),si(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.position[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.position[2],a=Fn(t,n,i);return this._setPosition(a),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.focalPoint[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.focalPoint[2],a=mt(0,1,0);if(this.focalPoint=Fn(t,n,i),this.trackingMode===wm.CINEMATIC){var s=lm(Qe(),this.focalPoint,this.position);t=s[0],n=s[1],i=s[2];var o=Si(s),l=Kn(Math.asin(n/o)),u=90+Kn(Math.atan2(i,t)),c=gt();TT(c,c,ot(u)),kT(c,c,ot(l)),a=In(Qe(),[0,1,0],c)}return si(this.matrix,FT(gt(),this.position,this.focalPoint,a)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<fw&&(this.distance=fw),this.dollyingStep=this.distance/100;var n=Qe();t=this.distance;var i=this.forward,a=this.focalPoint;return n[0]=t*i[0]+a[0],n[1]=t*i[1]+a[1],n[2]=t*i[2]+a[2],this._setPosition(n),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"setAzimuth",value:function(t){return this.azimuth=As(t),this.computeMatrix(),this._getAxes(),this.type===at.ORBITING||this.type===at.EXPLORING?this._getPosition():this.type===at.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=As(t),this.computeMatrix(),this._getAxes(),this.type===at.ORBITING||this.type===at.EXPLORING?this._getPosition():this.type===at.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(t){return this.roll=As(t),this.computeMatrix(),this._getAxes(),this.type===at.ORBITING||this.type===at.EXPLORING?this._getPosition():this.type===at.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var t=Ki(on(),[0,0,1],ot(this.roll));ua(this.matrix);var n=Ki(on(),[1,0,0],ot((this.rotateWorld&&this.type!==at.TRACKING||this.type===at.TRACKING?1:-1)*this.elevation)),i=Ki(on(),[0,1,0],ot((this.rotateWorld&&this.type!==at.TRACKING||this.type===at.TRACKING?1:-1)*this.azimuth)),a=aa(on(),i,n);a=aa(on(),a,t);var s=x1(gt(),a);this.type===at.ORBITING||this.type===at.EXPLORING?(Ts(this.matrix,this.matrix,this.focalPoint),Ln(this.matrix,this.matrix,s),Ts(this.matrix,this.matrix,[0,0,this.distance])):this.type===at.TRACKING&&(Ts(this.matrix,this.matrix,this.position),Ln(this.matrix,this.matrix,s))}},{key:"_setPosition",value:function(t,n,i){this.position=Fn(t,n,i);var a=this.matrix;a[12]=this.position[0],a[13]=this.position[1],a[14]=this.position[2],a[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){oi(this.right,Fn(Ti(ui(),[1,0,0,0],this.matrix))),oi(this.up,Fn(Ti(ui(),[0,1,0,0],this.matrix))),oi(this.forward,Fn(Ti(ui(),[0,0,1,0],this.matrix))),Da(this.right,this.right),Da(this.up,this.up),Da(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],n=this.distanceVector[1],i=this.distanceVector[2],a=Si(this.distanceVector);if(a===0){this.elevation=0,this.azimuth=0;return}this.type===at.TRACKING?(this.elevation=Kn(Math.asin(n/a)),this.azimuth=Kn(Math.atan2(-t,-i))):this.rotateWorld?(this.elevation=Kn(Math.asin(n/a)),this.azimuth=Kn(Math.atan2(-t,-i))):(this.elevation=-Kn(Math.asin(n/a)),this.azimuth=-Kn(Math.atan2(-t,-i)))}},{key:"_getPosition",value:function(){oi(this.position,Fn(Ti(ui(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){VL(this.distanceVector,[0,0,-this.distance],xL(xT(),this.matrix)),ia(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=lm(Qe(),this.focalPoint,this.position),this.distance=Si(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===Mr.ORTHOGRAPHIC){var t=this.position,n=Ki(on(),[0,0,1],-this.roll*Math.PI/180);Ao(this.orthoMatrix,n,mt((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),mt(this.zoom,this.zoom,1),t)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),n=Ln(gt(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(n),this.eventEmitter.emit(aA.UPDATED)}}},{key:"rotate",value:function(t,n,i){throw new Error(st)}},{key:"pan",value:function(t,n){throw new Error(st)}},{key:"dolly",value:function(t){throw new Error(st)}},{key:"createLandmark",value:function(t,n){throw new Error(st)}},{key:"gotoLandmark",value:function(t,n){throw new Error(st)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(st)}}])}(),BI=function(r){return r[r.Standard=0]="Standard",r}({}),ec=function(r){return r[r.ADDED=0]="ADDED",r[r.REMOVED=1]="REMOVED",r[r.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",r}({}),oA={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Fs(0,0,0,0)},we=function(r){return r.COORDINATE="<coordinate>",r.COLOR="<color>",r.PAINT="<paint>",r.NUMBER="<number>",r.ANGLE="<angle>",r.OPACITY_VALUE="<opacity-value>",r.SHADOW_BLUR="<shadow-blur>",r.LENGTH="<length>",r.PERCENTAGE="<percentage>",r.LENGTH_PERCENTAGE="<length> | <percentage>",r.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",r.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",r.LIST_OF_POINTS="<list-of-points>",r.PATH="<path>",r.FILTER="<filter>",r.Z_INDEX="<z-index>",r.OFFSET_DISTANCE="<offset-distance>",r.DEFINED_PATH="<defined-path>",r.MARKER="<marker>",r.TRANSFORM="<transform>",r.TRANSFORM_ORIGIN="<transform-origin>",r.TEXT="<text>",r.TEXT_TRANSFORM="<text-transform>",r}({});function M1(r,e,t){r.prototype=e.prototype=t,t.constructor=r}function lA(r,e){var t=Object.create(r.prototype);for(var n in e)t[n]=e[n];return t}function al(){}var zo=.7,tc=1/zo,Ps="\\s*([+-]?\\d+)\\s*",jo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ci="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",zI=/^#([0-9a-f]{3,8})$/,jI=new RegExp(`^rgb\\(${Ps},${Ps},${Ps}\\)$`),qI=new RegExp(`^rgb\\(${ci},${ci},${ci}\\)$`),$I=new RegExp(`^rgba\\(${Ps},${Ps},${Ps},${jo}\\)$`),GI=new RegExp(`^rgba\\(${ci},${ci},${ci},${jo}\\)$`),WI=new RegExp(`^hsl\\(${jo},${ci},${ci}\\)$`),VI=new RegExp(`^hsla\\(${jo},${ci},${ci},${jo}\\)$`),gw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};M1(al,Pc,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:pw,formatHex:pw,formatHex8:UI,formatHsl:HI,formatRgb:vw,toString:vw});function pw(){return this.rgb().formatHex()}function UI(){return this.rgb().formatHex8()}function HI(){return uA(this).formatHsl()}function vw(){return this.rgb().formatRgb()}function Pc(r){var e,t;return r=(r+"").trim().toLowerCase(),(e=zI.exec(r))?(t=e[1].length,e=parseInt(e[1],16),t===6?yw(e):t===3?new Qn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?Fl(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?Fl(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=jI.exec(r))?new Qn(e[1],e[2],e[3],1):(e=qI.exec(r))?new Qn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=$I.exec(r))?Fl(e[1],e[2],e[3],e[4]):(e=GI.exec(r))?Fl(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=WI.exec(r))?ww(e[1],e[2]/100,e[3]/100,1):(e=VI.exec(r))?ww(e[1],e[2]/100,e[3]/100,e[4]):gw.hasOwnProperty(r)?yw(gw[r]):r==="transparent"?new Qn(NaN,NaN,NaN,0):null}function yw(r){return new Qn(r>>16&255,r>>8&255,r&255,1)}function Fl(r,e,t,n){return n<=0&&(r=e=t=NaN),new Qn(r,e,t,n)}function YI(r){return r instanceof al||(r=Pc(r)),r?(r=r.rgb(),new Qn(r.r,r.g,r.b,r.opacity)):new Qn}function XI(r,e,t,n){return arguments.length===1?YI(r):new Qn(r,e,t,n??1)}function Qn(r,e,t,n){this.r=+r,this.g=+e,this.b=+t,this.opacity=+n}M1(Qn,XI,lA(al,{brighter(r){return r=r==null?tc:Math.pow(tc,r),new Qn(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?zo:Math.pow(zo,r),new Qn(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new Qn(Fa(this.r),Fa(this.g),Fa(this.b),nc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:mw,formatHex:mw,formatHex8:KI,formatRgb:bw,toString:bw}));function mw(){return`#${Ca(this.r)}${Ca(this.g)}${Ca(this.b)}`}function KI(){return`#${Ca(this.r)}${Ca(this.g)}${Ca(this.b)}${Ca((isNaN(this.opacity)?1:this.opacity)*255)}`}function bw(){const r=nc(this.opacity);return`${r===1?"rgb(":"rgba("}${Fa(this.r)}, ${Fa(this.g)}, ${Fa(this.b)}${r===1?")":`, ${r})`}`}function nc(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function Fa(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function Ca(r){return r=Fa(r),(r<16?"0":"")+r.toString(16)}function ww(r,e,t,n){return n<=0?r=e=t=NaN:t<=0||t>=1?r=e=NaN:e<=0&&(r=NaN),new Br(r,e,t,n)}function uA(r){if(r instanceof Br)return new Br(r.h,r.s,r.l,r.opacity);if(r instanceof al||(r=Pc(r)),!r)return new Br;if(r instanceof Br)return r;r=r.rgb();var e=r.r/255,t=r.g/255,n=r.b/255,i=Math.min(e,t,n),a=Math.max(e,t,n),s=NaN,o=a-i,l=(a+i)/2;return o?(e===a?s=(t-n)/o+(t<n)*6:t===a?s=(n-e)/o+2:s=(e-t)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new Br(s,o,l,r.opacity)}function ZI(r,e,t,n){return arguments.length===1?uA(r):new Br(r,e,t,n??1)}function Br(r,e,t,n){this.h=+r,this.s=+e,this.l=+t,this.opacity=+n}M1(Br,ZI,lA(al,{brighter(r){return r=r==null?tc:Math.pow(tc,r),new Br(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?zo:Math.pow(zo,r),new Br(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,i=2*t-n;return new Qn(kd(r>=240?r-240:r+120,i,n),kd(r,i,n),kd(r<120?r+240:r-120,i,n),this.opacity)},clamp(){return new Br(xw(this.h),Bl(this.s),Bl(this.l),nc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=nc(this.opacity);return`${r===1?"hsl(":"hsla("}${xw(this.h)}, ${Bl(this.s)*100}%, ${Bl(this.l)*100}%${r===1?")":`, ${r})`}`}}));function xw(r){return r=(r||0)%360,r<0?r+360:r}function Bl(r){return Math.max(0,Math.min(1,r||0))}function kd(r,e,t){return(r<60?e+(t-e)*r/60:r<180?t:r<240?e+(t-e)*(240-r)/60:e)*255}function nn(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var t=function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var o=e?e.apply(this,a):a[0],l=t.cache;if(l.has(o))return l.get(o);var u=r.apply(this,a);return t.cache=l.set(o,u)||l,u};return t.cache=new(nn.Cache||Map),nn.cacheList.push(t.cache),t}nn.Cache=Map;nn.cacheList=[];nn.clearCache=function(){nn.cacheList.forEach(function(r){return r.clear()})};var xe=function(r){return r[r.kUnknown=0]="kUnknown",r[r.kNumber=1]="kNumber",r[r.kPercentage=2]="kPercentage",r[r.kEms=3]="kEms",r[r.kPixels=4]="kPixels",r[r.kRems=5]="kRems",r[r.kDegrees=6]="kDegrees",r[r.kRadians=7]="kRadians",r[r.kGradians=8]="kGradians",r[r.kTurns=9]="kTurns",r[r.kMilliseconds=10]="kMilliseconds",r[r.kSeconds=11]="kSeconds",r[r.kInteger=12]="kInteger",r}({}),Fr=function(r){return r[r.kUNumber=0]="kUNumber",r[r.kUPercent=1]="kUPercent",r[r.kULength=2]="kULength",r[r.kUAngle=3]="kUAngle",r[r.kUTime=4]="kUTime",r[r.kUOther=5]="kUOther",r}({}),JI=function(r){return r[r.kYes=0]="kYes",r[r.kNo=1]="kNo",r}({}),QI=function(r){return r[r.kYes=0]="kYes",r[r.kNo=1]="kNo",r}({}),eD=[{name:"em",unit_type:xe.kEms},{name:"px",unit_type:xe.kPixels},{name:"deg",unit_type:xe.kDegrees},{name:"rad",unit_type:xe.kRadians},{name:"grad",unit_type:xe.kGradians},{name:"ms",unit_type:xe.kMilliseconds},{name:"s",unit_type:xe.kSeconds},{name:"rem",unit_type:xe.kRems},{name:"turn",unit_type:xe.kTurns}],Bs=function(r){return r[r.kUnknownType=0]="kUnknownType",r[r.kUnparsedType=1]="kUnparsedType",r[r.kKeywordType=2]="kKeywordType",r[r.kUnitType=3]="kUnitType",r[r.kSumType=4]="kSumType",r[r.kProductType=5]="kProductType",r[r.kNegateType=6]="kNegateType",r[r.kInvertType=7]="kInvertType",r[r.kMinType=8]="kMinType",r[r.kMaxType=9]="kMaxType",r[r.kClampType=10]="kClampType",r[r.kTransformType=11]="kTransformType",r[r.kPositionType=12]="kPositionType",r[r.kURLImageType=13]="kURLImageType",r[r.kColorType=14]="kColorType",r[r.kUnsupportedColorType=15]="kUnsupportedColorType",r}({}),tD=function(e){return eD.find(function(t){return t.name===e}).unit_type},nD=function(e){return e?e==="number"?xe.kNumber:e==="percent"||e==="%"?xe.kPercentage:tD(e):xe.kUnknown},rD=function(e){switch(e){case xe.kNumber:case xe.kInteger:return Fr.kUNumber;case xe.kPercentage:return Fr.kUPercent;case xe.kPixels:return Fr.kULength;case xe.kMilliseconds:case xe.kSeconds:return Fr.kUTime;case xe.kDegrees:case xe.kRadians:case xe.kGradians:case xe.kTurns:return Fr.kUAngle;default:return Fr.kUOther}},iD=function(e){switch(e){case Fr.kUNumber:return xe.kNumber;case Fr.kULength:return xe.kPixels;case Fr.kUPercent:return xe.kPercentage;case Fr.kUTime:return xe.kSeconds;case Fr.kUAngle:return xe.kDegrees;default:return xe.kUnknown}},Ew=function(e){var t=1;switch(e){case xe.kPixels:case xe.kDegrees:case xe.kSeconds:break;case xe.kMilliseconds:t=.001;break;case xe.kRadians:t=180/Math.PI;break;case xe.kGradians:t=.9;break;case xe.kTurns:t=360;break}return t},xm=function(e){switch(e){case xe.kNumber:case xe.kInteger:return"";case xe.kPercentage:return"%";case xe.kEms:return"em";case xe.kRems:return"rem";case xe.kPixels:return"px";case xe.kDegrees:return"deg";case xe.kRadians:return"rad";case xe.kGradians:return"grad";case xe.kMilliseconds:return"ms";case xe.kSeconds:return"s";case xe.kTurns:return"turn"}return""},Cc=function(){function r(){de(this,r)}return fe(r,[{key:"toString",value:function(){return this.buildCSSText(JI.kNo,QI.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=Bs.kUnitType&&this.getType()<=Bs.kClampType}}],[{key:"isAngle",value:function(t){return t===xe.kDegrees||t===xe.kRadians||t===xe.kGradians||t===xe.kTurns}},{key:"isLength",value:function(t){return t>=xe.kEms&&t<xe.kDegrees}},{key:"isRelativeUnit",value:function(t){return t===xe.kPercentage||t===xe.kEms||t===xe.kRems}},{key:"isTime",value:function(t){return t===xe.kSeconds||t===xe.kMilliseconds}}])}(),aD=function(r){function e(t){var n;return de(this,e),n=We(this,e),n.colorSpace=t,n}return Ve(e,r),fe(e,[{key:"getType",value:function(){return Bs.kColorType}},{key:"to",value:function(n){return this}}])}(Cc),Zi=function(r){return r[r.Constant=0]="Constant",r[r.LinearGradient=1]="LinearGradient",r[r.RadialGradient=2]="RadialGradient",r}({}),zl=function(r){function e(t,n){var i;return de(this,e),i=We(this,e),i.type=t,i.value=n,i}return Ve(e,r),fe(e,[{key:"clone",value:function(){return new e(this.type,this.value)}},{key:"buildCSSText",value:function(n,i,a){return a}},{key:"getType",value:function(){return Bs.kColorType}}])}(Cc),Ar=function(r){function e(t){var n;return de(this,e),n=We(this,e),n.value=t,n}return Ve(e,r),fe(e,[{key:"clone",value:function(){return new e(this.value)}},{key:"getType",value:function(){return Bs.kKeywordType}},{key:"buildCSSText",value:function(n,i,a){return a+this.value}}])}(Cc),sD=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n="";return Number.isFinite(e)?n="NaN":e>0?n="infinity":n="-infinity",n+=t},Em=function(e){return iD(rD(e))},pn=function(r){function e(t){var n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xe.kNumber;de(this,e),n=We(this,e);var a;return typeof i=="string"?a=nD(i):a=i,n.unit=a,n.value=t,n}return Ve(e,r),fe(e,[{key:"clone",value:function(){return new e(this.value,this.unit)}},{key:"equals",value:function(n){var i=n;return this.value===i.value&&this.unit===i.unit}},{key:"getType",value:function(){return Bs.kUnitType}},{key:"convertTo",value:function(n){if(this.unit===n)return new e(this.value,this.unit);var i=Em(this.unit);if(i!==Em(n)||i===xe.kUnknown)return null;var a=Ew(this.unit)/Ew(n);return new e(this.value*a,n)}},{key:"buildCSSText",value:function(n,i,a){var s;switch(this.unit){case xe.kUnknown:break;case xe.kInteger:s=Number(this.value).toFixed(0);break;case xe.kNumber:case xe.kPercentage:case xe.kEms:case xe.kRems:case xe.kPixels:case xe.kDegrees:case xe.kRadians:case xe.kGradians:case xe.kMilliseconds:case xe.kSeconds:case xe.kTurns:{var o=-999999,l=999999,u=this.value,c=xm(this.unit);if(u<o||u>l){var h=xm(this.unit);!Number.isFinite(u)||Number.isNaN(u)?s=sD(u,h):s=u+(h||"")}else s="".concat(u).concat(c)}}return a+=s,a}}])}(Cc),Ir=new pn(0,"px");new pn(1,"px");var Wa=new pn(0,"deg"),O1=function(r){function e(t,n,i){var a,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return de(this,e),a=We(this,e,["rgb"]),a.r=t,a.g=n,a.b=i,a.alpha=s,a.isNone=o,a}return Ve(e,r),fe(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(n,i,a){return"".concat(a,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(aD),Sw=new Ar("unset"),oD=new Ar("initial"),lD=new Ar("inherit"),Td={"":Sw,unset:Sw,initial:oD,inherit:lD},uD=function(e){return Td[e]||(Td[e]=new Ar(e)),Td[e]},cA=new O1(0,0,0,0,!0),hA=new O1(0,0,0,0),cD=nn(function(r,e,t,n){return new O1(r,e,t,n)},function(r,e,t,n){return"rgba(".concat(r,",").concat(e,",").concat(t,",").concat(n,")")}),kt=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xe.kNumber;return new pn(e,t)};new pn(50,"%");function hD(r){var e=r.type,t=r.value;return e==="hex"?"#".concat(t):e==="literal"?t:e==="rgb"?"rgb(".concat(t.join(","),")"):"rgba(".concat(t.join(","),")")}var dD=function(){var r={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function t($){throw new Error("".concat(e,": ").concat($))}function n(){var $=i();return e.length>0&&t("Invalid input not EOF"),$}function i(){return w(a)}function a(){return s("linear-gradient",r.linearGradient,l)||s("repeating-linear-gradient",r.repeatingLinearGradient,l)||s("radial-gradient",r.radialGradient,h)||s("repeating-radial-gradient",r.repeatingRadialGradient,h)||s("conic-gradient",r.conicGradient,h)}function s($,j,Z){return o(j,function(ne){var oe=Z();return oe&&(V(r.comma)||t("Missing comma before color stops")),{type:$,orientation:oe,colorStops:w(S)}})}function o($,j){var Z=V($);if(Z){V(r.startCall)||t("Missing (");var ne=j(Z);return V(r.endCall)||t("Missing )"),ne}}function l(){return u()||c()}function u(){return G("directional",r.sideOrCorner,1)}function c(){return G("angular",r.angleValue,1)}function h(){var $,j=d(),Z;return j&&($=[],$.push(j),Z=e,V(r.comma)&&(j=d(),j?$.push(j):e=Z)),$}function d(){var $=f()||g();if($)$.at=p();else{var j=v();if(j){$=j;var Z=p();Z&&($.at=Z)}else{var ne=y();ne&&($={type:"default-radial",at:ne})}}return $}function f(){var $=G("shape",/^(circle)/i,0);return $&&($.style=F()||v()),$}function g(){var $=G("shape",/^(ellipse)/i,0);return $&&($.style=N()||v()),$}function v(){return G("extent-keyword",r.extentKeywords,1)}function p(){if(G("position",/^at/,0)){var $=y();return $||t("Missing positioning value"),$}}function y(){var $=m();if($.x||$.y)return{type:"position",value:$}}function m(){return{x:N(),y:N()}}function w($){var j=$(),Z=[];if(j)for(Z.push(j);V(r.comma);)j=$(),j?Z.push(j):t("One extra comma");return Z}function S(){var $=_();return $||t("Expected color definition"),$.length=N(),$}function _(){return T()||P()||k()||O()}function O(){return G("literal",r.literalColor,0)}function T(){return G("hex",r.hexColor,1)}function k(){return o(r.rgbColor,function(){return{type:"rgb",value:w(C)}})}function P(){return o(r.rgbaColor,function(){return{type:"rgba",value:w(C)}})}function C(){return V(r.number)[1]}function N(){return G("%",r.percentageValue,1)||L()||F()}function L(){return G("position-keyword",r.positionKeywords,1)}function F(){return G("px",r.pixelValue,1)||G("em",r.emValue,1)}function G($,j,Z){var ne=V(j);if(ne)return{type:$,value:ne[Z]}}function V($){var j=/^[\n\r\t\s]+/.exec(e);j&&U(j[0].length);var Z=$.exec(e);return Z&&U(Z[0].length),Z}function U($){e=e.substring($)}return function($){return e=$,n()}}();function fD(r,e,t,n){var i=ot(n.value),a=0,s=0,o=a+e/2,l=s+t/2,u=Math.abs(e*Math.cos(i))+Math.abs(t*Math.sin(i)),c=r[0]+o-Math.cos(i)*u/2,h=r[1]+l-Math.sin(i)*u/2,d=r[0]+o+Math.cos(i)*u/2,f=r[1]+l+Math.sin(i)*u/2;return{x1:c,y1:h,x2:d,y2:f}}function gD(r,e,t,n,i,a){var s=n.value,o=i.value;n.unit===xe.kPercentage&&(s=n.value/100*e),i.unit===xe.kPercentage&&(o=i.value/100*t);var l=Math.max(Xn([0,0],[s,o]),Xn([0,t],[s,o]),Xn([e,t],[s,o]),Xn([e,0],[s,o]));return a&&(a instanceof pn?l=a.value:a instanceof Ar&&(a.value==="closest-side"?l=Math.min(s,e-s,o,t-o):a.value==="farthest-side"?l=Math.max(s,e-s,o,t-o):a.value==="closest-corner"&&(l=Math.min(Xn([0,0],[s,o]),Xn([0,t],[s,o]),Xn([e,t],[s,o]),Xn([e,0],[s,o]))))),{x:s+r[0],y:o+r[1],r:l}}var pD=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,vD=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,yD=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,dA=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function mD(r){var e,t=r.length;if(r[t-1].length=(e=r[t-1].length)!==null&&e!==void 0?e:{type:"%",value:"100"},t>1){var n;r[0].length=(n=r[0].length)!==null&&n!==void 0?n:{type:"%",value:"0"}}for(var i=0,a=Number(r[0].length.value),s=1;s<t;s++){var o,l=(o=r[s].length)===null||o===void 0?void 0:o.value;if(!Le(l)&&!Le(a)){for(var u=1;u<s-i;u++)r[i+u].length={type:"%",value:"".concat(a+(Number(l)-a)*u/(s-i))};i=s,a=Number(l)}}}var bD={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},wD=nn(function(r){var e;return r.type==="angular"?e=Number(r.value):e=bD[r.value]||0,kt(e,"deg")}),xD=nn(function(r){var e=50,t=50,n="%",i="%";if((r==null?void 0:r.type)==="position"){var a=r.value,s=a.x,o=a.y;(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?e=0:s.value==="center"?e=50:s.value==="right"?e=100:s.value==="top"?t=0:s.value==="bottom"&&(t=100)),(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?e=0:o.value==="center"?t=50:o.value==="right"?e=100:o.value==="top"?t=0:o.value==="bottom"&&(t=100)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(n=s==null?void 0:s.type,e=Number(s.value)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(i=o==null?void 0:o.type,t=Number(o.value))}return{cx:kt(e,n),cy:kt(t,i)}}),ED=nn(function(r){if(r.indexOf("linear")>-1||r.indexOf("radial")>-1){var e=dD(r);return e.map(function(o){var l=o.type,u=o.orientation,c=o.colorStops;mD(c);var h=c.map(function(w){return{offset:kt(Number(w.length.value),"%"),color:hD(w)}});if(l==="linear-gradient")return new zl(Zi.LinearGradient,{angle:u?wD(u):Wa,steps:h});if(l==="radial-gradient"&&(u||(u=[{type:"shape",value:"circle"}]),u[0].type==="shape"&&u[0].value==="circle")){var d=xD(u[0].at),f=d.cx,g=d.cy,v;if(u[0].style){var p=u[0].style,y=p.type,m=p.value;y==="extent-keyword"?v=uD(m):v=kt(m,y)}return new zl(Zi.RadialGradient,{cx:f,cy:g,size:v,steps:h})}})}var t=r[0];if(r[1]==="("||r[2]==="("){if(t==="l"){var n=pD.exec(r);if(n){var i,a=((i=n[2].match(dA))===null||i===void 0?void 0:i.map(function(o){return o.split(":")}))||[];return[new zl(Zi.LinearGradient,{angle:kt(parseFloat(n[1]),"deg"),steps:a.map(function(o){var l=qe(o,2),u=l[0],c=l[1];return{offset:kt(Number(u)*100,"%"),color:c}})})]}}else if(t==="r"){var s=SD(r);if(s)if(rt(s))r=s;else return[new zl(Zi.RadialGradient,s)]}else if(t==="p")return _D(r)}});function SD(r){var e=vD.exec(r);if(e){var t,n=((t=e[4].match(dA))===null||t===void 0?void 0:t.map(function(i){return i.split(":")}))||[];return{cx:kt(50,"%"),cy:kt(50,"%"),steps:n.map(function(i){var a=qe(i,2),s=a[0],o=a[1];return{offset:kt(Number(s)*100,"%"),color:o}})}}return null}function _D(r){var e=yD.exec(r);if(e){var t=e[1],n=e[2];switch(t){case"a":t="repeat";break;case"x":t="repeat-x";break;case"y":t="repeat-y";break;case"n":t="no-repeat";break;default:t="no-repeat"}return{image:n,repetition:t}}return null}function Va(r){return r&&!!r.image}function rc(r){return r&&!Le(r.r)&&!Le(r.g)&&!Le(r.b)}var No=nn(function(r){if(Va(r))return Ge({repetition:"repeat"},r);if(Le(r)&&(r=""),r==="transparent")return hA;if(r==="currentColor")r="black";else if(r==="none")return cA;var e=ED(r);if(e)return e;var t=Pc(r),n=[0,0,0,0];return t!==null&&(n[0]=t.r||0,n[1]=t.g||0,n[2]=t.b||0,n[3]=t.opacity),cD.apply(void 0,n)});function MD(r,e){if(!(!rc(r)||!rc(e)))return[[Number(r.r),Number(r.g),Number(r.b),Number(r.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var n=t.slice();if(n[3])for(var i=0;i<3;i++)n[i]=Math.round(Bt(n[i],0,255));return n[3]=Bt(n[3],0,1),"rgba(".concat(n.join(","),")")}]}function sl(r,e){if(Le(e))return kt(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(r)>=0)return kt(Number(e),"px");if("deg".search(r)>=0)return kt(Number(e),"deg")}var t=[];e=e.replace(r,function(i){return t.push(i),"U".concat(i)});var n="U(".concat(r.source,")");return t.map(function(i){return kt(Number(e.replace(new RegExp("U".concat(i),"g"),"").replace(new RegExp(n,"g"),"*0")),i)})[0]}var fA=function(e){return sl(new RegExp("px","g"),e)},OD=nn(fA),kD=function(e){return sl(new RegExp("%","g"),e)};nn(kD);var gA=function(e){return _e(e)||isFinite(Number(e))?kt(Number(e)||0,"px"):sl(new RegExp("px|%|em|rem","g"),e)},Sm=nn(gA),pA=function(e){return sl(new RegExp("deg|rad|grad|turn","g"),e)},TD=nn(pA);function AD(r,e,t,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,a="",s=r.value||0,o=e.value||0,l=Em(r.unit),u=r.convertTo(l),c=e.convertTo(l);return u&&c?(s=u.value,o=c.value,a=xm(r.unit)):(pn.isLength(r.unit)||pn.isLength(e.unit))&&(s=sr(r,i,t),o=sr(e,i,t),a="px"),[s,o,function(h){return h+a}]}function Zn(r){var e=0;return r.unit===xe.kDegrees?e=r.value:r.unit===xe.kRadians?e=Kn(Number(r.value)):r.unit===xe.kTurns?e=PI(Number(r.value)):r.value&&(e=r.value),e}function _w(r,e){var t;return Array.isArray(r)?t=r.map(function(n){return Number(n)}):rt(r)?t=r.split(" ").map(function(n){return Number(n)}):_e(r)&&(t=[r]),e===2?t.length===1?[t[0],t[0]]:[t[0],t[1]]:e===4?t.length===1?[t[0],t[0],t[0],t[0]]:t.length===2?[t[0],t[1],t[0],t[1]]:t.length===3?[t[0],t[1],t[2],t[1]]:[t[0],t[1],t[2],t[3]]:e==="even"&&t.length%2===1?[].concat(yt(t),yt(t)):t}function sr(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(r.unit===xe.kPixels)return Number(r.value);if(r.unit===xe.kPercentage&&t){var i=t.nodeName===re.GROUP?t.getLocalBounds():t.getGeometryBounds();return(n?i.min[e]:0)+r.value/100*i.halfExtents[e]*2}return 0}var PD=function(e){return sl(/deg|rad|grad|turn|px|%/g,e)},CD=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function ND(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(r=r.toLowerCase().trim(),r==="none")return[];for(var e=/\s*([\w-]+)\(([^)]*)\)/g,t=[],n,i=0;n=e.exec(r);){if(n.index!==i)return[];if(i=n.index+n[0].length,CD.indexOf(n[1])>-1&&t.push({name:n[1],params:n[2].split(" ").map(function(a){return PD(a)||No(a)})}),e.lastIndex===r.length)return t}return[]}function vA(r){return r.toString()}var yA=function(e){return typeof e=="number"?kt(e):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(e)?kt(Number(e)):kt(0)},_m=nn(yA);nn(function(r){return rt(r)?r.split(" ").map(_m):r.map(_m)});function k1(r,e){return[r,e,vA]}function T1(r,e){return function(t,n){return[t,n,function(i){return vA(Bt(i,r,e))}]}}function mA(r,e){if(r.length===e.length)return[r,e,function(t){return t}]}function Mm(r){return r.parsedStyle.d.totalLength===0&&(r.parsedStyle.d.totalLength=Z3(r.parsedStyle.d.absolutePath)),r.parsedStyle.d.totalLength}function RD(r){return r.parsedStyle.points.totalLength===0&&(r.parsedStyle.points.totalLength=pI(r.parsedStyle.points.points)),r.parsedStyle.points.totalLength}function LD(r){for(var e=0;e<r.length;e++){var t=r[e-1],n=r[e],i=n[0];if(i==="M"&&t){var a=t[0],s=[n[1],n[2]],o=void 0;a==="L"||a==="M"?o=[t[1],t[2]]:(a==="C"||a==="A"||a==="Q")&&(o=[t[t.length-2],t[t.length-1]]),o&&ic(s,o)&&(r.splice(e,1),e--)}}}function ID(r){for(var e=!1,t=r.length,n=0;n<t;n++){var i=r[n],a=i[0];if(a==="C"||a==="A"||a==="Q"){e=!0;break}}return e}function DD(r){for(var e=[],t=[],n=[],i=0;i<r.length;i++){var a=r[i],s=a[0];s==="M"?(n.length&&(t.push(n),n=[]),n.push([a[1],a[2]])):s==="Z"?n.length&&(e.push(n),n=[]):n.push([a[1],a[2]])}return n.length>0&&t.push(n),{polygons:e,polylines:t}}function ic(r,e){return r[0]===e[0]&&r[1]===e[1]}function FD(r,e){for(var t=[],n=[],i=[],a=0;a<r.length;a++){var s=r[a],o=s.currentPoint,l=s.params,u=s.prePoint,c=void 0;switch(s.command){case"Q":c=vI(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=dI(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=s.arcParams;c=uI(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:t.push(o[0]),n.push(o[1]);break}c&&(s.box=c,t.push(c.x,c.x+c.width),n.push(c.y,c.y+c.height))}t=t.filter(function(S){return!Number.isNaN(S)&&S!==1/0&&S!==-1/0}),n=n.filter(function(S){return!Number.isNaN(S)&&S!==1/0&&S!==-1/0});var d=Xu(t),f=Xu(n),g=Yu(t),v=Yu(n);if(i.length===0)return{x:d,y:f,width:g-d,height:v-f};for(var p=0;p<i.length;p++){var y=i[p],m=y.currentPoint,w=void 0;m[0]===d?(w=jl(y,e),d-=w.xExtra):m[0]===g&&(w=jl(y,e),g+=w.xExtra),m[1]===f?(w=jl(y,e),f-=w.yExtra):m[1]===v&&(w=jl(y,e),v+=w.yExtra)}return{x:d,y:f,width:g-d,height:v-f}}function jl(r,e){var t=r.prePoint,n=r.currentPoint,i=r.nextPoint,a=Math.pow(n[0]-t[0],2)+Math.pow(n[1]-t[1],2),s=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),o=Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),l=Math.acos((a+s-o)/(2*Math.sqrt(a)*Math.sqrt(s)));if(!l||Math.sin(l)===0||Po(l,0))return{xExtra:0,yExtra:0};var u=Math.abs(Math.atan2(i[1]-n[1],i[0]-n[0])),c=Math.abs(Math.atan2(i[0]-n[0],i[1]-n[1]));u=u>Math.PI/2?Math.PI-u:u,c=c>Math.PI/2?Math.PI-c:c;var h={xExtra:Math.cos(l/2-u)*(e/2*(1/Math.sin(l/2)))-e/2||0,yExtra:Math.cos(c-l/2)*(e/2*(1/Math.sin(l/2)))-e/2||0};return h}function Mw(r,e){return[e[0]+(e[0]-r[0]),e[1]+(e[1]-r[1])]}var Ow=function(e,t){var n=e.x*t.x+e.y*t.y,i=Math.sqrt((Math.pow(e.x,2)+Math.pow(e.y,2))*(Math.pow(t.x,2)+Math.pow(t.y,2))),a=e.x*t.y-e.y*t.x<0?-1:1,s=a*Math.acos(n/i);return s},kw=function(e,t,n,i,a,s,o,l){t=Math.abs(t),n=Math.abs(n),i=GT(i,360);var u=ot(i);if(e.x===o.x&&e.y===o.y)return{x:e.x,y:e.y,ellipticalArcAngle:0};if(t===0||n===0)return{x:0,y:0,ellipticalArcAngle:0};var c=(e.x-o.x)/2,h=(e.y-o.y)/2,d={x:Math.cos(u)*c+Math.sin(u)*h,y:-Math.sin(u)*c+Math.cos(u)*h},f=Math.pow(d.x,2)/Math.pow(t,2)+Math.pow(d.y,2)/Math.pow(n,2);f>1&&(t*=Math.sqrt(f),n*=Math.sqrt(f));var g=Math.pow(t,2)*Math.pow(n,2)-Math.pow(t,2)*Math.pow(d.y,2)-Math.pow(n,2)*Math.pow(d.x,2),v=Math.pow(t,2)*Math.pow(d.y,2)+Math.pow(n,2)*Math.pow(d.x,2),p=g/v;p=p<0?0:p;var y=(a!==s?1:-1)*Math.sqrt(p),m={x:y*(t*d.y/n),y:y*(-(n*d.x)/t)},w={x:Math.cos(u)*m.x-Math.sin(u)*m.y+(e.x+o.x)/2,y:Math.sin(u)*m.x+Math.cos(u)*m.y+(e.y+o.y)/2},S={x:(d.x-m.x)/t,y:(d.y-m.y)/n},_=Ow({x:1,y:0},S),O={x:(-d.x-m.x)/t,y:(-d.y-m.y)/n},T=Ow(S,O);!s&&T>0?T-=2*Math.PI:s&&T<0&&(T+=2*Math.PI),T%=2*Math.PI;var k=_+T*l,P=t*Math.cos(k),C=n*Math.sin(k),N={x:Math.cos(u)*P-Math.sin(u)*C+w.x,y:Math.sin(u)*P+Math.cos(u)*C+w.y,ellipticalArcStartAngle:_,ellipticalArcEndAngle:_+T,ellipticalArcAngle:k,ellipticalArcCenter:w,resultantRx:t,resultantRy:n};return N};function BD(r){for(var e=[],t=null,n=null,i=null,a=0,s=r.length,o=0;o<s;o++){var l=r[o];n=r[o+1];var u=l[0],c={command:u,prePoint:t,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=o;break;case"A":var h=zD(t,l);c.arcParams=h;break}if(u==="Z")t=i,n=r[a+1];else{var d=l.length;t=[l[d-2],l[d-1]]}n&&n[0]==="Z"&&(n=r[a],e[a]&&(e[a].prePoint=t)),c.currentPoint=t,e[a]&&ic(t,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=n?[n[n.length-2],n[n.length-1]]:null;c.nextPoint=f;var g=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[g[0]-t[0],g[1]-t[1]],c.endTangent=[t[0]-g[0],t[1]-g[1]];else if(u==="Q"){var v=[l[1],l[2]];c.startTangent=[g[0]-v[0],g[1]-v[1]],c.endTangent=[t[0]-v[0],t[1]-v[1]]}else if(u==="T"){var p=e[o-1],y=Mw(p.currentPoint,g);p.command==="Q"?(c.command="Q",c.startTangent=[g[0]-y[0],g[1]-y[1]],c.endTangent=[t[0]-y[0],t[1]-y[1]]):(c.command="TL",c.startTangent=[g[0]-t[0],g[1]-t[1]],c.endTangent=[t[0]-g[0],t[1]-g[1]])}else if(u==="C"){var m=[l[1],l[2]],w=[l[3],l[4]];c.startTangent=[g[0]-m[0],g[1]-m[1]],c.endTangent=[t[0]-w[0],t[1]-w[1]],c.startTangent[0]===0&&c.startTangent[1]===0&&(c.startTangent=[m[0]-w[0],m[1]-w[1]]),c.endTangent[0]===0&&c.endTangent[1]===0&&(c.endTangent=[w[0]-m[0],w[1]-m[1]])}else if(u==="S"){var S=e[o-1],_=Mw(S.currentPoint,g),O=[l[1],l[2]];S.command==="C"?(c.command="C",c.startTangent=[g[0]-_[0],g[1]-_[1]],c.endTangent=[t[0]-O[0],t[1]-O[1]]):(c.command="SQ",c.startTangent=[g[0]-O[0],g[1]-O[1]],c.endTangent=[t[0]-O[0],t[1]-O[1]])}else if(u==="A"){var T=Tw(c,0),k=T.x,P=T.y,C=Tw(c,1,!1),N=C.x,L=C.y;c.startTangent=[k,P],c.endTangent=[N,L]}e.push(c)}return e}function Tw(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=r.arcParams,i=n.rx,a=i===void 0?0:i,s=n.ry,o=s===void 0?0:s,l=n.xRotation,u=n.arcFlag,c=n.sweepFlag,h=kw({x:r.prePoint[0],y:r.prePoint[1]},a,o,l,!!u,!!c,{x:r.currentPoint[0],y:r.currentPoint[1]},e),d=kw({x:r.prePoint[0],y:r.prePoint[1]},a,o,l,!!u,!!c,{x:r.currentPoint[0],y:r.currentPoint[1]},t?e+.005:e-.005),f=d.x-h.x,g=d.y-h.y,v=Math.sqrt(f*f+g*g);return{x:-f/v,y:-g/v}}function ql(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Om(r,e){return ql(r)*ql(e)?(r[0]*e[0]+r[1]*e[1])/(ql(r)*ql(e)):1}function Aw(r,e){return(r[0]*e[1]<r[1]*e[0]?-1:1)*Math.acos(Om(r,e))}function zD(r,e){var t=e[1],n=e[2],i=GT(ot(e[3]),Math.PI*2),a=e[4],s=e[5],o=r[0],l=r[1],u=e[6],c=e[7],h=Math.cos(i)*(o-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(o-u)/2+Math.cos(i)*(l-c)/2,f=h*h/(t*t)+d*d/(n*n);f>1&&(t*=Math.sqrt(f),n*=Math.sqrt(f));var g=t*t*(d*d)+n*n*(h*h),v=g?Math.sqrt((t*t*(n*n)-g)/g):1;a===s&&(v*=-1),isNaN(v)&&(v=0);var p=n?v*t*d/n:0,y=t?v*-n*h/t:0,m=(o+u)/2+Math.cos(i)*p-Math.sin(i)*y,w=(l+c)/2+Math.sin(i)*p+Math.cos(i)*y,S=[(h-p)/t,(d-y)/n],_=[(-1*h-p)/t,(-1*d-y)/n],O=Aw([1,0],S),T=Aw(S,_);return Om(S,_)<=-1&&(T=Math.PI),Om(S,_)>=1&&(T=0),s===0&&T>0&&(T-=2*Math.PI),s===1&&T<0&&(T+=2*Math.PI),{cx:m,cy:w,rx:ic(r,[u,c])?0:t,ry:ic(r,[u,c])?0:n,startAngle:O,endAngle:O+T,xRotation:i,arcFlag:a,sweepFlag:s}}var bA=function(e){if(e===""||Array.isArray(e)&&e.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var t;try{t=Ju(e)}catch{t=Ju(""),console.error("[g]: Invalid SVG Path definition: ".concat(e))}LD(t);var n=ID(t),i=DD(t),a=i.polygons,s=i.polylines,o=BD(t),l=FD(o,0),u=l.x,c=l.y,h=l.width,d=l.height;return{absolutePath:t,hasArc:n,segments:o,polygons:a,polylines:s,totalLength:0,rect:{x:Number.isFinite(u)?u:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(h)?h:0,height:Number.isFinite(d)?d:0}}},jD=nn(bA);function wA(r){return rt(r)?jD(r):bA(r)}function qD(r,e,t){var n=r.curve,i=e.curve;(!n||n.length===0)&&(n=gm(r.absolutePath,!1),r.curve=n),(!i||i.length===0)&&(i=gm(e.absolutePath,!1),e.curve=i);var a=[n,i];n.length!==i.length&&(a=QT(n,i));var s=rw(a[0])!==rw(a[1])?V3(a[0]):W3(a[0]);return[s,Q3(a[1],s),function(o){return o}]}function $D(r,e){var t;return rt(r)?t=r.split(" ").map(function(n){var i=n.split(","),a=qe(i,2),s=a[0],o=a[1];return[Number(s),Number(o)]}):t=r,{points:t,totalLength:0,segments:[]}}function GD(r,e){return[r.points,e.points,function(t){return t}]}var Ft=null,Cs=/\s*(\w+)\(([^)]*)\)/g;function Un(r){return function(e){var t=0;return r.map(function(n){return n===Ft?e[t++]:n})}}function Ea(r){return r}var qo={matrix:["NNNNNN",[Ft,Ft,0,0,Ft,Ft,0,0,0,0,1,0,Ft,Ft,0,1],Ea],matrix3d:["NNNNNNNNNNNNNNNN",Ea],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Un([Ft,Ft,new pn(1)]),Ea],scaleX:["N",Un([Ft,new pn(1),new pn(1)]),Un([Ft,new pn(1)])],scaleY:["N",Un([new pn(1),Ft,new pn(1)]),Un([new pn(1),Ft])],scaleZ:["N",Un([new pn(1),new pn(1),Ft])],scale3d:["NNN",Ea],skew:["Aa",null,Ea],skewX:["A",null,Un([Ft,Wa])],skewY:["A",null,Un([Wa,Ft])],translate:["Tt",Un([Ft,Ft,Ir]),Ea],translateX:["T",Un([Ft,Ir,Ir]),Un([Ft,Ir])],translateY:["T",Un([Ir,Ft,Ir]),Un([Ir,Ft])],translateZ:["L",Un([Ir,Ir,Ft])],translate3d:["TTL",Ea]};function xA(r){for(var e=[],t=r.length,n=0;n<t;n++){var i=r[n],a=i[0],s=i.slice(1);a==="translate"||a==="skew"?s.length===1&&s.push(0):a==="scale"&&s.length===1&&s.push(s[0]);var o=qo[a];if(!o)return[];var l=s.map(function(u){return kt(u)});e.push({t:a,d:l})}return e}function EA(r){if(Array.isArray(r))return xA(r);if(r=(r||"none").trim(),r==="none")return[];var e=[],t,n=0;for(Cs.lastIndex=0;t=Cs.exec(r);){if(t.index!==n)return[];n=t.index+t[0].length;var i=t[1],a=qo[i];if(!a)return[];var s=t[2].split(","),o=a[0];if(o.length<s.length)return[];for(var l=[],u=0;u<o.length;u++){var c=s[u],h=o[u],d=void 0;if(c?d={A:function(g){return g.trim()==="0"?Wa:TD(g)},N:_m,T:Sm,L:OD}[h.toUpperCase()](c):d={a:Wa,n:l[0],t:Ir}[h],d===void 0)return[];l.push(d)}if(e.push({t:i,d:l}),Cs.lastIndex===r.length)return e}return[]}function WD(r){if(Array.isArray(r))return xA(r);if(r=(r||"none").trim(),r==="none")return[];var e=[],t,n=0;for(Cs.lastIndex=0;t=Cs.exec(r);){if(t.index!==n)return[];n=t.index+t[0].length;var i=t[1],a=qo[i];if(!a)return[];var s=t[2].split(","),o=a[0];if(o.length<s.length)return[];for(var l=[],u=0;u<o.length;u++){var c=s[u],h=o[u],d=void 0;if(c?d={A:function(g){return g.trim()==="0"?Wa:pA(g)},N:yA,T:gA,L:fA}[h.toUpperCase()](c):d={a:Wa,n:l[0],t:Ir}[h],d===void 0)return[];l.push(d)}if(e.push({t:i,d:l}),Cs.lastIndex===r.length)return e}return[]}function VD(r){var e,t,n,i;switch(r.t){case"rotateX":return i=ot(Zn(r.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return i=ot(Zn(r.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return i=ot(Zn(r.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=r.d[0].value,t=r.d[1].value,n=r.d[2].value,i=ot(Zn(r.d[3]));var a=e*e+t*t+n*n;if(a===0)e=1,t=0,n=0;else if(a!==1){var s=Math.sqrt(a);e/=s,t/=s,n/=s}var o=Math.sin(i/2),l=o*Math.cos(i/2),u=o*o;return[1-2*(t*t+n*n)*u,2*(e*t*u+n*l),2*(e*n*u-t*l),0,2*(e*t*u-n*l),1-2*(e*e+n*n)*u,2*(t*n*u+e*l),0,2*(e*n*u+t*l),2*(t*n*u-e*l),1-2*(e*e+t*t)*u,0,0,0,0,1];case"scale":return[r.d[0].value,0,0,0,0,r.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[r.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,r.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,r.d[0].value,0,0,0,0,1];case"scale3d":return[r.d[0].value,0,0,0,0,r.d[1].value,0,0,0,0,r.d[2].value,0,0,0,0,1];case"skew":var c=ot(Zn(r.d[0])),h=ot(Zn(r.d[1]));return[1,Math.tan(h),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return i=ot(Zn(r.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return i=ot(Zn(r.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return e=sr(r.d[0],0,null)||0,t=sr(r.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1];case"translateX":return e=sr(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,0,0,1];case"translateY":return t=sr(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,t,0,1];case"translateZ":return n=sr(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,n,1];case"translate3d":return e=sr(r.d[0],0,null)||0,t=sr(r.d[1],0,null)||0,n=sr(r.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,n,1];case"perspective":var d=sr(r.d[0],0,null)||0,f=d?-1/d:0;return[1,0,0,0,0,1,0,0,0,0,1,f,0,0,0,1];case"matrix":return[r.d[0].value,r.d[1].value,0,0,r.d[2].value,r.d[3].value,0,0,0,0,1,0,r.d[4].value,r.d[5].value,0,1];case"matrix3d":return r.d.map(function(g){return g.value})}}function UD(r,e){return[r[0]*e[0]+r[4]*e[1]+r[8]*e[2]+r[12]*e[3],r[1]*e[0]+r[5]*e[1]+r[9]*e[2]+r[13]*e[3],r[2]*e[0]+r[6]*e[1]+r[10]*e[2]+r[14]*e[3],r[3]*e[0]+r[7]*e[1]+r[11]*e[2]+r[15]*e[3],r[0]*e[4]+r[4]*e[5]+r[8]*e[6]+r[12]*e[7],r[1]*e[4]+r[5]*e[5]+r[9]*e[6]+r[13]*e[7],r[2]*e[4]+r[6]*e[5]+r[10]*e[6]+r[14]*e[7],r[3]*e[4]+r[7]*e[5]+r[11]*e[6]+r[15]*e[7],r[0]*e[8]+r[4]*e[9]+r[8]*e[10]+r[12]*e[11],r[1]*e[8]+r[5]*e[9]+r[9]*e[10]+r[13]*e[11],r[2]*e[8]+r[6]*e[9]+r[10]*e[10]+r[14]*e[11],r[3]*e[8]+r[7]*e[9]+r[11]*e[10]+r[15]*e[11],r[0]*e[12]+r[4]*e[13]+r[8]*e[14]+r[12]*e[15],r[1]*e[12]+r[5]*e[13]+r[9]*e[14]+r[13]*e[15],r[2]*e[12]+r[6]*e[13]+r[10]*e[14]+r[14]*e[15],r[3]*e[12]+r[7]*e[13]+r[11]*e[14]+r[15]*e[15]]}function HD(r){return r.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:r.map(VD).reduce(UD)}function Pw(r){var e=[0,0,0],t=[1,1,1],n=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return II(HD(r),e,t,n,i,a),[[e,t,n,a,i]]}var YD=function(){function r(n,i){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],s=0;s<4;s++)for(var o=0;o<4;o++)for(var l=0;l<4;l++)a[s][o]+=i[s][l]*n[l][o];return a}function e(n){return n[0][2]===0&&n[0][3]===0&&n[1][2]===0&&n[1][3]===0&&n[2][0]===0&&n[2][1]===0&&n[2][2]===1&&n[2][3]===0&&n[3][2]===0&&n[3][3]===1}function t(n,i,a,s,o){for(var l=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],u=0;u<4;u++)l[u][3]=o[u];for(var c=0;c<3;c++)for(var h=0;h<3;h++)l[3][c]+=n[h]*l[h][c];var d=s[0],f=s[1],g=s[2],v=s[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(f*f+g*g),p[0][1]=2*(d*f-g*v),p[0][2]=2*(d*g+f*v),p[1][0]=2*(d*f+g*v),p[1][1]=1-2*(d*d+g*g),p[1][2]=2*(f*g-d*v),p[2][0]=2*(d*g-f*v),p[2][1]=2*(f*g+d*v),p[2][2]=1-2*(d*d+f*f),l=r(l,p);var y=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(y[2][1]=a[2],l=r(l,y)),a[1]&&(y[2][1]=0,y[2][0]=a[0],l=r(l,y)),a[0]&&(y[2][0]=0,y[1][0]=a[0],l=r(l,y));for(var m=0;m<3;m++)for(var w=0;w<3;w++)l[m][w]*=i[m];return e(l)?[l[0][0],l[0][1],l[1][0],l[1][1],l[3][0],l[3][1]]:l[0].concat(l[1],l[2],l[3])}return t}();function XD(r){return r.toFixed(6).replace(".000000","")}function Ad(r,e){var t,n;return r.decompositionPair!==e&&(r.decompositionPair=e,t=Pw(r)),e.decompositionPair!==r&&(e.decompositionPair=r,n=Pw(e)),t[0]===null||n[0]===null?[[!1],[!0],function(i){return i?e[0].d:r[0].d}]:(t[0].push(0),n[0].push(1),[t,n,function(i){var a=ZD(t[0][3],n[0][3],i[5]),s=YD(i[0],i[1],i[2],a,i[4]),o=s.map(XD).join(",");return o}])}function KD(r,e){for(var t=0,n=0;n<r.length;n++)t+=r[n]*e[n];return t}function ZD(r,e,t){var n=KD(r,e);n=Bt(n,-1,1);var i=[];if(n===1)i=r;else for(var a=Math.acos(n),s=Math.sin(t*a)*1/Math.sqrt(1-n*n),o=0;o<4;o++)i.push(r[o]*(Math.cos(t*a)-n*s)+e[o]*s);return i}function Pd(r){return r.replace(/[XY]/,"")}function Cd(r){return r.replace(/(X|Y|Z|3d)?$/,"3d")}var JD=function(e,t){return e==="perspective"&&t==="perspective"||(e==="matrix"||e==="matrix3d")&&(t==="matrix"||t==="matrix3d")};function QD(r,e,t){var n=!1;if(!r.length||!e.length){r.length||(n=!0,r=e,e=[]);for(var i=function(){var N=r[a],L=N.t,F=N.d,G=L.substring(0,5)==="scale"?1:0;e.push({t:L,d:F.map(function(V){return typeof V=="number"?kt(G):kt(G,V.unit)})})},a=0;a<r.length;a++)i()}var s=[],o=[],l=[];if(r.length!==e.length){var u=Ad(r,e);s=[u[0]],o=[u[1]],l=[["matrix",[u[2]]]]}else for(var c=0;c<r.length;c++){var h=r[c].t,d=e[c].t,f=r[c].d,g=e[c].d,v=qo[h],p=qo[d],y=void 0;if(JD(h,d)){var m=Ad([r[c]],[e[c]]);s.push(m[0]),o.push(m[1]),l.push(["matrix",[m[2]]]);continue}else if(h===d)y=h;else if(v[2]&&p[2]&&Pd(h)===Pd(d))y=Pd(h),f=v[2](f),g=p[2](g);else if(v[1]&&p[1]&&Cd(h)===Cd(d))y=Cd(h),f=v[1](f),g=p[1](g);else{var w=Ad(r,e);s=[w[0]],o=[w[1]],l=[["matrix",[w[2]]]];break}for(var S=[],_=[],O=[],T=0;T<f.length;T++){var k=AD(f[T],g[T],t,!1,T);S[T]=k[0],_[T]=k[1],O.push(k[2])}s.push(S),o.push(_),l.push([y,O])}if(n){var P=s;s=o,o=P}return[s,o,function(C){return C.map(function(N,L){var F=N.map(function(G,V){return l[L][1][V](G)}).join(",");return l[L][0]==="matrix"&&F.split(",").length===16&&(l[L][0]="matrix3d"),l[L][0]==="matrix3d"&&F.split(",").length===6&&(l[L][0]="matrix"),"".concat(l[L][0],"(").concat(F,")")}).join(" ")}]}var e6=nn(function(r){if(rt(r)){if(r==="text-anchor")return[kt(0,"px"),kt(0,"px")];var e=r.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[Sm(Cw(e[0])),Sm(Cw(e[1]))]}return[kt(r[0]||0,"px"),kt(r[1]||0,"px")]});function Cw(r){return r==="center"?"50%":r==="left"||r==="top"?"0%":r==="right"||r==="bottom"?"100%":r}var A1=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:we.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:we.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:we.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:we.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:we.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:we.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:we.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:we.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:we.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:we.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:we.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:we.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:we.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:we.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:we.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:we.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:we.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:we.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:we.FILTER},{n:"clipPath",syntax:we.DEFINED_PATH},{n:"textPath",syntax:we.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:we.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:we.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:we.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:we.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:we.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:we.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:we.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:we.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:we.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:we.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:we.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:we.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:we.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:we.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:we.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:we.COORDINATE},{n:"y1",int:!0,l:!0,syntax:we.COORDINATE},{n:"z1",int:!0,l:!0,syntax:we.COORDINATE},{n:"x2",int:!0,l:!0,syntax:we.COORDINATE},{n:"y2",int:!0,l:!0,syntax:we.COORDINATE},{n:"z2",int:!0,l:!0,syntax:we.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:we.PATH,p:50},{n:"points",int:!0,l:!0,syntax:we.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:we.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:we.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:we.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:we.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:we.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:we.NUMBER,d:function(e){return e===re.PATH||e===re.POLYGON||e===re.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:we.MARKER},{n:"markerEnd",syntax:we.MARKER},{n:"markerMid",syntax:we.MARKER},{n:"markerStartOffset",syntax:we.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:we.LENGTH,l:!0,int:!0,d:"0"}],t6=new Set(A1.filter(function(r){return!!r.l}).map(function(r){return r.n})),SA={},n6=function(){function r(e){var t=this;de(this,r),this.runtime=e,A1.forEach(function(n){t.registerMetadata(n)})}return fe(r,[{key:"registerMetadata",value:function(t){[t.n].concat(yt(t.a||[])).forEach(function(n){SA[n]=t})}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t]}},{key:"processProperties",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{forceUpdateGeometry:!1};Object.assign(t.attributes,n);var a=t.parsedStyle.clipPath,s=t.parsedStyle.offsetPath;r6(t,n);var o=!!i.forceUpdateGeometry;if(!o){for(var l in n)if(t6.has(l)){o=!0;break}}var u=_A(t);u.has("fill")&&n.fill&&(t.parsedStyle.fill=No(n.fill)),u.has("stroke")&&n.stroke&&(t.parsedStyle.stroke=No(n.stroke)),u.has("shadowColor")&&n.shadowColor&&(t.parsedStyle.shadowColor=No(n.shadowColor)),u.has("filter")&&n.filter&&(t.parsedStyle.filter=ND(n.filter)),u.has("radius")&&!Le(n.radius)&&(t.parsedStyle.radius=_w(n.radius,4)),u.has("lineDash")&&!Le(n.lineDash)&&(t.parsedStyle.lineDash=_w(n.lineDash,"even")),u.has("points")&&n.points&&(t.parsedStyle.points=$D(n.points)),u.has("d")&&n.d===""&&(t.parsedStyle.d=Ge({},oA)),u.has("d")&&n.d&&(t.parsedStyle.d=wA(n.d)),u.has("textTransform")&&n.textTransform&&this.runtime.CSSPropertySyntaxFactory[we.TEXT_TRANSFORM].calculator(null,null,{value:n.textTransform},t,null),u.has("clipPath")&&!Be(n.clipPath)&&this.runtime.CSSPropertySyntaxFactory[we.DEFINED_PATH].calculator("clipPath",a,n.clipPath,t,this.runtime),u.has("offsetPath")&&n.offsetPath&&this.runtime.CSSPropertySyntaxFactory[we.DEFINED_PATH].calculator("offsetPath",s,n.offsetPath,t,this.runtime),u.has("transform")&&n.transform&&(t.parsedStyle.transform=EA(n.transform)),u.has("transformOrigin")&&n.transformOrigin&&(t.parsedStyle.transformOrigin=e6(n.transformOrigin)),u.has("markerStart")&&n.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[we.MARKER].calculator(null,n.markerStart,n.markerStart,null,null)),u.has("markerEnd")&&n.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[we.MARKER].calculator(null,n.markerEnd,n.markerEnd,null,null)),u.has("markerMid")&&n.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[we.MARKER].calculator("",n.markerMid,n.markerMid,null,null)),u.has("zIndex")&&!Le(n.zIndex)&&this.runtime.CSSPropertySyntaxFactory[we.Z_INDEX].postProcessor(t),u.has("offsetDistance")&&!Le(n.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[we.OFFSET_DISTANCE].postProcessor(t),u.has("transform")&&n.transform&&this.runtime.CSSPropertySyntaxFactory[we.TRANSFORM].postProcessor(t),u.has("transformOrigin")&&n.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[we.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.geometry.dirty=!0,t.renderable.boundsDirty=!0,t.renderable.renderBoundsDirty=!0,i.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(t))}},{key:"updateGeometry",value:function(t){var n=t.nodeName,i=this.runtime.geometryUpdaterFactory[n];if(i){var a=t.geometry;a.contentBounds||(a.contentBounds=new pt),a.renderBounds||(a.renderBounds=new pt);var s=t.parsedStyle,o=i.update(s,t),l=o.cx,u=l===void 0?0:l,c=o.cy,h=c===void 0?0:c,d=o.cz,f=d===void 0?0:d,g=o.hwidth,v=g===void 0?0:g,p=o.hheight,y=p===void 0?0:p,m=o.hdepth,w=m===void 0?0:m,S=[Math.abs(v),Math.abs(y),w],_=s.stroke,O=s.lineWidth,T=O===void 0?1:O,k=s.increasedLineWidthForHitTesting,P=k===void 0?0:k,C=s.shadowType,N=C===void 0?"outer":C,L=s.shadowColor,F=s.filter,G=F===void 0?[]:F,V=s.transformOrigin,U=[u,h,f];a.contentBounds.update(U,S);var $=n===re.POLYLINE||n===re.POLYGON||n===re.PATH?Math.SQRT2:.5,j=_&&!_.isNone;if(j){var Z=((T||0)+(P||0))*$;S[0]+=Z,S[1]+=Z}if(a.renderBounds.update(U,S),L&&N&&N!=="inner"){var ne=a.renderBounds,oe=ne.min,le=ne.max,Ce=s.shadowBlur,K=s.shadowOffsetX,W=s.shadowOffsetY,ee=Ce||0,he=K||0,Se=W||0,Ne=oe[0]-ee+he,Ue=le[0]+ee+he,Tt=oe[1]-ee+Se,fn=le[1]+ee+Se;oe[0]=Math.min(oe[0],Ne),le[0]=Math.max(le[0],Ue),oe[1]=Math.min(oe[1],Tt),le[1]=Math.max(le[1],fn),a.renderBounds.setMinMax(oe,le)}G.forEach(function(et){var mr=et.name,xt=et.params;if(mr==="blur"){var ls=xt[0].value;a.renderBounds.update(a.renderBounds.center,ia(a.renderBounds.halfExtents,a.renderBounds.halfExtents,[ls,ls,0]))}else if(mr==="drop-shadow"){var br=xt[0].value,Wt=xt[1].value,It=xt[2].value,Wn=a.renderBounds,Vn=Wn.min,wr=Wn.max,bi=Vn[0]-It+br,Kr=wr[0]+It+br,us=Vn[1]-It+Wt,cs=wr[1]+It+Wt;Vn[0]=Math.min(Vn[0],bi),wr[0]=Math.max(wr[0],Kr),Vn[1]=Math.min(Vn[1],us),wr[1]=Math.max(wr[1],cs),a.renderBounds.setMinMax(Vn,wr)}}),t.geometry.dirty=!1;var At=v<0,Kt=y<0,Ze=(At?-1:1)*(V?sr(V[0],0,t,!0):0),yr=(Kt?-1:1)*(V?sr(V[1],1,t,!0):0);(Ze||yr)&&t.setOrigin(Ze,yr)}}},{key:"updateSizeAttenuation",value:function(t,n){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/n,t.nodeName===re.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/n)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===re.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR))}}])}();function r6(r,e){var t=_A(r);for(var n in e)t.has(n)&&(r.parsedStyle[n]=e[n])}function _A(r){return r.constructor.PARSED_STYLE_LIST}var i6=function(){function r(){de(this,r),this.mixer=k1}return fe(r,[{key:"calculator",value:function(t,n,i,a){return Zn(i)}}])}(),a6=function(){function r(){de(this,r)}return fe(r,[{key:"calculator",value:function(t,n,i,a,s){return i instanceof Ar&&(i=null),s.sceneGraphService.updateDisplayObjectDependency(t,n,i,a),t==="clipPath"&&a.forEach(function(o){o.childNodes.length===0&&s.sceneGraphService.dirtifyToRoot(o)}),i}}])}(),s6=function(){function r(){de(this,r),this.parser=No,this.mixer=MD}return fe(r,[{key:"calculator",value:function(t,n,i,a){return i instanceof Ar?i.value==="none"?cA:hA:i}}])}(),o6=function(){function r(){de(this,r)}return fe(r,[{key:"calculator",value:function(t,n,i){return i instanceof Ar?[]:i}}])}();function Nw(r){var e=r.parsedStyle,t=e.fontSize;return Le(t)?null:t}var km=function(){function r(){de(this,r),this.mixer=k1}return fe(r,[{key:"calculator",value:function(t,n,i,a,s){if(_e(i))return i;if(pn.isRelativeUnit(i.unit)){if(i.unit===xe.kPercentage)return 0;if(i.unit===xe.kEms){if(a.parentNode){var o=Nw(a.parentNode);if(o)return o*=i.value,o}return 0}if(i.unit===xe.kRems){var l;if(a!=null&&(l=a.ownerDocument)!==null&&l!==void 0&&l.documentElement){var u=Nw(a.ownerDocument.documentElement);if(u)return u*=i.value,u}return 0}}else return i.value}}])}(),l6=function(){function r(){de(this,r),this.mixer=mA}return fe(r,[{key:"calculator",value:function(t,n,i){return i.map(function(a){return a.value})}}])}(),u6=function(){function r(){de(this,r),this.mixer=mA}return fe(r,[{key:"calculator",value:function(t,n,i){return i.map(function(a){return a.value})}}])}(),c6=function(){function r(){de(this,r)}return fe(r,[{key:"calculator",value:function(t,n,i,a){var s;i instanceof Ar&&(i=null);var o=(s=i)===null||s===void 0?void 0:s.cloneNode(!0);return o&&(o.style.isMarker=!0),o}}])}(),h6=function(){function r(){de(this,r),this.mixer=k1}return fe(r,[{key:"calculator",value:function(t,n,i){return i.value}}])}(),d6=function(){function r(){de(this,r),this.mixer=T1(0,1)}return fe(r,[{key:"calculator",value:function(t,n,i){return i.value}},{key:"postProcessor",value:function(t){var n=t.parsedStyle,i=n.offsetPath,a=n.offsetDistance;if(i){var s=i.nodeName;if(s===re.LINE||s===re.PATH||s===re.POLYLINE){var o=i.getPoint(a);o&&t.setLocalPosition(o.x,o.y)}}}}])}(),f6=function(){function r(){de(this,r),this.mixer=T1(0,1)}return fe(r,[{key:"calculator",value:function(t,n,i){return i.value}}])}(),g6=function(){function r(){de(this,r),this.parser=wA,this.mixer=qD}return fe(r,[{key:"calculator",value:function(t,n,i){return i instanceof Ar&&i.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Fs(0,0,0,0)}:i}}])}(),p6=fe(function r(){de(this,r),this.mixer=GD}),v6=function(r){function e(){var t;de(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=We(this,e,[].concat(i)),t.mixer=T1(0,1/0),t}return Ve(e,r),fe(e)}(km),y6=function(){function r(){de(this,r)}return fe(r,[{key:"calculator",value:function(t,n,i,a){return i instanceof Ar?i.value==="unset"?"":i.value:"".concat(i)}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||""}}])}(),m6=function(){function r(){de(this,r)}return fe(r,[{key:"calculator",value:function(t,n,i,a){var s=a.getAttribute("text");if(s){var o=s;i.value==="capitalize"?o=s.charAt(0).toUpperCase()+s.slice(1):i.value==="lowercase"?o=s.toLowerCase():i.value==="uppercase"&&(o=s.toUpperCase()),a.parsedStyle.text=o}return i.value}}])}(),Nd=new WeakMap;function b6(r,e,t){if(r){var n=typeof r=="string"?document.getElementById(r):r;Nd.has(n)&&Nd.get(n).destroy(t),Nd.set(n,e)}}var P1=typeof window<"u"&&typeof window.document<"u";function w6(r){return!!r.getAttribute}function x6(r,e){for(var t=0,n=r.length;t<n;){var i=t+n>>>1;MA(r[i],e)<0?t=i+1:n=i}return t}function MA(r,e){var t=Number(r.parsedStyle.zIndex||0),n=Number(e.parsedStyle.zIndex||0);if(t===n){var i=r.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(r)-a.indexOf(e)}}return t-n}function OA(r){var e=r;do{var t,n=(t=e.parsedStyle)===null||t===void 0?void 0:t.clipPath;if(n)return e;e=e.parentElement}while(e!==null);return null}var Rw="px";function E6(r,e,t){P1&&r.style&&(r.style.width=e+Rw,r.style.height=t+Rw)}function kA(r,e){if(P1)return document.defaultView.getComputedStyle(r,null).getPropertyValue(e)}function S6(r){var e=kA(r,"width");return e==="auto"?r.offsetWidth:parseFloat(e)}function _6(r){var e=kA(r,"height");return e==="auto"?r.offsetHeight:parseFloat(e)}var M6=1,O6={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Tm=typeof performance=="object"&&performance.now?performance:Date;function ac(r){return r.nodeName===re.FRAGMENT?!0:r.getRootNode().nodeName===re.FRAGMENT}function Qa(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"auto",e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,n=!1,i=!1,a=!!e&&!e.isNone,s=!!t&&!t.isNone;return r==="visiblepainted"||r==="painted"||r==="auto"?(n=a,i=s):r==="visiblefill"||r==="fill"?n=!0:r==="visiblestroke"||r==="stroke"?i=!0:(r==="visible"||r==="all")&&(n=!0,i=!0),[n,i]}var k6=1,T6=function(){return k6++},hi=typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:{},A6=Date.now(),P6=function(){return hi.performance&&typeof hi.performance.now=="function"?hi.performance.now():Date.now()-A6},bo={},Lw=Date.now(),C6=function(e){if(typeof e!="function")throw new TypeError("".concat(e," is not a function"));var t=Date.now(),n=t-Lw,i=n>16?0:16-n,a=T6();return bo[a]=e,Object.keys(bo).length>1||setTimeout(function(){Lw=t;var s=bo;bo={},Object.keys(s).forEach(function(o){return s[o](P6())})},i),a},N6=function(e){delete bo[e]},R6=["","webkit","moz","ms","o"],TA=function(e){return typeof e!="string"?C6:e===""?hi.requestAnimationFrame:hi["".concat(e,"RequestAnimationFrame")]},L6=function(e){return typeof e!="string"?N6:e===""?hi.cancelAnimationFrame:hi["".concat(e,"CancelAnimationFrame")]||hi["".concat(e,"CancelRequestAnimationFrame")]},I6=function(e,t){for(var n=0;e[n]!==void 0;){if(t(e[n]))return e[n];n+=1}},AA=I6(R6,function(r){return!!TA(r)}),C1=TA(AA),PA=L6(AA);hi.requestAnimationFrame=C1;hi.cancelAnimationFrame=PA;var D6=function(){function r(){de(this,r),this.callbacks=[]}return fe(r,[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(t,n){this.callbacks.push(n)}},{key:"promise",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return Promise.all(this.callbacks.map(function(a){return a.apply(void 0,n)}))}}])}(),F6=function(){function r(){de(this,r),this.callbacks=[]}return fe(r,[{key:"tapPromise",value:function(t,n){this.callbacks.push(n)}},{key:"promise",value:function(){var e=ha(_n().mark(function n(){var i,a,s,o,l=arguments;return _n().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!this.callbacks.length){c.next=14;break}return c.next=3,(i=this.callbacks)[0].apply(i,l);case 3:a=c.sent,s=0;case 5:if(!(s<this.callbacks.length-1)){c.next=13;break}return o=this.callbacks[s],c.next=9,o(a);case 9:a=c.sent;case 10:s++,c.next=5;break;case 13:return c.abrupt("return",a);case 14:return c.abrupt("return",null);case 15:case"end":return c.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()}])}(),Dn=function(){function r(){de(this,r),this.callbacks=[]}return fe(r,[{key:"tap",value:function(t,n){this.callbacks.push(n)}},{key:"call",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=arguments;this.callbacks.forEach(function(s){s.apply(void 0,a)})}}])}(),Rd=function(){function r(){de(this,r),this.callbacks=[]}return fe(r,[{key:"tap",value:function(t,n){this.callbacks.push(n)}},{key:"call",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(this.callbacks.length){for(var a=arguments,s=this.callbacks[0].apply(void 0,a),o=0;o<this.callbacks.length-1;o++){var l=this.callbacks[o];s=l(s)}return s}return null}}])}(),B6=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],z6=/([\"\'])[^\'\"]+\1/;function j6(r){for(var e=r.fontSize,t=e===void 0?16:e,n=r.fontFamily,i=n===void 0?"sans-serif":n,a=r.fontStyle,s=a===void 0?"normal":a,o=r.fontVariant,l=o===void 0?"normal":o,u=r.fontWeight,c=u===void 0?"normal":u,h=_e(t)&&"".concat(t,"px")||"16px",d=i.split(","),f=d.length-1;f>=0;f--){var g=d[f].trim();!z6.test(g)&&B6.indexOf(g)<0&&(g='"'.concat(g,'"')),d[f]=g}return"".concat(s," ").concat(l," ").concat(c," ").concat(h," ").concat(d.join(","))}function Ld(r,e,t){return ua(r),r[4]=Math.tan(e),r[1]=Math.tan(t),r}var Ut=gt(),q6=gt(),$6={scale:function(e){Ta(Ut,[e[0].value,e[1].value,1])},scaleX:function(e){Ta(Ut,[e[0].value,1,1])},scaleY:function(e){Ta(Ut,[1,e[0].value,1])},scaleZ:function(e){Ta(Ut,[1,1,e[0].value])},scale3d:function(e){Ta(Ut,[e[0].value,e[1].value,e[2].value])},translate:function(e){Yi(Ut,[e[0].value,e[1].value,0])},translateX:function(e){Yi(Ut,[e[0].value,0,0])},translateY:function(e){Yi(Ut,[0,e[0].value,0])},translateZ:function(e){Yi(Ut,[0,0,e[0].value])},translate3d:function(e){Yi(Ut,[e[0].value,e[1].value,e[2].value])},rotate:function(e){sm(Ut,ot(Zn(e[0])))},rotateX:function(e){PT(Ut,ot(Zn(e[0])))},rotateY:function(e){CT(Ut,ot(Zn(e[0])))},rotateZ:function(e){sm(Ut,ot(Zn(e[0])))},rotate3d:function(e){AT(Ut,ot(Zn(e[3])),[e[0].value,e[1].value,e[2].value])},skew:function(e){Ld(Ut,ot(e[0].value),ot(e[1].value))},skewX:function(e){Ld(Ut,ot(e[0].value),0)},skewY:function(e){Ld(Ut,0,ot(e[0].value))},matrix:function(e){am(Ut,e[0].value,e[1].value,0,0,e[2].value,e[3].value,0,0,0,0,1,0,e[4].value,e[5].value,0,1)},matrix3d:function(e){am.apply(jL,[Ut].concat(yt(e.map(function(t){return t.value}))))}},G6=mt(1,1,1),W6=Qe(),Iw={translate:function(e,t){ge.sceneGraphService.setLocalScale(e,G6,!1),ge.sceneGraphService.setLocalEulerAngles(e,W6,void 0,void 0,!1),ge.sceneGraphService.setLocalPosition(e,[t[0].value,t[1].value,0],!1),ge.sceneGraphService.dirtifyLocal(e,e.transformable)}};function CA(r,e){if(r.length){if(r.length===1&&Iw[r[0].t]){Iw[r[0].t](e,r[0].d);return}for(var t=ua(q6),n=0;n<r.length;n++){var i=r[n],a=i.t,s=i.d,o=$6[a];o&&(o(s),zT(t,t,Ut))}e.setLocalTransform(t)}else e.resetLocalTransform();return e.getLocalTransform()}var V6=function(){function r(){de(this,r),this.parser=WD,this.mixer=QD}return fe(r,[{key:"calculator",value:function(t,n,i,a){return i instanceof Ar?[]:i}},{key:"postProcessor",value:function(t){CA(t.parsedStyle.transform,t)}}])}(),U6=function(){function r(){de(this,r)}return fe(r,[{key:"postProcessor",value:function(t){var n=t.parsedStyle.transformOrigin;n[0].unit===xe.kPixels&&n[1].unit===xe.kPixels?t.setOrigin(n[0].value,n[1].value):t.getGeometryBounds()}}])}(),H6=function(){function r(){de(this,r)}return fe(r,[{key:"calculator",value:function(t,n,i,a){return i.value}},{key:"postProcessor",value:function(t){if(t.parentNode){var n=t.parentNode,i=n.renderable,a=n.sortable;i&&(i.dirty=!0),a&&(a.dirty=!0,a.dirtyReason=ec.Z_INDEX_CHANGED)}}}])}(),Y6=function(){function r(){de(this,r)}return fe(r,[{key:"update",value:function(t,n){var i=t.cx,a=i===void 0?0:i,s=t.cy,o=s===void 0?0:s,l=t.r,u=l===void 0?0:l;return{cx:a,cy:o,hwidth:u,hheight:u}}}])}(),X6=function(){function r(){de(this,r)}return fe(r,[{key:"update",value:function(t,n){var i=t.cx,a=i===void 0?0:i,s=t.cy,o=s===void 0?0:s,l=t.rx,u=l===void 0?0:l,c=t.ry,h=c===void 0?0:c;return{cx:a,cy:o,hwidth:u,hheight:h}}}])}(),K6=function(){function r(){de(this,r)}return fe(r,[{key:"update",value:function(t){var n=t.x1,i=t.y1,a=t.x2,s=t.y2,o=Math.min(n,a),l=Math.max(n,a),u=Math.min(i,s),c=Math.max(i,s),h=l-o,d=c-u,f=h/2,g=d/2;return{cx:o+f,cy:u+g,hwidth:f,hheight:g}}}])}(),Z6=function(){function r(){de(this,r)}return fe(r,[{key:"update",value:function(t){var n=t.d,i=n.rect,a=i.x,s=i.y,o=i.width,l=i.height,u=o/2,c=l/2;return{cx:a+u,cy:s+c,hwidth:u,hheight:c}}}])}(),J6=function(){function r(){de(this,r)}return fe(r,[{key:"update",value:function(t){if(t.points&&pr(t.points.points)){var n=t.points.points,i=Math.min.apply(Math,yt(n.map(function(d){return d[0]}))),a=Math.max.apply(Math,yt(n.map(function(d){return d[0]}))),s=Math.min.apply(Math,yt(n.map(function(d){return d[1]}))),o=Math.max.apply(Math,yt(n.map(function(d){return d[1]}))),l=a-i,u=o-s,c=l/2,h=u/2;return{cx:i+c,cy:s+h,hwidth:c,hheight:h}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),Q6=function(){function r(){de(this,r)}return fe(r,[{key:"update",value:function(t,n){var i=t.x,a=i===void 0?0:i,s=t.y,o=s===void 0?0:s,l=t.src,u=t.width,c=u===void 0?0:u,h=t.height,d=h===void 0?0:h,f=c,g=d;return l&&!rt(l)&&(f||(f=l.width,t.width=f),g||(g=l.height,t.height=g)),{cx:a+f/2,cy:o+g/2,hwidth:f/2,hheight:g/2}}}])}(),eF=function(){function r(e){de(this,r),this.globalRuntime=e}return fe(r,[{key:"isReadyToMeasure",value:function(t,n){var i=t.text;return i}},{key:"update",value:function(t,n){var i,a=t.text,s=t.textAlign,o=s===void 0?"start":s,l=t.lineWidth,u=l===void 0?1:l,c=t.textBaseline,h=c===void 0?"alphabetic":c,d=t.dx,f=d===void 0?0:d,g=t.dy,v=g===void 0?0:g,p=t.x,y=p===void 0?0:p,m=t.y,w=m===void 0?0:m;if(!this.isReadyToMeasure(t,n))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var S=(n==null||(i=n.ownerDocument)===null||i===void 0||(i=i.defaultView)===null||i===void 0?void 0:i.getConfig())||{},_=S.offscreenCanvas,O=this.globalRuntime.textService.measureText(a,t,_);t.metrics=O;var T=O.width,k=O.height,P=T/2,C=k/2,N=y+P;o==="center"||o==="middle"?N+=u/2-P:(o==="right"||o==="end")&&(N+=u-P*2);var L=w-C;return h==="middle"?L+=C:h==="top"||h==="hanging"?L+=C*2:h==="alphabetic"||(h==="bottom"||h==="ideographic")&&(L+=0),f&&(N+=f),v&&(L+=v),{cx:N,cy:L,hwidth:P,hheight:C}}}])}(),tF=function(){function r(){de(this,r)}return fe(r,[{key:"update",value:function(t,n){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),nF=function(){function r(){de(this,r)}return fe(r,[{key:"update",value:function(t,n){var i=t.x,a=i===void 0?0:i,s=t.y,o=s===void 0?0:s,l=t.width,u=l===void 0?0:l,c=t.height,h=c===void 0?0:c;return{cx:a+u/2,cy:o+h/2,hwidth:u/2,hheight:h/2}}}])}(),Nc=function(){function r(e){de(this,r),this.eventPhase=r.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new En,this.page=new En,this.canvas=new En,this.viewport=new En,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}return fe(r,[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(st)}}])}(),NA=function(r){function e(){var t;de(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=We(this,e,[].concat(i)),t.client=new En,t.movement=new En,t.offset=new En,t.global=new En,t.screen=new En,t}return Ve(e,r),fe(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(n){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(n)}},{key:"initMouseEvent",value:function(){throw new Error(st)}}])}(Nc),sc=function(r){function e(){var t;de(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=We(this,e,[].concat(i)),t.width=0,t.height=0,t.isPrimary=!1,t}return Ve(e,r),fe(e,[{key:"getCoalescedEvents",value:function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(NA),Am=function(r){function e(){return de(this,e),We(this,e,arguments)}return Ve(e,r),fe(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(NA),Jt=function(r){function e(t,n){var i;return de(this,e),i=We(this,e,[null]),i.type=t,i.detail=n,Object.assign(i,n),i}return Ve(e,r),fe(e)}(Nc),Dw=new WeakMap,RA=function(){function r(){de(this,r),this.emitter=new wT}return fe(r,[{key:"on",value:function(t,n,i){return this.addEventListener(t,n,i),this}},{key:"addEventListener",value:function(t,n,i){var a=!1,s=!1;if(Zu(i))a=i;else if(i){var o=i.capture;a=o===void 0?!1:o;var l=i.once;s=l===void 0?!1:l}a&&(t+="capture"),n=Te(n)?n:n.handleEvent;var u=Te(n)?void 0:n;return s?this.emitter.once(t,n,u):this.emitter.on(t,n,u),this}},{key:"off",value:function(t,n,i){return t?this.removeEventListener(t,n,i):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var t;(t=this.emitter)===null||t===void 0||t.removeAllListeners()}},{key:"removeEventListener",value:function(t,n,i){var a;if(!this.emitter)return this;var s=Zu(i)?i:i==null?void 0:i.capture;s&&(t+="capture"),n=Te(n)?n:(a=n)===null||a===void 0?void 0:a.handleEvent;var o=Te(n)?void 0:n;return this.emitter.off(t,n,o),this}},{key:"emit",value:function(t,n){this.dispatchEvent(new Jt(t,n))}},{key:"dispatchEvent",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=Dw.get(this);if(!i){var a;this.document?i=this:this.defaultView?i=this.defaultView:i=(a=this.ownerDocument)===null||a===void 0?void 0:a.defaultView,i&&Dw.set(this,i)}if(i){if(t.manager=i.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],n||(t.target=this),t.manager.dispatchEvent(t,t.type,n)}else this.emitter.emit(t.type,t);return!t.defaultPrevented}}])}(),Rt=function(r){function e(){var t;de(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=We(this,e,[].concat(i)),t.shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return Ve(e,r),fe(e,[{key:"textContent",get:function(){var n="";this.nodeName===re.TEXT&&(n+=this.style.text);var i=Aa(this.childNodes),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;s.nodeName===re.TEXT?n+=s.nodeValue:n+=s.textContent}}catch(o){i.e(o)}finally{i.f()}return n},set:function(n){var i=this;this.childNodes.slice().forEach(function(a){i.removeChild(a)}),this.nodeName===re.TEXT&&(this.style.text="".concat(n))}},{key:"getRootNode",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(n):n.composed&&this.host?this.host.getRootNode(n):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(n){throw new Error(st)}},{key:"lookupNamespaceURI",value:function(n){throw new Error(st)}},{key:"lookupPrefix",value:function(n){throw new Error(st)}},{key:"normalize",value:function(){throw new Error(st)}},{key:"isEqualNode",value:function(n){return this===n}},{key:"isSameNode",value:function(n){return this.isEqualNode(n)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(n){if(n===this)return 0;for(var i=n,a=this,s=[i],o=[a];(l=i.parentNode)!==null&&l!==void 0?l:a.parentNode;){var l;i=i.parentNode?(s.push(i.parentNode),i.parentNode):i,a=a.parentNode?(o.push(a.parentNode),a.parentNode):a}if(i!==a)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var u=s.length>o.length?s:o,c=u===s?o:s;if(u[u.length-c.length]===c[0])return u===s?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var h=u.length-c.length,d=c.length-1;d>=0;d--){var f=c[d],g=u[h+d];if(g!==f){var v=f.parentNode.childNodes;return v.indexOf(f)<v.indexOf(g)?c===s?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:u===s?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(n){return this.contains(n)}},{key:"contains",value:function(n){for(var i=n;i&&this!==i;)i=i.parentNode;return!!i}},{key:"getAncestor",value:function(n){for(var i=this;n>0&&i;)i=i.parentNode,n--;return i}},{key:"forEach",value:function(n){for(var i=[this];i.length>0;){var a=i.pop(),s=n(a);if(s===!1)break;for(var o=a.childNodes.length-1;o>=0;o--)i.push(a.childNodes[o])}}}],[{key:"isNode",value:function(n){return!!n.childNodes}}])}(RA);Rt.DOCUMENT_POSITION_DISCONNECTED=1;Rt.DOCUMENT_POSITION_PRECEDING=2;Rt.DOCUMENT_POSITION_FOLLOWING=4;Rt.DOCUMENT_POSITION_CONTAINS=8;Rt.DOCUMENT_POSITION_CONTAINED_BY=16;Rt.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var rF=2048,iF=function(){function r(e,t){var n=this;de(this,r),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=gt(),this.tmpVec3=Qe(),this.onPointerDown=function(i){var a=n.createPointerEvent(i);if(n.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")n.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var s=a.button===2;n.dispatchEvent(a,s?"rightdown":"mousedown")}var o=n.trackingData(i.pointerId);o.pressTargetsByButton[i.button]=a.composedPath(),n.freeEvent(a)},this.onPointerUp=function(i){var a=Tm.now(),s=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);if(n.dispatchEvent(s,"pointerup"),s.pointerType==="touch")n.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var o=s.button===2;n.dispatchEvent(s,o?"rightup":"mouseup")}var l=n.trackingData(i.pointerId),u=n.findMountedTarget(l.pressTargetsByButton[i.button]),c=u;if(u&&!s.composedPath().includes(u)){for(var h=u;h&&!s.composedPath().includes(h);){if(s.currentTarget=h,n.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")n.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var d=s.button===2;n.notifyTarget(s,d?"rightupoutside":"mouseupoutside")}Rt.isNode(h)&&(h=h.parentNode)}delete l.pressTargetsByButton[i.button],c=h}if(c){var f,g=n.clonePointerEvent(s,"click");g.target=c,g.path=[],l.clicksByButton[i.button]||(l.clicksByButton[i.button]={clickCount:0,target:g.target,timeStamp:a});var v=n.context.renderingContext.root.ownerDocument.defaultView,p=l.clicksByButton[i.button];p.target===g.target&&a-p.timeStamp<v.getConfig().dblClickSpeed?++p.clickCount:p.clickCount=1,p.target=g.target,p.timeStamp=a,g.detail=p.clickCount,(f=s.detail)!==null&&f!==void 0&&f.preventClick||(!n.context.config.useNativeClickEvent&&(g.pointerType==="mouse"||g.pointerType==="touch")&&n.dispatchEvent(g,"click"),n.dispatchEvent(g,"pointertap")),n.freeEvent(g)}n.freeEvent(s)},this.onPointerMove=function(i){var a=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0),s=a.pointerType==="mouse"||a.pointerType==="pen",o=n.trackingData(i.pointerId),l=n.findMountedTarget(o.overTargets);if(o.overTargets&&l!==a.target){var u=i.type==="mousemove"?"mouseout":"pointerout",c=n.createPointerEvent(i,u,l||void 0);if(n.dispatchEvent(c,"pointerout"),s&&n.dispatchEvent(c,"mouseout"),!a.composedPath().includes(l)){var h=n.createPointerEvent(i,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,n.notifyTarget(h),s&&n.notifyTarget(h,"mouseleave"),Rt.isNode(h.target)&&(h.target=h.target.parentNode);n.freeEvent(h)}n.freeEvent(c)}if(l!==a.target){var d=i.type==="mousemove"?"mouseover":"pointerover",f=n.clonePointerEvent(a,d);n.dispatchEvent(f,"pointerover"),s&&n.dispatchEvent(f,"mouseover");for(var g=l&&Rt.isNode(l)&&l.parentNode;g&&g!==(Rt.isNode(n.rootTarget)&&n.rootTarget.parentNode)&&g!==a.target;)g=g.parentNode;var v=!g||g===(Rt.isNode(n.rootTarget)&&n.rootTarget.parentNode);if(v){var p=n.clonePointerEvent(a,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==l&&p.target!==(Rt.isNode(n.rootTarget)&&n.rootTarget.parentNode);)p.currentTarget=p.target,n.notifyTarget(p),s&&n.notifyTarget(p,"mouseenter"),Rt.isNode(p.target)&&(p.target=p.target.parentNode);n.freeEvent(p)}n.freeEvent(f)}n.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&n.dispatchEvent(a,"touchmove"),s&&(n.dispatchEvent(a,"mousemove"),n.cursor=n.getCursor(a.target)),o.overTargets=a.composedPath(),n.freeEvent(a)},this.onPointerOut=function(i){var a=n.trackingData(i.pointerId);if(a.overTargets){var s=i.pointerType==="mouse"||i.pointerType==="pen",o=n.findMountedTarget(a.overTargets),l=n.createPointerEvent(i,"pointerout",o||void 0);n.dispatchEvent(l),s&&n.dispatchEvent(l,"mouseout");var u=n.createPointerEvent(i,"pointerleave",o||void 0);for(u.eventPhase=u.AT_TARGET;u.target&&u.target!==(Rt.isNode(n.rootTarget)&&n.rootTarget.parentNode);)u.currentTarget=u.target,n.notifyTarget(u),s&&n.notifyTarget(u,"mouseleave"),Rt.isNode(u.target)&&(u.target=u.target.parentNode);a.overTargets=null,n.freeEvent(l),n.freeEvent(u)}n.cursor=null},this.onPointerOver=function(i){var a=n.trackingData(i.pointerId),s=n.createPointerEvent(i),o=s.pointerType==="mouse"||s.pointerType==="pen";n.dispatchEvent(s,"pointerover"),o&&n.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(n.cursor=n.getCursor(s.target));var l=n.clonePointerEvent(s,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(Rt.isNode(n.rootTarget)&&n.rootTarget.parentNode);)l.currentTarget=l.target,n.notifyTarget(l),o&&n.notifyTarget(l,"mouseenter"),Rt.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=s.composedPath(),n.freeEvent(s),n.freeEvent(l)},this.onPointerUpOutside=function(i){var a=n.trackingData(i.pointerId),s=n.findMountedTarget(a.pressTargetsByButton[i.button]),o=n.createPointerEvent(i);if(s){for(var l=s;l;)o.currentTarget=l,n.notifyTarget(o,"pointerupoutside"),o.pointerType==="touch"||(o.pointerType==="mouse"||o.pointerType==="pen")&&n.notifyTarget(o,o.button===2?"rightupoutside":"mouseupoutside"),Rt.isNode(l)&&(l=l.parentNode);delete a.pressTargetsByButton[i.button]}n.freeEvent(o)},this.onWheel=function(i){var a=n.createWheelEvent(i);n.dispatchEvent(a),n.freeEvent(a)},this.onClick=function(i){if(n.context.config.useNativeClickEvent){var a=n.createPointerEvent(i);n.dispatchEvent(a),n.freeEvent(a)}},this.onPointerCancel=function(i){var a=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);n.dispatchEvent(a),n.freeEvent(a)},this.globalRuntime=e,this.context=t}return fe(r,[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),n=1,i=1,a=this.context.contextService.getDomElement();if(a&&t){var s=a.offsetWidth,o=a.offsetHeight;s&&o&&(n=t.width/s,i=t.height/o)}return{scaleX:n,scaleY:i,bbox:t}}},{key:"client2Viewport",value:function(t){var n=this.getScale(),i=n.scaleX,a=n.scaleY,s=n.bbox;return new En((t.x-((s==null?void 0:s.left)||0))/i,(t.y-((s==null?void 0:s.top)||0))/a)}},{key:"viewport2Client",value:function(t){var n=this.getScale(),i=n.scaleX,a=n.scaleY,s=n.bbox;return new En((t.x+((s==null?void 0:s.left)||0))*i,(t.y+((s==null?void 0:s.top)||0))*a)}},{key:"viewport2Canvas",value:function(t){var n=t.x,i=t.y,a=this.rootTarget.defaultView,s=a.getCamera(),o=this.context.config,l=o.width,u=o.height,c=s.getPerspectiveInverse(),h=s.getWorldTransform(),d=Ln(this.tmpMatrix,h,c),f=Nn(this.tmpVec3,n/l*2-1,(1-i/u)*2-1,0);return In(f,f,d),new En(f[0],f[1])}},{key:"canvas2Viewport",value:function(t){var n=this.rootTarget.defaultView,i=n.getCamera(),a=i.getPerspective(),s=i.getViewTransform(),o=Ln(this.tmpMatrix,a,s),l=Nn(this.tmpVec3,t.x,t.y,0);In(this.tmpVec3,this.tmpVec3,o);var u=this.context.config,c=u.width,h=u.height;return new En((l[0]+1)/2*c,(1-(l[1]+1)/2)*h)}},{key:"setPickHandler",value:function(t){this.pickHandler=t}},{key:"addEventMapping",value:function(t,n){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:n,priority:0}),this.mappingTable[t].sort(function(i,a){return i.priority-a.priority})}},{key:"mapEvent",value:function(t){if(this.rootTarget){var n=this.mappingTable[t.type];if(n)for(var i=0,a=n.length;i<a;i++)n[i].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type))}}},{key:"dispatchEvent",value:function(t,n,i){if(!i)t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,n);else{t.eventPhase=t.AT_TARGET;var a=this.rootTarget.defaultView||null;t.currentTarget=a,this.notifyListeners(t,n)}}},{key:"propagate",value:function(t,n){if(t.target){var i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var a=i.length-1;a>=1;a--)if(t.currentTarget=i[a],this.notifyTarget(t,n),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,n),!(t.propagationStopped||t.propagationImmediatelyStopped)){var s=i.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var o=s+1;o<i.length;o++)if(t.currentTarget=i[o],this.notifyTarget(t,n),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(t){var n=[t],i=this.rootTarget.defaultView||null;if(i&&i===t)return n.unshift(i.document),n;for(var a=0;a<rF&&t!==this.rootTarget;a++)Rt.isNode(t)&&t.parentNode&&(n.push(t.parentNode),t=t.parentNode);return i&&n.push(i),n}},{key:"hitTest",value:function(t){var n=t.viewportX,i=t.viewportY,a=this.context.config,s=a.width,o=a.height,l=a.disableHitTesting;return n<0||i<0||n>s||i>o?null:!l&&this.pickHandler(t)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(t,n){var i,a=n==null?void 0:n.target;if((i=a)!==null&&i!==void 0&&i.shadowRoot&&(a=n.composedPath()[0]),a){if(a===t)return!0;if(t&&t.contains)return t.contains(a)}return n!=null&&n.composedPath?n.composedPath().indexOf(t)>-1:!1}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var n=0,i=t.nativeEvent.composedPath();n<i.length;n++){var a=i[n],s=this.nativeHTMLMap.get(a);if(s)return s}return null}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY})}},{key:"createPointerEvent",value:function(t,n,i,a){var s=this.allocateEvent(sc);this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t;var o=this.getExistedHTML(s),l=this.context.contextService.getDomElement();return s.target=i??(o||this.isNativeEventFromCanvas(l,s.nativeEvent)&&this.pickTarget(s)||a),typeof n=="string"&&(s.type=n),s}},{key:"createWheelEvent",value:function(t){var n=this.allocateEvent(Am);this.copyWheelData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t;var i=this.getExistedHTML(n),a=this.context.contextService.getDomElement();return n.target=i||this.isNativeEventFromCanvas(a,n.nativeEvent)&&this.pickTarget(n),n}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"cloneWheelEvent",value:function(t){var n=this.allocateEvent(Am);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyWheelData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=t.type,n}},{key:"clonePointerEvent",value:function(t,n){var i=this.allocateEvent(sc);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=n??i.type,i}},{key:"copyPointerData",value:function(t,n){n.pointerId=t.pointerId,n.width=t.width,n.height=t.height,n.isPrimary=t.isPrimary,n.pointerType=t.pointerType,n.pressure=t.pressure,n.tangentialPressure=t.tangentialPressure,n.tiltX=t.tiltX,n.tiltY=t.tiltY,n.twist=t.twist}},{key:"copyMouseData",value:function(t,n){n.altKey=t.altKey,n.button=t.button,n.buttons=t.buttons,n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey,n.client.copyFrom(t.client),n.movement.copyFrom(t.movement),n.canvas.copyFrom(t.canvas),n.screen.copyFrom(t.screen),n.global.copyFrom(t.global),n.offset.copyFrom(t.offset)}},{key:"copyWheelData",value:function(t,n){n.deltaMode=t.deltaMode,n.deltaX=t.deltaX,n.deltaY=t.deltaY,n.deltaZ=t.deltaZ}},{key:"copyData",value:function(t,n){n.isTrusted=t.isTrusted,n.timeStamp=Tm.now(),n.type=t.type,n.detail=t.detail,n.view=t.view,n.page.copyFrom(t.page),n.viewport.copyFrom(t.viewport)}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var n=this.eventPool.get(t).pop()||new t(this);return n.eventPhase=n.NONE,n.currentTarget=null,n.path=[],n.target=null,n}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var n=t.constructor;this.eventPool.has(n)||this.eventPool.set(n,[]),this.eventPool.get(n).push(t)}},{key:"notifyTarget",value:function(t,n){n=n??t.type;var i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(n,"capture"):n;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,n)}},{key:"notifyListeners",value:function(t,n){var i=t.currentTarget.emitter,a=i._events[n];if(a)if("fn"in a)a.once&&i.removeListener(n,a.fn,void 0,!0),a.fn.call(t.currentTarget||a.context,t);else for(var s=0;s<a.length&&!t.propagationImmediatelyStopped;s++)a[s].once&&i.removeListener(n,a[s].fn,void 0,!0),a[s].fn.call(t.currentTarget||a[s].context,t)}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var n=t[t.length-1],i=t.length-2;i>=0;i--){var a=t[i];if(a===this.rootTarget||Rt.isNode(a)&&a.parentNode===n)n=t[i];else break}return n}},{key:"getCursor",value:function(t){for(var n=t;n;){var i=w6(n)&&n.getAttribute("cursor");if(i)return i;n=Rt.isNode(n)&&n.parentNode}}}])}(),N1=function(){function r(){de(this,r)}return fe(r,[{key:"getOrCreateCanvas",value:function(t,n){if(this.canvas)return this.canvas;if(t||ge.offscreenCanvas)this.canvas=t||ge.offscreenCanvas,this.context=this.canvas.getContext("2d",Ge({willReadFrequently:!0},n));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",Ge({willReadFrequently:!0},n)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch{this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",Ge({willReadFrequently:!0},n))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(t,n){return this.context?this.context:(this.getOrCreateCanvas(t,n),this.context)}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch{}try{return document.createElement("canvas")}catch{}return null}}])}(),Ns=function(r){return r[r.CAMERA_CHANGED=0]="CAMERA_CHANGED",r[r.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",r[r.NONE=2]="NONE",r}({}),aF=function(){function r(e,t){de(this,r),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Dn,initAsync:new D6,dirtycheck:new Rd,cull:new Rd,beginFrame:new Dn,beforeRender:new Dn,render:new Dn,afterRender:new Dn,endFrame:new Dn,destroy:new Dn,pick:new F6,pickSync:new Rd,pointerDown:new Dn,pointerUp:new Dn,pointerMove:new Dn,pointerOut:new Dn,pointerOver:new Dn,pointerWheel:new Dn,pointerCancel:new Dn,click:new Dn},this.globalRuntime=e,this.context=t}return fe(r,[{key:"init",value:function(t){var n=this,i=Ge(Ge({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(a){a.apply(i,n.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){n.inited=!0,t()}).catch(function(a){})}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){var t=this.context.config.renderer,n=t.getConfig(),i=n.enableDirtyRectangleRendering;return!i||this.context.renderingContext.renderReasons.has(Ns.CAMERA_CHANGED)}},{key:"render",value:function(t,n,i){var a=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var s=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(s.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),s.renderReasons.size&&this.inited){s.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=s.renderReasons.size===1&&s.renderReasons.has(Ns.CAMERA_CHANGED),l=!t.disableRenderHooks||!(t.disableRenderHooks&&o);l&&this.renderDisplayObject(s.root,t,s),this.hooks.beginFrame.call(n),l&&s.renderListCurrentFrame.forEach(function(u){a.hooks.beforeRender.call(u),a.hooks.render.call(u),a.hooks.afterRender.call(u)}),this.hooks.endFrame.call(n),s.renderListCurrentFrame=[],s.renderReasons.clear(),i()}}},{key:"renderDisplayObject",value:function(t,n,i){var a=this,s=n.renderer.getConfig(),o=s.enableDirtyCheck,l=s.enableCulling;function u(g){var v=g.renderable,p=g.sortable,y=o?v.dirty||i.dirtyRectangleRenderingDisabled?g:null:g;if(y){var m=l?a.hooks.cull.call(y,a.context.camera):y;m&&(a.stats.rendered+=1,i.renderListCurrentFrame.push(m))}v.dirty=!1,p.renderOrder=a.zIndexCounter,a.zIndexCounter+=1,a.stats.total+=1,p.dirty&&(a.sort(g,p),p.dirty=!1,p.dirtyChildren=[],p.dirtyReason=void 0)}for(var c=[t];c.length>0;){var h=c.pop();u(h);for(var d=h.sortable.sorted||h.childNodes,f=d.length-1;f>=0;f--)c.push(d[f])}}},{key:"sort",value:function(t,n){n.sorted&&n.dirtyReason!==ec.Z_INDEX_CHANGED?n.dirtyChildren.forEach(function(i){var a=t.childNodes.indexOf(i);if(a===-1){var s=n.sorted.indexOf(i);s>=0&&n.sorted.splice(s,1)}else if(n.sorted.length===0)n.sorted.push(i);else{var o=x6(n.sorted,i);n.sorted.splice(o,0,i)}}):n.sorted=t.childNodes.slice().sort(MA)}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(Ns.DISPLAY_OBJECT_CHANGED)}}])}(),sF=/\[\s*(.*)=(.*)\s*\]/,oF=function(){function r(){de(this,r)}return fe(r,[{key:"selectOne",value:function(t,n){var i=this;if(t.startsWith("."))return n.find(function(l){return((l==null?void 0:l.classList)||[]).indexOf(i.getIdOrClassname(t))>-1});if(t.startsWith("#"))return n.find(function(l){return l.id===i.getIdOrClassname(t)});if(t.startsWith("[")){var a=this.getAttribute(t),s=a.name,o=a.value;return s?n.find(function(l){return n!==l&&(s==="name"?l.name===o:i.attributeToString(l,s)===o)}):null}return n.find(function(l){return n!==l&&l.nodeName===t})}},{key:"selectAll",value:function(t,n){var i=this;if(t.startsWith("."))return n.findAll(function(l){return n!==l&&((l==null?void 0:l.classList)||[]).indexOf(i.getIdOrClassname(t))>-1});if(t.startsWith("#"))return n.findAll(function(l){return n!==l&&l.id===i.getIdOrClassname(t)});if(t.startsWith("[")){var a=this.getAttribute(t),s=a.name,o=a.value;return s?n.findAll(function(l){return n!==l&&(s==="name"?l.name===o:i.attributeToString(l,s)===o)}):[]}return n.findAll(function(l){return n!==l&&l.nodeName===t})}},{key:"is",value:function(t,n){if(t.startsWith("."))return n.className===this.getIdOrClassname(t);if(t.startsWith("#"))return n.id===this.getIdOrClassname(t);if(t.startsWith("[")){var i=this.getAttribute(t),a=i.name,s=i.value;return a==="name"?n.name===s:this.attributeToString(n,a)===s}return n.nodeName===t}},{key:"getIdOrClassname",value:function(t){return t.substring(1)}},{key:"getAttribute",value:function(t){var n=t.match(sF),i="",a="";return n&&n.length>2&&(i=n[1].replace(/"/g,""),a=n[2].replace(/"/g,"")),{name:i,value:a}}},{key:"attributeToString",value:function(t,n){if(!t.getAttribute)return"";var i=t.getAttribute(n);return Le(i)?"":i.toString?i.toString():""}}])}(),Ke=function(r){return r.ATTR_MODIFIED="DOMAttrModified",r.INSERTED="DOMNodeInserted",r.MOUNTED="DOMNodeInsertedIntoDocument",r.REMOVED="removed",r.UNMOUNTED="DOMNodeRemovedFromDocument",r.REPARENT="reparent",r.DESTROY="destroy",r.BOUNDS_CHANGED="bounds-changed",r.CULLED="culled",r}({}),di=function(r){function e(t,n,i,a,s,o,l,u){var c;return de(this,e),c=We(this,e,[null]),c.relatedNode=n,c.prevValue=i,c.newValue=a,c.attrName=s,c.attrChange=o,c.prevParsedValue=l,c.newParsedValue=u,c.type=t,c}return Ve(e,r),fe(e)}(Nc);di.ADDITION=2;di.MODIFICATION=1;di.REMOVAL=3;function Fw(r){var e=r.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}var lF=new di(Ke.REPARENT,null,"","","",0,"",""),uF=E1(),$l=Qe(),cF=mt(1,1,1),hF=gt(),dF=E1(),ji=Qe(),ps=gt(),qi=on(),fF=Qe(),gF=on(),pF=Qe(),so=Qe(),Sa=Qe(),Gl=gt(),Bw=on(),zw=on(),Wl=on(),Id={affectChildren:!0},vF=function(){function r(e){de(this,r),this.pendingEvents=new Map,this.boundsChangedEvent=new Jt(Ke.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=e}return fe(r,[{key:"matches",value:function(t,n){return this.runtime.sceneGraphSelector.is(t,n)}},{key:"querySelector",value:function(t,n){return this.runtime.sceneGraphSelector.selectOne(t,n)}},{key:"querySelectorAll",value:function(t,n){return this.runtime.sceneGraphSelector.selectAll(t,n)}},{key:"attach",value:function(t,n,i){var a,s=!1;t.parentNode&&(s=t.parentNode!==n,this.detach(t));var o=t.nodeName===re.FRAGMENT,l=ac(n);t.parentNode=n;var u=o?t.childNodes:[t];_e(i)?u.forEach(function(f){n.childNodes.splice(i,0,f),f.parentNode=n}):u.forEach(function(f){n.childNodes.push(f),f.parentNode=n});var c=n,h=c.sortable;if((h!=null&&(a=h.sorted)!==null&&a!==void 0&&a.length||t.parsedStyle.zIndex)&&(h.dirtyChildren.indexOf(t)===-1&&h.dirtyChildren.push(t),h.dirty=!0,h.dirtyReason=ec.ADDED),!l){if(o)this.dirtifyFragment(t);else{var d=t.transformable;d&&this.dirtifyWorld(t,d)}s&&t.dispatchEvent(lF)}}},{key:"detach",value:function(t){if(t.parentNode){var n,i,a=t.transformable,s=t.parentNode,o=s.sortable;(o!=null&&(n=o.sorted)!==null&&n!==void 0&&n.length||(i=t.style)!==null&&i!==void 0&&i.zIndex)&&(o.dirtyChildren.indexOf(t)===-1&&o.dirtyChildren.push(t),o.dirty=!0,o.dirtyReason=ec.REMOVED);var l=t.parentNode.childNodes.indexOf(t);l>-1&&t.parentNode.childNodes.splice(l,1),a&&this.dirtifyWorld(t,a),t.parentNode=null}}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin}},{key:"setOrigin",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=[n,i,a]);var s=t.transformable;if(!(n[0]===s.origin[0]&&n[1]===s.origin[1]&&n[2]===s.origin[2])){var o=s.origin;o[0]=n[0],o[1]=n[1],o[2]=n[2]||0,this.dirtifyLocal(t,s)}}},{key:"rotate",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=mt(n,i,a));var s=t.transformable;if(t.parentNode===null||!t.parentNode.transformable)this.rotateLocal(t,n);else{var o=qi;Rl(o,n[0],n[1],n[2]);var l=this.getRotation(t),u=this.getRotation(t.parentNode);Ll(Wl,u),md(Wl,Wl),aa(o,Wl,o),aa(s.localRotation,o,l),Hu(s.localRotation,s.localRotation),this.dirtifyLocal(t,s)}}},{key:"rotateLocal",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=mt(n,i,a));var s=t.transformable;Rl(zw,n[0],n[1],n[2]),Qb(s.localRotation,s.localRotation,zw),this.dirtifyLocal(t,s)}},{key:"setEulerAngles",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=mt(n,i,a));var s=t.transformable;if(t.parentNode===null||!t.parentNode.transformable)this.setLocalEulerAngles(t,n);else{Rl(s.localRotation,n[0],n[1],n[2]);var o=this.getRotation(t.parentNode);Ll(Bw,md(qi,o)),Qb(s.localRotation,s.localRotation,Bw),this.dirtifyLocal(t,s)}}},{key:"setLocalEulerAngles",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;typeof n=="number"&&(n=mt(n,i,a));var o=t.transformable;Rl(o.localRotation,n[0],n[1],n[2]),s&&this.dirtifyLocal(t,o)}},{key:"translateLocal",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=mt(n,i,a));var s=t.transformable;io(n,$l)||(UL(n,n,s.localRotation),ia(s.localPosition,s.localPosition,n),this.dirtifyLocal(t,s))}},{key:"setPosition",value:function(t,n){var i,a=t.transformable;if(Sa[0]=n[0],Sa[1]=n[1],Sa[2]=(i=n[2])!==null&&i!==void 0?i:0,!io(this.getPosition(t),Sa)){if(oi(a.position,Sa),t.parentNode===null||!t.parentNode.transformable)oi(a.localPosition,Sa);else{var s=t.parentNode.transformable;Ls(Gl,s.worldTransform),si(Gl,Gl),In(a.localPosition,Sa,Gl)}this.dirtifyLocal(t,a)}}},{key:"setLocalPosition",value:function(t,n){var i,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=t.transformable;so[0]=n[0],so[1]=n[1],so[2]=(i=n[2])!==null&&i!==void 0?i:0,!io(s.localPosition,so)&&(oi(s.localPosition,so),a&&this.dirtifyLocal(t,s))}},{key:"scaleLocal",value:function(t,n){var i,a=t.transformable;qL(a.localScale,a.localScale,Nn(ji,n[0],n[1],(i=n[2])!==null&&i!==void 0?i:1)),this.dirtifyLocal(t,a)}},{key:"setLocalScale",value:function(t,n){var i,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=t.transformable;Nn(ji,n[0],n[1],(i=n[2])!==null&&i!==void 0?i:s.localScale[2]),!io(ji,s.localScale)&&(oi(s.localScale,ji),a&&this.dirtifyLocal(t,s))}},{key:"translate",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=Nn(ji,n,i,a)),!io(n,$l)&&(ia(ji,this.getPosition(t),n),this.setPosition(t,ji))}},{key:"setRotation",value:function(t,n,i,a,s){var o=t.transformable;if(typeof n=="number"&&(n=JL(n,i,a,s)),t.parentNode===null||!t.parentNode.transformable)this.setLocalRotation(t,n);else{var l=this.getRotation(t.parentNode);Ll(qi,l),md(qi,qi),aa(o.localRotation,qi,n),Hu(o.localRotation,o.localRotation),this.dirtifyLocal(t,o)}}},{key:"setLocalRotation",value:function(t,n,i,a,s){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;typeof n=="number"&&(n=Jb(qi,n,i,a,s));var l=t.transformable;Ll(l.localRotation,n),o&&this.dirtifyLocal(t,l)}},{key:"setLocalSkew",value:function(t,n,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;typeof n=="number"&&(n=e3(dF,n,i));var s=t.transformable;QL(s.localSkew,n),a&&this.dirtifyLocal(t,s)}},{key:"dirtifyLocal",value:function(t,n){ac(t)||n.localDirtyFlag||(n.localDirtyFlag=!0,n.dirtyFlag||this.dirtifyWorld(t,n))}},{key:"dirtifyWorld",value:function(t,n){n.dirtyFlag||this.unfreezeParentToRoot(t),this.dirtifyWorldInternal(t,n),this.dirtifyToRoot(t,!0)}},{key:"dirtifyFragment",value:function(t){var n=t.transformable;n&&(n.frozen=!1,n.dirtyFlag=!0,n.localDirtyFlag=!0);var i=t.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0);for(var a=t.childNodes.length,s=0;s<a;s++)this.dirtifyFragment(t.childNodes[s]);t.nodeName===re.FRAGMENT&&this.pendingEvents.set(t,!1)}},{key:"triggerPendingEvents",value:function(){var t=this,n=new Set,i=function(s,o){!s.isConnected||n.has(s)||s.nodeName===re.FRAGMENT||(t.boundsChangedEvent.detail=o,t.boundsChangedEvent.target=s,s.isMutationObserved?s.dispatchEvent(t.boundsChangedEvent):s.ownerDocument.defaultView.dispatchEvent(t.boundsChangedEvent,!0),n.add(s))};this.pendingEvents.forEach(function(a,s){s.nodeName!==re.FRAGMENT&&(Id.affectChildren=a,a?s.forEach(function(o){i(o,Id)}):i(s,Id))}),n.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"dirtifyToRoot",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=t;for(i.renderable&&(i.renderable.dirty=!0);i;)Fw(i),i=i.parentNode;n&&t.forEach(function(a){Fw(a)}),this.informDependentDisplayObjects(t),this.pendingEvents.set(t,n)}},{key:"updateDisplayObjectDependency",value:function(t,n,i,a){if(n&&n!==i){var s=this.displayObjectDependencyMap.get(n);if(s&&s[t]){var o=s[t].indexOf(a);s[t].splice(o,1)}}if(i){var l=this.displayObjectDependencyMap.get(i);l||(this.displayObjectDependencyMap.set(i,{}),l=this.displayObjectDependencyMap.get(i)),l[t]||(l[t]=[]),l[t].push(a)}}},{key:"informDependentDisplayObjects",value:function(t){var n=this,i=this.displayObjectDependencyMap.get(t);i&&Object.keys(i).forEach(function(a){i[a].forEach(function(s){n.dirtifyToRoot(s,!0),s.dispatchEvent(new di(Ke.ATTR_MODIFIED,s,n,n,a,di.MODIFICATION,n,n)),s.isCustomElement&&s.isConnected&&s.attributeChangedCallback&&s.attributeChangedCallback(a,n,n)})})}},{key:"getPosition",value:function(t){var n=t.transformable;return Wu(n.position,this.getWorldTransform(t,n))}},{key:"getRotation",value:function(t){var n=t.transformable;return Vu(n.rotation,this.getWorldTransform(t,n))}},{key:"getScale",value:function(t){var n=t.transformable;return Is(n.scaling,this.getWorldTransform(t,n))}},{key:"getWorldTransform",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.transformable;return!n.localDirtyFlag&&!n.dirtyFlag||(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.sync(t,n)),n.worldTransform}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation}},{key:"getLocalScale",value:function(t){return t.transformable.localScale}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew}},{key:"calcLocalTransform",value:function(t){var n=t.localSkew[0]!==0||t.localSkew[1]!==0;if(n){Ao(t.localTransform,t.localRotation,t.localPosition,mt(1,1,1),t.origin),(t.localSkew[0]!==0||t.localSkew[1]!==0)&&(ua(ps),ps[4]=Math.tan(t.localSkew[0]),ps[1]=Math.tan(t.localSkew[1]),Ln(t.localTransform,t.localTransform,ps));var i=Ao(ps,Jb(qi,0,0,0,1),Nn(ji,1,1,1),t.localScale,t.origin);Ln(t.localTransform,t.localTransform,i)}else{var a=t.localTransform,s=t.localPosition,o=t.localRotation,l=t.localScale,u=t.origin,c=s[0]!==0||s[1]!==0||s[2]!==0,h=o[3]!==1||o[0]!==0||o[1]!==0||o[2]!==0,d=l[0]!==1||l[1]!==1||l[2]!==1,f=u[0]!==0||u[1]!==0||u[2]!==0;!h&&!d&&!f?c?Yi(a,s):ua(a):Ao(a,o,s,l,u)}}},{key:"getLocalTransform",value:function(t){var n=t.transformable;return n.localDirtyFlag&&(this.calcLocalTransform(n),n.localDirtyFlag=!1),n.localTransform}},{key:"setLocalTransform",value:function(t,n){var i=Wu(fF,n),a=Vu(gF,n),s=Is(pF,n);this.setLocalScale(t,s,!1),this.setLocalPosition(t,i,!1),this.setLocalRotation(t,a,void 0,void 0,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,cF,!1),this.setLocalPosition(t,$l,!1),this.setLocalEulerAngles(t,$l,void 0,void 0,!1),this.setLocalSkew(t,uF,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"getTransformedGeometryBounds",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2?arguments[2]:void 0,a=this.getGeometryBounds(t,n);if(!pt.isEmpty(a)){var s=i||new pt;return s.setFromTransformedAABB(a,this.getWorldTransform(t)),s}return null}},{key:"getGeometryBounds",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=t,a=i.geometry;a.dirty&&ge.styleValueRegistry.updateGeometry(t);var s=n?a.renderBounds:a.contentBounds||null;return s||new pt}},{key:"getBounds",value:function(t){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=t,s=a.renderable;if(!s.boundsDirty&&!i&&s.bounds)return s.bounds;if(!s.renderBoundsDirty&&i&&s.renderBounds)return s.renderBounds;var o=i?s.renderBounds:s.bounds,l=this.getTransformedGeometryBounds(t,i,o),u=t.childNodes;if(u.forEach(function(d){var f=n.getBounds(d,i);f&&(l?l.add(f):(l=o||new pt,l.update(f.center,f.halfExtents)))}),l||(l=new pt),i){var c=OA(t);if(c){var h=c.parsedStyle.clipPath.getBounds(i);l?h&&(l=h.intersection(l)):l.update(h.center,h.halfExtents)}}return i?(s.renderBounds=l,s.renderBoundsDirty=!1):(s.bounds=l,s.boundsDirty=!1),l}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var n=hF;t.parentNode.transformable&&(n=si(ps,this.getWorldTransform(t.parentNode)));var i=this.getBounds(t);if(!pt.isEmpty(i)){var a=new pt;return a.setFromTransformedAABB(i,n),a}}return this.getBounds(t)}},{key:"getBoundingClientRect",value:function(t){var n,i,a=this.getGeometryBounds(t);pt.isEmpty(a)||(i=new pt,i.setFromTransformedAABB(a,this.getWorldTransform(t)));var s=(n=t.ownerDocument)===null||n===void 0||(n=n.defaultView)===null||n===void 0?void 0:n.getContextService().getBoundingClientRect();if(i){var o=i.getMin(),l=qe(o,2),u=l[0],c=l[1],h=i.getMax(),d=qe(h,2),f=d[0],g=d[1];return new Fs(u+((s==null?void 0:s.left)||0),c+((s==null?void 0:s.top)||0),f-u,g-c)}return new Fs((s==null?void 0:s.left)||0,(s==null?void 0:s.top)||0,0,0)}},{key:"dirtifyWorldInternal",value:function(t,n){var i=this;if(!n.dirtyFlag){n.dirtyFlag=!0,n.frozen=!1,t.childNodes.forEach(function(o){var l=o.transformable;l.dirtyFlag||i.dirtifyWorldInternal(o,l)});var a=t,s=a.renderable;s&&(s.renderBoundsDirty=!0,s.boundsDirty=!0,s.dirty=!0)}}},{key:"syncHierarchy",value:function(t){var n=t.transformable;if(!n.frozen){n.frozen=!0,(n.localDirtyFlag||n.dirtyFlag)&&this.sync(t,n);for(var i=t.childNodes,a=0;a<i.length;a++)this.syncHierarchy(i[a])}}},{key:"sync",value:function(t,n){if(n.localDirtyFlag&&(this.calcLocalTransform(n),n.localDirtyFlag=!1),n.dirtyFlag){var i=t.parentNode,a=i&&i.transformable;i===null||!a?Ls(n.worldTransform,n.localTransform):Ln(n.worldTransform,a.worldTransform,n.localTransform),n.dirtyFlag=!1}}},{key:"unfreezeParentToRoot",value:function(t){for(var n=t.parentNode;n;){var i=n.transformable;i&&(i.frozen=!1),n=n.parentNode}}}])}(),_a={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},jw=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,yF=/[!%),.:;?\]}'""]/,mF=/[$('"]/,bF=/[!),.:;?\]}'""]/,wF=/[([{'"]/,xF=/[)\]'"?!:;,.]/,EF=/[(['"...]/,SF=/[!%),.:;?\]}'"]/,_F=/[$([{'"#]/,MF=new RegExp("".concat(yF.source,"|").concat(bF.source,"|").concat(xF.source,"|").concat(SF.source)),OF=new RegExp("".concat(mF.source,"|").concat(wF.source,"|").concat(EF.source,"|").concat(_F.source)),kF=function(){function r(e){var t=this;de(this,r),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(n,i){return t.isBreakingSpace(i)?!1:!!(n&&(OF.exec(i)||MF.exec(n)))},this.trimByKinsokuShorui=function(n){var i=yt(n),a=i[i.length-2];if(!a)return n;var s=a[a.length-1];return i[i.length-2]=a.slice(0,-1),i[i.length-1]=s+i[i.length-1],i},this.runtime=e}return fe(r,[{key:"measureFont",value:function(t,n){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var i={ascent:0,descent:0,fontSize:0},a=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(n),s=this.runtime.offscreenCanvasCreator.getOrCreateContext(n,{willReadFrequently:!0});s.font=t;var o=_a.MetricsString+_a.BaselineSymbol,l=Math.ceil(s.measureText(o).width),u=Math.ceil(s.measureText(_a.BaselineSymbol).width),c=_a.HeightMultiplier*u;u=u*_a.BaselineMultiplier|0,a.width=l,a.height=c,s.fillStyle="#f00",s.fillRect(0,0,l,c),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(o,0,u);var h=s.getImageData(0,0,l||1,c||1).data,d=h.length,f=l*4,g=0,v=0,p=!1;for(g=0;g<u;++g){for(var y=0;y<f;y+=4)if(h[v+y]!==255){p=!0;break}if(!p)v+=f;else break}for(i.ascent=u-g,v=d-f,p=!1,g=c;g>u;--g){for(var m=0;m<f;m+=4)if(h[v+m]!==255){p=!0;break}if(!p)v-=f;else break}return i.descent=g-u,i.fontSize=i.ascent+i.descent,this.fontMetricsCache[t]=i,i}},{key:"measureText",value:function(t,n,i){var a=n.fontSize,s=a===void 0?16:a,o=n.wordWrap,l=o===void 0?!1:o,u=n.lineHeight,c=n.lineWidth,h=c===void 0?1:c,d=n.textBaseline,f=d===void 0?"alphabetic":d,g=n.textAlign,v=g===void 0?"start":g,p=n.letterSpacing,y=p===void 0?0:p,m=n.textPath;n.textPathSide,n.textPathStartOffset;var w=n.leading,S=w===void 0?0:w,_=j6(n),O=this.measureFont(_,i);O.fontSize===0&&(O.fontSize=s,O.ascent=s);var T=this.runtime.offscreenCanvasCreator.getOrCreateContext(i);T.font=_,n.isOverflowing=!1;var k=l?this.wordWrap(t,n,i):t,P=k.split(/(?:\r\n|\r|\n)/),C=new Array(P.length),N=0;if(m){m.getTotalLength();for(var L=0;L<P.length;L++)T.measureText(P[L]).width+(P[L].length-1)*y}else{for(var F=0;F<P.length;F++){var G=T.measureText(P[F]).width+(P[F].length-1)*y;C[F]=G,N=Math.max(N,G)}var V=N+h,U=u||O.fontSize+h,$=Math.max(U,O.fontSize+h)+(P.length-1)*(U+S);U+=S;var j=0;return f==="middle"?j=-$/2:f==="bottom"||f==="alphabetic"||f==="ideographic"?j=-$:(f==="top"||f==="hanging")&&(j=0),{font:_,width:V,height:$,lines:P,lineWidths:C,lineHeight:U,maxLineWidth:N,fontProperties:O,lineMetrics:C.map(function(Z,ne){var oe=0;return v==="center"||v==="middle"?oe-=Z/2:(v==="right"||v==="end")&&(oe-=Z),new Fs(oe-h/2,j+ne*U,Z+h,U)})}}}},{key:"wordWrap",value:function(t,n,i){var a=this,s=this,o=n.wordWrapWidth,l=o===void 0?0:o,u=n.letterSpacing,c=u===void 0?0:u,h=n.maxLines,d=h===void 0?1/0:h,f=n.textOverflow,g=this.runtime.offscreenCanvasCreator.getOrCreateContext(i),v=l+c,p="";f==="ellipsis"?p="...":f&&f!=="clip"&&(p=f);var y=Array.from(t),m=[],w=0,S=0,_=0,O={},T=function(j){return a.getFromCache(j,c,O,g)},k=T(p);function P($,j,Z,ne){for(;T($)<ne&&j<y.length-1&&!s.isNewline(y[j+1]);)j+=1,$+=y[j];for(;T($)>ne&&j>Z;)j-=1,$=$.slice(0,-1);return{lineTxt:$,txtLastCharIndex:j}}function C($,j){if(!(k<=0||k>v)){if(!m[$]){m[$]=p;return}var Z=P(m[$],j,_+1,v-k);m[$]=Z.lineTxt+p}}for(var N=0;N<y.length;N++){var L=y[N],F=y[N-1],G=y[N+1],V=T(L);if(this.isNewline(L)){if(w+1>=d){n.isOverflowing=!0,N<y.length-1&&C(w,N-1);break}_=N-1,w+=1,S=0,m[w]="";continue}if(S>0&&S+V>v){var U=P(m[w],N-1,_+1,v);if(U.txtLastCharIndex!==N-1){if(m[w]=U.lineTxt,U.txtLastCharIndex===y.length-1)break;N=U.txtLastCharIndex+1,L=y[N],F=y[N-1],G=y[N+1],V=T(L)}if(w+1>=d){n.isOverflowing=!0,C(w,N-1);break}if(_=N-1,w+=1,S=0,m[w]="",this.isBreakingSpace(L))continue;this.canBreakInLastChar(L)||(m=this.trimToBreakable(m),S=this.sumTextWidthByCache(m[w]||"",T)),this.shouldBreakByKinsokuShorui(L,G)&&(m=this.trimByKinsokuShorui(m),S+=T(F||""))}S+=V,m[w]=(m[w]||"")+L}return m.join(`
`)}},{key:"isBreakingSpace",value:function(t){return typeof t!="string"?!1:_a.BreakingSpaces.indexOf(t.charCodeAt(0))>=0}},{key:"isNewline",value:function(t){return typeof t!="string"?!1:_a.Newlines.indexOf(t.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(t){var n=yt(t),i=n[n.length-2],a=this.findBreakableIndex(i);if(a===-1||!i)return n;var s=i.slice(a,a+1),o=this.isBreakingSpace(s),l=a+1,u=a+(o?0:1);return n[n.length-1]+=i.slice(l,i.length),n[n.length-2]=i.slice(0,u),n}},{key:"canBreakInLastChar",value:function(t){return!(t&&jw.test(t))}},{key:"sumTextWidthByCache",value:function(t,n){return t.split("").reduce(function(i,a){return i+n(a)},0)}},{key:"findBreakableIndex",value:function(t){for(var n=t.length-1;n>=0;n--)if(!jw.test(t[n]))return n;return-1}},{key:"getFromCache",value:function(t,n,i,a){var s=i[t];if(typeof s!="number"){var o=t.length*n,l=a.measureText(t);s=l.width+o,i[t]=s}return s}}])}(),ge={},TF=function(r){var e=new Q6,t=new J6;return r={},Me(Me(Me(Me(Me(Me(Me(Me(Me(Me(r,re.FRAGMENT,null),re.CIRCLE,new Y6),re.ELLIPSE,new X6),re.RECT,e),re.IMAGE,e),re.GROUP,new tF),re.LINE,new K6),re.TEXT,new eF(ge)),re.POLYLINE,t),re.POLYGON,t),Me(Me(Me(r,re.PATH,new Z6),re.HTML,new nF),re.MESH,null)}(),AF=function(r){var e=new s6,t=new km;return r={},Me(Me(Me(Me(Me(Me(Me(Me(Me(Me(r,we.PERCENTAGE,null),we.NUMBER,new h6),we.ANGLE,new i6),we.DEFINED_PATH,new a6),we.PAINT,e),we.COLOR,e),we.FILTER,new o6),we.LENGTH,t),we.LENGTH_PERCENTAGE,t),we.LENGTH_PERCENTAGE_12,new l6),Me(Me(Me(Me(Me(Me(Me(Me(Me(Me(r,we.LENGTH_PERCENTAGE_14,new u6),we.COORDINATE,new km),we.OFFSET_DISTANCE,new d6),we.OPACITY_VALUE,new f6),we.PATH,new g6),we.LIST_OF_POINTS,new p6),we.SHADOW_BLUR,new v6),we.TEXT,new y6),we.TEXT_TRANSFORM,new m6),we.TRANSFORM,new V6),Me(Me(Me(r,we.TRANSFORM_ORIGIN,new U6),we.Z_INDEX,new H6),we.MARKER,new c6)}(),PF=function(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}};ge.CameraContribution=sA;ge.AnimationTimeline=null;ge.EasingFunction=null;ge.offscreenCanvasCreator=new N1;ge.sceneGraphSelector=new oF;ge.sceneGraphService=new vF(ge);ge.textService=new kF(ge);ge.geometryUpdaterFactory=TF;ge.CSSPropertySyntaxFactory=AF;ge.styleValueRegistry=new n6(ge);ge.layoutRegistry=null;ge.globalThis=PF();ge.enableStyleSyntax=!0;ge.enableSizeAttenuation=!1;var CF=0,Pm=new di(Ke.INSERTED,null,"","","",0,"",""),Cm=new di(Ke.REMOVED,null,"","","",0,"",""),LA=new Jt(Ke.DESTROY),NF=function(r){function e(){var t;de(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=We(this,e,[].concat(i)),t.entity=CF++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:BI.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t}return Ve(e,r),fe(e,[{key:"className",get:function(){return this.getAttribute("class")||""},set:function(n){this.setAttribute("class",n)}},{key:"classList",get:function(){return this.className.split(" ").filter(function(n){return n!==""})}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n-1]||null}return null}},{key:"cloneNode",value:function(n){throw new Error(st)}},{key:"appendChild",value:function(n,i){var a;if(n.destroyed)throw new Error(kI);return ge.sceneGraphService.attach(n,this,i),(a=this.ownerDocument)!==null&&a!==void 0&&a.defaultView&&(!ac(this)&&n.nodeName===re.FRAGMENT?this.ownerDocument.defaultView.mountFragment(n):this.ownerDocument.defaultView.mountChildren(n)),this.isMutationObserved&&(Pm.relatedNode=this,n.dispatchEvent(Pm)),n}},{key:"insertBefore",value:function(n,i){if(!i)this.appendChild(n);else{n.parentElement&&n.parentElement.removeChild(n);var a=this.childNodes.indexOf(i);a===-1?this.appendChild(n):this.appendChild(n,a)}return n}},{key:"replaceChild",value:function(n,i){var a=this.childNodes.indexOf(i);return this.removeChild(i),this.appendChild(n,a),i}},{key:"removeChild",value:function(n){var i;return Cm.relatedNode=this,n.dispatchEvent(Cm),(i=n.ownerDocument)!==null&&i!==void 0&&i.defaultView&&n.ownerDocument.defaultView.unmountChildren(n),ge.sceneGraphService.detach(n),n}},{key:"removeChildren",value:function(){for(var n=this.childNodes.length-1;n>=0;n--){var i=this.childNodes[n];this.removeChild(i)}}},{key:"destroyChildren",value:function(){for(var n=this.childNodes.length-1;n>=0;n--){var i=this.childNodes[n];i.childNodes.length>0&&i.destroyChildren(),i.destroy()}}},{key:"matches",value:function(n){return ge.sceneGraphService.matches(n,this)}},{key:"getElementById",value:function(n){return ge.sceneGraphService.querySelector("#".concat(n),this)}},{key:"getElementsByName",value:function(n){return ge.sceneGraphService.querySelectorAll('[name="'.concat(n,'"]'),this)}},{key:"getElementsByClassName",value:function(n){return ge.sceneGraphService.querySelectorAll(".".concat(n),this)}},{key:"getElementsByTagName",value:function(n){return ge.sceneGraphService.querySelectorAll(n,this)}},{key:"querySelector",value:function(n){return ge.sceneGraphService.querySelector(n,this)}},{key:"querySelectorAll",value:function(n){return ge.sceneGraphService.querySelectorAll(n,this)}},{key:"closest",value:function(n){var i=this;do{if(ge.sceneGraphService.matches(n,i))return i;i=i.parentElement}while(i!==null);return null}},{key:"find",value:function(n){var i=this,a=null;return this.forEach(function(s){return s!==i&&n(s)?(a=s,!1):!0}),a}},{key:"findAll",value:function(n){var i=this,a=[];return this.forEach(function(s){s!==i&&n(s)&&a.push(s)}),a}},{key:"after",value:function(){var n=this;if(this.parentNode){for(var i=this.parentNode.childNodes.indexOf(this),a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];s.forEach(function(l,u){var c;return(c=n.parentNode)===null||c===void 0?void 0:c.appendChild(l,i+u+1)})}}},{key:"before",value:function(){if(this.parentNode){for(var n,i=this.parentNode.childNodes.indexOf(this),a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];var l=s[0],u=s.slice(1);this.parentNode.appendChild(l,i),(n=l).after.apply(n,yt(u))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var n=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];a.forEach(function(o){return n.appendChild(o)})}},{key:"prepend",value:function(){for(var n=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];a.forEach(function(o,l){return n.appendChild(o,l)})}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){this.destroyChildren(),this.dispatchEvent(LA),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return ge.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return ge.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return ge.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return ge.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return ge.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(n){if(typeof n!="symbol"){var i=this.attributes[n];return i}}},{key:"hasAttribute",value:function(n){return this.getAttributeNames().includes(n)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(n){this.setAttribute(n,null),delete this.attributes[n]}},{key:"setAttribute",value:function(n,i,a,s){this.attributes[n]=i}},{key:"getAttributeNS",value:function(n,i){throw new Error(st)}},{key:"getAttributeNode",value:function(n){throw new Error(st)}},{key:"getAttributeNodeNS",value:function(n,i){throw new Error(st)}},{key:"hasAttributeNS",value:function(n,i){throw new Error(st)}},{key:"removeAttributeNS",value:function(n,i){throw new Error(st)}},{key:"removeAttributeNode",value:function(n){throw new Error(st)}},{key:"setAttributeNS",value:function(n,i,a){throw new Error(st)}},{key:"setAttributeNode",value:function(n){throw new Error(st)}},{key:"setAttributeNodeNS",value:function(n){throw new Error(st)}},{key:"toggleAttribute",value:function(n,i){throw new Error(st)}}])}(Rt);function nt(r){return!!(r!=null&&r.nodeName)}var RF=ge.globalThis.Proxy?ge.globalThis.Proxy:function(){},ii=new di(Ke.ATTR_MODIFIED,null,null,null,null,di.MODIFICATION,null,null),oo=Qe(),LF=on(),wt=function(r){function e(t){var n;return de(this,e),n=We(this,e),n.isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||re.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),ge.enableStyleSyntax&&(n.style=new RF({setProperty:function(a,s){n.setAttribute(a,s)},getPropertyValue:function(a){return n.getAttribute(a)},removeProperty:function(a){n.removeAttribute(a)},item:function(){return""}},{get:function(a,s){return a[s]!==void 0?a[s]:n.getAttribute(s)},set:function(a,s,o){return n.setAttribute(s,o),!0}})),n}return Ve(e,r),fe(e,[{key:"destroy",value:function(){aw(e,"destroy",this)([]),this.getAnimations().forEach(function(n){n.cancel()})}},{key:"cloneNode",value:function(n,i){var a=Ge({},this.attributes);for(var s in a){var o=a[s];nt(o)&&s!=="clipPath"&&s!=="offsetPath"&&s!=="textPath"&&(a[s]=o.cloneNode(n)),i&&(a[s]=i(s,o))}var l=new this.constructor(Ge(Ge({},this.config),{},{style:a}));return l.setLocalTransform(this.getLocalTransform()),n&&this.children.forEach(function(u){if(!u.style.isMarker){var c=u.cloneNode(n);l.appendChild(c)}}),l}},{key:"initAttributes",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i={forceUpdateGeometry:!0};ge.styleValueRegistry.processProperties(this,n,i),this.renderable.dirty=!0}},{key:"setAttribute",value:function(n,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;Be(i)||(a||i!==this.attributes[n])&&(this.internalSetAttribute(n,i,{memoize:s}),aw(e,"setAttribute",this)([n,i]))}},{key:"internalSetAttribute",value:function(n,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=this.renderable,o=this.attributes[n],l=this.parsedStyle[n];ge.styleValueRegistry.processProperties(this,Me({},n,i),a),s.dirty=!0;var u=this.parsedStyle[n];if(this.isConnected&&(ii.relatedNode=this,ii.prevValue=o,ii.newValue=i,ii.attrName=n,ii.prevParsedValue=l,ii.newParsedValue=u,this.isMutationObserved?this.dispatchEvent(ii):(ii.target=this,this.ownerDocument.defaultView.dispatchEvent(ii,!0))),this.isCustomElement&&this.isConnected||!this.isCustomElement){var c,h;(c=(h=this).attributeChangedCallback)===null||c===void 0||c.call(h,n,o,i,l,u)}}},{key:"getBBox",value:function(){var n=this.getBounds(),i=n.getMin(),a=qe(i,2),s=a[0],o=a[1],l=n.getMax(),u=qe(l,2),c=u[0],h=u[1];return new Fs(s,o,c-s,h-o)}},{key:"setOrigin",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ge.sceneGraphService.setOrigin(this,Fn(n,i,a,!1)),this}},{key:"getOrigin",value:function(){return ge.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ge.sceneGraphService.setPosition(this,Fn(n,i,a,!1)),this}},{key:"setLocalPosition",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ge.sceneGraphService.setLocalPosition(this,Fn(n,i,a,!1)),this}},{key:"translate",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ge.sceneGraphService.translate(this,Fn(n,i,a,!1)),this}},{key:"translateLocal",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ge.sceneGraphService.translateLocal(this,Fn(n,i,a,!1)),this}},{key:"getPosition",value:function(){return ge.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return ge.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(n,i,a){return this.scaleLocal(n,i,a)}},{key:"scaleLocal",value:function(n,i,a){return typeof n=="number"&&(i=i||n,a=a||n,n=Fn(n,i,a,!1)),ge.sceneGraphService.scaleLocal(this,n),this}},{key:"setLocalScale",value:function(n,i,a){return typeof n=="number"&&(i=i||n,a=a||n,n=Fn(n,i,a,!1)),ge.sceneGraphService.setLocalScale(this,n),this}},{key:"getLocalScale",value:function(){return ge.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return ge.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){var n=Md(oo,ge.sceneGraphService.getWorldTransform(this)),i=qe(n,3),a=i[2];return Kn(a)}},{key:"getLocalEulerAngles",value:function(){var n=Md(oo,ge.sceneGraphService.getLocalRotation(this)),i=qe(n,3),a=i[2];return Kn(a)}},{key:"setEulerAngles",value:function(n){return ge.sceneGraphService.setEulerAngles(this,0,0,n),this}},{key:"setLocalEulerAngles",value:function(n){return ge.sceneGraphService.setLocalEulerAngles(this,0,0,n),this}},{key:"rotateLocal",value:function(n,i,a){return Le(i)&&Le(a)?ge.sceneGraphService.rotateLocal(this,0,0,n):ge.sceneGraphService.rotateLocal(this,n,i,a),this}},{key:"rotate",value:function(n,i,a){return Le(i)&&Le(a)?ge.sceneGraphService.rotate(this,0,0,n):ge.sceneGraphService.rotate(this,n,i,a),this}},{key:"setRotation",value:function(n,i,a,s){return ge.sceneGraphService.setRotation(this,n,i,a,s),this}},{key:"setLocalRotation",value:function(n,i,a,s){return ge.sceneGraphService.setLocalRotation(this,n,i,a,s),this}},{key:"setLocalSkew",value:function(n,i){return ge.sceneGraphService.setLocalSkew(this,n,i),this}},{key:"getRotation",value:function(){return ge.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return ge.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return ge.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return ge.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return ge.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(n){return ge.sceneGraphService.setLocalTransform(this,n),this}},{key:"resetLocalTransform",value:function(){ge.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(n,i){var a,s=(a=this.ownerDocument)===null||a===void 0?void 0:a.timeline;return s?s.play(this,n,i):null}},{key:"isVisible",value:function(){var n;return((n=this.parsedStyle)===null||n===void 0?void 0:n.visibility)!=="hidden"}},{key:"interactive",get:function(){return this.isInteractive()},set:function(n){this.style.pointerEvents=n?"auto":"none"}},{key:"isInteractive",value:function(){var n;return((n=this.parsedStyle)===null||n===void 0?void 0:n.pointerEvents)!=="none"}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,yt(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,yt(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var n=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var o=a[0],l=a[1];return o?Yt(o)?(Object.keys(o).forEach(function(u){n.setAttribute(u,o[u])}),this):a.length===2?(this.setAttribute(o,l),this):this.attributes[o]:this.attributes}},{key:"getMatrix",value:function(n){var i=n||this.getWorldTransform(),a=Wu(oo,i),s=qe(a,2),o=s[0],l=s[1],u=Is(oo,i),c=qe(u,2),h=c[0],d=c[1],f=Vu(LF,i),g=Md(oo,f),v=qe(g,3),p=v[0],y=v[2];return RI(p||y,o,l,h,d)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(n){var i=hw(n),a=qe(i,5),s=a[0],o=a[1],l=a[2],u=a[3],c=a[4];this.setEulerAngles(c).setPosition(s,o).setLocalScale(l,u)}},{key:"setLocalMatrix",value:function(n){var i=hw(n),a=qe(i,5),s=a[0],o=a[1],l=a[2],u=a[3],c=a[4];this.setLocalEulerAngles(c).setLocalPosition(s,o).setLocalScale(l,u)}},{key:"show",value:function(){this.forEach(function(n){n.style.visibility="visible"})}},{key:"hide",value:function(){this.forEach(function(n){n.style.visibility="hidden"})}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(n){return this.children[n]||null}},{key:"add",value:function(n,i){return this.appendChild(n,i)}},{key:"set",value:function(n,i){this.config[n]=i}},{key:"get",value:function(n){return this.config[n]}},{key:"moveTo",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(n,i,a),this}},{key:"move",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(n,i,a),this}},{key:"setZIndex",value:function(n){return this.style.zIndex=n,this}}])}(NF);wt.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var Fi=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return de(this,e),We(this,e,[Ge({type:re.CIRCLE},t)])}return Ve(e,r),fe(e)}(wt);Fi.PARSED_STYLE_LIST=new Set([].concat(yt(wt.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var IF=["style"],R1=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=Ja(n,IF);return de(this,e),t=We(this,e,[Ge({style:i},a)]),t.isCustomElement=!0,t}return Ve(e,r),fe(e)}(wt);R1.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var ol=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return de(this,e),We(this,e,[Ge({type:re.ELLIPSE},t)])}return Ve(e,r),fe(e)}(wt);ol.PARSED_STYLE_LIST=new Set([].concat(yt(wt.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"]));var DF=function(r){function e(){return de(this,e),We(this,e,[{type:re.FRAGMENT}])}return Ve(e,r),fe(e)}(wt);DF.PARSED_STYLE_LIST=new Set(["class","className"]);var hn=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return de(this,e),We(this,e,[Ge({type:re.GROUP},t)])}return Ve(e,r),fe(e)}(wt);hn.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var FF=["style"],ll=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=Ja(n,FF);return de(this,e),t=We(this,e,[Ge({type:re.HTML,style:i},a)]),t.cullable.enable=!1,t}return Ve(e,r),fe(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var n=si(gt(),this.parentNode.getWorldTransform()),i=this.getBounds();if(!pt.isEmpty(i)){var a=new pt;return a.setFromTransformedAABB(i,n),a}}return this.getBounds()}}])}(wt);ll.PARSED_STYLE_LIST=new Set([].concat(yt(wt.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var ul=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return de(this,e),We(this,e,[Ge({type:re.IMAGE},t)])}return Ve(e,r),fe(e)}(wt);ul.PARSED_STYLE_LIST=new Set([].concat(yt(wt.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var BF=["style"],Ua=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=Ja(n,BF);de(this,e),t=We(this,e,[Ge({type:re.LINE,style:Ge({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},a)]),t.markerStartAngle=0,t.markerEndAngle=0;var s=t.parsedStyle,o=s.markerStart,l=s.markerEnd;return o&&nt(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&nt(l)&&(t.markerEndAngle=l.getLocalEulerAngles(),t.appendChild(l)),t.transformMarker(!0),t.transformMarker(!1),t}return Ve(e,r),fe(e,[{key:"attributeChangedCallback",value:function(n,i,a,s,o){n==="x1"||n==="y1"||n==="x2"||n==="y2"||n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&nt(s)&&(this.markerStartAngle=0,s.remove()),o&&nt(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):n==="markerEnd"&&(s&&nt(s)&&(this.markerEndAngle=0,s.remove()),o&&nt(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1)))}},{key:"transformMarker",value:function(n){var i=this.parsedStyle,a=i.markerStart,s=i.markerEnd,o=i.markerStartOffset,l=i.markerEndOffset,u=i.x1,c=i.x2,h=i.y1,d=i.y2,f=n?a:s;if(!(!f||!nt(f))){var g=0,v,p,y,m,w,S;n?(y=u,m=h,v=c-u,p=d-h,w=o||0,S=this.markerStartAngle):(y=c,m=d,v=u-c,p=h-d,w=l||0,S=this.markerEndAngle),g=Math.atan2(p,v),f.setLocalEulerAngles(g*180/Math.PI+S),f.setLocalPosition(y+Math.cos(g)*w,m+Math.sin(g)*w)}}},{key:"getPoint",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle,s=a.x1,o=a.y1,l=a.x2,u=a.y2,c=rA(s,o,l,u,n),h=c.x,d=c.y,f=In(Qe(),mt(h,d,0),i?this.getWorldTransform():this.getLocalTransform());return new En(f[0],f[1])}},{key:"getPointAtLength",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(n/this.getTotalLength(),i)}},{key:"getTotalLength",value:function(){var n=this.parsedStyle,i=n.x1,a=n.y1,s=n.x2,o=n.y2;return nA(i,a,s,o)}}])}(wt);Ua.PARSED_STYLE_LIST=new Set([].concat(yt(wt.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var zF=["style"],ur=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=Ja(n,zF);de(this,e),t=We(this,e,[Ge({type:re.PATH,style:i,initialParsedStyle:{miterLimit:4,d:Ge({},oA)}},a)]),t.markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var s=t.parsedStyle,o=s.markerStart,l=s.markerEnd,u=s.markerMid;return o&&nt(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),u&&nt(u)&&t.placeMarkerMid(u),l&&nt(l)&&(t.markerEndAngle=l.getLocalEulerAngles(),t.appendChild(l)),t.transformMarker(!0),t.transformMarker(!1),t}return Ve(e,r),fe(e,[{key:"attributeChangedCallback",value:function(n,i,a,s,o){n==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&nt(s)&&(this.markerStartAngle=0,s.remove()),o&&nt(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):n==="markerEnd"?(s&&nt(s)&&(this.markerEndAngle=0,s.remove()),o&&nt(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(o)}},{key:"transformMarker",value:function(n){var i=this.parsedStyle,a=i.markerStart,s=i.markerEnd,o=i.markerStartOffset,l=i.markerEndOffset,u=n?a:s;if(!(!u||!nt(u))){var c=0,h,d,f,g,v,p;if(n){var y=this.getStartTangent(),m=qe(y,2),w=m[0],S=m[1];f=S[0],g=S[1],h=w[0]-S[0],d=w[1]-S[1],v=o||0,p=this.markerStartAngle}else{var _=this.getEndTangent(),O=qe(_,2),T=O[0],k=O[1];f=k[0],g=k[1],h=T[0]-k[0],d=T[1]-k[1],v=l||0,p=this.markerEndAngle}c=Math.atan2(d,h),u.setLocalEulerAngles(c*180/Math.PI+p),u.setLocalPosition(f+Math.cos(c)*v,g+Math.sin(c)*v)}}},{key:"placeMarkerMid",value:function(n){var i=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(c){c.remove()}),n&&nt(n))for(var a=1;a<i.length-1;a++){var s=qe(i[a].currentPoint,2),o=s[0],l=s[1],u=a===1?n:n.cloneNode(!0);this.markerMidList.push(u),this.appendChild(u),u.setLocalPosition(o,l)}}},{key:"getTotalLength",value:function(){return Mm(this)}},{key:"getPointAtLength",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle.d.absolutePath,s=nI(a,n),o=s.x,l=s.y,u=In(Qe(),mt(o,l,0),i?this.getWorldTransform():this.getLocalTransform());return new En(u[0],u[1])}},{key:"getPoint",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPointAtLength(n*Mm(this),i)}},{key:"getStartTangent",value:function(){var n=this.parsedStyle.d.segments,i=[];if(n.length>1){var a=n[0].currentPoint,s=n[1].currentPoint,o=n[1].startTangent;i=[],o?(i.push([a[0]-o[0],a[1]-o[1]]),i.push([a[0],a[1]])):(i.push([s[0],s[1]]),i.push([a[0],a[1]]))}return i}},{key:"getEndTangent",value:function(){var n=this.parsedStyle.d.segments,i=n.length,a=[];if(i>1){var s=n[i-2].currentPoint,o=n[i-1].currentPoint,l=n[i-1].endTangent;a=[],l?(a.push([o[0]-l[0],o[1]-l[1]]),a.push([o[0],o[1]])):(a.push([s[0],s[1]]),a.push([o[0],o[1]]))}return a}}])}(wt);ur.PARSED_STYLE_LIST=new Set([].concat(yt(wt.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var jF=["style"],es=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=Ja(n,jF);de(this,e),t=We(this,e,[Ge({type:re.POLYGON,style:i,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a)]),t.markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var s=t.parsedStyle,o=s.markerStart,l=s.markerEnd,u=s.markerMid;return o&&nt(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),u&&nt(u)&&t.placeMarkerMid(u),l&&nt(l)&&(t.markerEndAngle=l.getLocalEulerAngles(),t.appendChild(l)),t.transformMarker(!0),t.transformMarker(!1),t}return Ve(e,r),fe(e,[{key:"attributeChangedCallback",value:function(n,i,a,s,o){n==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&nt(s)&&(this.markerStartAngle=0,s.remove()),o&&nt(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):n==="markerEnd"?(s&&nt(s)&&(this.markerEndAngle=0,s.remove()),o&&nt(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(o)}},{key:"transformMarker",value:function(n){var i=this.parsedStyle,a=i.markerStart,s=i.markerEnd,o=i.markerStartOffset,l=i.markerEndOffset,u=i.points,c=u||{},h=c.points,d=n?a:s;if(!(!d||!nt(d)||!h)){var f=0,g,v,p,y,m,w;if(p=h[0][0],y=h[0][1],n)g=h[1][0]-h[0][0],v=h[1][1]-h[0][1],m=o||0,w=this.markerStartAngle;else{var S=h.length;this.parsedStyle.isClosed?(g=h[S-1][0]-h[0][0],v=h[S-1][1]-h[0][1]):(p=h[S-1][0],y=h[S-1][1],g=h[S-2][0]-h[S-1][0],v=h[S-2][1]-h[S-1][1]),m=l||0,w=this.markerEndAngle}f=Math.atan2(v,g),d.setLocalEulerAngles(f*180/Math.PI+w),d.setLocalPosition(p+Math.cos(f)*m,y+Math.sin(f)*m)}}},{key:"placeMarkerMid",value:function(n){var i=this.parsedStyle.points,a=i||{},s=a.points;if(this.markerMidList.forEach(function(h){h.remove()}),this.markerMidList=[],n&&nt(n)&&s)for(var o=1;o<(this.parsedStyle.isClosed?s.length:s.length-1);o++){var l=s[o][0],u=s[o][1],c=o===1?n:n.cloneNode(!0);this.markerMidList.push(c),this.appendChild(c),c.setLocalPosition(l,u)}}}])}(wt);es.PARSED_STYLE_LIST=new Set([].concat(yt(wt.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var qF=["style"],Rc=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.style,i=Ja(t,qF);return de(this,e),We(this,e,[Ge({type:re.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i)])}return Ve(e,r),fe(e,[{key:"getTotalLength",value:function(){return RD(this)}},{key:"getPointAtLength",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(n/this.getTotalLength(),i)}},{key:"getPoint",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var s=[],o=0,l,u,c=this.getTotalLength();a.forEach(function(y,m){a[m+1]&&(l=[0,0],l[0]=o/c,u=nA(y[0],y[1],a[m+1][0],a[m+1][1]),o+=u,l[1]=o/c,s.push(l))}),this.parsedStyle.points.segments=s}var h=0,d=0;this.parsedStyle.points.segments.forEach(function(y,m){n>=y[0]&&n<=y[1]&&(h=(n-y[0])/(y[1]-y[0]),d=m)});var f=rA(a[d][0],a[d][1],a[d+1][0],a[d+1][1],h),g=f.x,v=f.y,p=In(Qe(),mt(g,v,0),i?this.getWorldTransform():this.getLocalTransform());return new En(p[0],p[1])}},{key:"getStartTangent",value:function(){var n=this.parsedStyle.points.points,i=[];return i.push([n[1][0],n[1][1]]),i.push([n[0][0],n[0][1]]),i}},{key:"getEndTangent",value:function(){var n=this.parsedStyle.points.points,i=n.length-1,a=[];return a.push([n[i-1][0],n[i-1][1]]),a.push([n[i][0],n[i][1]]),a}}])}(es);Rc.PARSED_STYLE_LIST=new Set([].concat(yt(es.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var Mn=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return de(this,e),We(this,e,[Ge({type:re.RECT},t)])}return Ve(e,r),fe(e)}(wt);Mn.PARSED_STYLE_LIST=new Set([].concat(yt(wt.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var $F=["style"],ts=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.style,i=Ja(t,$F);return de(this,e),We(this,e,[Ge({type:re.TEXT,style:Ge({fill:"black"},n)},i)])}return Ve(e,r),fe(e,[{key:"getComputedTextLength",value:function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(wt);ts.PARSED_STYLE_LIST=new Set([].concat(yt(wt.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var GF=function(){function r(){de(this,r),this.registry={},this.define(re.CIRCLE,Fi),this.define(re.ELLIPSE,ol),this.define(re.RECT,Mn),this.define(re.IMAGE,ul),this.define(re.LINE,Ua),this.define(re.GROUP,hn),this.define(re.PATH,ur),this.define(re.POLYGON,es),this.define(re.POLYLINE,Rc),this.define(re.TEXT,ts),this.define(re.HTML,ll)}return fe(r,[{key:"define",value:function(t,n){this.registry[t]=n}},{key:"get",value:function(t){return this.registry[t]}}])}(),IA=function(r){function e(){var t;de(this,e),t=We(this,e),t.defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new ge.AnimationTimeline(t)}catch{}var n={};return A1.forEach(function(i){var a=i.n,s=i.inh,o=i.d;s&&o&&(n[a]=Te(o)?o(re.GROUP):o)}),t.documentElement=new hn({id:"g-root",style:n}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return Ve(e,r),fe(e,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(n,i){if(n==="svg")return this.documentElement;var a=this.defaultView.customElements.get(n);a||(console.warn("Unsupported tagName: ",n),a=n==="tspan"?ts:hn);var s=new a(i);return s.ownerDocument=this,s}},{key:"createElementNS",value:function(n,i,a){return this.createElement(i,a)}},{key:"cloneNode",value:function(n){throw new Error(st)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch{}}},{key:"elementsFromBBox",value:function(n,i,a,s){var o=this.defaultView.context.rBushRoot,l=o.search({minX:n,minY:i,maxX:a,maxY:s}),u=[];return l.forEach(function(c){var h=c.displayObject,d=h.parsedStyle.pointerEvents,f=d===void 0?"auto":d,g=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(f);(!g||g&&h.isVisible())&&!h.isCulled()&&h.isInteractive()&&u.push(h)}),u.sort(function(c,h){return h.sortable.renderOrder-c.sortable.renderOrder}),u}},{key:"elementFromPointSync",value:function(n,i){var a=this.defaultView.canvas2Viewport({x:n,y:i}),s=a.x,o=a.y,l=this.defaultView.getConfig(),u=l.width,c=l.height;if(s<0||o<0||s>u||o>c)return null;var h=this.defaultView.viewport2Client({x:s,y:o}),d=h.x,f=h.y,g=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:n,y:i,viewportX:s,viewportY:o,clientX:d,clientY:f},picked:[]}),v=g.picked;return v&&v[0]||this.documentElement}},{key:"elementFromPoint",value:function(){var t=ha(_n().mark(function i(a,s){var o,l,u,c,h,d,f,g,v,p,y;return _n().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(o=this.defaultView.canvas2Viewport({x:a,y:s}),l=o.x,u=o.y,c=this.defaultView.getConfig(),h=c.width,d=c.height,!(l<0||u<0||l>h||u>d)){w.next=4;break}return w.abrupt("return",null);case 4:return f=this.defaultView.viewport2Client({x:l,y:u}),g=f.x,v=f.y,w.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:a,y:s,viewportX:l,viewportY:u,clientX:g,clientY:v},picked:[]});case 7:return p=w.sent,y=p.picked,w.abrupt("return",y&&y[0]||this.documentElement);case 10:case"end":return w.stop()}},i,this)}));function n(i,a){return t.apply(this,arguments)}return n}()},{key:"elementsFromPointSync",value:function(n,i){var a=this.defaultView.canvas2Viewport({x:n,y:i}),s=a.x,o=a.y,l=this.defaultView.getConfig(),u=l.width,c=l.height;if(s<0||o<0||s>u||o>c)return[];var h=this.defaultView.viewport2Client({x:s,y:o}),d=h.x,f=h.y,g=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:n,y:i,viewportX:s,viewportY:o,clientX:d,clientY:f},picked:[]}),v=g.picked;return v[v.length-1]!==this.documentElement&&v.push(this.documentElement),v}},{key:"elementsFromPoint",value:function(){var t=ha(_n().mark(function i(a,s){var o,l,u,c,h,d,f,g,v,p,y;return _n().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(o=this.defaultView.canvas2Viewport({x:a,y:s}),l=o.x,u=o.y,c=this.defaultView.getConfig(),h=c.width,d=c.height,!(l<0||u<0||l>h||u>d)){w.next=4;break}return w.abrupt("return",[]);case 4:return f=this.defaultView.viewport2Client({x:l,y:u}),g=f.x,v=f.y,w.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:a,y:s,viewportX:l,viewportY:u,clientX:g,clientY:v},picked:[]});case 7:return p=w.sent,y=p.picked,y[y.length-1]!==this.documentElement&&y.push(this.documentElement),w.abrupt("return",y);case 11:case"end":return w.stop()}},i,this)}));function n(i,a){return t.apply(this,arguments)}return n}()},{key:"appendChild",value:function(n,i){throw new Error(gs)}},{key:"insertBefore",value:function(n,i){throw new Error(gs)}},{key:"removeChild",value:function(n,i){throw new Error(gs)}},{key:"replaceChild",value:function(n,i,a){throw new Error(gs)}},{key:"append",value:function(){throw new Error(gs)}},{key:"prepend",value:function(){throw new Error(gs)}},{key:"getElementById",value:function(n){return this.documentElement.getElementById(n)}},{key:"getElementsByName",value:function(n){return this.documentElement.getElementsByName(n)}},{key:"getElementsByTagName",value:function(n){return this.documentElement.getElementsByTagName(n)}},{key:"getElementsByClassName",value:function(n){return this.documentElement.getElementsByClassName(n)}},{key:"querySelector",value:function(n){return this.documentElement.querySelector(n)}},{key:"querySelectorAll",value:function(n){return this.documentElement.querySelectorAll(n)}},{key:"find",value:function(n){return this.documentElement.find(n)}},{key:"findAll",value:function(n){return this.documentElement.findAll(n)}}])}(Rt),DA=function(){function r(e){de(this,r),this.strategies=e}return fe(r,[{key:"apply",value:function(t){var n=t.camera,i=t.renderingService,a=t.renderingContext,s=this.strategies;i.hooks.cull.tap(r.tag,function(o){if(o){var l=o.cullable;return s.length===0?l.visible=a.unculledEntities.indexOf(o.entity)>-1:l.visible=s.every(function(u){return u.isVisible(n,o)}),!o.isCulled()&&o.isVisible()?o:(o.dispatchEvent(new Jt(Ke.CULLED)),null)}return o}),i.hooks.afterRender.tap(r.tag,function(o){o.cullable.visibilityPlaneMask=-1})}}])}();DA.tag="Culling";var FA=function(){function r(){var e=this;de(this,r),this.autoPreventDefault=!1,this.rootPointerEvent=new sc(null),this.rootWheelEvent=new Am(null),this.onPointerMove=function(t){var n,i=(n=e.context.renderingContext.root)===null||n===void 0||(n=n.ownerDocument)===null||n===void 0?void 0:n.defaultView;if(!(i.supportsTouchEvents&&t.pointerType==="touch")){var a=e.normalizeToPointerEvent(t,i),s=Aa(a),o;try{for(s.s();!(o=s.n()).done;){var l=o.value,u=e.bootstrapEvent(e.rootPointerEvent,l,i,t);e.context.eventService.mapEvent(u)}}catch(c){s.e(c)}finally{s.f()}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var n,i=(n=e.context.renderingContext.root)===null||n===void 0||(n=n.ownerDocument)===null||n===void 0?void 0:n.defaultView,a=e.normalizeToPointerEvent(t,i),s=Aa(a),o;try{for(s.s();!(o=s.n()).done;){var l=o.value,u=e.bootstrapEvent(e.rootPointerEvent,l,i,t);e.context.eventService.mapEvent(u)}}catch(c){s.e(c)}finally{s.f()}e.setCursor(e.context.eventService.cursor)}}return fe(r,[{key:"apply",value:function(t){var n=this;this.context=t;var i=t.renderingService,a=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(s){var o=n.context.renderingService.hooks.pickSync.call({position:s,picked:[],topmost:!0}),l=o.picked;return l[0]||null}),i.hooks.pointerWheel.tap(r.tag,function(s){var o=n.normalizeWheelEvent(s);n.context.eventService.mapEvent(o)}),i.hooks.pointerDown.tap(r.tag,function(s){if(!(a.supportsTouchEvents&&s.pointerType==="touch")){var o=n.normalizeToPointerEvent(s,a);if(n.autoPreventDefault&&o[0].isNormalized){var l=s.cancelable||!("cancelable"in s);l&&s.preventDefault()}var u=Aa(o),c;try{for(u.s();!(c=u.n()).done;){var h=c.value,d=n.bootstrapEvent(n.rootPointerEvent,h,a,s);n.context.eventService.mapEvent(d)}}catch(f){u.e(f)}finally{u.f()}n.setCursor(n.context.eventService.cursor)}}),i.hooks.pointerUp.tap(r.tag,function(s){if(!(a.supportsTouchEvents&&s.pointerType==="touch")){var o=n.context.contextService.getDomElement(),l=n.context.eventService.isNativeEventFromCanvas(o,s),u=l?"":"outside",c=n.normalizeToPointerEvent(s,a),h=Aa(c),d;try{for(h.s();!(d=h.n()).done;){var f=d.value,g=n.bootstrapEvent(n.rootPointerEvent,f,a,s);g.type+=u,n.context.eventService.mapEvent(g)}}catch(v){h.e(v)}finally{h.f()}n.setCursor(n.context.eventService.cursor)}}),i.hooks.pointerMove.tap(r.tag,this.onPointerMove),i.hooks.pointerOver.tap(r.tag,this.onPointerMove),i.hooks.pointerOut.tap(r.tag,this.onPointerMove),i.hooks.click.tap(r.tag,this.onClick),i.hooks.pointerCancel.tap(r.tag,function(s){var o=n.normalizeToPointerEvent(s,a),l=Aa(o),u;try{for(l.s();!(u=l.n()).done;){var c=u.value,h=n.bootstrapEvent(n.rootPointerEvent,c,a,s);n.context.eventService.mapEvent(h)}}catch(d){l.e(d)}finally{l.f()}n.setCursor(n.context.eventService.cursor)})}},{key:"bootstrapEvent",value:function(t,n,i,a){t.view=i,t.originalEvent=null,t.nativeEvent=a,t.pointerId=n.pointerId,t.width=n.width,t.height=n.height,t.isPrimary=n.isPrimary,t.pointerType=n.pointerType,t.pressure=n.pressure,t.tangentialPressure=n.tangentialPressure,t.tiltX=n.tiltX,t.tiltY=n.tiltY,t.twist=n.twist,this.transferMouseData(t,n);var s=this.context.eventService.client2Viewport({x:n.clientX,y:n.clientY}),o=s.x,l=s.y;t.viewport.x=o,t.viewport.y=l;var u=this.context.eventService.viewport2Canvas(t.viewport),c=u.x,h=u.y;return t.canvas.x=c,t.canvas.y=h,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=a.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=O6[t.type]||t.type),t}},{key:"normalizeWheelEvent",value:function(t){var n=this.rootWheelEvent;this.transferMouseData(n,t),n.deltaMode=t.deltaMode,n.deltaX=t.deltaX,n.deltaY=t.deltaY,n.deltaZ=t.deltaZ;var i=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),a=i.x,s=i.y;n.viewport.x=a,n.viewport.y=s;var o=this.context.eventService.viewport2Canvas(n.viewport),l=o.x,u=o.y;return n.canvas.x=l,n.canvas.y=u,n.global.copyFrom(n.canvas),n.offset.copyFrom(n.canvas),n.nativeEvent=t,n.type=t.type,n}},{key:"transferMouseData",value:function(t,n){t.isTrusted=n.isTrusted,t.srcElement=n.srcElement,t.timeStamp=Tm.now(),t.type=n.type,t.altKey=n.altKey,t.metaKey=n.metaKey,t.shiftKey=n.shiftKey,t.ctrlKey=n.ctrlKey,t.button=n.button,t.buttons=n.buttons,t.client.x=n.clientX,t.client.y=n.clientY,t.movement.x=n.movementX,t.movement.y=n.movementY,t.page.x=n.pageX,t.page.y=n.pageY,t.screen.x=n.screenX,t.screen.y=n.screenY,t.relatedTarget=null}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(t,n){var i=[];if(n.isTouchEvent(t))for(var a=0;a<t.changedTouches.length;a++){var s=t.changedTouches[a];Be(s.button)&&(s.button=0),Be(s.buttons)&&(s.buttons=1),Be(s.isPrimary)&&(s.isPrimary=t.touches.length===1&&t.type==="touchstart"),Be(s.width)&&(s.width=s.radiusX||1),Be(s.height)&&(s.height=s.radiusY||1),Be(s.tiltX)&&(s.tiltX=0),Be(s.tiltY)&&(s.tiltY=0),Be(s.pointerType)&&(s.pointerType="touch"),Be(s.pointerId)&&(s.pointerId=s.identifier||0),Be(s.pressure)&&(s.pressure=s.force||.5),Be(s.twist)&&(s.twist=0),Be(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,s.type=t.type,i.push(s)}else if(n.isMouseEvent(t)){var o=t;Be(o.isPrimary)&&(o.isPrimary=!0),Be(o.width)&&(o.width=1),Be(o.height)&&(o.height=1),Be(o.tiltX)&&(o.tiltX=0),Be(o.tiltY)&&(o.tiltY=0),Be(o.pointerType)&&(o.pointerType="mouse"),Be(o.pointerId)&&(o.pointerId=M6),Be(o.pressure)&&(o.pressure=.5),Be(o.twist)&&(o.twist=0),Be(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,i.push(o)}else i.push(t);return i}}])}();FA.tag="Event";var WF=[re.CIRCLE,re.ELLIPSE,re.IMAGE,re.RECT,re.LINE,re.POLYLINE,re.POLYGON,re.TEXT,re.PATH,re.HTML],VF=function(){function r(){de(this,r)}return fe(r,[{key:"isVisible",value:function(t,n){var i,a=n.cullable;if(!a.enable)return!0;var s=n.getRenderBounds();if(pt.isEmpty(s))return!1;var o=t.getFrustum(),l=(i=n.parentNode)===null||i===void 0||(i=i.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(n,s,l||fs.INDETERMINATE,o.planes),a.visible=a.visibilityPlaneMask!==fs.OUTSIDE,a.visible}},{key:"computeVisibilityWithPlaneMask",value:function(t,n,i,a){if(i===fs.OUTSIDE||i===fs.INSIDE)return i;for(var s=fs.INSIDE,o=WF.indexOf(t.nodeName)>-1,l=0,u=a.length;l<u;++l){var c=1<<l;if((i&c)!==0&&!(o&&(l===4||l===5))){var h=a[l],d=h.normal,f=h.distance;if(li(d,n.getPositiveFarPoint(a[l]))+f<0)return fs.OUTSIDE;li(d,n.getNegativeFarPoint(a[l]))+f<0&&(s|=c)}}return s}}])}(),BA=function(){function r(){de(this,r),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return fe(r,[{key:"apply",value:function(t){var n=this,i,a=t.renderingService,s=t.renderingContext,o=t.rBushRoot,l=s.root.ownerDocument.defaultView;this.rBush=o;var u=function(v){var p=v.target;p.renderable.dirty=!0,a.dirtify()},c=function(v){n.syncTasks.set(v.target,v.detail.affectChildren),a.dirtify()},h=function(v){var p=v.target;ge.enableSizeAttenuation&&ge.styleValueRegistry.updateSizeAttenuation(p,l.getCamera().getZoom())},d=function(v){var p=v.target,y=p.rBushNode;y.aabb&&n.rBush.remove(y.aabb),n.syncTasks.delete(p),ge.sceneGraphService.dirtifyToRoot(p),a.dirtify()};a.hooks.init.tap(r.tag,function(){l.addEventListener(Ke.MOUNTED,h),l.addEventListener(Ke.UNMOUNTED,d),l.addEventListener(Ke.ATTR_MODIFIED,u),l.addEventListener(Ke.BOUNDS_CHANGED,c)}),a.hooks.destroy.tap(r.tag,function(){l.removeEventListener(Ke.MOUNTED,h),l.removeEventListener(Ke.UNMOUNTED,d),l.removeEventListener(Ke.ATTR_MODIFIED,u),l.removeEventListener(Ke.BOUNDS_CHANGED,c),n.syncTasks.clear()});var f=(i=ge.globalThis.requestIdleCallback)!==null&&i!==void 0?i:C1.bind(ge.globalThis);a.hooks.endFrame.tap(r.tag,function(){n.isFirstTimeRendering?(n.isFirstTimeRendering=!1,n.syncing=!0,f(function(){n.syncRTree(!0),n.isFirstTimeRenderingFinished=!0})):n.syncRTree()})}},{key:"syncNode",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.isConnected){var i=t.rBushNode;i.aabb&&this.rBush.remove(i.aabb);var a=t.getRenderBounds();if(a){var s=t.renderable;n&&(s.dirtyRenderBounds||(s.dirtyRenderBounds=new pt),s.dirtyRenderBounds.update(a.center,a.halfExtents));var o=a.getMin(),l=qe(o,2),u=l[0],c=l[1],h=a.getMax(),d=qe(h,2),f=d[0],g=d[1];i.aabb||(i.aabb={}),i.aabb.displayObject=t,i.aabb.minX=u,i.aabb.minY=c,i.aabb.maxX=f,i.aabb.maxY=g}if(i.aabb&&!isNaN(i.aabb.maxX)&&!isNaN(i.aabb.maxX)&&!isNaN(i.aabb.minX)&&!isNaN(i.aabb.minY))return i.aabb}}},{key:"syncRTree",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!n&&(this.syncing||this.syncTasks.size===0))){this.syncing=!0;var i=[],a=new Set,s=function(l){if(!a.has(l)&&l.renderable){var u=t.syncNode(l,n);u&&(i.push(u),a.add(l))}};this.syncTasks.forEach(function(o,l){o&&l.forEach(s);for(var u=l;u;)s(u),u=u.parentElement}),this.rBush.load(i),i.length=0,this.syncing=!1}}}])}();BA.tag="Prepare";var or=function(r){return r.READY="ready",r.BEFORE_RENDER="beforerender",r.RERENDER="rerender",r.AFTER_RENDER="afterrender",r.BEFORE_DESTROY="beforedestroy",r.AFTER_DESTROY="afterdestroy",r.RESIZE="resize",r.DIRTY_RECTANGLE="dirtyrectangle",r.RENDERER_CHANGED="rendererchanged",r}({}),qw=500,UF=.1,HF=1e3,Vl=new Jt(Ke.MOUNTED),Ul=new Jt(Ke.UNMOUNTED),Dd=new Jt(or.BEFORE_RENDER),$w=new Jt(or.RERENDER),Fd=new Jt(or.AFTER_RENDER),Nm=function(r){function e(t){var n;de(this,e),n=We(this,e),n.Element=wt,n.inited=!1,n.context={};var i=t.container,a=t.canvas,s=t.renderer,o=t.width,l=t.height,u=t.background,c=t.cursor,h=t.supportsMutipleCanvasesInOneContainer,d=t.cleanUpOnDestroy,f=d===void 0?!0:d,g=t.offscreenCanvas,v=t.devicePixelRatio,p=t.requestAnimationFrame,y=t.cancelAnimationFrame,m=t.createImage,w=t.supportsTouchEvents,S=t.supportsPointerEvents,_=t.isTouchEvent,O=t.isMouseEvent,T=t.dblClickSpeed,k=o,P=l,C=v||P1&&window.devicePixelRatio||1;return C=C>=1?Math.ceil(C):1,a&&(k=o||S6(a)||a.width/C,P=l||_6(a)||a.height/C),n.customElements=new GF,n.devicePixelRatio=C,n.requestAnimationFrame=p??C1.bind(ge.globalThis),n.cancelAnimationFrame=y??PA.bind(ge.globalThis),n.supportsTouchEvents=w??"ontouchstart"in ge.globalThis,n.supportsPointerEvents=S??!!ge.globalThis.PointerEvent,n.isTouchEvent=_??function(N){return n.supportsTouchEvents&&N instanceof ge.globalThis.TouchEvent},n.isMouseEvent=O??function(N){return!ge.globalThis.MouseEvent||N instanceof ge.globalThis.MouseEvent&&(!n.supportsPointerEvents||!(N instanceof ge.globalThis.PointerEvent))},g&&(ge.offscreenCanvas=g),n.document=new IA,n.document.defaultView=n,h||b6(i,n,f),n.initRenderingContext(Ge(Ge({},t),{},{width:k,height:P,background:u??"transparent",cursor:c??"default",cleanUpOnDestroy:f,devicePixelRatio:C,requestAnimationFrame:n.requestAnimationFrame,cancelAnimationFrame:n.cancelAnimationFrame,supportsTouchEvents:n.supportsTouchEvents,supportsPointerEvents:n.supportsPointerEvents,isTouchEvent:n.isTouchEvent,isMouseEvent:n.isMouseEvent,dblClickSpeed:T??200,createImage:m??function(){return new window.Image}})),n.initDefaultCamera(k,P,s.clipSpaceNearZ),n.initRenderer(s,!0),n}return Ve(e,r),fe(e,[{key:"initRenderingContext",value:function(n){this.context.config=n,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(n,i,a){var s=this,o=new ge.CameraContribution;o.clipSpaceNearZ=a,o.setType(at.EXPLORING,wm.DEFAULT).setPosition(n/2,i/2,qw).setFocalPoint(n/2,i/2,0).setOrthographic(n/-2,n/2,i/2,i/-2,UF,HF),o.canvas=this,o.eventEmitter.on(aA.UPDATED,function(){s.context.renderingContext.renderReasons.add(Ns.CAMERA_CHANGED),ge.enableSizeAttenuation&&s.getConfig().renderer.getConfig().enableSizeAttenuation&&s.updateSizeAttenuation()}),this.context.camera=o}},{key:"updateSizeAttenuation",value:function(){var n=this.getCamera().getZoom();this.document.documentElement.forEach(function(i){ge.styleValueRegistry.updateSizeAttenuation(i,n)})}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var n=this;return this.readyPromise||(this.readyPromise=new Promise(function(i){n.resolveReadyPromise=function(){i(n)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,i=arguments.length>1?arguments[1]:void 0;nn.clearCache(),i||this.dispatchEvent(new Jt(or.BEFORE_DESTROY)),this.frameId&&this.cancelAnimationFrame(this.frameId);var a=this.getRoot();n&&(this.unmountChildren(a),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),this.context.rBushRoot&&this.context.rBushRoot.clear(),i||this.dispatchEvent(new Jt(or.AFTER_DESTROY));var s=function(l){l.currentTarget=null,l.manager=null,l.target=null,l.relatedNode=null};s(Vl),s(Ul),s(Dd),s($w),s(Fd),s(ii),s(Pm),s(Cm),s(LA)}},{key:"changeSize",value:function(n,i){this.resize(n,i)}},{key:"resize",value:function(n,i){var a=this.context.config;a.width=n,a.height=i,this.getContextService().resize(n,i);var s=this.context.camera,o=s.getProjectionMode();s.setPosition(n/2,i/2,qw).setFocalPoint(n/2,i/2,0),o===Mr.ORTHOGRAPHIC?s.setOrthographic(n/-2,n/2,i/2,i/-2,s.getNear(),s.getFar()):s.setAspect(n/i),this.dispatchEvent(new Jt(or.RESIZE,{width:n,height:i}))}},{key:"appendChild",value:function(n,i){return this.document.documentElement.appendChild(n,i)}},{key:"insertBefore",value:function(n,i){return this.document.documentElement.insertBefore(n,i)}},{key:"removeChild",value:function(n){return this.document.documentElement.removeChild(n)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(n){var i=this;n&&(Dd.detail=n,Fd.detail=n),this.dispatchEvent(Dd);var a=this.getRenderingService();a.render(this.getConfig(),n,function(){i.dispatchEvent($w)}),this.dispatchEvent(Fd)}},{key:"run",value:function(){var n=this,i=function(s,o){n.render(o),n.frameId=n.requestAnimationFrame(i)};i()}},{key:"initRenderer",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new xI,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new FA,new BA,new DA([new VF])),this.loadRendererContainerModule(n),this.context.contextService=new this.context.ContextService(Ge(Ge({},ge),this.context)),this.context.renderingService=new aF(ge,this.context),this.context.eventService=new iF(ge,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(n,a,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(n,a)}).catch(function(s){console.error(s)})}},{key:"initRenderingService",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.context.renderingService.init(function(){i.inited=!0,a?s?i.requestAnimationFrame(function(){i.dispatchEvent(new Jt(or.READY))}):i.dispatchEvent(new Jt(or.READY)):i.dispatchEvent(new Jt(or.RENDERER_CHANGED)),i.readyPromise&&i.resolveReadyPromise(),a||i.getRoot().forEach(function(o){var l=o,u=l.renderable;u&&(u.renderBoundsDirty=!0,u.boundsDirty=!0,u.dirty=!0)}),i.mountChildren(i.getRoot()),n.getConfig().enableAutoRendering&&i.run()})}},{key:"loadRendererContainerModule",value:function(n){var i=this,a=n.getPlugins();a.forEach(function(s){s.context=i.context,s.init(ge)})}},{key:"setRenderer",value:function(n){var i=this.getConfig();if(i.renderer!==n){var a=i.renderer;i.renderer=n,this.destroy(!1,!0),yt((a==null?void 0:a.getPlugins())||[]).reverse().forEach(function(s){s.destroy(ge)}),this.initRenderer(n)}}},{key:"setCursor",value:function(n){var i=this.getConfig();i.cursor=n,this.getContextService().applyCursorStyle(n)}},{key:"unmountChildren",value:function(n){var i=this;n.childNodes.forEach(function(a){i.unmountChildren(a)}),this.inited&&(n.isMutationObserved?n.dispatchEvent(Ul):(Ul.target=n,this.dispatchEvent(Ul,!0)),n!==this.document.documentElement&&(n.ownerDocument=null),n.isConnected=!1),n.isCustomElement&&n.disconnectedCallback&&n.disconnectedCallback()}},{key:"mountChildren",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ac(n);this.inited?n.isConnected||(n.ownerDocument=this.document,n.isConnected=!0,a||(n.isMutationObserved?n.dispatchEvent(Vl):(Vl.target=n,this.dispatchEvent(Vl,!0)))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",n.nodeName),n.childNodes.forEach(function(s){i.mountChildren(s,a)}),n.isCustomElement&&n.connectedCallback&&n.connectedCallback()}},{key:"mountFragment",value:function(n){this.mountChildren(n,!1)}},{key:"client2Viewport",value:function(n){return this.getEventService().client2Viewport(n)}},{key:"viewport2Client",value:function(n){return this.getEventService().viewport2Client(n)}},{key:"viewport2Canvas",value:function(n){return this.getEventService().viewport2Canvas(n)}},{key:"canvas2Viewport",value:function(n){return this.getEventService().canvas2Viewport(n)}},{key:"getPointByClient",value:function(n,i){return this.client2Viewport({x:n,y:i})}},{key:"getClientByPoint",value:function(n,i){return this.viewport2Client({x:n,y:i})}}])}(RA);/*!
 * @antv/g-camera-api
 * @description A simple implementation of Camera API.
 * @version 2.0.35
 * @date 1/23/2025, 8:32:08 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var YF=function(r){function e(){var t;de(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=We(this,e,[].concat(i)),t.landmarks=[],t}return Ve(e,r),fe(e,[{key:"rotate",value:function(n,i,a){if(this.relElevation=As(i),this.relAzimuth=As(n),this.relRoll=As(a),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===at.EXPLORING){var s=Ki(on(),[1,0,0],ot((this.rotateWorld?1:-1)*this.relElevation)),o=Ki(on(),[0,1,0],ot((this.rotateWorld?1:-1)*this.relAzimuth)),l=Ki(on(),[0,0,1],ot(this.relRoll)),u=aa(on(),o,s);u=aa(on(),u,l);var c=x1(gt(),u);Ts(this.matrix,this.matrix,[0,0,-this.distance]),Ln(this.matrix,this.matrix,c),Ts(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===at.ORBITING||this.type===at.EXPLORING?this._getPosition():this.type===at.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(n,i){var a=Fn(n,i,0),s=xi(this.position);return ia(s,s,Uu(Qe(),this.right,a[0])),ia(s,s,Uu(Qe(),this.up,a[1])),this._setPosition(s),this.triggerUpdate(),this}},{key:"dolly",value:function(n){var i=this.forward,a=xi(this.position),s=n*this.dollyingStep,o=this.distance+n*this.dollyingStep;return s=Math.max(Math.min(o,this.maxDistance),this.minDistance)-this.distance,a[0]+=s*i[0],a[1]+=s*i[1],a[2]+=s*i[2],this._setPosition(a),this.type===at.ORBITING||this.type===at.EXPLORING?this._getDistance():this.type===at.TRACKING&&ia(this.focalPoint,a,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(n){var i,a,s,o,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=l.position,c=u===void 0?this.position:u,h=l.focalPoint,d=h===void 0?this.focalPoint:h,f=l.roll,g=l.zoom,v=new ge.CameraContribution;v.setType(this.type,void 0),v.setPosition(c[0],(i=c[1])!==null&&i!==void 0?i:this.position[1],(a=c[2])!==null&&a!==void 0?a:this.position[2]),v.setFocalPoint(d[0],(s=d[1])!==null&&s!==void 0?s:this.focalPoint[1],(o=d[2])!==null&&o!==void 0?o:this.focalPoint[2]),v.setRoll(f??this.roll),v.setZoom(g??this.zoom);var p={name:n,matrix:ET(v.getWorldTransform()),right:xi(v.right),up:xi(v.up),forward:xi(v.forward),position:xi(v.getPosition()),focalPoint:xi(v.getFocalPoint()),distanceVector:xi(v.getDistanceVector()),distance:v.getDistance(),dollyingStep:v.getDollyingStep(),azimuth:v.getAzimuth(),elevation:v.getElevation(),roll:v.getRoll(),relAzimuth:v.relAzimuth,relElevation:v.relElevation,relRoll:v.relRoll,zoom:v.getZoom()};return this.landmarks.push(p),p}},{key:"gotoLandmark",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=rt(n)?this.landmarks.find(function(N){return N.name===n}):n;if(s){var o=_e(a)?{duration:a}:a,l=o.easing,u=l===void 0?"linear":l,c=o.duration,h=c===void 0?100:c,d=o.easingFunction,f=d===void 0?void 0:d,g=o.onfinish,v=g===void 0?void 0:g,p=o.onframe,y=p===void 0?void 0:p,m=.01;this.cancelLandmarkAnimation();var w=s.position,S=s.focalPoint,_=s.zoom,O=s.roll,T=f||ge.EasingFunction(u),k,P=function(){i.setFocalPoint(S),i.setPosition(w),i.setRoll(O),i.setZoom(_),i.computeMatrix(),i.triggerUpdate(),v==null||v()};if(h===0)return P();var C=function(L){k===void 0&&(k=L);var F=L-k;if(F>=h){P();return}var G=T(F/h),V=Qe(),U=Qe(),$=1,j=0;um(V,i.focalPoint,S,G),um(U,i.position,w,G),j=i.roll*(1-G)+O*G,$=i.zoom*(1-G)+_*G,i.setFocalPoint(V),i.setPosition(U),i.setRoll(j),i.setZoom($);var Z=Zb(V,S)+Zb(U,w);if(Z<=m&&_===void 0&&O===void 0)return P();i.computeMatrix(),i.triggerUpdate(),F<h&&(y==null||y(G),i.landmarkAnimationID=i.canvas.requestAnimationFrame(C))};this.canvas.requestAnimationFrame(C)}}}])}(sA);ge.CameraContribution=YF;/*!
 * @antv/g-web-animations-api
 * @description A simple implementation of Web Animations API.
 * @version 2.1.21
 * @date 1/23/2025, 8:33:55 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var Bd=function(r){function e(t,n,i,a){var s;return de(this,e),s=We(this,e,[t]),s.currentTime=i,s.timelineTime=a,s.target=n,s.type="finish",s.bubbles=!1,s.currentTarget=n,s.defaultPrevented=!1,s.eventPhase=s.AT_TARGET,s.timeStamp=Date.now(),s.currentTime=i,s.timelineTime=a,s}return Ve(e,r),fe(e)}(Nc),XF=0,KF=function(){function r(e,t){var n;de(this,r),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=t,this.id="".concat(XF++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((n=this.effect)===null||n===void 0?void 0:n.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return fe(r,[{key:"pending",get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var t=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(n,i){t.resolveReadyPromise=function(){n(t)},t.rejectReadyPromise=function(){i(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var t=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(n,i){t.resolveFinishedPromise=function(){n(t)},t.rejectFinishedPromise=function(){i(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){if(t=Number(t),!isNaN(t)){if(this.timeline.restart(),!this._paused&&this._startTime!==null){var n;this._startTime=Number((n=this.timeline)===null||n===void 0?void 0:n.currentTime)-t/this.playbackRate}this.currentTimePending=!1,this._currentTime!==t&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this))}}},{key:"startTime",get:function(){return this._startTime},set:function(t){if(t!==null){if(this.updatePromises(),t=Number(t),isNaN(t)||this._paused||this._idle)return;this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){if(t!==this._playbackRate){this.updatePromises();var n=this.currentTime;this._playbackRate=t,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),n!==null&&(this.currentTime=n),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||this.playState==="running"||!this._finishedFlag}},{key:"updatePromises",value:function(){var t=this.oldPlayState,n=this.pending?"pending":this.playState;return this.readyPromise&&n!==t&&(n==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):t==="pending"?this.resolveReadyPromise():n==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&n!==t&&(n==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):n==="finished"?this.resolveFinishedPromise():t==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=n,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){var t=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var n=new Bd(null,this,this.currentTime,null);setTimeout(function(){t.oncancel(n)})}}},{key:"reverse",value:function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),t!==null&&(this.currentTime=t),this.updatePromises()}},{key:"updatePlaybackRate",value:function(t){this.playbackRate=t}},{key:"targetAnimations",value:function(){var t,n=(t=this.effect)===null||t===void 0?void 0:t.target;return n.getAnimations()}},{key:"markTarget",value:function(){var t=this.targetAnimations();t.indexOf(this)===-1&&t.push(this)}},{key:"unmarkTarget",value:function(){var t=this.targetAnimations(),n=t.indexOf(this);n!==-1&&t.splice(n,1)}},{key:"tick",value:function(t,n){!this._idle&&!this._paused&&(this._startTime===null?n&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),n&&(this.currentTimePending=!1,this.fireEvents(t))}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")}},{key:"persist",value:function(){throw new Error(st)}},{key:"addEventListener",value:function(t,n,i){throw new Error(st)}},{key:"removeEventListener",value:function(t,n,i){throw new Error(st)}},{key:"dispatchEvent",value:function(t){throw new Error(st)}},{key:"commitStyles",value:function(){throw new Error(st)}},{key:"ensureAlive",value:function(){if(this.playbackRate<0&&this.currentTime===0){var t;this._inEffect=!!((t=this.effect)!==null&&t!==void 0&&t.update(-1))}else{var n;this._inEffect=!!((n=this.effect)!==null&&n!==void 0&&n.update(this.currentTime))}!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(t,n){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!n&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(t){var n=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var i=new Bd(null,this,this.currentTime,t);setTimeout(function(){n.onfinish&&n.onfinish(i)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var a=new Bd(null,this,this.currentTime,t);this.onframe(a)}this._finishedFlag=!1}}}])}(),ZF=4,JF=.001,QF=1e-7,eB=10,wo=11,Hl=1/(wo-1),tB=typeof Float32Array=="function",zA=function(e,t){return 1-3*t+3*e},jA=function(e,t){return 3*t-6*e},qA=function(e){return 3*e},oc=function(e,t,n){return((zA(t,n)*e+jA(t,n))*e+qA(t))*e},$A=function(e,t,n){return 3*zA(t,n)*e*e+2*jA(t,n)*e+qA(t)},nB=function(e,t,n,i,a){var s,o,l=0;do o=t+(n-t)/2,s=oc(o,i,a)-e,s>0?n=o:t=o;while(Math.abs(s)>QF&&++l<eB);return o},rB=function(e,t,n,i){for(var a=0;a<ZF;++a){var s=$A(t,n,i);if(s===0)return t;var o=oc(t,n,i)-e;t-=o/s}return t},L1=function(e,t,n,i){if(!(e>=0&&e<=1&&n>=0&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&n===i)return function(l){return l};for(var a=tB?new Float32Array(wo):new Array(wo),s=0;s<wo;++s)a[s]=oc(s*Hl,e,n);var o=function(u){for(var c=0,h=1,d=wo-1;h!==d&&a[h]<=u;++h)c+=Hl;--h;var f=(u-a[h])/(a[h+1]-a[h]),g=c+f*Hl,v=$A(g,e,n);return v>=JF?rB(u,g,e,n):v===0?g:nB(u,c,c+Hl,e,n)};return function(l){return l===0||l===1?l:oc(o(l),t,i)}},iB=function(e){return e=e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())}),e.charAt(0)==="-"?e.substring(1):e},Yl=function(e){return Math.pow(e,2)},Xl=function(e){return Math.pow(e,3)},Kl=function(e){return Math.pow(e,4)},Zl=function(e){return Math.pow(e,5)},Jl=function(e){return Math.pow(e,6)},Ql=function(e){return 1-Math.cos(e*Math.PI/2)},eu=function(e){return 1-Math.sqrt(1-e*e)},tu=function(e){return e*e*(3*e-2)},nu=function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((t*3-2)/22-e,2)},ru=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=qe(t,2),i=n[0],a=i===void 0?1:i,s=n[1],o=s===void 0?.5:s,l=Bt(Number(a),1,10),u=Bt(Number(o),.1,2);return e===0||e===1?e:-l*Math.pow(2,10*(e-1))*Math.sin((e-1-u/(Math.PI*2)*Math.asin(1/l))*(Math.PI*2)/u)},lo=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=qe(t,4),a=i[0],s=a===void 0?1:a,o=i[1],l=o===void 0?100:o,u=i[2],c=u===void 0?10:u,h=i[3],d=h===void 0?0:h;s=Bt(s,.1,1e3),l=Bt(l,.1,1e3),c=Bt(c,.1,1e3),d=Bt(d,.1,1e3);var f=Math.sqrt(l/s),g=c/(2*Math.sqrt(l*s)),v=g<1?f*Math.sqrt(1-g*g):0,p=1,y=g<1?(g*f+-d)/v:-d+f,m=n?n*e/1e3:e;return g<1?m=Math.exp(-m*g*f)*(p*Math.cos(v*m)+y*Math.sin(v*m)):m=(p+y*m)*Math.exp(-m*f),e===0||e===1?e:1-m},zd=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=t,i=qe(n,2),a=i[0],s=a===void 0?10:a,o=i[1],l=o==="start"?Math.ceil:Math.floor;return l(Bt(e,0,1)*s)/s},Gw=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=qe(t,4),i=n[0],a=n[1],s=n[2],o=n[3];return L1(i,a,s,o)(e)},iu=L1(.42,0,1,1),xr=function(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return 1-e(1-t,n,i)}},Er=function(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return t<.5?e(t*2,n,i)/2:1-e(t*-2+2,n,i)/2}},Sr=function(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return t<.5?(1-e(1-t*2,n,i))/2:(e(t*2-1,n,i)+1)/2}},Ww={steps:zd,"step-start":function(e){return zd(e,[1,"start"])},"step-end":function(e){return zd(e,[1,"end"])},linear:function(e){return e},"cubic-bezier":Gw,ease:function(e){return Gw(e,[.25,.1,.25,1])},in:iu,out:xr(iu),"in-out":Er(iu),"out-in":Sr(iu),"in-quad":Yl,"out-quad":xr(Yl),"in-out-quad":Er(Yl),"out-in-quad":Sr(Yl),"in-cubic":Xl,"out-cubic":xr(Xl),"in-out-cubic":Er(Xl),"out-in-cubic":Sr(Xl),"in-quart":Kl,"out-quart":xr(Kl),"in-out-quart":Er(Kl),"out-in-quart":Sr(Kl),"in-quint":Zl,"out-quint":xr(Zl),"in-out-quint":Er(Zl),"out-in-quint":Sr(Zl),"in-expo":Jl,"out-expo":xr(Jl),"in-out-expo":Er(Jl),"out-in-expo":Sr(Jl),"in-sine":Ql,"out-sine":xr(Ql),"in-out-sine":Er(Ql),"out-in-sine":Sr(Ql),"in-circ":eu,"out-circ":xr(eu),"in-out-circ":Er(eu),"out-in-circ":Sr(eu),"in-back":tu,"out-back":xr(tu),"in-out-back":Er(tu),"out-in-back":Sr(tu),"in-bounce":nu,"out-bounce":xr(nu),"in-out-bounce":Er(nu),"out-in-bounce":Sr(nu),"in-elastic":ru,"out-elastic":xr(ru),"in-out-elastic":Er(ru),"out-in-elastic":Sr(ru),spring:lo,"spring-in":lo,"spring-out":xr(lo),"spring-in-out":Er(lo),"spring-out-in":Sr(lo)},aB=function(e){return iB(e).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},sB=function(e){return Ww[aB(e)]||Ww.linear},oB=function(e){return e},lB=1,uB=.5,Vw=0;function Uw(r,e){return function(t){if(t>=1)return 1;var n=1/r;return t+=e*n,t-t%n}}var au="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",cB=new RegExp("cubic-bezier\\(".concat(au,",").concat(au,",").concat(au,",").concat(au,"\\)")),hB=/steps\(\s*(\d+)\s*\)/,dB=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function I1(r){var e=cB.exec(r);if(e)return L1.apply(void 0,yt(e.slice(1).map(Number)));var t=hB.exec(r);if(t)return Uw(Number(t[1]),Vw);var n=dB.exec(r);return n?Uw(Number(n[1]),{start:lB,middle:uB,end:Vw}[n[2]]):sB(r)}function fB(r){return Math.abs(gB(r)/(r.playbackRate||1))}function gB(r){var e;return r.duration===0||r.iterations===0?0:(r.duration==="auto"?0:Number(r.duration))*((e=r.iterations)!==null&&e!==void 0?e:1)}var GA=0,D1=1,Lc=2,WA=3;function pB(r,e,t){if(e===null)return GA;var n=t.endTime;return e<Math.min(t.delay,n)?D1:e>=Math.min(t.delay+r+t.endDelay,n)?Lc:WA}function vB(r,e,t,n,i){switch(n){case D1:return e==="backwards"||e==="both"?0:null;case WA:return t-i;case Lc:return e==="forwards"||e==="both"?r:null;case GA:return null}}function yB(r,e,t,n,i){var a=i;return r===0?e!==D1&&(a+=t):a+=n/r,a}function mB(r,e,t,n,i,a){var s=r===1/0?e%1:r%1;return s===0&&t===Lc&&n!==0&&(i!==0||a===0)&&(s=1),s}function bB(r,e,t,n){return r===Lc&&e===1/0?1/0:t===1?Math.floor(n)-1:Math.floor(n)}function wB(r,e,t){var n=r;if(r!=="normal"&&r!=="reverse"){var i=e;r==="alternate-reverse"&&(i+=1),n="normal",i!==1/0&&i%2!==0&&(n="reverse")}return n==="normal"?t:1-t}function xB(r,e,t){var n=pB(r,e,t),i=vB(r,t.fill,e,n,t.delay);if(i===null)return null;var a=t.duration==="auto"?0:t.duration,s=yB(a,n,t.iterations,i,t.iterationStart),o=mB(s,t.iterationStart,n,t.iterations,i,a),l=bB(n,t.iterations,o,s),u=wB(t.direction,l,o);return t.currentIteration=l,t.progress=u,t.easingFunction(u)}function EB(r,e,t){var n=SB(r,e),i=_B(n,t);return function(a,s){if(s!==null)i.filter(function(l){return s>=l.applyFrom&&s<l.applyTo}).forEach(function(l){var u=s-l.startOffset,c=l.endOffset-l.startOffset,h=c===0?0:u/c;a.setAttribute(l.property,l.interpolation(h),!1,!1)});else for(var o in n)VA(o)&&a.setAttribute(o,null)}}function VA(r){return r!=="offset"&&r!=="easing"&&r!=="composite"&&r!=="computedOffset"}function SB(r,e){for(var t={},n=0;n<r.length;n++)for(var i in r[n])if(VA(i)){var a={offset:r[n].offset,computedOffset:r[n].computedOffset,easing:r[n].easing,easingFunction:I1(r[n].easing)||e.easingFunction,value:r[n][i]};t[i]=t[i]||[],t[i].push(a)}return t}function _B(r,e){var t=[];for(var n in r)for(var i=r[n],a=0;a<i.length-1;a++){var s=a,o=a+1,l=i[s].computedOffset,u=i[o].computedOffset,c=l,h=u;a===0&&(c=-1/0,u===0&&(o=s)),a===i.length-2&&(h=1/0,l===1&&(s=o)),t.push({applyFrom:c,applyTo:h,startOffset:i[s].computedOffset,endOffset:i[o].computedOffset,easingFunction:i[s].easingFunction,property:n,interpolation:MB(n,i[s].value,i[o].value,e)})}return t.sort(function(d,f){return d.startOffset-f.startOffset}),t}var Hw=function(e,t,n){return function(i){var a=UA(e,t,i);return _e(a)?a:n(a)}};function MB(r,e,t,n){var i=SA[r];if(i&&i.syntax&&i.int){var a=ge.styleValueRegistry.getPropertySyntax(i.syntax);if(a){var s=a.parser,o=s?s(e,n):e,l=s?s(t,n):t,u=a.mixer(o,l,n);if(u){var c=Hw.apply(void 0,yt(u));return function(h){return h===0?e:h===1?t:c(h)}}}}return Hw(!1,!0,function(h){return h?t:e})}function UA(r,e,t){if(typeof r=="number"&&typeof e=="number")return r*(1-t)+e*t;if(typeof r=="boolean"&&typeof e=="boolean"||typeof r=="string"&&typeof e=="string")return t<.5?r:e;if(Array.isArray(r)&&Array.isArray(e)){for(var n=r.length,i=e.length,a=Math.max(n,i),s=[],o=0;o<a;o++)s.push(UA(r[o<n?o:n-1],e[o<i?o:i-1],t));return s}throw new Error("Mismatched interpolation arguments ".concat(r,":").concat(e))}var OB=function(){function r(){de(this,r),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=oB,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return fe(r,[{key:"easing",get:function(){return this._easing},set:function(t){this.easingFunction=I1(t),this._easing=t}}])}();function kB(r){var e=[];for(var t in r)if(!(t in["easing","offset","composite"])){var n=r[t];Array.isArray(n)||(n=[n]);for(var i=n.length,a=0;a<i;a++){if(!e[a]){var s={};"offset"in r&&(s.offset=Number(r.offset)),"easing"in r&&(s.easing=r.easing),"composite"in r&&(s.composite=r.composite),e[a]=s}n[a]!==void 0&&n[a]!==null&&(e[a][t]=n[a])}}return e.sort(function(o,l){return(o.computedOffset||0)-(l.computedOffset||0)}),e}function Yw(r,e){if(r===null)return[];Array.isArray(r)||(r=kB(r));for(var t=r.map(function(l){var u={};e!=null&&e.composite&&(u.composite="auto");for(var c in l){var h=l[c];if(c==="offset"){if(h!==null){if(h=Number(h),!isFinite(h))throw new Error("Keyframe offsets must be numbers.");if(h<0||h>1)throw new Error("Keyframe offsets must be between 0 and 1.");u.computedOffset=h}}else if(c==="composite"&&["replace","add","accumulate","auto"].indexOf(h)===-1)throw new Error("".concat(h," compositing is not supported"));u[c]=h}return u.offset===void 0&&(u.offset=null),u.easing===void 0&&(u.easing=(e==null?void 0:e.easing)||"linear"),u.composite===void 0&&(u.composite="auto"),u}),n=!0,i=-1/0,a=0;a<t.length;a++){var s=t[a].offset;if(Le(s))n=!1;else{if(s<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=s}}t=t.filter(function(l){return Number(l.offset)>=0&&Number(l.offset)<=1});function o(){var l,u=t,c=u.length;if(t[c-1].computedOffset=Number((l=t[c-1].offset)!==null&&l!==void 0?l:1),c>1){var h;t[0].computedOffset=Number((h=t[0].offset)!==null&&h!==void 0?h:0)}for(var d=0,f=Number(t[0].computedOffset),g=1;g<c;g++){var v=t[g].computedOffset;if(!Le(v)&&!Le(f)){for(var p=1;p<g-d;p++)t[d+p].computedOffset=f+(Number(v)-f)*p/(g-d);d=g,f=Number(v)}}}return n||o(),t}var TB="backwards|forwards|both|none".split("|"),AB="reverse|alternate|alternate-reverse".split("|");function PB(r,e){var t=new OB;return typeof r=="number"&&!isNaN(r)?t.duration=r:r!==void 0&&Object.keys(r).forEach(function(n){if(r[n]!==void 0&&r[n]!==null&&r[n]!=="auto"){if((typeof t[n]=="number"||n==="duration")&&(typeof r[n]!="number"||isNaN(r[n]))||n==="fill"&&TB.indexOf(r[n])===-1||n==="direction"&&AB.indexOf(r[n])===-1)return;t[n]=r[n]}}),t}function CB(r,e){return r=NB(r??{duration:"auto"}),PB(r)}function NB(r){return typeof r=="number"&&(isNaN(r)?r={duration:"auto"}:r={duration:r}),r}var RB=function(){function r(e,t,n){var i=this;de(this,r),this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=CB(n),this.timing.effect=this,this.timing.activeDuration=fB(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Yw(t,this.timing),this.interpolations=EB(this.normalizedKeyframes,this.timing,this.target);var a=ge.globalThis.Proxy;this.computedTiming=a?new a(this.timing,{get:function(o,l){return l==="duration"?o.duration==="auto"?0:o.duration:l==="fill"?o.fill==="auto"?"none":o.fill:l==="localTime"?i.animation&&i.animation.currentTime||null:l==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:o.currentIteration||0:l==="progress"?!i.animation||i.animation.playState!=="running"?null:o.progress||0:o[l]},set:function(){return!0}}):this.timing}return fe(r,[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(t){return t===null?!1:(this.timeFraction=xB(this.timing.activeDuration,t,this.timing),this.timeFraction!==null)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(t){this.normalizedKeyframes=Yw(t)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(t){var n=this;Object.keys(t||{}).forEach(function(i){n.timing[i]=t[i]})}}])}();function Xw(r,e){return Number(r.id)-Number(e.id)}var LB=function(){function r(e){var t=this;de(this,r),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(n){t.currentTime=n,t.discardAnimations(),t.animations.length===0?t.timelineTicking=!1:t.requestAnimationFrame(t.webAnimationsNextTick)},this.processRafCallbacks=function(n){var i=t.rafCallbacks;t.rafCallbacks=[],n<Number(t.currentTime)&&(n=Number(t.currentTime)),t.animations.sort(Xw),t.animations=t.tick(n,!0,t.animations)[0],i.forEach(function(a){a[1](n)}),t.applyPendingEffects()},this.document=e}return fe(r,[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(t,n,i){var a=new RB(t,n,i),s=new KF(a,this);return this.animations.push(s),this.restartWebAnimationsNextTick(),s.updatePromises(),s.play(),s.updatePromises(),s}},{key:"applyDirtiedAnimation",value:function(t){var n=this;if(!this.inTick){t.markTarget();var i=t.targetAnimations();i.sort(Xw);var a=this.tick(Number(this.currentTime),!1,i.slice())[1];a.forEach(function(s){var o=n.animations.indexOf(s);o!==-1&&n.animations.splice(o,1)}),this.applyPendingEffects()}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach(function(t){t==null||t.applyInterpolations()}),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(t){return t.updatePromises()})}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(t){return t.playState!=="finished"&&t.playState!=="idle"})}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(t){var n=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([n,t]),n}},{key:"requestAnimationFrame",value:function(t){var n=this;return this.rAF(function(i){n.updateAnimationsPromises(),t(i),n.updateAnimationsPromises()})}},{key:"tick",value:function(t,n,i){var a=this,s,o;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=t,this.ticking=!1;var l=[],u=[],c=[],h=[];return i.forEach(function(d){d.tick(t,n),d._inEffect?(u.push(d.effect),d.markTarget()):(l.push(d.effect),d.unmarkTarget()),d._needsTick&&(a.ticking=!0);var f=d._inEffect||d._needsTick;d._inTimeline=f,f?c.push(d):h.push(d)}),(s=this.pendingEffects).push.apply(s,l),(o=this.pendingEffects).push.apply(o,u),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[c,h]}}])}();ge.EasingFunction=I1;ge.AnimationTimeline=LB;const IB={duration:500},DB={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};var Mt;(function(r){r.NodeAdded="NodeAdded",r.NodeUpdated="NodeUpdated",r.NodeRemoved="NodeRemoved",r.EdgeAdded="EdgeAdded",r.EdgeUpdated="EdgeUpdated",r.EdgeRemoved="EdgeRemoved",r.ComboAdded="ComboAdded",r.ComboUpdated="ComboUpdated",r.ComboRemoved="ComboRemoved"})(Mt||(Mt={}));var Yn;(function(r){r.DRAW="draw",r.COLLAPSE="collapse",r.EXPAND="expand",r.TRANSFORM="transform"})(Yn||(Yn={}));var Ni;(function(r){r.CLICK="canvas:click",r.DBLCLICK="canvas:dblclick",r.POINTER_OVER="canvas:pointerover",r.POINTER_LEAVE="canvas:pointerleave",r.POINTER_ENTER="canvas:pointerenter",r.POINTER_MOVE="canvas:pointermove",r.POINTER_OUT="canvas:pointerout",r.POINTER_DOWN="canvas:pointerdown",r.POINTER_UP="canvas:pointerup",r.CONTEXT_MENU="canvas:contextmenu",r.DRAG_START="canvas:dragstart",r.DRAG="canvas:drag",r.DRAG_END="canvas:dragend",r.DRAG_ENTER="canvas:dragenter",r.DRAG_OVER="canvas:dragover",r.DRAG_LEAVE="canvas:dragleave",r.DROP="canvas:drop",r.WHEEL="canvas:wheel"})(Ni||(Ni={}));var Na;(function(r){r.CLICK="combo:click",r.DBLCLICK="combo:dblclick",r.POINTER_OVER="combo:pointerover",r.POINTER_LEAVE="combo:pointerleave",r.POINTER_ENTER="combo:pointerenter",r.POINTER_MOVE="combo:pointermove",r.POINTER_OUT="combo:pointerout",r.POINTER_DOWN="combo:pointerdown",r.POINTER_UP="combo:pointerup",r.CONTEXT_MENU="combo:contextmenu",r.DRAG_START="combo:dragstart",r.DRAG="combo:drag",r.DRAG_END="combo:dragend",r.DRAG_ENTER="combo:dragenter",r.DRAG_OVER="combo:dragover",r.DRAG_LEAVE="combo:dragleave",r.DROP="combo:drop"})(Na||(Na={}));var ie;(function(r){r.CLICK="click",r.DBLCLICK="dblclick",r.POINTER_OVER="pointerover",r.POINTER_LEAVE="pointerleave",r.POINTER_ENTER="pointerenter",r.POINTER_MOVE="pointermove",r.POINTER_OUT="pointerout",r.POINTER_DOWN="pointerdown",r.POINTER_UP="pointerup",r.CONTEXT_MENU="contextmenu",r.DRAG_START="dragstart",r.DRAG="drag",r.DRAG_END="dragend",r.DRAG_ENTER="dragenter",r.DRAG_OVER="dragover",r.DRAG_LEAVE="dragleave",r.DROP="drop",r.KEY_DOWN="keydown",r.KEY_UP="keyup",r.WHEEL="wheel",r.PINCH="pinch"})(ie||(ie={}));var Ms;(function(r){r.KEY_DOWN="keydown",r.KEY_UP="keyup"})(Ms||(Ms={}));var lc;(function(r){r.CLICK="edge:click",r.DBLCLICK="edge:dblclick",r.POINTER_OVER="edge:pointerover",r.POINTER_LEAVE="edge:pointerleave",r.POINTER_ENTER="edge:pointerenter",r.POINTER_MOVE="edge:pointermove",r.POINTER_OUT="edge:pointerout",r.POINTER_DOWN="edge:pointerdown",r.POINTER_UP="edge:pointerup",r.CONTEXT_MENU="edge:contextmenu",r.DRAG_ENTER="edge:dragenter",r.DRAG_OVER="edge:dragover",r.DRAG_LEAVE="edge:dragleave",r.DROP="edge:drop"})(lc||(lc={}));var ye;(function(r){r.BEFORE_CANVAS_INIT="beforecanvasinit",r.AFTER_CANVAS_INIT="aftercanvasinit",r.BEFORE_SIZE_CHANGE="beforesizechange",r.AFTER_SIZE_CHANGE="aftersizechange",r.BEFORE_ELEMENT_CREATE="beforeelementcreate",r.AFTER_ELEMENT_CREATE="afterelementcreate",r.BEFORE_ELEMENT_UPDATE="beforeelementupdate",r.AFTER_ELEMENT_UPDATE="afterelementupdate",r.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",r.AFTER_ELEMENT_DESTROY="afterelementdestroy",r.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",r.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",r.BEFORE_DRAW="beforedraw",r.AFTER_DRAW="afterdraw",r.BEFORE_RENDER="beforerender",r.AFTER_RENDER="afterrender",r.BEFORE_ANIMATE="beforeanimate",r.AFTER_ANIMATE="afteranimate",r.BEFORE_LAYOUT="beforelayout",r.AFTER_LAYOUT="afterlayout",r.BEFORE_STAGE_LAYOUT="beforestagelayout",r.AFTER_STAGE_LAYOUT="afterstagelayout",r.BEFORE_TRANSFORM="beforetransform",r.AFTER_TRANSFORM="aftertransform",r.BATCH_START="batchstart",r.BATCH_END="batchend",r.BEFORE_DESTROY="beforedestroy",r.AFTER_DESTROY="afterdestroy",r.BEFORE_RENDERER_CHANGE="beforerendererchange",r.AFTER_RENDERER_CHANGE="afterrendererchange"})(ye||(ye={}));var Hi;(function(r){r.UNDO="undo",r.REDO="redo",r.CANCEL="cancel",r.ADD="add",r.CLEAR="clear",r.CHANGE="change"})(Hi||(Hi={}));var kr;(function(r){r.CLICK="node:click",r.DBLCLICK="node:dblclick",r.POINTER_OVER="node:pointerover",r.POINTER_LEAVE="node:pointerleave",r.POINTER_ENTER="node:pointerenter",r.POINTER_MOVE="node:pointermove",r.POINTER_OUT="node:pointerout",r.POINTER_DOWN="node:pointerdown",r.POINTER_UP="node:pointerup",r.CONTEXT_MENU="node:contextmenu",r.DRAG_START="node:dragstart",r.DRAG="node:drag",r.DRAG_END="node:dragend",r.DRAG_ENTER="node:dragenter",r.DRAG_OVER="node:dragover",r.DRAG_LEAVE="node:dragleave",r.DROP="node:drop"})(kr||(kr={}));const ct="combo",lr="tree";var $o;(function(r){r.NODE="node",r.EDGE="edge",r.COMBO="combo",r.THEME="theme",r.PALETTE="palette",r.LAYOUT="layout",r.BEHAVIOR="behavior",r.PLUGIN="plugin",r.ANIMATION="animation",r.TRANSFORM="transform",r.SHAPE="shape"})($o||($o={}));const Rm={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function Ri(r,e){var t;const n=(t=Rm[r])===null||t===void 0?void 0:t[e];if(n)return n}const FB="5.0.44",BB="G6";function Ai(r){return`[${BB} v${FB}] ${r}`}const gi={mute:!1,debug:r=>{console.debug(Ai(r))},info:r=>{console.info(Ai(r))},warn:r=>{console.warn(Ai(r))},error:r=>{console.error(Ai(r))}};function HA(r){const{theme:e}=r;if(!e)return{};const t=Ri($o.THEME,e);return t||(gi.warn(`The theme of ${e} is not registered.`),{})}function F1(r,e){if(Array.isArray(r)&&r.length===0)return null;const t=Array.isArray(r)?r[0]:r,n=Array.isArray(r)?r.slice(1):e||[];return new Proxy(t,{get(i,a){return typeof i[a]=="function"&&!["onframe","onfinish"].includes(a)?(...s)=>{i[a](...s),n.forEach(o=>{var l;return(l=o[a])===null||l===void 0?void 0:l.call(o,...s)})}:a==="finished"?Promise.all([t.finished,...n.map(s=>s.finished)]):Reflect.get(i,a)},set(i,a,s){return["onframe","onfinish"].includes(a)||n.forEach(o=>{o[a]=s}),Reflect.set(i,a,s)}})}function Lm(r){const e=r.reduce((n,i)=>(Object.entries(i).forEach(([a,s])=>{n[a]===void 0?n[a]=[s]:n[a].push(s)}),n),{});Object.entries(e).forEach(([n,i])=>{(i.length!==r.length||i.some(a=>Le(a))||i.every(a=>!["sourceNode","targetNode","childrenNode"].includes(n)&&zt(a,i[0])))&&delete e[n]});const t=Object.entries(e).reduce((n,[i,a])=>(a.forEach((s,o)=>{n[o]?n[o][i]=s:n[o]={[i]:s}}),n),[]);return r.length!==0&&t.length===0&&t.push({_:0},{_:0}),t}function Go(r){switch(r){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function YA(r,e){const{animation:t}=r;if(t===!1||e===!1)return!1;const n=Object.assign({},IB);return Yt(t)&&Object.assign(n,t),Yt(e)&&Object.assign(n,e),n}function zB(r){if(typeof r=="string"){const e=Ri($o.ANIMATION,r);return e||(gi.warn(`The animation of ${r} is not registered.`),[])}return r}function jB(r,e,t,n){var i,a;const{animation:s}=r;if(s===!1||n===!1)return[];const o=(i=r==null?void 0:r[e])===null||i===void 0?void 0:i.animation;if(o===!1)return[];const l=o==null?void 0:o[t];if(l===!1)return[];const u=(a=HA(r)[e])===null||a===void 0?void 0:a.animation,c=(d=[])=>zB(d).map(f=>Object.assign(Object.assign(Object.assign(Object.assign({},DB),Yt(s)&&s),f),Yt(n)&&n));if(l)return c(l);if(!u)return[];const h=u[t];return h===!1?[]:c(h)}function XA(r,e,t,n=[]){if(!n&&r===0&&e===0&&t===0)return null;if(Array.isArray(n)){let a=-1;const s=[];for(let o=0;o<n.length;o++){const l=n[o];if(l[0]==="translate"){if(l[1]===r&&l[2]===e)return null;a=o,s.push(["translate",r,e])}else if(l[0]==="translate3d"){if(l[1]===r&&l[2]===e&&l[3]===t)return null;a=o,s.push(["translate3d",r,e,t??0])}else s.push(l)}return a===-1&&s.splice(0,0,_e(t)?["translate3d",r,e,t??0]:["translate",r,e]),s.length===0?null:s}const i=n?n.replace(/translate(3d)?\([^)]*\)/g,""):"";return t===0?`translate(${r}, ${e})${i}`:`translate3d(${r}, ${e}, ${t})${i}`}var qB=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const $B=(r,e,t)=>{if(!t.length)return null;const[n,i]=e,a=u=>{var c;if(u){const h=r.getShape(u);if(!h)return null;const d=`get${Ku(u)}Style`,f=((c=r==null?void 0:r[d])===null||c===void 0?void 0:c.bind(r))||(p=>p),g=(f==null?void 0:f(n))||{},v=(f==null?void 0:f(i))||{};return{shape:h,fromStyle:g,toStyle:v}}else return{shape:r,fromStyle:n,toStyle:i}};let s;const o=t.map(u=>{var{fields:c,shape:h,states:d}=u,f=qB(u,["fields","shape","states"]);const g=a(h);if(!g)return null;const{shape:v,fromStyle:p,toStyle:y}=g,m=[{},{}];if(c.forEach(S=>{var _,O;Object.assign(m[0],{[S]:(_=p[S])!==null&&_!==void 0?_:Go(S)}),Object.assign(m[1],{[S]:(O=y[S])!==null&&O!==void 0?O:Go(S)})}),m.some(S=>Object.keys(S).some(_=>["x","y","z"].includes(_)))){const{x:S=0,y:_=0,z:O,transform:T=""}=v.attributes||{};m.forEach(k=>{var P,C,N;k.transform=XA((P=k.x)!==null&&P!==void 0?P:S,(C=k.y)!==null&&C!==void 0?C:_,(N=k.z)!==null&&N!==void 0?N:O,T)})}const w=v.animate(Lm(m),f);return h===void 0&&(s=w),w}).filter(Boolean),l=s||(o==null?void 0:o[0]);return l?F1(l,o.filter(u=>u!==u)):null},GB=[{fields:["opacity"]}],WB=[{fields:["x","y"]}],KA=[{fields:["x","y"]}],VB=KA,ZA=[{fields:["sourceNode","targetNode"]}],UB=ZA,JA=[{fields:["childrenNode","x","y"]}],HB=JA;function YB(r){return"source"in r&&"target"in r}function XB(r){return r.length===2}function zs(r){return r instanceof Float32Array?!0:Array.isArray(r)&&(r.length===2||r.length===3)?r.every(e=>typeof e=="number"):!1}function fi(r,e,t){return r>=e&&r<=t}function pi(r=0){if(Array.isArray(r)){const[e=0,t=e,n=e,i=t]=r;return[e,t,n,i]}return[r,r,r,r]}function KB(r=0){const e=pi(r);return e[0]+e[2]}function vi(r){return r.max[0]-r.min[0]}function yi(r){return r.max[1]-r.min[1]}function pa(r){return[vi(r),yi(r)]}function Ji(r,e){const t=zs(r)?B1(r):r.getShape("key").getBounds();return e?va(t,e):t}function B1(r){const[e,t,n=0]=r,i=new pt;return i.setMinMax([e,t,n],[e,t,n]),i}function va(r,e){const[t,n,i,a]=pi(e),[s,o,l]=r.min,[u,c,h]=r.max,d=new pt;return d.setMinMax([s-a,o-t,l],[u+n,c+i,h]),d}function cl(r){if(r.length===0)return new pt;if(r.length===1)return r[0];const e=new pt;e.setMinMax(r[0].min,r[0].max);for(let t=1;t<r.length;t++){const n=r[t];e.setMinMax([Math.min(e.min[0],n.min[0]),Math.min(e.min[1],n.min[1]),Math.min(e.min[2],n.min[2])],[Math.max(e.max[0],n.max[0]),Math.max(e.max[1],n.max[1]),Math.max(e.max[2],n.max[2])])}return e}function ZB(r,e){const[t,n]=r.min,[i,a]=r.max,[s,o]=e.min,[l,u]=e.max;return t>=s&&i<=l&&n>=o&&a<=u}function $r(r,e){return fi(r[0],e.min[0],e.max[0])&&fi(r[1],e.min[1],e.max[1])}function QA(r,e,t=!1){const{min:[n,i],max:[a,s]}=e,o=(r[1]===i||r[1]===s)&&(t||fi(r[0],n,a)),l=(r[0]===n||r[0]===a)&&(t||fi(r[1],i,s));return o||l}function JB(r,e){return!$r(r,e)}function uc(r,e){const{center:t}=e;return r[0]===t[0]&&r[1]===t[1]}function Ro(r,e){const[t,n]=r,[i,a]=e.min,[s,o]=e.max,l=t-i,u=s-t,c=n-a,h=o-n,d=Math.min(l,u,c,h);return d===l?"left":d===u?"right":d===c?"top":d===h?"bottom":"left"}function Ba(r,e){const t=ca(r);if($r(r,e))switch(Ro(r,e)){case"left":t[0]=e.min[0];break;case"right":t[0]=e.max[0];break;case"top":t[1]=e.min[1];break;case"bottom":t[1]=e.max[1];break}else{const[n,i]=r,[a,s]=e.min,[o,l]=e.max;t[0]=fi(n,a,o)?n:n<a?a:o,t[1]=fi(i,s,l)?i:i<s?s:l}return t}function QB(r,e){const{center:t}=r,[n,i]=pa(r),a=e==="up"||e==="down"?t[0]:e==="right"?t[0]-n/6:t[0]+n/6,s=e==="left"||e==="right"?t[1]:e==="down"?t[1]-i/6:t[1]+i/6;return[a,s]}function e5(r,e){let[t,n]=pa(r);return[t,n]=e==="up"||e==="down"?[t,n]:[n,t],(Math.pow(n,2)-Math.pow(Math.sqrt(Math.pow(t/2,2)+Math.pow(n,2))-t/2,2))/(2*n)}function t5(r){const{min:[e,t],max:[n,i]}=r,a=[e,i],s=[n,i],o=[n,t],l=[e,t];return[[a,s],[s,o],[o,l],[l,a]]}var n5=function(e,t){return e===t},Kw=function(){function r(e,t){t===void 0&&(t=null),this.value=e,this.next=t}return r.prototype.toString=function(e){return e?e(this.value):"".concat(this.value)},r}(),r5=function(){function r(e){e===void 0&&(e=n5),this.head=null,this.tail=null,this.compare=e}return r.prototype.prepend=function(e){var t=new Kw(e,this.head);return this.head=t,this.tail||(this.tail=t),this},r.prototype.append=function(e){var t=new Kw(e);return this.head?(this.tail.next=t,this.tail=t,this):(this.head=t,this.tail=t,this)},r.prototype.delete=function(e){if(!this.head)return null;for(var t=null;this.head&&this.compare(this.head.value,e);)t=this.head,this.head=this.head.next;var n=this.head;if(n!==null)for(;n.next;)this.compare(n.next.value,e)?(t=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,e)&&(this.tail=n),t},r.prototype.find=function(e){var t=e.value,n=t===void 0?void 0:t,i=e.callback,a=i===void 0?void 0:i;if(!this.head)return null;for(var s=this.head;s;){if(a&&a(s.value)||n!==void 0&&this.compare(s.value,n))return s;s=s.next}return null},r.prototype.deleteTail=function(){var e=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,e;for(var t=this.head;t.next;)t.next.next?t=t.next:t.next=null;return this.tail=t,e},r.prototype.deleteHead=function(){if(!this.head)return null;var e=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),e},r.prototype.fromArray=function(e){var t=this;return e.forEach(function(n){return t.append(n)}),this},r.prototype.toArray=function(){for(var e=[],t=this.head;t;)e.push(t),t=t.next;return e},r.prototype.reverse=function(){for(var e=this.head,t=null,n=null;e;)n=e.next,e.next=t,t=e,e=n;this.tail=this.head,this.head=t},r.prototype.toString=function(e){return e===void 0&&(e=void 0),this.toArray().map(function(t){return t.toString(e)}).toString()},r}(),i5=function(e,t,n){t===void 0&&(t=[]);var i=t.filter(function(l){return l.source===e||l.target===e});if(n==="target"){var a=function(u){return u.source===e};return i.filter(a).map(function(l){return l.target})}if(n==="source"){var s=function(u){return u.target===e};return i.filter(s).map(function(l){return l.source})}var o=function(u){return u.source===e?u.target:u.source};return i.map(o)},a5=function(e,t){return t.filter(function(n){return n.source===e})},s5=function(e,t){return t.filter(function(n){return n.source===e||n.target===e})},o5=function(e){var t={},n=e.nodes,i=n===void 0?[]:n,a=e.edges,s=a===void 0?[]:a;return i.forEach(function(o){t[o.id]={degree:0,inDegree:0,outDegree:0}}),s.forEach(function(o){t[o.source].degree++,t[o.source].outDegree++,t[o.target].degree++,t[o.target].inDegree++}),t},l5={}.toString,z1=function(r,e){return l5.call(r)==="[object "+e+"]"};const eP=function(r){return z1(r,"Function")},tP=function(r){return Array.isArray?Array.isArray(r):z1(r,"Array")},u5=function(r){var e=typeof r;return r!==null&&e==="object"||e==="function"};function c5(r,e){if(r){var t;if(tP(r))for(var n=0,i=r.length;n<i&&(t=e(r[n],n),t!==!1);n++);else if(u5(r)){for(var a in r)if(r.hasOwnProperty(a)&&(t=e(r[a],a),t===!1))break}}}const h5=function(r){return z1(r,"String")};var d5=Object.values?function(r){return Object.values(r)}:function(r){var e=[];return c5(r,function(t,n){eP(r)&&n==="prototype"||e.push(t)}),e};const f5=function(r,e){if(!eP(r))throw new TypeError("Expected a function");var t=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=e?e.apply(this,n):n[0],s=t.cache;if(s.has(a))return s.get(a);var o=r.apply(this,n);return s.set(a,o),o};return t.cache=new Map,t};var su;f5(function(r,e){e===void 0&&(e={});var t=e.fontSize,n=e.fontFamily,i=e.fontWeight,a=e.fontStyle,s=e.fontVariant;return su||(su=document.createElement("canvas").getContext("2d")),su.font=[a,s,i,t+"px",n].join(" "),su.measureText(h5(r)?r:"").width},function(r,e){return e===void 0&&(e={}),T3([r],d5(e)).join("")});var g5=function(e,t,n){for(var i=1/0,a,s=0;s<t.length;s++){var o=t[s].id;!n[o]&&e[o]<=i&&(i=e[o],a=t[s])}return a},p5=function(e,t,n,i){var a=e.nodes,s=a===void 0?[]:a,o=e.edges,l=o===void 0?[]:o,u={},c={},h={};s.forEach(function(m,w){var S=m.id;c[S]=1/0,S===t&&(c[S]=0)});for(var d=s.length,f=function(w){var S=g5(c,s,u),_=S.id;if(u[_]=!0,c[_]===1/0)return"continue";var O=[];n?O=a5(_,l):O=s5(_,l),O.forEach(function(T){var k=T.target,P=T.source,C=k===_?P:k,N=i&&T[i]?T[i]:1;c[C]>c[S.id]+N?(c[C]=c[S.id]+N,h[C]=[S.id]):c[C]===c[S.id]+N&&h[C].push(S.id)})},g=0;g<d;g++)f();h[t]=[t];var v={};for(var p in c)c[p]!==1/0&&nP(t,p,h,v);var y={};for(var p in v)y[p]=v[p][0];return{length:c,path:y,allPath:v}};function nP(r,e,t,n){if(r===e)return[r];if(n[e])return n[e];for(var i=[],a=0,s=t[e];a<s.length;a++){var o=s[a],l=nP(r,o,t,n);if(!l)return;for(var u=0,c=l;u<c.length;u++){var h=c[u];tP(h)?i.push(Ee(Ee([],h,!0),[e],!1)):i.push([h,e])}}return n[e]=i,n[e]}var rP=function(e,t,n,i,a){var s=p5(e,t,i,a),o=s.length,l=s.path,u=s.allPath;return{length:o[n],path:l[n],allPath:u[n]}},Zw;(function(r){r.EuclideanDistance="euclideanDistance"})(Zw||(Zw={}));var v5=function(e,t,n){typeof t!="number"&&(t=1e-6),typeof n!="number"&&(n=.85);for(var i=1,a=0,s=1e3,o=e.nodes,l=o===void 0?[]:o,u=e.edges,c=u===void 0?[]:u,h=l.length,d,f={},g={},v=0;v<h;++v){var p=l[v],y=p.id;f[y]=1/h,g[y]=1/h}for(var m=o5(e);s>0&&i>t;){a=0;for(var v=0;v<h;++v){var p=l[v],y=p.id;if(d=0,m[p.id].inDegree===0)f[y]=0;else{for(var w=i5(y,c,"source"),S=0;S<w.length;++S){var _=w[S],O=m[_].outDegree;O>0&&(d+=g[_]/O)}f[y]=n*d,a+=f[y]}}a=(1-a)/h,i=0;for(var v=0;v<h;++v){var p=l[v],y=p.id;d=f[y]+a,i+=Math.abs(d-g[y]),g[y]=d}s-=1}return g};(function(){function r(e){e===void 0&&(e=10),this.linkedList=new r5,this.maxStep=e}return Object.defineProperty(r.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),r.prototype.isEmpty=function(){return!this.linkedList.head},r.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},r.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},r.prototype.push=function(e){this.linkedList.prepend(e),this.length>this.maxStep&&this.linkedList.deleteTail()},r.prototype.pop=function(){var e=this.linkedList.deleteHead();return e?e.value:null},r.prototype.toArray=function(){return this.linkedList.toArray().map(function(e){return e.value})},r.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},r})();function J(r){if(r.id!==void 0)return r.id;if(r.source!==void 0&&r.target!==void 0)return`${r.source}-${r.target}`;throw new Error(Ai("The datum does not have available id."))}function ou(r){return r.combo}function iP(r,e){const t={nodes:(r.nodes||[]).map(J),edges:(r.edges||[]).map(J),combos:(r.combos||[]).map(J)};return e?Object.values(t).flat():t}const aP=(r,e,t)=>{var n;switch(t.type){case"degree":{const i=new Map;return(n=r.nodes)===null||n===void 0||n.forEach(a=>{const s=e(J(a),t.direction).length;i.set(J(a),s)}),i}case"betweenness":return y5(r,t.directed,t.weightPropertyName);case"closeness":return m5(r,t.directed,t.weightPropertyName);case"eigenvector":return w5(r,t.directed);case"pagerank":return b5(r,t.epsilon,t.linkProb);default:return sP(r)}},sP=r=>{var e;const t=new Map;return(e=r.nodes)===null||e===void 0||e.forEach(n=>{t.set(J(n),0)}),t},y5=(r,e,t)=>{const n=sP(r),{nodes:i=[]}=r;return i.forEach(a=>{i.forEach(s=>{if(a!==s){const{allPath:o}=rP(r,J(a),J(s),e,t),l=o.length;o.flat().forEach(u=>{u!==J(a)&&u!==J(s)&&n.set(u,n.get(u)+1/l)})}})}),n},m5=(r,e,t)=>{const n=new Map,{nodes:i=[]}=r;return i.forEach(a=>{const s=i.reduce((o,l)=>{if(a!==l){const{length:u}=rP(r,J(a),J(l),e,t);o+=u}return o},0);n.set(J(a),1/s)}),n},b5=(r,e,t)=>{var n;const i=new Map,a=v5(r,e,t);return(n=r.nodes)===null||n===void 0||n.forEach(s=>{i.set(J(s),a[J(s)])}),i},w5=(r,e)=>{const{nodes:t=[]}=r,n=x5(r,e),i=E5(n,t.length),a=new Map;return t.forEach((s,o)=>{a.set(J(s),i[o])}),a},x5=(r,e)=>{const{nodes:t=[],edges:n=[]}=r,i=Array(t.length).fill(null).map(()=>Array(t.length).fill(0));return n.forEach(({source:a,target:s})=>{const o=t.findIndex(u=>J(u)===a),l=t.findIndex(u=>J(u)===s);e?i[o][l]=1:(i[o][l]=1,i[l][o]=1)}),i},E5=(r,e,t=100,n=1e-6)=>{let i=Array(e).fill(1),a=1/0;for(let s=0;s<t&&a>n;s++){const o=Array(e).fill(0);for(let u=0;u<e;u++)for(let c=0;c<e;c++)o[u]+=r[u][c]*i[c];const l=Math.sqrt(o.reduce((u,c)=>u+c*c,0));for(let u=0;u<e;u++)o[u]/=l;a=Math.sqrt(o.reduce((u,c,h)=>u+(c-i[h])*c,0)),i=o}return i};function sa(r,e,t,n=zt){const i=new Map(r.map(d=>[t(d),d])),a=new Map(e.map(d=>[t(d),d])),s=new Set(i.keys()),o=new Set(a.keys()),l=[],u=[],c=[],h=[];return o.forEach(d=>{s.has(d)?n(i.get(d),a.get(d))?h.push(a.get(d)):u.push(a.get(d)):l.push(a.get(d))}),s.forEach(d=>{o.has(d)||c.push(i.get(d))}),{enter:l,exit:c,keep:h,update:u}}function Ha(r,e,t){const n=i=>{t&&!t(i)||(i.style.visibility=e)};r.forEach(i=>{n(i)})}function S5(r,e,t){const n={},i=a=>(a in n||(n[a]=0),`${e}-${a}-${n[a]++}`);return t.map(a=>typeof a=="string"?{type:a,key:i(a)}:typeof a=="function"?a.call(r):a.key?a:Object.assign(Object.assign({},a),{key:i(a.type)}))}class j1{constructor(e){this.extensions=[],this.extensionMap={},this.context=e}setExtensions(e){const t=S5(this.context.graph,this.category,e),{enter:n,update:i,exit:a,keep:s}=sa(this.extensions,t,o=>o.key);this.createExtensions(n),this.updateExtensions([...i,...s]),this.destroyExtensions(a),this.extensions=t}createExtension(e){const{category:t}=this,{key:n,type:i}=e,a=Ri(t,i);if(!a)return gi.warn(`The extension ${i} of ${t} is not registered.`);const s=new a(this.context,e);this.extensionMap[n]=s}createExtensions(e){e.forEach(t=>this.createExtension(t))}updateExtension(e){const{key:t}=e,n=this.extensionMap[t];n&&n.update(e)}updateExtensions(e){e.forEach(t=>this.updateExtension(t))}destroyExtension(e){const t=this.extensionMap[e];t&&(t.destroy(),delete this.extensionMap[e])}destroyExtensions(e){e.forEach(({key:t})=>this.destroyExtension(t))}destroy(){Object.values(this.extensionMap).forEach(e=>e.destroy()),this.context={},this.extensions=[],this.extensionMap={}}}class q1{constructor(e,t){this.events=[],this.destroyed=!1,this.context=e,this.options=t}update(e){this.options=Object.assign(this.options,e)}destroy(){this.context={},this.options={},this.destroyed=!0}}class vr extends q1{}class Ic extends vr{constructor(e,t){super(e,Object.assign({},Ic.defaultOptions,t)),this.isOverlapping=(n,i)=>i.some(a=>n.intersects(a)),this.occupiedBounds=[],this.detectLabelCollision=n=>{const i=this.context.viewport,a={show:[],hide:[]};return this.occupiedBounds=[],n.forEach(s=>{const o=s.getShape("label").getRenderBounds();i.isInViewport(o,!0)&&!this.isOverlapping(o,this.occupiedBounds)?(a.show.push(s),this.occupiedBounds.push(va(o,this.options.padding))):a.hide.push(s)}),a},this.hideLabelIfExceedViewport=(n,i)=>{const{exit:a}=sa(n,i,s=>s.id);a==null||a.forEach(this.hideLabel)},this.nodeCentralities=new Map,this.sortNodesByCentrality=(n,i)=>{const{model:a}=this.context,s=a.getData(),o=a.getRelatedEdgesData.bind(a);return n.map(u=>(this.nodeCentralities.has(u.id)||(this.nodeCentralities=aP(s,o,i)),{node:u,centrality:this.nodeCentralities.get(u.id)})).sort((u,c)=>c.centrality-u.centrality).map(u=>u.node)},this.sortLabelElementsInView=n=>{const{sort:i,sortNode:a,sortCombo:s,sortEdge:o}=this.options,{model:l}=this.context;if(Te(i))return n.sort((v,p)=>i(l.getElementDataById(v.id),l.getElementDataById(p.id)));const{node:u=[],edge:c=[],combo:h=[]}=Ac(n,v=>v.type),d=Te(s)?h.sort((v,p)=>s(...l.getComboData([v.id,p.id]))):h,f=Te(a)?u.sort((v,p)=>a(...l.getNodeData([v.id,p.id]))):this.sortNodesByCentrality(u,a),g=Te(o)?c.sort((v,p)=>o(...l.getEdgeData([v.id,p.id]))):c;return[...d,...f,...g]},this.labelElementsInView=[],this.isFirstRender=!0,this.onToggleVisibility=n=>{var i;if(((i=n.data)===null||i===void 0?void 0:i.stage)==="zIndex")return;if(!this.validate(n)){this.hiddenElements.size>0&&(this.hiddenElements.forEach(this.showLabel),this.hiddenElements.clear());return}const a=this.isFirstRender?this.getLabelElements():this.getLabelElementsInView();this.hideLabelIfExceedViewport(this.labelElementsInView,a),this.labelElementsInView=a;const s=this.sortLabelElementsInView(this.labelElementsInView),{show:o,hide:l}=this.detectLabelCollision(s);for(let u=o.length-1;u>=0;u--)this.showLabel(o[u]);l.forEach(this.hideLabel)},this.hiddenElements=new Map,this.hideLabel=n=>{const i=n.getShape("label");i&&Ha(i,"hidden"),this.hiddenElements.set(n.id,n)},this.showLabel=n=>{const i=n.getShape("label");i&&Ha(i,"visible"),n.toFront(),this.hiddenElements.delete(n.id)},this.onTransform=UT(this.onToggleVisibility,this.options.throttle,{leading:!0}),this.enableToggle=!0,this.toggle=n=>{this.enableToggle&&this.onToggleVisibility(n)},this.onBeforeRender=()=>{this.enableToggle=!1},this.onAfterRender=n=>{this.onToggleVisibility(n),this.enableToggle=!0},this.bindEvents()}update(e){this.unbindEvents(),super.update(e),this.bindEvents(),this.onToggleVisibility({})}getLabelElements(){const{elementMap:e}=this.context.element,t=[];for(const n in e){const i=e[n];i.isVisible()&&i.getShape("label")&&t.push(i)}return t}getLabelElementsInView(){const e=this.context.viewport;return this.getLabelElements().filter(t=>e.isInViewport(t.getShape("key").getRenderBounds()))}bindEvents(){const{graph:e}=this.context;e.on(ye.BEFORE_RENDER,this.onBeforeRender),e.on(ye.AFTER_RENDER,this.onAfterRender),e.on(ye.AFTER_DRAW,this.toggle),e.on(ye.AFTER_LAYOUT,this.toggle),e.on(ye.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:e}=this.context;e.off(ye.BEFORE_RENDER,this.onBeforeRender),e.off(ye.AFTER_RENDER,this.onAfterRender),e.off(ye.AFTER_DRAW,this.toggle),e.off(ye.AFTER_LAYOUT,this.toggle),e.off(ye.AFTER_TRANSFORM,this.onTransform)}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}destroy(){this.unbindEvents(),super.destroy()}}Ic.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:"degree"}};const Jw=[0,0,0];function $e(r,e){return r.map((t,n)=>t+e[n])}function ut(r,e){return r.map((t,n)=>t-e[n])}function _i(r,e){return typeof e=="number"?r.map(t=>t*e):r.map((t,n)=>t*e[n])}function Gr(r,e){return typeof e=="number"?r.map(t=>t/e):r.map((t,n)=>t/e[n])}function _5(r,e){return r.reduce((t,n,i)=>t+n*e[i],0)}function M5(r,e){const t=Wo(r),n=Wo(e);return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function Qi(r,e){return r.map(t=>t*e)}function bt(r,e){return Math.sqrt(r.reduce((t,n,i)=>t+Math.pow(n-e[i]||0,2),0))}function cc(r,e){return r.reduce((t,n,i)=>t+Math.abs(n-e[i]),0)}function Ci(r){const e=r.reduce((t,n)=>t+Math.pow(n,2),0);return r.map(t=>t/Math.sqrt(e))}function $1(r,e,t=!1){const n=r[0]*e[1]-r[1]*e[0];let i=Math.acos(_i(r,e).reduce((a,s)=>a+s,0)/(bt(r,Jw)*bt(e,Jw)));return t&&n<0&&(i=2*Math.PI-i),i}function Dc(r,e=!0){return e?[-r[1],r[0]]:[r[1],-r[0]]}function O5(r,e){return r.map(t=>t%e)}function Ya(r){return[r[0],r[1]]}function Wo(r){return XB(r)?[r[0],r[1],0]:r}function oP(r){const[e,t]=r;return!e&&!t?0:Math.atan2(t,e)}function lP(r,e){const[t,n]=r,[i,a]=e,s=ut(t,n),o=ut(i,a);return M5(s,o).every(l=>l===0)}function G1(r,e,t=!1){if(lP(r,e))return;const[n,i]=r,[a,s]=e,o=((n[0]-a[0])*(a[1]-s[1])-(n[1]-a[1])*(a[0]-s[0]))/((n[0]-i[0])*(a[1]-s[1])-(n[1]-i[1])*(a[0]-s[0])),l=s[0]-a[0]?(n[0]-a[0]+o*(i[0]-n[0]))/(s[0]-a[0]):(n[1]-a[1]+o*(i[1]-n[1]))/(s[1]-a[1]);if(!(!t&&(!fi(o,0,1)||!fi(l,0,1))))return[n[0]+o*(i[0]-n[0]),n[1]+o*(i[1]-n[1])]}function uP(r){if(Array.isArray(r))return fi(r[0],0,1)&&fi(r[1],0,1)?r:[.5,.5];const e=r.split("-"),t=e.includes("left")?0:e.includes("right")?1:.5,n=e.includes("top")?0:e.includes("bottom")?1:.5;return[t,n]}function un(r){const{x:e=0,y:t=0,z:n=0}=r.style||{};return[+e,+t,+n]}function k5(r){const{x:e,y:t,z:n}=r.style||{};return e!==void 0||t!==void 0||n!==void 0}function T5(r,e){const[t,n]=e,{min:i,max:a}=r;return[i[0]+t*(a[0]-i[0]),i[1]+n*(a[1]-i[1])]}function Mi(r,e="center"){const t=uP(e);return T5(r,t)}function Sn(r){var e;return[r.x,r.y,(e=r.z)!==null&&e!==void 0?e:0]}function zr(r){var e;return{x:r[0],y:r[1],z:(e=r[2])!==null&&e!==void 0?e:0}}function uo(r,e=0){return r.map(t=>parseFloat(t.toFixed(e)))}function oa(r,e,t,n=!1){if(zt(r,e))return r;const i=n?ut(r,e):ut(e,r),a=Ci(i),s=[a[0]*t,a[1]*t];return $e(Ya(r),s)}function cP(r,e){return r[1]===e[1]}function A5(r,e){return r[0]===e[0]}function P5(r,e){return cP(r,e)||A5(r,e)}function hP(r,e,t){return lP([r,e],[e,t])}function dP(r,e){return[2*e[0]-r[0],2*e[1]-r[1]]}function fP(r,e,t,n=!0,i=!1){for(let a=0;a<t.length;a++){let s=t[a],o=t[(a+1)%t.length];n&&(s=$e(e,s),o=$e(e,o));const l=i?dP(r,e):r,u=G1([e,l],[s,o]);if(u)return{point:u,line:[s,o]}}return{point:e,line:void 0}}function C5(r,e,t,n){const i=r[0],a=r[1];let s=!1;t===void 0&&(t=0),n===void 0&&(n=e.length);const o=n-t;for(let l=0,u=o-1;l<o;u=l++){const c=e[l+t][0],h=e[l+t][1],d=e[u+t][0],f=e[u+t][1];h>a!=f>a&&i<(d-c)*(a-h)/(f-h)+c&&(s=!s)}return s}function N5(r,e,t=!1){const n=Mi(e,"center"),i=[Mi(e,"left-top"),Mi(e,"right-top"),Mi(e,"right-bottom"),Mi(e,"left-bottom")];return fP(r,n,i,!1,t).point}function Fc(r,e,t=!1){const n=e.center,i=t?dP(r,n):r,a=ut(i,e.center),s=Math.atan2(a[1],a[0]);if(isNaN(s))return n;const o=vi(e)/2,l=yi(e)/2,u=n[0]+o*Math.cos(s),c=n[1]+l*Math.sin(s);return[u,c]}function R5(r,e){let t=1/0,n=[r[0],e[0]];return r.forEach(i=>{e.forEach(a=>{const s=bt(i,a);s<t&&(t=s,n=[i,a])})}),n}function L5(r,e){let t=1/0,n=[[0,0],[0,0]];return e.forEach(i=>{const a=I5(r,i);a<t&&(t=a,n=i)}),n}function I5(r,e){const t=gP(r,e);return bt(r,t)}function gP(r,e){const[t,n]=e[0],[i,a]=e[1],[s,o]=r,l=i-t,u=a-n;if(l===0&&u===0)return[t,n];let c=((s-t)*l+(o-n)*u)/(l*l+u*u);c>1?c=1:c<0&&(c=0);const h=t+c*l,d=n+c*u;return[h,d]}function D5(r){const e=r.reduce((t,n)=>$e(t,n),[0,0]);return Gr(e,r.length)}function W1(r,e=!0){const t=D5(r);return r.sort(([n,i],[a,s])=>{const o=Math.atan2(i-t[1],n-t[0]),l=Math.atan2(s-t[1],a-t[0]);return e?l-o:o-l})}function Qw(r,e){return[r,[r[0],e[1]],e,[e[0],r[1]]]}class Ht{constructor(e,t,n){if(this.phase=t,this.pointerByTouch=[],this.initialDistance=null,this.emitter=e,Ht.instance)return Ht.callbacks[this.phase].push(n),Ht.instance;this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.bindEvents(),Ht.instance=this,Ht.callbacks[this.phase].push(n)}bindEvents(){const{emitter:e}=this;e.on(ie.POINTER_DOWN,this.onPointerDown),e.on(ie.POINTER_MOVE,this.onPointerMove),e.on(ie.POINTER_UP,this.onPointerUp)}updatePointerPosition(e,t,n){const i=this.pointerByTouch.findIndex(a=>a.pointerId===e);i>=0&&(this.pointerByTouch[i]={x:t,y:n,pointerId:e})}onPointerDown(e){const{x:t,y:n}=e.client||{};if(!(t===void 0||n===void 0)&&(this.pointerByTouch.push({x:t,y:n,pointerId:e.pointerId}),e.pointerType==="touch"&&this.pointerByTouch.length===2)){Ht.isPinching=!0;const i=this.pointerByTouch[0].x-this.pointerByTouch[1].x,a=this.pointerByTouch[0].y-this.pointerByTouch[1].y;this.initialDistance=Math.sqrt(i*i+a*a),Ht.callbacks.pinchstart.forEach(s=>s(e,{scale:0}))}}onPointerMove(e){if(this.pointerByTouch.length!==2||this.initialDistance===null)return;const{x:t,y:n}=e.client||{};if(t===void 0||n===void 0)return;this.updatePointerPosition(e.pointerId,t,n);const i=this.pointerByTouch[0].x-this.pointerByTouch[1].x,a=this.pointerByTouch[0].y-this.pointerByTouch[1].y,o=Math.sqrt(i*i+a*a)/this.initialDistance;Ht.callbacks.pinchmove.forEach(l=>l(e,{scale:(o-1)*5}))}onPointerUp(e){var t;Ht.callbacks.pinchend.forEach(n=>n(e,{scale:0})),Ht.isPinching=!1,this.initialDistance=null,this.pointerByTouch=[],(t=Ht.instance)===null||t===void 0||t.tryDestroy()}destroy(){this.emitter.off(ie.POINTER_DOWN,this.onPointerDown),this.emitter.off(ie.POINTER_MOVE,this.onPointerMove),this.emitter.off(ie.POINTER_UP,this.onPointerUp),Ht.instance=null}off(e,t){const n=Ht.callbacks[e].indexOf(t);n>-1&&Ht.callbacks[e].splice(n,1),this.tryDestroy()}tryDestroy(){Object.values(Ht.callbacks).every(e=>e.length===0)&&this.destroy()}}Ht.isPinching=!1;Ht.instance=null;Ht.callbacks={pinchstart:[],pinchmove:[],pinchend:[]};const ex=r=>r.map(e=>rt(e)?e.toLocaleLowerCase():e);class Gs{constructor(e){this.map=new Map,this.boundHandlePinch=()=>{},this.recordKey=new Set,this.onKeyDown=t=>{t!=null&&t.key&&(this.recordKey.add(t.key),this.trigger(t))},this.onKeyUp=t=>{t!=null&&t.key&&this.recordKey.delete(t.key)},this.onWheel=t=>{this.triggerExtendKey(ie.WHEEL,t)},this.onDrag=t=>{this.triggerExtendKey(ie.DRAG,t)},this.handlePinch=(t,n)=>{this.triggerExtendKey(ie.PINCH,Object.assign(Object.assign({},t),n))},this.onFocus=()=>{this.recordKey.clear()},this.emitter=e,this.bindEvents()}bind(e,t){e.length!==0&&(e.includes(ie.PINCH)&&!this.pinchHandler&&(this.boundHandlePinch=this.handlePinch.bind(this),this.pinchHandler=new Ht(this.emitter,"pinchmove",this.boundHandlePinch)),this.map.set(e,t))}unbind(e,t){this.map.forEach((n,i)=>{zt(i,e)&&(!t||t===n)&&this.map.delete(i)})}unbindAll(){this.map.clear()}match(e){const t=ex(Array.from(this.recordKey)).sort(),n=ex(e).sort();return zt(t,n)}bindEvents(){var e;const{emitter:t}=this;t.on(ie.KEY_DOWN,this.onKeyDown),t.on(ie.KEY_UP,this.onKeyUp),t.on(ie.WHEEL,this.onWheel),t.on(ie.DRAG,this.onDrag),(e=globalThis.addEventListener)===null||e===void 0||e.call(globalThis,"focus",this.onFocus)}trigger(e){this.map.forEach((t,n)=>{this.match(n)&&t(e)})}triggerExtendKey(e,t){this.map.forEach((n,i)=>{i.includes(e)&&zt(Array.from(this.recordKey),i.filter(a=>a!==e))&&n(t)})}destroy(){var e,t;this.unbindAll(),this.emitter.off(ie.KEY_DOWN,this.onKeyDown),this.emitter.off(ie.KEY_UP,this.onKeyUp),this.emitter.off(ie.WHEEL,this.onWheel),this.emitter.off(ie.DRAG,this.onDrag),(e=this.pinchHandler)===null||e===void 0||e.off("pinchmove",this.boundHandlePinch),(t=globalThis.removeEventListener)===null||t===void 0||t.call(globalThis,"blur",this.onFocus)}}class hl extends vr{constructor(e,t){super(e,$n({},hl.defaultOptions,t)),this.shortcut=new Gs(e.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(e){if(!this.validate(e)||!this.isKeydown()||this.startPoint)return;const{canvas:t,graph:n}=this.context,i=Object.assign({},this.options.style);this.options.style.lineWidth&&(i.lineWidth=+this.options.style.lineWidth/n.getZoom()),this.rectShape=new Mn({id:"g6-brush-select",style:i}),t.appendChild(this.rectShape),this.startPoint=[e.canvas.x,e.canvas.y]}onPointerMove(e){var t;if(!this.startPoint)return;const{immediately:n,mode:i}=this.options;this.endPoint=hc(e),(t=this.rectShape)===null||t===void 0||t.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),n&&i==="default"&&this.updateElementsStates(Qw(this.startPoint,this.endPoint))}onPointerUp(e){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=hc(e),this.updateElementsStates(Qw(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:e}=this.context,t=Object.values(e.getData()).reduce((n,i)=>Object.assign({},n,i.reduce((a,s)=>(a[J(s)]=[],a),{})),{});e.setElementState(t,this.options.animation)}updateElementsStates(e){const{graph:t}=this.context,{enableElements:n,state:i,mode:a,onSelect:s}=this.options,o=this.selector(t,e,n);let l={};switch(a){case"union":o.forEach(u=>{l[u]=[...t.getElementState(u),i]});break;case"diff":o.forEach(u=>{const c=t.getElementState(u);l[u]=c.includes(i)?c.filter(h=>h!==i):[...c,i]});break;case"intersect":o.forEach(u=>{const c=t.getElementState(u);l[u]=c.includes(i)?[i]:[]});break;case"default":default:o.forEach(u=>{l[u]=[i]});break}Te(s)&&(l=s(l)),t.setElementState(l,this.options.animation)}selector(e,t,n){if(!n||n.length===0)return[];const i=[],a=e.getData();if(n.forEach(s=>{a[`${s}s`].forEach(o=>{const l=J(o);e.getElementVisibility(l)!=="hidden"&&C5(e.getElementPosition(l),t)&&i.push(l)})}),n.includes("edge")){const s=a.edges;s==null||s.forEach(o=>{const{source:l,target:u}=o;i.includes(l)&&i.includes(u)&&i.push(J(o))})}return i}clearBrush(){var e;(e=this.rectShape)===null||e===void 0||e.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:e}=this.options,t=Array.isArray(e)?e:[e];return this.shortcut.match(t.filter(n=>n!=="drag"))}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}bindEvents(){const{graph:e}=this.context;e.on(ie.POINTER_DOWN,this.onPointerDown),e.on(ie.POINTER_MOVE,this.onPointerMove),e.on(ie.POINTER_UP,this.onPointerUp),e.on(Ni.CLICK,this.clearStates)}unbindEvents(){const{graph:e}=this.context;e.off(ie.POINTER_DOWN,this.onPointerDown),e.off(ie.POINTER_MOVE,this.onPointerMove),e.off(ie.POINTER_UP,this.onPointerUp),e.off(Ni.CLICK,this.clearStates)}update(e){this.unbindEvents(),this.options=$n(this.options,e),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}hl.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};const hc=r=>[r.canvas.x,r.canvas.y],Li=.8,Xa=["node","edge","combo"];function za(r,e,t,n,i=0){n==="TB"&&e(r,i);const a=t(r);if(a)for(const s of a)za(s,e,t,n,i+1);n==="BT"&&e(r,i)}function F5(r,e,t){const n=[[r,0]];for(;n.length;){const[i,a]=n.shift();e(i,a);const s=t(i);if(s)for(const o of s)n.push([o,a+1])}}function pP(r,e,t,n,i="both"){if(e==="combo"||e==="node")return jd(r,t,n,i);const a=r.getEdgeData(t);if(!a)return[];const s=jd(r,a.source,n-1,i),o=jd(r,a.target,n-1,i);return Array.from(new Set([...s,...o,t]))}function jd(r,e,t,n="both"){const i=new Set,a=new Set,s=new Set;return F5(e,(o,l)=>{l>t||(s.add(o),r.getRelatedEdgesData(o,n).forEach(u=>{const c=J(u);!a.has(c)&&l<t&&(s.add(c),a.add(c))}))},o=>r.getRelatedEdgesData(o,n).map(l=>l.source===o?l.target:l.source).filter(l=>i.has(l)?!1:(i.add(l),!0))),Array.from(s)}function qd(r){return r.states||[]}var lu=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Bc extends vr{constructor(e,t){super(e,Object.assign({},Bc.defaultOptions,t)),this.onClickSelect=n=>lu(this,void 0,void 0,function*(){var i,a;this.validate(n)&&(yield this.updateState(n),(a=(i=this.options).onClick)===null||a===void 0||a.call(i,n))}),this.onClickCanvas=n=>lu(this,void 0,void 0,function*(){var i,a;this.validate(n)&&(yield this.clearState(),(a=(i=this.options).onClick)===null||a===void 0||a.call(i,n))}),this.shortcut=new Gs(e.graph),this.bindEvents()}bindEvents(){const{graph:e}=this.context;this.unbindEvents(),Xa.forEach(t=>{e.on(`${t}:${ie.CLICK}`,this.onClickSelect)}),e.on(Ni.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:e,trigger:t}=this.options;return e&&this.shortcut.match(t)}getNeighborIds(e){const{target:t,targetType:n}=e,{graph:i}=this.context,{degree:a}=this.options;return pP(i,n,t.id,typeof a=="function"?a(e):a).filter(s=>s!==t.id)}updateState(e){return lu(this,void 0,void 0,function*(){const{state:t,unselectedState:n,neighborState:i,animation:a}=this.options;if(!t&&!i&&!n)return;const{target:s}=e,{graph:o}=this.context,l=o.getElementData(s.id),u=qd(l).includes(t)?"unselect":"select",c={},h=this.isMultipleSelect,d=[s.id],f=this.getNeighborIds(e);if(h)if(Object.assign(c,this.getDataStates()),u==="select"){const g=(v,p)=>{v.forEach(y=>{const m=new Set(o.getElementState(y));m.add(p),m.delete(n),c[y]=Array.from(m)})};g(d,t),g(f,i),n&&Object.keys(c).forEach(v=>{const p=c[v];!p.includes(t)&&!p.includes(i)&&!p.includes(n)&&c[v].push(n)})}else{const g=c[s.id];c[s.id]=g.filter(v=>v!==t&&v!==i),g.includes(n)||c[s.id].push(n),f.forEach(v=>{c[v]=c[v].filter(p=>p!==i),c[v].includes(t)||c[v].push(n)})}else if(u==="select"){Object.assign(c,this.getClearStates(!!n));const g=(v,p)=>{v.forEach(y=>{c[y]||(c[y]=o.getElementState(y)),c[y].push(p)})};g(d,t),g(f,i),n&&Object.keys(c).forEach(v=>{!d.includes(v)&&!f.includes(v)&&c[v].push(n)})}else Object.assign(c,this.getClearStates());yield o.setElementState(c,a)})}getDataStates(){const{graph:e}=this.context,{nodes:t,edges:n,combos:i}=e.getData(),a={};return[...t,...n,...i].forEach(s=>{a[J(s)]=qd(s)}),a}getClearStates(e=!1){const{graph:t}=this.context,{state:n,unselectedState:i,neighborState:a}=this.options,s=new Set([n,i,a]),{nodes:o,edges:l,combos:u}=t.getData(),c={};return[...o,...l,...u].forEach(h=>{const d=qd(h),f=d.filter(g=>!s.has(g));(e||f.length!==d.length)&&(c[J(h)]=f)}),c}clearState(){return lu(this,void 0,void 0,function*(){const{graph:e}=this.context;yield e.setElementState(this.getClearStates(),this.options.animation)})}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}unbindEvents(){const{graph:e}=this.context;Xa.forEach(t=>{e.off(`${t}:${ie.CLICK}`,this.onClickSelect)}),e.off(Ni.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}}Bc.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};function Jn(r){var e;return!!(!((e=r.style)===null||e===void 0)&&e.collapsed)}function dc(r,e){if(!r.startsWith(e))return!1;const t=r[e.length];return t>="A"&&t<="Z"}function B5(r,e){return`${e}${Ku(r)}`}function z5(r,e,t=!0){if(!e||!dc(r,e))return r;const n=r.slice(e.length);return t?g3(n):n}function en(r,e){const t=Object.entries(r).reduce((n,[i,a])=>(i==="className"||i==="class"||dc(i,e)&&Object.assign(n,{[z5(i,e)]:a}),n),{});if("opacity"in r){const n=B5("opacity",e),i=r.opacity;if(n in r){const a=r[n];Object.assign(t,{opacity:i*a})}else Object.assign(t,{opacity:i})}return t}function Im(r,e){const t=e.length;return Object.keys(r).reduce((n,i)=>{if(i.startsWith(e)){const a=i.slice(t);n[a]=r[i]}return n},{})}function vP(r,e){const t=typeof e=="string"?[e]:e,n={};return Object.keys(r).forEach(i=>{t.find(a=>i.startsWith(a))||(n[i]=r[i])}),n}function dr(r=0){if(typeof r=="number")return[r,r,r];const[e,t=e,n=e]=r;return[e,t,n]}var j5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function tx(r,e){const{datum:t,graph:n}=e;return typeof r=="function"?r.call(n,t):Object.fromEntries(Object.entries(r).map(([i,a])=>typeof a=="function"?[i,a.call(n,t)]:[i,a]))}function mn(r,e){const t=(r==null?void 0:r.style)||{},n=(e==null?void 0:e.style)||{};for(const i in t)i in n||(n[i]=t[i]);return Object.assign({},r,e,{style:n})}function q5(r){const{x:e,y:t,z:n,class:i,className:a,transform:s,transformOrigin:o,zIndex:l,visibility:u}=r;return j5(r,["x","y","z","class","className","transform","transformOrigin","zIndex","visibility"])}function $5(r,e){const t=dr(r);let n={};return e.text&&!e.fontSize&&(n={fontSize:Math.min(...t)*.5}),e.src&&(!e.width||!e.height)&&(n={width:t[0]*.5,height:t[1]*.5}),n}function nx(r){if(r)return typeof r=="string"||typeof r=="function"||Array.isArray(r)?{type:"group",field:e=>e.id,color:r,invert:!1}:r}function G5(r,e){if(!e)return{};const{type:t,color:n,field:i,invert:a}=e,s=l=>{const u=typeof n=="string"?Ri("palette",n):n;if(typeof u=="function"){const c={};return l.forEach(([h,d])=>{c[h]=u(a?1-d:d)}),c}else if(Array.isArray(u)){const c=a?[...u].reverse():u,h={};return l.forEach(([d,f])=>{h[d]=c[f%u.length]}),h}return{}},o=(l,u)=>{var c;return typeof l=="string"?(c=u.data)===null||c===void 0?void 0:c[l]:l==null?void 0:l(u)};if(t==="group"){const l=Ac(r,d=>{if(!i)return"default";const f=o(i,d);return f?String(f):"default"}),u=Object.keys(l),c=s(u.map((d,f)=>[d,f])),h={};return Object.entries(l).forEach(([d,f])=>{f.forEach(g=>{h[J(g)]=c[d]})}),h}else if(t==="value"){const[l,u]=r.reduce(([h,d],f)=>{const g=o(i,f);if(typeof g!="number")throw new Error(Ai(`Palette field ${i} is not a number`));return[Math.min(h,g),Math.max(d,g)]},[1/0,-1/0]),c=u-l;return s(r.map(h=>[h.id,(o(i,h)-l)/c]))}}function yP(r){const e=typeof r=="string"?Ri("palette",r):r;if(typeof e!="function")return e}function mP(r,e){let t=2*r;return typeof e=="string"?t=r*Number(e.replace("%",""))/100:typeof e=="number"&&(t=e),isNaN(t)&&(t=2*r),t}function bP(r,e,t=1,n=!1){const i=n?t:1,a=(r.max[0]-r.min[0])*i;return mP(a,e)}function W5(r,e,t=1){const n=bt(r[0],r[1])*t;return mP(n,e)}class dl extends R1{constructor(e){rx(e.style),super(e),this.shapeMap={},this.animateMap={},this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(e,t,n,i,a){var s,o,l,u,c,h,d,f;const g=this.shapeMap[e];if(n===!1){g&&((s=a==null?void 0:a.beforeDestroy)===null||s===void 0||s.call(a,g),i.removeChild(g),delete this.shapeMap[e],(o=a==null?void 0:a.afterDestroy)===null||o===void 0||o.call(a,g));return}const v=typeof t=="string"?Ri($o.SHAPE,t):t;if(!v)throw new Error(Ai(`Shape ${t} not found`));if(!g||g.destroyed||!(g instanceof v)){g&&((l=a==null?void 0:a.beforeDestroy)===null||l===void 0||l.call(a,g),g==null||g.destroy(),(u=a==null?void 0:a.afterDestroy)===null||u===void 0||u.call(a,g)),(c=a==null?void 0:a.beforeCreate)===null||c===void 0||c.call(a);const p=new v({className:e,style:n});return i.appendChild(p),this.shapeMap[e]=p,(h=a==null?void 0:a.afterCreate)===null||h===void 0||h.call(a,p),p}return(d=a==null?void 0:a.beforeUpdate)===null||d===void 0||d.call(a,g),Gm(g,n),(f=a==null?void 0:a.afterUpdate)===null||f===void 0||f.call(a,g),g}update(e={}){const t=Object.assign({},this.attributes,e);rx(t),zz(this,t),this.render(t,this),this.setVisibility()}bindEvents(){}getGraphicStyle(e){return q5(e)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(e,t){if(e.length===0)return null;const n=[];if(e[0].x!==void 0||e[0].y!==void 0||e[0].z!==void 0){const{x:a=0,y:s=0,z:o=0}=this.attributes;e.forEach(l=>{const{x:u=a,y:c=s,z:h=o}=l;Object.assign(l,{transform:h?[["translate3d",u,c,h]]:[["translate",u,c]]})})}const i=super.animate(e,t);if(i&&($d(this,i),n.push(i)),Array.isArray(e)&&e.length>0){const a=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(e[0]).some(s=>!a.includes(s))){Object.entries(this.shapeMap).forEach(([o,l])=>{const u=`get${Ku(o)}Style`,c=this[u];if(Te(c)){const h=e.map(f=>c.call(this,Object.assign(Object.assign({},this.attributes),f))),d=l.animate(Lm(h),t);d&&($d(l,d),n.push(d))}});const s=(o,l)=>{if(!ai(o)){const u=`get${Ku(l)}Style`,c=this[u];if(Te(c)){const h=e.map(d=>c.call(this,Object.assign(Object.assign({},this.attributes),d)));Object.entries(h[0]).map(([d])=>{const f=h.map(v=>v[d]),g=o[d];if(g){const v=g.animate(Lm(f),t);v&&($d(g,v),n.push(v))}})}}};this.compositeShapes.forEach(([o,l])=>{const u=Im(this.shapeMap,l);s(u,o)})}}return F1(n)}getShape(e){return this.shapeMap[e]}setVisibility(){const{visibility:e}=this.attributes;Ha(this,e)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function $d(r,e){e==null||e.finished.then(()=>{const t=r.activeAnimations.findIndex(n=>n===e);t>-1&&r.activeAnimations.splice(t,1)})}function rx(r){if(!r)return{};if("x"in r||"y"in r||"z"in r){const{x:e=0,y:t=0,z:n,transform:i}=r,a=XA(e,t,n,i);a&&(r.transform=a)}return r}var V5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class ya extends dl{constructor(e){super(mn({style:ya.defaultStyleProps},e))}isTextStyle(e){return dc(e,"label")}isBackgroundStyle(e){return dc(e,"background")}getTextStyle(e){const t=this.getGraphicStyle(e),{padding:n}=t,i=V5(t,["padding"]);return vP(i,"background")}getBackgroundStyle(e){if(e.background===!1)return!1;const t=this.getGraphicStyle(e),{wordWrap:n,wordWrapWidth:i,padding:a}=t,s=en(t,"background"),{min:[o,l],center:[u,c],halfExtents:[h,d]}=this.shapeMap.text.getGeometryBounds(),[f,g,v,p]=pi(a),y=h*2+p+g,{width:m,height:w}=s;m&&w?Object.assign(s,{x:u-Number(m)/2,y:c-Number(w)/2}):Object.assign(s,{x:o-p,y:l-f,width:n?Math.min(y,i+p+g):y,height:d*2+f+v});const{radius:S}=s;if(typeof S=="string"&&S.endsWith("%")){const _=Number(S.replace("%",""))/100;s.radius=Math.min(+s.width,+s.height)*_}return s}render(e=this.parsedAttributes,t=this){this.upsert("text",ts,this.getTextStyle(e),t),this.upsert("background",Mn,this.getBackgroundStyle(e),t)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}}ya.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class Ws extends dl{constructor(e){super(mn({style:Ws.defaultStyleProps},e))}getBadgeStyle(e){return this.getGraphicStyle(e)}render(e=this.parsedAttributes,t=this){this.upsert("label",ya,this.getBadgeStyle(e),t)}getGeometryBounds(){const e=this.getShape("label");return(e.getShape("background")||e.getShape("text")).getGeometryBounds()}}Ws.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};function U5(r,e=!0){const t=[];return r.forEach((n,i)=>{t.push([i===0?"M":"L",...n])}),e&&t.push(["Z"]),t}const ix={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};function H5(r){const e=r.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),t=[];let n="",i={};for(;e.length>0;){let a=e.shift();a in ix?n=a:e.unshift(a),i={type:n},ix[n].forEach(l=>{a=e.shift(),i[l]=a}),n==="M"?n="L":n==="m"&&(n="l");const[s,...o]=Object.values(i);t.push([s,...o.map(Number)])}return t}function Y5(r){const e=[];return(typeof r=="string"?H5(r):r).forEach(n=>{const i=n[0];if(i==="Z"){e.push(e[0]);return}if(i!=="A")for(let a=1;a<n.length;a=a+2)e.push([n[a],n[a+1],0]);else{const a=n.length;e.push([n[a-2],n[a-1],0])}}),e}const wP=r=>{if(r.length<2)return[["M",0,0],["L",0,0]];const e=r[0],t=r[1],n=r[r.length-1],i=r[r.length-2];r.unshift(i,n),r.push(e,t);const a=[["M",n[0],n[1]]];for(let s=1;s<r.length-2;s+=1){const[o,l]=r[s-1],[u,c]=r[s],[h,d]=r[s+1],[f,g]=s!==r.length-2?r[s+2]:[h,d],v=u+(h-o)/6,p=c+(d-l)/6,y=h-(f-u)/6,m=d-(g-c)/6;a.push(["C",v,p,y,m,h,d])}return a};function X5(r,e,t,n,i,a,s){const[o,l]=Mi(r,e),u={textAlign:e==="left"?"right":e==="right"?"left":"center",textBaseline:e==="top"?"bottom":e==="bottom"?"top":"middle",transform:[["translate",o+t,l+n]]};if(e==="center"||!i)return u;const c=Y5(a);if(!c||c.length<=3)return u;const h=c.map((g,v)=>{const p=g,y=c[(v+1)%c.length];return zt(p,y)?null:[p,y]}).filter(Boolean),d=L5([o,l],h),f=gP([o,l],d);if(f&&d&&(u.transform=[["translate",f[0]+t,f[1]+n]],s)){const g=Math.atan((d[0][1]-d[1][1])/(d[0][0]-d[1][0]));u.transform.push(["rotate",g/Math.PI*180]),u.textAlign="center",(e==="right"||e==="left")&&(g>0?u.textBaseline=e==="right"?"bottom":"top":u.textBaseline=e==="right"?"top":"bottom")}return u}var K5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class fl extends dl{constructor(e){super(mn({style:fl.defaultStyleProps},e))}getLabelStyle(e){if(!e.label||!e.d||e.d.length===0)return!1;const t=en(this.getGraphicStyle(e),"label"),{maxWidth:n,offsetX:i,offsetY:a,autoRotate:s,placement:o,closeToPath:l}=t,u=K5(t,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),c=this.shapeMap.key,h=c==null?void 0:c.getRenderBounds();return Object.assign(X5(h,o,i,a,l,e.d,s),{wordWrapWidth:bP(h,n)},u)}getKeyStyle(e){return this.getGraphicStyle(e)}render(e,t){this.upsert("key",ur,this.getKeyStyle(e),t),this.upsert("label",ya,this.getLabelStyle(e),t)}}fl.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};function Z5(r){const e=[],t=n=>{n!=null&&n.children.length&&n.children.forEach(i=>{e.push(i),t(i)})};return t(r),e}function J5(r){const e=[];let t=r.parentNode;for(;t;)e.push(t),t=t.parentNode;return e}let V1=class extends ul{constructor(e){super(e),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},Es=this,this.isMutationObserved=!0,this.addEventListener(Ke.MOUNTED,this.onMounted),this.addEventListener(Ke.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){const{radius:e,clipPath:t,width:n=0,height:i=0}=this.attributes;if(e&&n&&i){const[a,s]=this.getBounds().min,o={x:a,y:s,radius:e,width:n,height:i};if(t)Object.assign(this.parsedStyle.clipPath.style,o);else{const l=new Mn({style:o});this.style.clipPath=l}}else t&&(this.style.clipPath=null)}};const Dm=new WeakMap;let Es=null;const U1=r=>{if(Es&&J5(Es).includes(r)){const e=Dm.get(r);e?e.includes(Es)||e.push(Es):Dm.set(r,[Es])}},H1=r=>{const e=Dm.get(r);e&&e.forEach(t=>t.handleRadius())};class xP extends dl{constructor(e){super(e)}isImage(){const{src:e}=this.attributes;return!!e}getIconStyle(e=this.attributes){const{width:t=0,height:n=0}=e,i=this.getGraphicStyle(e);return this.isImage()?Object.assign({x:-t/2,y:-n/2},i):Object.assign({textBaseline:"middle",textAlign:"center"},i)}render(e=this.attributes,t=this){this.upsert("icon",this.isImage()?V1:ts,this.getIconStyle(e),t)}}class EP extends dl{get context(){return this.config.context}get parsedAttributes(){return this.attributes}onframe(){}animate(e,t){const n=super.animate(e,t);return n&&(n.onframe=()=>this.onframe(),n.finished.then(()=>this.onframe())),n}}var uu=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Vr extends EP{constructor(e){super(mn({style:Vr.defaultStyleProps},e)),this.type="node"}getSize(e=this.attributes){const{size:t}=e;return dr(t)}getKeyStyle(e){const t=this.getGraphicStyle(e);return Object.assign(vP(t,["label","halo","icon","badge","port"]))}getLabelStyle(e){if(e.label===!1||!e.labelText)return!1;const t=en(this.getGraphicStyle(e),"label"),{placement:n,maxWidth:i,offsetX:a,offsetY:s}=t,o=uu(t,["placement","maxWidth","offsetX","offsetY"]),l=this.getShape("key").getLocalBounds();return Object.assign(wx(l,n,a,s),{wordWrapWidth:bP(l,i)},o)}getHaloStyle(e){if(e.halo===!1)return!1;const t=this.getKeyStyle(e),{fill:n}=t,i=uu(t,["fill"]),a=en(this.getGraphicStyle(e),"halo");return Object.assign(Object.assign(Object.assign({},i),{stroke:n}),a)}getIconStyle(e){if(e.icon===!1||!e.iconText&&!e.iconSrc)return!1;const t=en(this.getGraphicStyle(e),"icon");return Object.assign($5(e.size,t),t)}getBadgesStyle(e){var t;const n=Im(this.shapeMap,"badge-"),i={};if(Object.keys(n).forEach(h=>{i[h]=!1}),e.badge===!1||!(!((t=e.badges)===null||t===void 0)&&t.length))return i;const{badges:a=[],badgePalette:s,opacity:o=1}=e,l=uu(e,["badges","badgePalette","opacity"]),u=yP(s),c=en(this.getGraphicStyle(l),"badge");return a.forEach((h,d)=>{i[d]=Object.assign(Object.assign({backgroundFill:u?u[d%(u==null?void 0:u.length)]:void 0,opacity:o},c),this.getBadgeStyle(h))}),i}getBadgeStyle(e){const t=this.getShape("key"),{placement:n="top",offsetX:i,offsetY:a}=e,s=uu(e,["placement","offsetX","offsetY"]),o=wx(t.getLocalBounds(),n,i,a,!0);return Object.assign(Object.assign({},o),s)}getPortsStyle(e){var t;const n=this.getPorts(),i={};if(Object.keys(n).forEach(o=>{i[o]=!1}),e.port===!1||!(!((t=e.ports)===null||t===void 0)&&t.length))return i;const a=en(this.getGraphicStyle(e),"port"),{ports:s=[]}=e;return s.forEach((o,l)=>{const u=o.key||l,c=Object.assign(Object.assign({},a),o);if(GP(c))i[u]=!1;else{const[h,d]=this.getPortXY(e,o);i[u]=Object.assign({transform:[["translate",h,d]]},c)}}),i}getPortXY(e,t){const{placement:n="left"}=t,i=this.getShape("key");return J1(Q5(this.context,i),n)}getPorts(){return Im(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(e,t=!1){const n=this.getShape("key").getBounds();return N5(e,n,t)}drawHaloShape(e,t){const n=this.getHaloStyle(e),i=this.getShape("key");this.upsert("halo",i.constructor,n,t)}drawIconShape(e,t){const n=this.getIconStyle(e);this.upsert("icon",xP,n,t),U1(this)}drawBadgeShapes(e,t){const n=this.getBadgesStyle(e);Object.keys(n).forEach(i=>{const a=n[i];this.upsert(`badge-${i}`,Ws,a,t)})}drawPortShapes(e,t){const n=this.getPortsStyle(e);Object.keys(n).forEach(i=>{const a=n[i],s=`port-${i}`;this.upsert(s,Fi,a,t)})}drawLabelShape(e,t){const n=this.getLabelStyle(e);this.upsert("label",ya,n,t)}_drawKeyShape(e,t){return this.drawKeyShape(e,t)}render(e=this.parsedAttributes,t=this){this._drawKeyShape(e,t),this.getShape("key")&&(this.drawHaloShape(e,t),this.drawIconShape(e,t),this.drawBadgeShapes(e,t),this.drawLabelShape(e,t),this.drawPortShapes(e,t))}update(e){super.update(e),e&&("x"in e||"y"in e||"z"in e)&&H1(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}}Vr.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};function Q5(r,e){if(!r)return e.getLocalBounds();const t=r.canvas.getLayer(),n=e.cloneNode();Ha(n,"hidden"),t.appendChild(n);const i=n.getLocalBounds();return n.destroy(),i}let gl=class SP extends Vr{constructor(e){super(mn({style:SP.defaultStyleProps},e))}drawKeyShape(e,t){return this.upsert("key",Fi,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e);return Object.assign(Object.assign({},t),{r:Math.min(...this.getSize(e))/2})}getIconStyle(e){const t=super.getIconStyle(e),{r:n}=this.getShape("key").attributes,i=n*2*Li;return t?Object.assign({width:i,height:i},t):!1}getIntersectPoint(e,t=!1){const n=this.getShape("key").getBounds();return Fc(e,n,t)}};gl.defaultStyleProps={size:32};class zc extends Vr{constructor(e){super(e)}get parsedAttributes(){return this.attributes}drawKeyShape(e,t){return this.upsert("key",es,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e);return Object.assign(Object.assign({},t),{points:this.getPoints(e)})}getIntersectPoint(e,t=!1){var n,i;const{points:a}=this.getShape("key").attributes,s=[+(((n=this.attributes)===null||n===void 0?void 0:n.x)||0),+(((i=this.attributes)===null||i===void 0?void 0:i.y)||0)];return fP(e,s,a,!0,t).point}}class e4 extends zc{constructor(e){super(e)}getPoints(e){const[t,n]=this.getSize(e);return Fz(t,n)}}var t4=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class jc extends gl{constructor(e){super(mn({style:jc.defaultStyleProps},e))}parseOuterR(){const{size:e}=this.parsedAttributes;return Math.min(...dr(e))/2}parseInnerR(){const{innerR:e}=this.parsedAttributes;return rt(e)?parseInt(e)/100*this.parseOuterR():e}drawDonutShape(e,t){const{donuts:n}=e;if(!(n!=null&&n.length))return;const i=n.map(h=>_e(h)?{value:h}:h),a=en(this.getGraphicStyle(e),"donut"),s=yP(e.donutPalette);if(!s)return;const o=i.reduce((h,d)=>{var f;return h+((f=d.value)!==null&&f!==void 0?f:0)},0),l=this.parseOuterR(),u=this.parseInnerR();let c=0;i.forEach((h,d)=>{const{value:f=0,color:g=s[d%s.length]}=h,v=t4(h,["value","color"]),p=(o===0?1/i.length:f/o)*360;this.upsert(`round${d}`,ur,Object.assign(Object.assign(Object.assign({},a),{d:i4(l,u,c,c+p),fill:g}),v),t),c+=p})}render(e,t=this){super.render(e,t),this.drawDonutShape(e,t)}}jc.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};const cu=(r,e,t,n)=>[r+Math.sin(n)*t,e-Math.cos(n)*t],n4=(r,e,t,n)=>n<=0||t<=n?[["M",r-t,e],["A",t,t,0,1,1,r+t,e],["A",t,t,0,1,1,r-t,e],["Z"]]:[["M",r-t,e],["A",t,t,0,1,1,r+t,e],["A",t,t,0,1,1,r-t,e],["Z"],["M",r+n,e],["A",n,n,0,1,0,r-n,e],["A",n,n,0,1,0,r+n,e],["Z"]],r4=(r,e,t,n,i,a)=>{const[s,o]=[i/360*2*Math.PI,a/360*2*Math.PI],l=[cu(r,e,n,s),cu(r,e,t,s),cu(r,e,t,o),cu(r,e,n,o)],u=o-s>Math.PI?1:0;return[["M",l[0][0],l[0][1]],["L",l[1][0],l[1][1]],["A",t,t,0,u,1,l[2][0],l[2][1]],["L",l[3][0],l[3][1]],["A",n,n,0,u,0,l[0][0],l[0][1]],["Z"]]},i4=(r=0,e=0,t,n)=>{const[i,a]=[0,0];return Math.abs(t-n)%360<1e-6?n4(i,a,r,e):r4(i,a,r,e,t,n)};class qc extends Vr{constructor(e){super(mn({style:qc.defaultStyleProps},e))}drawKeyShape(e,t){return this.upsert("key",ol,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e),[n,i]=this.getSize(e);return Object.assign(Object.assign({},t),{rx:n/2,ry:i/2})}getIconStyle(e){const t=super.getIconStyle(e),{rx:n,ry:i}=this.getShape("key").attributes,a=Math.min(+n,+i)*2*Li;return t?Object.assign({width:a,height:a},t):!1}getIntersectPoint(e,t=!1){const n=this.getShape("key").getBounds();return Fc(e,n,t)}}qc.defaultStyleProps={size:[45,35]};class a4 extends zc{constructor(e){super(e)}getOuterR(e){return e.outerR||Math.min(...this.getSize(e))/2}getPoints(e){return jz(this.getOuterR(e))}getIconStyle(e){const t=super.getIconStyle(e),n=this.getOuterR(e)*Li;return t?Object.assign({width:n,height:n},t):!1}}/*!
 * @antv/g-plugin-canvas-path-generator
 * @description A G plugin of path generator with Canvas2D API
 * @version 2.1.16
 * @date 1/23/2025, 8:32:57 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */function s4(r,e){var t=e.cx,n=t===void 0?0:t,i=e.cy,a=i===void 0?0:i,s=e.r;r.arc(n,a,s,0,Math.PI*2,!1)}function o4(r,e){var t=e.cx,n=t===void 0?0:t,i=e.cy,a=i===void 0?0:i,s=e.rx,o=e.ry;if(r.ellipse)r.ellipse(n,a,s,o,0,0,Math.PI*2,!1);else{var l=s>o?s:o,u=s>o?1:s/o,c=s>o?o/s:1;r.save(),r.scale(u,c),r.arc(n,a,l,0,Math.PI*2)}}function l4(r,e){var t=e.x1,n=e.y1,i=e.x2,a=e.y2,s=e.markerStart,o=e.markerEnd,l=e.markerStartOffset,u=e.markerEndOffset,c=0,h=0,d=0,f=0,g=0,v,p;s&&nt(s)&&l&&(v=i-t,p=a-n,g=Math.atan2(p,v),c=Math.cos(g)*(l||0),h=Math.sin(g)*(l||0)),o&&nt(o)&&u&&(v=t-i,p=n-a,g=Math.atan2(p,v),d=Math.cos(g)*(u||0),f=Math.sin(g)*(u||0)),r.moveTo(t+c,n+h),r.lineTo(i+d,a+f)}function u4(r,e){var t=e.markerStart,n=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,s=e.d,o=s.absolutePath,l=s.segments,u=0,c=0,h=0,d=0,f=0,g,v;if(t&&nt(t)&&i){var p=t.parentNode.getStartTangent(),y=qe(p,2),m=y[0],w=y[1];g=m[0]-w[0],v=m[1]-w[1],f=Math.atan2(v,g),u=Math.cos(f)*(i||0),c=Math.sin(f)*(i||0)}if(n&&nt(n)&&a){var S=n.parentNode.getEndTangent(),_=qe(S,2),O=_[0],T=_[1];g=O[0]-T[0],v=O[1]-T[1],f=Math.atan2(v,g),h=Math.cos(f)*(a||0),d=Math.sin(f)*(a||0)}for(var k=0;k<o.length;k++){var P=o[k],C=P[0],N=o[k+1],L=k===0&&(u!==0||c!==0),F=(k===o.length-1||N&&(N[0]==="M"||N[0]==="Z"))&&h!==0&&d!==0,G=L?[u,c]:[0,0],V=qe(G,2),U=V[0],$=V[1],j=F?[h,d]:[0,0],Z=qe(j,2),ne=Z[0],oe=Z[1];switch(C){case"M":r.moveTo(P[1]+U,P[2]+$);break;case"L":r.lineTo(P[1]+ne,P[2]+oe);break;case"Q":r.quadraticCurveTo(P[1],P[2],P[3]+ne,P[4]+oe);break;case"C":r.bezierCurveTo(P[1],P[2],P[3],P[4],P[5]+ne,P[6]+oe);break;case"A":{var le=l[k].arcParams,Ce=le.cx,K=le.cy,W=le.rx,ee=le.ry,he=le.startAngle,Se=le.endAngle,Ne=le.xRotation,Ue=le.sweepFlag;if(r.ellipse)r.ellipse(Ce,K,W,ee,Ne,he,Se,!!(1-Ue));else{var Tt=W>ee?W:ee,fn=W>ee?1:W/ee,At=W>ee?ee/W:1;r.translate(Ce,K),r.rotate(Ne),r.scale(fn,At),r.arc(0,0,Tt,he,Se,!!(1-Ue)),r.scale(1/fn,1/At),r.rotate(-Ne),r.translate(-Ce,-K)}F&&r.lineTo(P[6]+h,P[7]+d);break}case"Z":r.closePath();break}}}function c4(r,e){var t=e.markerStart,n=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,s=e.points.points,o=s.length,l=s[0][0],u=s[0][1],c=s[o-1][0],h=s[o-1][1],d=0,f=0,g=0,v=0,p=0,y,m;t&&nt(t)&&i&&(y=s[1][0]-s[0][0],m=s[1][1]-s[0][1],p=Math.atan2(m,y),d=Math.cos(p)*(i||0),f=Math.sin(p)*(i||0)),n&&nt(n)&&a&&(y=s[o-1][0]-s[0][0],m=s[o-1][1]-s[0][1],p=Math.atan2(m,y),g=Math.cos(p)*(a||0),v=Math.sin(p)*(a||0)),r.moveTo(l+(d||g),u+(f||v));for(var w=1;w<o-1;w++){var S=s[w];r.lineTo(S[0],S[1])}r.lineTo(c,h)}function h4(r,e){var t=e.markerStart,n=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,s=e.points.points,o=s.length,l=s[0][0],u=s[0][1],c=s[o-1][0],h=s[o-1][1],d=0,f=0,g=0,v=0,p=0,y,m;t&&nt(t)&&i&&(y=s[1][0]-s[0][0],m=s[1][1]-s[0][1],p=Math.atan2(m,y),d=Math.cos(p)*(i||0),f=Math.sin(p)*(i||0)),n&&nt(n)&&a&&(y=s[o-2][0]-s[o-1][0],m=s[o-2][1]-s[o-1][1],p=Math.atan2(m,y),g=Math.cos(p)*(a||0),v=Math.sin(p)*(a||0)),r.moveTo(l+d,u+f);for(var w=1;w<o-1;w++){var S=s[w];r.lineTo(S[0],S[1])}r.lineTo(c+g,h+v)}function d4(r,e){var t=e.x,n=t===void 0?0:t,i=e.y,a=i===void 0?0:i,s=e.radius,o=e.width,l=e.height,u=o,c=l,h=s&&s.some(function(_){return _!==0});if(!h)r.rect(n,a,u,c);else{var d=o>0?1:-1,f=l>0?1:-1,g=d+f===0,v=s.map(function(_){return Bt(_,0,Math.min(Math.abs(u)/2,Math.abs(c)/2))}),p=qe(v,4),y=p[0],m=p[1],w=p[2],S=p[3];r.moveTo(d*y+n,a),r.lineTo(u-d*m+n,a),m!==0&&r.arc(u-d*m+n,f*m+a,m,-f*Math.PI/2,d>0?0:Math.PI,g),r.lineTo(u+n,c-f*w+a),w!==0&&r.arc(u-d*w+n,c-f*w+a,w,d>0?0:Math.PI,f>0?Math.PI/2:1.5*Math.PI,g),r.lineTo(d*S+n,c+a),S!==0&&r.arc(d*S+n,c-f*S+a,S,f>0?Math.PI/2:-Math.PI/2,d>0?Math.PI:0,g),r.lineTo(n,f*y+a),y!==0&&r.arc(d*y+n,f*y+a,y,d>0?Math.PI:0,f>0?Math.PI*1.5:Math.PI/2,g)}}var f4=function(r){function e(){var t;de(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=We(this,e,[].concat(i)),t.name="canvas-path-generator",t}return Ve(e,r),fe(e,[{key:"init",value:function(){var n,i=(n={},Me(Me(Me(Me(Me(Me(Me(Me(Me(Me(n,re.CIRCLE,s4),re.ELLIPSE,o4),re.RECT,d4),re.LINE,l4),re.POLYLINE,h4),re.POLYGON,c4),re.PATH,u4),re.TEXT,void 0),re.GROUP,void 0),re.IMAGE,void 0),Me(Me(Me(n,re.HTML,void 0),re.MESH,void 0),re.FRAGMENT,void 0));this.context.pathGeneratorFactory=i}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory}}])}(ga);/*!
 * @antv/g-plugin-canvas-picker
 * @description A G plugin for picking in canvas
 * @version 2.1.19
 * @date 2/27/2025, 8:28:58 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var g4=Qe(),p4=Qe(),v4=Qe(),y4=gt(),_P=function(){function r(){var e=this;de(this,r),this.isHit=function(t,n,i,a){var s=e.context.pointInPathPickerFactory[t.nodeName];if(s){var o=si(y4,i),l=In(p4,Nn(v4,n[0],n[1],0),o);if(s(t,new En(l[0],l[1]),a,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(t,n){var i=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),a=e.context.pathGeneratorFactory[t.nodeName];return a&&(i.beginPath(),a(i,t.parsedStyle),i.closePath()),i.isPointInPath(n.x,n.y)}}return fe(r,[{key:"apply",value:function(t,n){var i,a=this,s=t.renderingService,o=t.renderingContext;this.context=t,this.runtime=n;var l=(i=o.root)===null||i===void 0?void 0:i.ownerDocument;s.hooks.pick.tapPromise(r.tag,function(){var u=ha(_n().mark(function c(h){return _n().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",a.pick(l,h));case 1:case"end":return f.stop()}},c)}));return function(c){return u.apply(this,arguments)}}()),s.hooks.pickSync.tap(r.tag,function(u){return a.pick(l,u)})}},{key:"pick",value:function(t,n){var i=n.topmost,a=n.position,s=a.x,o=a.y,l=Nn(g4,s,o,0),u=t.elementsFromBBox(l[0],l[1],l[0],l[1]),c=[],h=Aa(u),d;try{for(h.s();!(d=h.n()).done;){var f=d.value,g=f.getWorldTransform(),v=this.isHit(f,l,g,!1);if(v){var p=OA(f);if(p){var y=p.parsedStyle.clipPath,m=this.isHit(y,l,y.getWorldTransform(),!0);if(m){if(i)return n.picked=[f],n;c.push(f)}}else{if(i)return n.picked=[f],n;c.push(f)}}}}catch(w){h.e(w)}finally{h.f()}return n.picked=c,n}}])}();_P.tag="CanvasPicker";function m4(r,e,t){var n=r.parsedStyle,i=n.cx,a=i===void 0?0:i,s=n.cy,o=s===void 0?0:s,l=n.r,u=n.fill,c=n.stroke,h=n.lineWidth,d=h===void 0?1:h,f=n.increasedLineWidthForHitTesting,g=f===void 0?0:f,v=n.pointerEvents,p=v===void 0?"auto":v,y=(d+g)/2,m=Pi(a,o,e.x,e.y),w=Qa(p,u,c),S=qe(w,2),_=S[0],O=S[1];return _&&O||t?m<=l+y:_?m<=l:O?m>=l-y&&m<=l+y:!1}function hu(r,e,t,n){return r/(t*t)+e/(n*n)}function b4(r,e,t){var n=r.parsedStyle,i=n.cx,a=i===void 0?0:i,s=n.cy,o=s===void 0?0:s,l=n.rx,u=n.ry,c=n.fill,h=n.stroke,d=n.lineWidth,f=d===void 0?1:d,g=n.increasedLineWidthForHitTesting,v=g===void 0?0:g,p=n.pointerEvents,y=p===void 0?"auto":p,m=e.x,w=e.y,S=Qa(y,c,h),_=qe(S,2),O=_[0],T=_[1],k=(f+v)/2,P=(m-a)*(m-a),C=(w-o)*(w-o);return O&&T||t?hu(P,C,l+k,u+k)<=1:O?hu(P,C,l,u)<=1:T?hu(P,C,l-k,u-k)>=1&&hu(P,C,l+k,u+k)<=1:!1}function Ra(r,e,t,n,i,a){return i>=r&&i<=r+t&&a>=e&&a<=e+n}function w4(r,e,t,n,i,a,s){var o=i/2;return Ra(r-o,e-o,t,i,a,s)||Ra(r+t-o,e-o,i,n,a,s)||Ra(r+o,e+n-o,t,i,a,s)||Ra(r-o,e+o,i,n,a,s)}function du(r,e,t,n,i,a,s,o){var l=(Math.atan2(o-e,s-r)+Math.PI*2)%(Math.PI*2),u={x:r+t*Math.cos(l),y:e+t*Math.sin(l)};return Pi(u.x,u.y,s,o)<=a/2}function ea(r,e,t,n,i,a,s){var o=Math.min(r,t),l=Math.max(r,t),u=Math.min(e,n),c=Math.max(e,n),h=i/2;return a>=o-h&&a<=l+h&&s>=u-h&&s<=c+h?hI(r,e,t,n,a,s)<=i/2:!1}function MP(r,e,t,n,i){var a=r.length;if(a<2)return!1;for(var s=0;s<a-1;s++){var o=r[s][0],l=r[s][1],u=r[s+1][0],c=r[s+1][1];if(ea(o,l,u,c,e,t,n))return!0}if(i){var h=r[0],d=r[a-1];if(ea(h[0],h[1],d[0],d[1],e,t,n))return!0}return!1}var x4=1e-6;function Gd(r){return Math.abs(r)<x4?0:r<0?-1:1}function E4(r,e,t){return(t[0]-r[0])*(e[1]-r[1])===(e[0]-r[0])*(t[1]-r[1])&&Math.min(r[0],e[0])<=t[0]&&t[0]<=Math.max(r[0],e[0])&&Math.min(r[1],e[1])<=t[1]&&t[1]<=Math.max(r[1],e[1])}function OP(r,e,t){var n=!1,i=r.length;if(i<=2)return!1;for(var a=0;a<i;a++){var s=r[a],o=r[(a+1)%i];if(E4(s,o,[e,t]))return!0;Gd(s[1]-t)>0!=Gd(o[1]-t)>0&&Gd(e-(t-s[1])*(s[0]-o[0])/(s[1]-o[1])-s[0])<0&&(n=!n)}return n}function ax(r,e,t){for(var n=!1,i=0;i<r.length;i++){var a=r[i];if(n=OP(a,e,t),n)break}return n}function S4(r,e,t){var n=r.parsedStyle,i=n.x1,a=n.y1,s=n.x2,o=n.y2,l=n.lineWidth,u=l===void 0?1:l,c=n.increasedLineWidthForHitTesting,h=c===void 0?0:c,d=n.pointerEvents,f=d===void 0?"auto":d,g=n.fill,v=n.stroke,p=Qa(f,g,v),y=qe(p,2),m=y[1];return!m&&!t||!u?!1:ea(i,a,s,o,u+h,e.x,e.y)}function _4(r,e,t,n,i){for(var a=!1,s=e/2,o=0;o<r.length;o++){var l=r[o],u=l.currentPoint,c=l.params,h=l.prePoint,d=l.box;if(!(d&&!Ra(d.x-s,d.y-s,d.width+e,d.height+e,t,n)))switch(l.command){case"L":case"Z":if(a=ea(h[0],h[1],u[0],u[1],e,t,n),a)return!0;break;case"Q":var f=mI(h[0],h[1],c[1],c[2],c[3],c[4],t,n);if(a=f<=e/2,a)return!0;break;case"C":var g=ow(h[0],h[1],c[1],c[2],c[3],c[4],c[5],c[6],t,n,i);if(a=g<=e/2,a)return!0;break;case"A":l.cubicParams||(l.cubicParams=_1(h[0],h[1],c[1],c[2],c[3],c[4],c[5],c[6],c[7],void 0));for(var v=l.cubicParams,p=h,y=0;y<v.length;y+=6){var m=ow(p[0],p[1],v[y],v[y+1],v[y+2],v[y+3],v[y+4],v[y+5],t,n,i);if(p=[v[y+4],v[y+5]],a=m<=e/2,a)return!0}break}}return a}function M4(r,e,t,n,i,a){var s=r.parsedStyle,o=s.lineWidth,l=o===void 0?1:o,u=s.increasedLineWidthForHitTesting,c=u===void 0?0:u,h=s.stroke,d=s.fill,f=s.d,g=s.pointerEvents,v=g===void 0?"auto":g,p=f.segments,y=f.hasArc,m=f.polylines,w=f.polygons,S=Qa(v,(w==null?void 0:w.length)&&d,h),_=qe(S,2),O=_[0],T=_[1],k=Mm(r),P=!1;return O||t?(y?P=n(r,e):P=ax(w,e.x,e.y)||ax(m,e.x,e.y),P):((T||t)&&(P=_4(p,l+c,e.x,e.y,k)),P)}function O4(r,e,t){var n=r.parsedStyle,i=n.stroke,a=n.fill,s=n.lineWidth,o=s===void 0?1:s,l=n.increasedLineWidthForHitTesting,u=l===void 0?0:l,c=n.points,h=n.pointerEvents,d=h===void 0?"auto":h,f=Qa(d,a,i),g=qe(f,2),v=g[0],p=g[1],y=!1;return(p||t)&&(y=MP(c.points,o+u,e.x,e.y,!0)),!y&&(v||t)&&(y=OP(c.points,e.x,e.y)),y}function k4(r,e,t){var n=r.parsedStyle,i=n.lineWidth,a=i===void 0?1:i,s=n.increasedLineWidthForHitTesting,o=s===void 0?0:s,l=n.points,u=n.pointerEvents,c=u===void 0?"auto":u,h=n.fill,d=n.stroke,f=Qa(c,h,d),g=qe(f,2),v=g[1];return!v&&!t||!a?!1:MP(l.points,a+o,e.x,e.y,!1)}function T4(r,e,t,n,i){var a=r.parsedStyle,s=a.radius,o=a.fill,l=a.stroke,u=a.lineWidth,c=u===void 0?1:u,h=a.increasedLineWidthForHitTesting,d=h===void 0?0:h,f=a.x,g=f===void 0?0:f,v=a.y,p=v===void 0?0:v,y=a.width,m=a.height,w=a.pointerEvents,S=w===void 0?"auto":w,_=Qa(S,o,l),O=qe(_,2),T=O[0],k=O[1],P=s&&s.some(function(F){return F!==0}),C=c+d;if(P){var L=!1;return(k||t)&&(L=A4(g,p,y,m,s.map(function(F){return Bt(F,0,Math.min(Math.abs(y)/2,Math.abs(m)/2))}),C,e.x,e.y)),!L&&(T||t)&&(L=n(r,e)),L}else{var N=C/2;if(T&&k||t)return Ra(g-N,p-N,y+N,m+N,e.x,e.y);if(T)return Ra(g,p,y,m,e.x,e.y);if(k)return w4(g,p,y,m,C,e.x,e.y)}return!1}function A4(r,e,t,n,i,a,s,o){var l=qe(i,4),u=l[0],c=l[1],h=l[2],d=l[3];return ea(r+u,e,r+t-c,e,a,s,o)||ea(r+t,e+c,r+t,e+n-h,a,s,o)||ea(r+t-h,e+n,r+d,e+n,a,s,o)||ea(r,e+n-d,r,e+u,a,s,o)||du(r+t-c,e+c,c,1.5*Math.PI,2*Math.PI,a,s,o)||du(r+t-h,e+n-h,h,0,.5*Math.PI,a,s,o)||du(r+d,e+n-d,d,.5*Math.PI,Math.PI,a,s,o)||du(r+u,e+u,u,Math.PI,1.5*Math.PI,a,s,o)}function P4(r,e,t,n,i,a){var s=r.parsedStyle,o=s.pointerEvents,l=o===void 0?"auto":o,u=s.x,c=u===void 0?0:u,h=s.y,d=h===void 0?0:h,f=s.width,g=s.height;if(l==="non-transparent-pixel"){var v=i.config.offscreenCanvas,p=a.offscreenCanvasCreator.getOrCreateCanvas(v),y=a.offscreenCanvasCreator.getOrCreateContext(v,{willReadFrequently:!0});p.width=f,p.height=g,i.defaultStyleRendererFactory[re.IMAGE].render(y,Ge(Ge({},r.parsedStyle),{},{x:0,y:0}),r,void 0,void 0,void 0);var m=y.getImageData(e.x-c,e.y-d,1,1).data;return m.every(function(w){return w!==0})}return!0}function C4(r,e,t,n){var i=r.getGeometryBounds();return e.x>=i.min[0]&&e.y>=i.min[1]&&e.x<=i.max[0]&&e.y<=i.max[1]}var N4=function(r){function e(){var t;de(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=We(this,e,[].concat(i)),t.name="canvas-picker",t}return Ve(e,r),fe(e,[{key:"init",value:function(){var n,i=(n={},Me(Me(Me(Me(Me(Me(Me(Me(Me(Me(n,re.CIRCLE,m4),re.ELLIPSE,b4),re.RECT,T4),re.LINE,S4),re.POLYLINE,k4),re.POLYGON,O4),re.PATH,M4),re.TEXT,C4),re.GROUP,null),re.IMAGE,P4),Me(Me(n,re.HTML,null),re.MESH,null));this.context.pointInPathPickerFactory=i,this.addRenderingPlugin(new _P)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(ga);function ti(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var R4=0;function L4(r){return"__private_"+R4+++"_"+r}/*!
 * @antv/g-plugin-image-loader
 * @description A G plugin for loading image
 * @version 2.1.19
 * @date 2/27/2025, 8:27:22 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var I4=function(){function r(){de(this,r),this.cacheStore=new Map}return fe(r,[{key:"onRefAdded",value:function(t){}},{key:"has",value:function(t){return this.cacheStore.has(t)}},{key:"put",value:function(t,n,i){return this.cacheStore.has(t)?!1:(this.cacheStore.set(t,{value:n,counter:new Set([i])}),this.onRefAdded(i),!0)}},{key:"get",value:function(t,n){var i=this.cacheStore.get(t);return i?(i.counter.has(n)||(i.counter.add(n),this.onRefAdded(n)),i.value):null}},{key:"update",value:function(t,n,i){var a=this.cacheStore.get(t);return a?(a.value=Ge(Ge({},a.value),n),a.counter.has(i)||(a.counter.add(i),this.onRefAdded(i)),!0):!1}},{key:"release",value:function(t,n){var i=this.cacheStore.get(t);return i?(i.counter.delete(n),i.counter.size<=0&&this.cacheStore.delete(t),!0):!1}},{key:"releaseRef",value:function(t){var n=this;Array.from(this.cacheStore.keys()).forEach(function(i){n.release(i,t)})}},{key:"getSize",value:function(){return this.cacheStore.size}},{key:"clear",value:function(){this.cacheStore.clear()}}])}(),Wd=[],Vd=[],Fm=function(){function r(){de(this,r)}return fe(r,null,[{key:"stop",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:r.api;r.rafId&&(t.cancelAnimationFrame(r.rafId),r.rafId=null)}},{key:"executeTask",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:r.api;Wd.length<=0&&Vd.length<=0||(Vd.forEach(function(n){return n()}),Vd=Wd.splice(0,r.TASK_NUM_PER_FRAME),r.rafId=t.requestAnimationFrame(function(){r.executeTask(t)}))}},{key:"sliceImage",value:function(t,n,i,a){for(var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:r.api,l=t.naturalWidth||t.width,u=t.naturalHeight||t.height,c=n-s,h=i-s,d=Math.ceil(l/c),f=Math.ceil(u/h),g={tileSize:[n,i],gridSize:[f,d],tiles:Array(f).fill(null).map(function(){return Array(d).fill(null)})},v=function(m){for(var w=function(O){Wd.push(function(){var T=O*c,k=m*h,P=[Math.min(n,l-T),Math.min(i,u-k)],C=P[0],N=P[1],L=o.createCanvas();L.width=n,L.height=i;var F=L.getContext("2d");F.drawImage(t,T,k,C,N,0,0,C,N),g.tiles[m][O]={x:T,y:k,tileX:O,tileY:m,data:L},a()})},S=0;S<d;S++)w(S)},p=0;p<f;p++)v(p);return r.stop(),r.executeTask(),g}}])}();Fm.TASK_NUM_PER_FRAME=10;var ir=new I4;ir.onRefAdded=function(e){var t=this;e.addEventListener(Ke.DESTROY,function(){t.releaseRef(e)},{once:!0})};var Y1=function(){function r(e,t){de(this,r),this.gradientCache={},this.patternCache={},this.context=e,this.runtime=t}return fe(r,[{key:"getImageSync",value:function(t,n,i){var a=rt(t)?t:t.src;if(ir.has(a)){var s=ir.get(a,n);if(s.img.complete)return i==null||i(s),s}return this.getOrCreateImage(t,n).then(function(o){i==null||i(o)}).catch(function(o){console.error(o)}),null}},{key:"getOrCreateImage",value:function(t,n){var i=this,a=rt(t)?t:t.src;if(!rt(t)&&!ir.has(a)){var s={img:t,size:[t.naturalWidth||t.width,t.naturalHeight||t.height],tileSize:fu(t)};ir.put(a,s,n)}if(ir.has(a)){var o=ir.get(a,n);return o.img.complete?Promise.resolve(o):new Promise(function(l,u){o.img.addEventListener("load",function(){o.size=[o.img.naturalWidth||o.img.width,o.img.naturalHeight||o.img.height],o.tileSize=fu(o.img),l(o)}),o.img.addEventListener("error",function(c){u(c)})})}return new Promise(function(l,u){var c=i.context.config.createImage();if(c){var h={img:c,size:[0,0],tileSize:fu(c)};ir.put(a,h,n),c.onload=function(){h.size=[c.naturalWidth||c.width,c.naturalHeight||c.height],h.tileSize=fu(h.img),l(h)},c.onerror=function(d){u(d)},c.crossOrigin="Anonymous",c.src=a}})}},{key:"createDownSampledImage",value:function(){var e=ha(_n().mark(function n(i,a){var s,o,l,u,c,h,d,f,g,v,p,y,m,w;return _n().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this.getOrCreateImage(i,a);case 2:if(s=_.sent,!(typeof s.downSamplingRate<"u")){_.next=5;break}return _.abrupt("return",s);case 5:if(o=this.context.config.enableLargeImageOptimization,l=typeof o=="boolean"?{}:o,u=l.maxDownSampledImageSize,c=u===void 0?2048:u,h=l.downSamplingRateThreshold,d=h===void 0?.5:h,f=this.runtime.globalThis.createImageBitmap,g=qe(s.size,2),v=g[0],p=g[1],y=s.img,m=Math.min((c+c)/(v+p),Math.max(.01,Math.min(d,.5))),w=Ge(Ge({},s),{},{downSamplingRate:m}),ir.update(s.img.src,w,a),!f){_.next=25;break}return _.prev=14,_.next=17,f(s.img,{resizeWidth:v*m,resizeHeight:p*m});case 17:y=_.sent,_.next=23;break;case 20:_.prev=20,_.t0=_.catch(14),m=1;case 23:_.next=26;break;case 25:m=1;case 26:return w=Ge(Ge({},this.getImageSync(i,a)),{},{downSampled:y,downSamplingRate:m}),ir.update(s.img.src,w,a),_.abrupt("return",w);case 29:case"end":return _.stop()}},n,this,[[14,20]])}));function t(n,i){return e.apply(this,arguments)}return t}()},{key:"createImageTiles",value:function(){var e=ha(_n().mark(function n(i,a,s,o){var l,u,c,h,d;return _n().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.getOrCreateImage(i,o);case 2:return l=g.sent,u=o.ownerDocument.defaultView,c=u.requestAnimationFrame,h=u.cancelAnimationFrame,Fm.api={requestAnimationFrame:c,cancelAnimationFrame:h,createCanvas:function(){return N1.createCanvas()}},d=Ge(Ge({},l),Fm.sliceImage(l.img,l.tileSize[0],l.tileSize[0],s)),ir.update(l.img.src,d,o),g.abrupt("return",d);case 8:case"end":return g.stop()}},n,this)}));function t(n,i,a,s){return e.apply(this,arguments)}return t}()},{key:"releaseImage",value:function(t,n){ir.release(rt(t)?t:t.src,n)}},{key:"releaseImageRef",value:function(t){ir.releaseRef(t)}},{key:"getOrCreatePatternSync",value:function(t,n,i,a,s,o,l){var u=this.generatePatternKey(n);if(u&&this.patternCache[u])return this.patternCache[u];var c=n.image,h=n.repetition,d=n.transform,f,g=!1;if(rt(c)){var v=this.getImageSync(c,t,l);f=v==null?void 0:v.img}else a?(f=a,g=!0):f=c;var p=f&&i.createPattern(f,h);if(p){var y;d?y=CA(EA(d),new wt({})):y=ua(gt()),g&&OT(y,y,[1/s,1/s,1]),p.setTransform({a:y[0],b:y[1],c:y[4],d:y[5],e:y[12]+o[0],f:y[13]+o[1]})}return u&&p&&(this.patternCache[u]=p),p}},{key:"getOrCreateGradient",value:function(t,n){var i=this.generateGradientKey(t),a=t.type,s=t.steps,o=t.min,l=t.width,u=t.height,c=t.angle,h=t.cx,d=t.cy,f=t.size;if(this.gradientCache[i])return this.gradientCache[i];var g=null;if(a===Zi.LinearGradient){var v=fD(o,l,u,c),p=v.x1,y=v.y1,m=v.x2,w=v.y2;g=n.createLinearGradient(p,y,m,w)}else if(a===Zi.RadialGradient){var S=gD(o,l,u,h,d,f),_=S.x,O=S.y,T=S.r;g=n.createRadialGradient(_,O,0,_,O,T)}return g&&(s.forEach(function(k){var P=k.offset,C=k.color;if(P.unit===xe.kPercentage){var N;(N=g)===null||N===void 0||N.addColorStop(P.value/100,C.toString())}}),this.gradientCache[i]=g),this.gradientCache[i]}},{key:"generateGradientKey",value:function(t){var n=t.type,i=t.min,a=t.width,s=t.height,o=t.steps,l=t.angle,u=t.cx,c=t.cy,h=t.size;return"gradient-".concat(n,"-").concat((l==null?void 0:l.toString())||0,"-").concat((u==null?void 0:u.toString())||0,"-").concat((c==null?void 0:c.toString())||0,"-").concat((h==null?void 0:h.toString())||0,"-").concat(i[0],"-").concat(i[1],"-").concat(a,"-").concat(s,"-").concat(o.map(function(d){var f=d.offset,g=d.color;return"".concat(f).concat(g)}).join("-"))}},{key:"generatePatternKey",value:function(t){var n=t.image,i=t.repetition;if(rt(n))return"pattern-".concat(n,"-").concat(i);if(n.nodeName==="rect")return"pattern-".concat(n.entity,"-").concat(i)}}])}();Y1.isSupportTile=!!N1.createCanvas();function fu(r){if(!r.complete)return[0,0];var e=r.naturalWidth||r.width,t=r.naturalHeight||r.height,n=256;return[256,512].forEach(function(i){var a=Math.ceil(t/i),s=Math.ceil(e/i);a*s<1e3&&(n=i)}),[n,n]}var kP=function(){function r(){de(this,r)}return fe(r,[{key:"apply",value:function(t){var n=t.renderingService,i=t.renderingContext,a=t.imagePool,s=i.root.ownerDocument.defaultView,o=function(h,d,f){var g=h.parsedStyle,v=g.width,p=g.height;v&&!p?h.setAttribute("height",f/d*v):!v&&p&&h.setAttribute("width",d/f*p)},l=function(h){var d=h.target,f=d.nodeName,g=d.attributes;if(f===re.IMAGE){var v=g.src,p=g.keepAspectRatio;a.getImageSync(v,d,function(y){var m=y.img,w=m.width,S=m.height;p&&o(d,w,S),d.renderable.dirty=!0,n.dirtify()})}},u=function(h){var d=h.target,f=h.attrName,g=h.prevValue,v=h.newValue;d.nodeName!==re.IMAGE||f!=="src"||(g!==v&&a.releaseImage(g,d),rt(v)&&a.getOrCreateImage(v,d).then(function(p){var y=p.img,m=y.width,w=y.height;d.attributes.keepAspectRatio&&o(d,m,w),d.renderable.dirty=!0,n.dirtify()}).catch(function(){}))};n.hooks.init.tap(r.tag,function(){s.addEventListener(Ke.MOUNTED,l),s.addEventListener(Ke.ATTR_MODIFIED,u)}),n.hooks.destroy.tap(r.tag,function(){s.removeEventListener(Ke.MOUNTED,l),s.removeEventListener(Ke.ATTR_MODIFIED,u)})}}])}();kP.tag="LoadImage";var D4=function(r){function e(){var t;de(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=We(this,e,[].concat(i)),t.name="image-loader",t}return Ve(e,r),fe(e,[{key:"init",value:function(n){this.context.imagePool=new Y1(this.context,n),this.addRenderingPlugin(new kP)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(ga);/*!
 * @antv/g-plugin-canvas-renderer
 * @description A G plugin of renderer implementation with Canvas2D API
 * @version 2.2.19
 * @date 2/27/2025, 8:28:07 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var Vt=L4("renderState"),TP=function(){function r(e){de(this,r),this.removedRBushNodeAABBs=[],this.renderQueue=[],Object.defineProperty(this,Vt,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=gt(),this.dprMatrix=gt(),this.tmpMat4=gt(),this.vec3a=Qe(),this.vec3b=Qe(),this.vec3c=Qe(),this.vec3d=Qe(),this.canvasRendererPluginOptions=e}return fe(r,[{key:"apply",value:function(t,n){var i=this;this.context=t;var a=this.context,s=a.config,o=a.camera,l=a.renderingService,u=a.renderingContext,c=a.rBushRoot,h=a.pathGeneratorFactory,d=s.renderer.getConfig().enableRenderingOptimization;s.renderer.getConfig().enableDirtyCheck=!1,s.renderer.getConfig().enableDirtyRectangleRendering=!1,this.rBush=c,this.pathGeneratorFactory=h;var f=t.contextService,g=u.root.ownerDocument.defaultView,v=function(w){var S=w.target,_=S.rBushNode;_.aabb&&i.removedRBushNodeAABBs.push(_.aabb)},p=function(w){var S=w.target,_=S.rBushNode;_.aabb&&i.removedRBushNodeAABBs.push(_.aabb)};l.hooks.init.tap(r.tag,function(){g.addEventListener(Ke.UNMOUNTED,v),g.addEventListener(Ke.CULLED,p);var m=f.getDPR(),w=s.width,S=s.height,_=f.getContext();i.clearRect(_,0,0,w*m,S*m,s.background)}),l.hooks.destroy.tap(r.tag,function(){g.removeEventListener(Ke.UNMOUNTED,v),g.removeEventListener(Ke.CULLED,p),i.renderQueue=[],i.removedRBushNodeAABBs=[],ti(i,Vt)[Vt]={restoreStack:[],prevObject:null,currentContext:null}}),l.hooks.beginFrame.tap(r.tag,function(){var m,w=f.getContext(),S=f.getDPR(),_=s.width,O=s.height,T=i.canvasRendererPluginOptions,k=T.dirtyObjectNumThreshold,P=T.dirtyObjectRatioThreshold,C=l.getStats(),N=C.total,L=C.rendered,F=L/N;i.clearFullScreen=i.clearFullScreenLastFrame||!((m=g.context.renderingPlugins[1])!==null&&m!==void 0&&m.isFirstTimeRenderingFinished)||l.disableDirtyRectangleRendering()||L>k&&F>P,w&&(typeof w.resetTransform=="function"?w.resetTransform():w.setTransform(1,0,0,1,0,0),i.clearFullScreen&&i.clearRect(w,0,0,_*S,O*S,s.background))});var y=function(w,S){for(var _=[w];_.length>0;){var O=_.pop();O.isVisible()&&!O.isCulled()&&(d?i.renderDisplayObjectOptimized(O,S,i.context,ti(i,Vt)[Vt],n):i.renderDisplayObject(O,S,i.context,ti(i,Vt)[Vt],n));for(var T=O.sortable.sorted||O.childNodes,k=T.length-1;k>=0;k--)_.push(T[k])}};l.hooks.endFrame.tap(r.tag,function(){if(u.root.childNodes.length===0){i.clearFullScreenLastFrame=!0;return}d=s.renderer.getConfig().enableRenderingOptimization,ti(i,Vt)[Vt]={restoreStack:[],prevObject:null,currentContext:ti(i,Vt)[Vt].currentContext},ti(i,Vt)[Vt].currentContext.clear(),i.clearFullScreenLastFrame=!1;var m=f.getContext(),w=f.getDPR();if(Ta(i.dprMatrix,[w,w,1]),Ln(i.vpMatrix,i.dprMatrix,o.getOrthoMatrix()),i.clearFullScreen)d?(m.save(),y(u.root,m),m.restore()):y(u.root,m),i.removedRBushNodeAABBs=[];else{var S=i.safeMergeAABB.apply(i,[i.mergeDirtyAABBs(i.renderQueue)].concat(yt(i.removedRBushNodeAABBs.map(function(W){var ee=W.minX,he=W.minY,Se=W.maxX,Ne=W.maxY,Ue=new pt;return Ue.setMinMax([ee,he,0],[Se,Ne,0]),Ue}))));if(i.removedRBushNodeAABBs=[],pt.isEmpty(S)){i.renderQueue=[];return}var _=i.convertAABB2Rect(S),O=_.x,T=_.y,k=_.width,P=_.height,C=In(i.vec3a,[O,T,0],i.vpMatrix),N=In(i.vec3b,[O+k,T,0],i.vpMatrix),L=In(i.vec3c,[O,T+P,0],i.vpMatrix),F=In(i.vec3d,[O+k,T+P,0],i.vpMatrix),G=Math.min(C[0],N[0],F[0],L[0]),V=Math.min(C[1],N[1],F[1],L[1]),U=Math.max(C[0],N[0],F[0],L[0]),$=Math.max(C[1],N[1],F[1],L[1]),j=Math.floor(G),Z=Math.floor(V),ne=Math.ceil(U-G),oe=Math.ceil($-V);m.save(),i.clearRect(m,j,Z,ne,oe,s.background),m.beginPath(),m.rect(j,Z,ne,oe),m.clip(),m.setTransform(i.vpMatrix[0],i.vpMatrix[1],i.vpMatrix[4],i.vpMatrix[5],i.vpMatrix[12],i.vpMatrix[13]);var le=s.renderer.getConfig(),Ce=le.enableDirtyRectangleRenderingDebug;Ce&&g.dispatchEvent(new Jt(or.DIRTY_RECTANGLE,{dirtyRect:{x:j,y:Z,width:ne,height:oe}}));var K=i.searchDirtyObjects(S);K.sort(function(W,ee){return W.sortable.renderOrder-ee.sortable.renderOrder}).forEach(function(W){W&&W.isVisible()&&!W.isCulled()&&i.renderDisplayObject(W,m,i.context,ti(i,Vt)[Vt],n)}),m.restore(),i.renderQueue.forEach(function(W){i.saveDirtyAABB(W)}),i.renderQueue=[]}ti(i,Vt)[Vt].restoreStack.forEach(function(){m.restore()}),ti(i,Vt)[Vt].restoreStack=[]}),l.hooks.render.tap(r.tag,function(m){i.clearFullScreen||i.renderQueue.push(m)})}},{key:"clearRect",value:function(t,n,i,a,s,o){t.clearRect(n,i,a,s),o&&(t.fillStyle=o,t.fillRect(n,i,a,s))}},{key:"renderDisplayObjectOptimized",value:function(t,n,i,a,s){var o=t.nodeName,l=!1,u=!1,c=this.context.styleRendererFactory[o],h=this.pathGeneratorFactory[o],d=t.parsedStyle.clipPath;if(d){l=!a.prevObject||!om(d.getWorldTransform(),a.prevObject.getWorldTransform()),l&&(this.applyWorldTransform(n,d),a.prevObject=null);var f=this.pathGeneratorFactory[d.nodeName];f&&(n.save(),u=!0,n.beginPath(),f(n,d.parsedStyle),n.closePath(),n.clip())}if(c){l=!a.prevObject||!om(t.getWorldTransform(),a.prevObject.getWorldTransform()),l&&this.applyWorldTransform(n,t);var g=!a.prevObject;if(!g){var v=a.prevObject.nodeName;o===re.TEXT?g=v!==re.TEXT:o===re.IMAGE?g=v!==re.IMAGE:g=v===re.TEXT||v===re.IMAGE}c.applyStyleToContext(n,t,g,a),a.prevObject=t}h&&(n.beginPath(),h(n,t.parsedStyle),o!==re.LINE&&o!==re.PATH&&o!==re.POLYLINE&&n.closePath()),c&&c.drawToContext(n,t,ti(this,Vt)[Vt],this,s),u&&n.restore(),t.renderable.dirty=!1}},{key:"renderDisplayObject",value:function(t,n,i,a,s){var o=t.nodeName,l=a.restoreStack[a.restoreStack.length-1];l&&!(t.compareDocumentPosition(l)&Rt.DOCUMENT_POSITION_CONTAINS)&&(n.restore(),a.restoreStack.pop());var u=this.context.styleRendererFactory[o],c=this.pathGeneratorFactory[o],h=t.parsedStyle.clipPath;if(h){this.applyWorldTransform(n,h);var d=this.pathGeneratorFactory[h.nodeName];d&&(n.save(),a.restoreStack.push(t),n.beginPath(),d(n,h.parsedStyle),n.closePath(),n.clip())}u&&(this.applyWorldTransform(n,t),n.save(),this.applyAttributesToContext(n,t)),c&&(n.beginPath(),c(n,t.parsedStyle),o!==re.LINE&&o!==re.PATH&&o!==re.POLYLINE&&n.closePath()),u&&(u.render(n,t.parsedStyle,t,i,this,s),n.restore()),t.renderable.dirty=!1}},{key:"applyAttributesToContext",value:function(t,n){var i=n.parsedStyle,a=i.stroke,s=i.fill,o=i.opacity,l=i.lineDash,u=i.lineDashOffset;l&&t.setLineDash(l),Le(u)||(t.lineDashOffset=u),Le(o)||(t.globalAlpha*=o),!Le(a)&&!Array.isArray(a)&&!a.isNone&&(t.strokeStyle=n.attributes.stroke),!Le(s)&&!Array.isArray(s)&&!s.isNone&&(t.fillStyle=n.attributes.fill)}},{key:"convertAABB2Rect",value:function(t){var n=t.getMin(),i=t.getMax(),a=Math.floor(n[0]),s=Math.floor(n[1]),o=Math.ceil(i[0]),l=Math.ceil(i[1]),u=o-a,c=l-s;return{x:a,y:s,width:u,height:c}}},{key:"mergeDirtyAABBs",value:function(t){var n=new pt;return t.forEach(function(i){var a=i.getRenderBounds();n.add(a);var s=i.renderable.dirtyRenderBounds;s&&n.add(s)}),n}},{key:"searchDirtyObjects",value:function(t){var n=t.getMin(),i=qe(n,2),a=i[0],s=i[1],o=t.getMax(),l=qe(o,2),u=l[0],c=l[1],h=this.rBush.search({minX:a,minY:s,maxX:u,maxY:c});return h.map(function(d){var f=d.displayObject;return f})}},{key:"saveDirtyAABB",value:function(t){var n=t.renderable;n.dirtyRenderBounds||(n.dirtyRenderBounds=new pt);var i=t.getRenderBounds();i&&n.dirtyRenderBounds.update(i.center,i.halfExtents)}},{key:"applyWorldTransform",value:function(t,n,i){i?(Ls(this.tmpMat4,n.getLocalTransform()),Ln(this.tmpMat4,i,this.tmpMat4),Ln(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(Ls(this.tmpMat4,n.getWorldTransform()),Ln(this.tmpMat4,this.vpMatrix,this.tmpMat4)),t.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:"safeMergeAABB",value:function(){for(var t=new pt,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return i.forEach(function(s){t.add(s)}),t}}])}();TP.tag="CanvasRenderer";function fc(r,e,t,n,i,a,s){var o,l;if(r.image.nodeName==="rect"){var u=r.image.parsedStyle,c=u.width,h=u.height;l=n.contextService.getDPR();var d=n.config.offscreenCanvas;o=a.offscreenCanvasCreator.getOrCreateCanvas(d),o.width=c*l,o.height=h*l;var f=a.offscreenCanvasCreator.getOrCreateContext(d),g={restoreStack:[],prevObject:null,currentContext:new Map};r.image.forEach(function(p){i.renderDisplayObject(p,f,n,g,a)}),g.restoreStack.forEach(function(){f.restore()})}var v=s.getOrCreatePatternSync(e,r,t,o,l,e.getGeometryBounds().min,function(){e.renderable.dirty=!0,n.renderingService.dirtify()});return v}function gc(r,e,t,n){var i;if(r.type===Zi.LinearGradient||r.type===Zi.RadialGradient){var a=e.getGeometryBounds(),s=a&&a.halfExtents[0]*2||1,o=a&&a.halfExtents[1]*2||1,l=a&&a.min||[0,0];i=n.getOrCreateGradient(Ge(Ge({type:r.type},r.value),{},{min:l,width:s,height:o}),t)}return i}var gu=["shadowBlur","shadowOffsetX","shadowOffsetY"],sx=["lineCap","lineJoin","miterLimit"],Zt={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},ox={};function Dt(r,e,t,n){var i=n.has(e)?n.get(e):Zt[e];return i!==t&&(e==="lineDash"?r.setLineDash(t):r[e]=t,n.set(e,t)),i}var F4=function(){function r(e){de(this,r),this.imagePool=e}return fe(r,[{key:"applyAttributesToContext",value:function(t,n){}},{key:"render",value:function(t,n,i,a,s,o){}},{key:"applyCommonStyleToContext",value:function(t,n,i,a){var s=i?ox:a.prevObject.parsedStyle,o=n.parsedStyle;(i||o.opacity!==s.opacity)&&Dt(t,"globalAlpha",Le(o.opacity)?Zt.globalAlpha:o.opacity,a.currentContext),(i||o.blend!==s.blend)&&Dt(t,"globalCompositeOperation",Le(o.blend)?Zt.globalCompositeOperation:o.blend,a.currentContext)}},{key:"applyStrokeFillStyleToContext",value:function(t,n,i,a){var s=i?ox:a.prevObject.parsedStyle,o=n.parsedStyle,l=o.lineWidth,u=l===void 0?Zt.lineWidth:l,c=o.fill&&!o.fill.isNone,h=o.stroke&&!o.stroke.isNone&&u>0;if(h){if(i||n.attributes.stroke!==a.prevObject.attributes.stroke){var d=!Le(o.stroke)&&!Array.isArray(o.stroke)&&!o.stroke.isNone?n.attributes.stroke:Zt.strokeStyle;Dt(t,"strokeStyle",d,a.currentContext)}(i||o.lineWidth!==s.lineWidth)&&Dt(t,"lineWidth",Le(o.lineWidth)?Zt.lineWidth:o.lineWidth,a.currentContext),(i||o.lineDash!==s.lineDash)&&Dt(t,"lineDash",o.lineDash||Zt.lineDash,a.currentContext),(i||o.lineDashOffset!==s.lineDashOffset)&&Dt(t,"lineDashOffset",Le(o.lineDashOffset)?Zt.lineDashOffset:o.lineDashOffset,a.currentContext);for(var f=0;f<sx.length;f++){var g=sx[f];(i||o[g]!==s[g])&&Dt(t,g,Le(o[g])?Zt[g]:o[g],a.currentContext)}}if(c&&(i||n.attributes.fill!==a.prevObject.attributes.fill)){var v=!Le(o.fill)&&!Array.isArray(o.fill)&&!o.fill.isNone?n.attributes.fill:Zt.fillStyle;Dt(t,"fillStyle",v,a.currentContext)}}},{key:"applyStyleToContext",value:function(t,n,i,a){var s=n.nodeName;this.applyCommonStyleToContext(t,n,i,a),s===re.IMAGE||this.applyStrokeFillStyleToContext(t,n,i,a)}},{key:"applyShadowAndFilterStyleToContext",value:function(t,n,i,a){var s=n.parsedStyle;if(i){Dt(t,"shadowColor",s.shadowColor.toString(),a.currentContext);for(var o=0;o<gu.length;o++){var l=gu[o];Dt(t,l,s[l]||Zt[l],a.currentContext)}}s.filter&&s.filter.length&&Dt(t,"filter",n.attributes.filter,a.currentContext)}},{key:"clearShadowAndFilterStyleForContext",value:function(t,n,i,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(n){Dt(t,"shadowColor",Zt.shadowColor,a.currentContext);for(var o=0;o<gu.length;o++){var l=gu[o];Dt(t,l,Zt[l],a.currentContext)}}if(i)if(n&&s){var u=t.filter;!Le(u)&&u.indexOf("drop-shadow")>-1&&Dt(t,"filter",u.replace(/drop-shadow\([^)]*\)/,"").trim()||Zt.filter,a.currentContext)}else Dt(t,"filter",Zt.filter,a.currentContext)}},{key:"fillToContext",value:function(t,n,i,a,s){var o=this,l=n.parsedStyle,u=l.fill,c=l.fillRule,h=null;if(Array.isArray(u)&&u.length>0)u.forEach(function(f){var g=Dt(t,"fillStyle",gc(f,n,t,o.imagePool),i.currentContext);h=h??g,c?t.fill(c):t.fill()});else{if(Va(u)){var d=fc(u,n,t,n.ownerDocument.defaultView.context,a,s,this.imagePool);d&&(t.fillStyle=d,h=!0)}c?t.fill(c):t.fill()}h!==null&&Dt(t,"fillStyle",h,i.currentContext)}},{key:"strokeToContext",value:function(t,n,i,a,s){var o=this,l=n.parsedStyle.stroke,u=null;if(Array.isArray(l)&&l.length>0)l.forEach(function(d){var f=Dt(t,"strokeStyle",gc(d,n,t,o.imagePool),i.currentContext);u=u??f,t.stroke()});else{if(Va(l)){var c=fc(l,n,t,n.ownerDocument.defaultView.context,a,s,this.imagePool);if(c){var h=Dt(t,"strokeStyle",c,i.currentContext);u=u??h}}t.stroke()}u!==null&&Dt(t,"strokeStyle",u,i.currentContext)}},{key:"drawToContext",value:function(t,n,i,a,s){var o,l=n.nodeName,u=n.parsedStyle,c=u.opacity,h=c===void 0?Zt.globalAlpha:c,d=u.fillOpacity,f=d===void 0?Zt.fillOpacity:d,g=u.strokeOpacity,v=g===void 0?Zt.strokeOpacity:g,p=u.lineWidth,y=p===void 0?Zt.lineWidth:p,m=u.fill&&!u.fill.isNone,w=u.stroke&&!u.stroke.isNone&&y>0;if(!(!m&&!w)){var S=!Le(u.shadowColor)&&u.shadowBlur>0,_=u.shadowType==="inner",O=((o=u.fill)===null||o===void 0?void 0:o.alpha)===0,T=!!(u.filter&&u.filter.length),k=S&&w&&(l===re.PATH||l===re.LINE||l===re.POLYLINE||O||_),P=null;if(m){k||this.applyShadowAndFilterStyleToContext(t,n,S,i);var C=h*f;P=Dt(t,"globalAlpha",C,i.currentContext),this.fillToContext(t,n,i,a,s),k||this.clearShadowAndFilterStyleForContext(t,S,T,i)}if(w){var N=!1,L=h*v,F=Dt(t,"globalAlpha",L,i.currentContext);if(P=m?P:F,k&&(this.applyShadowAndFilterStyleToContext(t,n,S,i),N=!0,_)){var G=t.globalCompositeOperation;t.globalCompositeOperation="source-atop",this.strokeToContext(t,n,i,a,s),t.globalCompositeOperation=G,this.clearShadowAndFilterStyleForContext(t,S,T,i,!0)}this.strokeToContext(t,n,i,a,s),N&&this.clearShadowAndFilterStyleForContext(t,S,T,i)}P!==null&&Dt(t,"globalAlpha",P,i.currentContext)}}}])}(),X1=function(r){function e(){return de(this,e),We(this,e,arguments)}return Ve(e,r),fe(e,[{key:"render",value:function(n,i,a,s,o,l){var u=i.fill,c=i.fillRule,h=i.opacity,d=h===void 0?1:h,f=i.fillOpacity,g=f===void 0?1:f,v=i.stroke,p=i.strokeOpacity,y=p===void 0?1:p,m=i.lineWidth,w=m===void 0?1:m,S=i.lineCap,_=i.lineJoin,O=i.shadowType,T=i.shadowColor,k=i.shadowBlur,P=i.filter,C=i.miterLimit,N=u&&!u.isNone,L=v&&!v.isNone&&w>0,F=(u==null?void 0:u.alpha)===0,G=!!(P&&P.length),V=!Le(T)&&k>0,U=a.nodeName,$=O==="inner",j=L&&V&&(U===re.PATH||U===re.LINE||U===re.POLYLINE||F||$);N&&(n.globalAlpha=d*g,j||pc(a,n,V),AP(n,a,u,c,s,o,l,this.imagePool),j||this.clearShadowAndFilter(n,G,V)),L&&(n.globalAlpha=d*y,n.lineWidth=w,Le(C)||(n.miterLimit=C),Le(S)||(n.lineCap=S),Le(_)||(n.lineJoin=_),j&&($&&(n.globalCompositeOperation="source-atop"),pc(a,n,!0),$&&(Bm(n,a,v,s,o,l,this.imagePool),n.globalCompositeOperation=Zt.globalCompositeOperation,this.clearShadowAndFilter(n,G,!0))),Bm(n,a,v,s,o,l,this.imagePool))}},{key:"clearShadowAndFilter",value:function(n,i,a){if(a&&(n.shadowColor="transparent",n.shadowBlur=0),i){var s=n.filter;!Le(s)&&s.indexOf("drop-shadow")>-1&&(n.filter=s.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}}}])}(F4);function pc(r,e,t){var n=r.parsedStyle,i=n.filter,a=n.shadowColor,s=n.shadowBlur,o=n.shadowOffsetX,l=n.shadowOffsetY;i&&i.length&&(e.filter=r.style.filter),t&&(e.shadowColor=a.toString(),e.shadowBlur=s||0,e.shadowOffsetX=o||0,e.shadowOffsetY=l||0)}function AP(r,e,t,n,i,a,s,o){var l=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1;Array.isArray(t)?t.forEach(function(u){r.fillStyle=gc(u,e,r,o),l||(n?r.fill(n):r.fill())}):(Va(t)&&(r.fillStyle=fc(t,e,r,i,a,s,o)),l||(n?r.fill(n):r.fill()))}function Bm(r,e,t,n,i,a,s){var o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;Array.isArray(t)?t.forEach(function(l){r.strokeStyle=gc(l,e,r,s),o||r.stroke()}):(Va(t)&&(r.strokeStyle=fc(t,e,r,n,i,a,s)),o||r.stroke())}function B4(r,e){var t=qe(r,4),n=t[0],i=t[1],a=t[2],s=t[3],o=qe(e,4),l=o[0],u=o[1],c=o[2],h=o[3],d=Math.max(n,l),f=Math.max(i,u),g=Math.min(n+a,l+c),v=Math.min(i+s,u+h);return g<=d||v<=f?null:[d,f,g-d,v-f]}function z4(r,e){var t=In(Qe(),[r[0],r[1],0],e),n=In(Qe(),[r[0]+r[2],r[1],0],e),i=In(Qe(),[r[0],r[1]+r[3],0],e),a=In(Qe(),[r[0]+r[2],r[1]+r[3],0],e);return[Math.min(t[0],n[0],i[0],a[0]),Math.min(t[1],n[1],i[1],a[1]),Math.max(t[0],n[0],i[0],a[0])-Math.min(t[0],n[0],i[0],a[0]),Math.max(t[1],n[1],i[1],a[1])-Math.min(t[1],n[1],i[1],a[1])]}var j4=function(r){function e(){return de(this,e),We(this,e,arguments)}return Ve(e,r),fe(e,[{key:"renderDownSampled",value:function(n,i,a,s){var o=s.src,l=s.imageCache;if(!l.downSampled){this.imagePool.createDownSampledImage(o,a).then(function(){a.ownerDocument&&(a.renderable.dirty=!0,a.ownerDocument.defaultView.context.renderingService.dirtify())}).catch(function(u){console.error(u)});return}n.drawImage(l.downSampled,Math.floor(s.drawRect[0]),Math.floor(s.drawRect[1]),Math.ceil(s.drawRect[2]),Math.ceil(s.drawRect[3]))}},{key:"renderTile",value:function(n,i,a,s){var o=s.src,l=s.imageCache,u=s.imageRect,c=s.drawRect,h=l.size,d=n.getTransform(),f=d.a,g=d.b,v=d.c,p=d.d,y=d.e,m=d.f;if(n.resetTransform(),!(l!=null&&l.gridSize)){this.imagePool.createImageTiles(o,[],function(){a.ownerDocument&&(a.renderable.dirty=!0,a.ownerDocument.defaultView.context.renderingService.dirtify())},a).catch(function(V){console.error(V)});return}for(var w=[h[0]/u[2],h[1]/u[3]],S=[l.tileSize[0]/w[0],l.tileSize[1]/w[1]],_=[Math.floor((c[0]-u[0])/S[0]),Math.ceil((c[0]+c[2]-u[0])/S[0])],O=_[0],T=_[1],k=[Math.floor((c[1]-u[1])/S[1]),Math.ceil((c[1]+c[3]-u[1])/S[1])],P=k[0],C=k[1],N=P;N<=C;N++)for(var L=O;L<=T;L++){var F=l.tiles[N][L];if(F){var G=[Math.floor(u[0]+F.tileX*S[0]),Math.floor(u[1]+F.tileY*S[1]),Math.ceil(S[0]),Math.ceil(S[1])];n.drawImage(F.data,G[0],G[1],G[2],G[3])}}n.setTransform(f,g,v,p,y,m)}},{key:"render",value:function(n,i,a){var s=i.x,o=s===void 0?0:s,l=i.y,u=l===void 0?0:l,c=i.width,h=i.height,d=i.src,f=i.shadowColor,g=i.shadowBlur,v=this.imagePool.getImageSync(d,a),p=v==null?void 0:v.img,y=c,m=h;if(p){y||(y=p.width),m||(m=p.height);var w=!Le(f)&&g>0;pc(a,n,w);try{var S=a.ownerDocument.defaultView.getContextService().getDomElement(),_=S.width,O=S.height,T=n.getTransform(),k=T.a,P=T.b,C=T.c,N=T.d,L=T.e,F=T.f,G=ST(k,C,0,0,P,N,0,0,0,0,1,0,L,F,0,1),V=z4([o,u,y,m],G),U=B4([0,0,_,O],V);if(!U)return;if(!a.ownerDocument.defaultView.getConfig().enableLargeImageOptimization){e.renderFull(n,i,a,{image:p,drawRect:[o,u,y,m]});return}var $=V[2]/v.size[0];if($<(v.downSamplingRate||.5)){this.renderDownSampled(n,i,a,{src:d,imageCache:v,drawRect:[o,u,y,m]});return}if(!Y1.isSupportTile){e.renderFull(n,i,a,{image:p,drawRect:[o,u,y,m]});return}this.renderTile(n,i,a,{src:d,imageCache:v,imageRect:V,drawRect:U})}catch{}}}},{key:"drawToContext",value:function(n,i,a,s,o){this.render(n,i.parsedStyle,i)}}],[{key:"renderFull",value:function(n,i,a,s){n.drawImage(s.image,Math.floor(s.drawRect[0]),Math.floor(s.drawRect[1]),Math.ceil(s.drawRect[2]),Math.ceil(s.drawRect[3]))}}])}(X1),q4=function(r){function e(){return de(this,e),We(this,e,arguments)}return Ve(e,r),fe(e,[{key:"render",value:function(n,i,a,s,o,l){a.getBounds();var u=i.lineWidth,c=u===void 0?1:u,h=i.textAlign,d=h===void 0?"start":h,f=i.textBaseline,g=f===void 0?"alphabetic":f,v=i.lineJoin,p=v===void 0?"miter":v,y=i.miterLimit,m=y===void 0?10:y,w=i.letterSpacing,S=w===void 0?0:w,_=i.stroke,O=i.fill,T=i.fillRule,k=i.fillOpacity,P=k===void 0?1:k,C=i.strokeOpacity,N=C===void 0?1:C,L=i.opacity,F=L===void 0?1:L,G=i.metrics,V=i.x,U=V===void 0?0:V,$=i.y,j=$===void 0?0:$,Z=i.dx,ne=i.dy,oe=i.shadowColor,le=i.shadowBlur,Ce=G.font,K=G.lines,W=G.height,ee=G.lineHeight,he=G.lineMetrics;n.font=Ce,n.lineWidth=c,n.textAlign=d==="middle"?"center":d;var Se=g;Se==="alphabetic"&&(Se="bottom"),n.lineJoin=p,Le(m)||(n.miterLimit=m);var Ne=j;g==="middle"?Ne+=-W/2-ee/2:g==="bottom"||g==="alphabetic"||g==="ideographic"?Ne+=-W:(g==="top"||g==="hanging")&&(Ne+=-ee);var Ue=U+(Z||0);Ne+=ne||0,K.length===1&&(Se==="bottom"?(Se="middle",Ne-=.5*W):Se==="top"&&(Se="middle",Ne+=.5*W)),n.textBaseline=Se;var Tt=!Le(oe)&&le>0;pc(a,n,Tt);for(var fn=0;fn<K.length;fn++){var At=c/2+Ue;Ne+=ee,!Le(_)&&!_.isNone&&c&&this.drawLetterSpacing(n,a,K[fn],he[fn],d,At,Ne,S,O,T,P,_,N,F,!0,s,o,l),Le(O)||this.drawLetterSpacing(n,a,K[fn],he[fn],d,At,Ne,S,O,T,P,_,N,F,!1,s,o,l)}}},{key:"drawLetterSpacing",value:function(n,i,a,s,o,l,u,c,h,d,f,g,v,p,y,m,w,S){if(c===0){y?this.strokeText(n,i,a,l,u,g,v,m,w,S):this.fillText(n,i,a,l,u,h,d,f,p,m,w,S);return}var _=n.textAlign;n.textAlign="left";var O=l;o==="center"||o==="middle"?O=l-s.width/2:(o==="right"||o==="end")&&(O=l-s.width);for(var T=Array.from(a),k=n.measureText(a).width,P=0,C=0;C<T.length;++C){var N=T[C];y?this.strokeText(n,i,N,O,u,g,v,m,w,S):this.fillText(n,i,N,O,u,h,d,f,p,m,w,S),P=n.measureText(a.substring(C+1)).width,O+=k-P+c,k=P}n.textAlign=_}},{key:"fillText",value:function(n,i,a,s,o,l,u,c,h,d,f,g){AP(n,i,l,u,d,f,g,this.imagePool,!0);var v,p=!Le(c)&&c!==1;p&&(v=n.globalAlpha,n.globalAlpha=c*h),n.fillText(a,s,o),p&&(n.globalAlpha=v)}},{key:"strokeText",value:function(n,i,a,s,o,l,u,c,h,d){Bm(n,i,l,c,h,d,this.imagePool,!0);var f,g=!Le(u)&&u!==1;g&&(f=n.globalAlpha,n.globalAlpha=u),n.strokeText(a,s,o),g&&(n.globalAlpha=f)}},{key:"drawToContext",value:function(n,i,a,s,o){this.render(n,i.parsedStyle,i,i.ownerDocument.defaultView.context,s,o)}}])}(X1),$4=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return de(this,e),t=We(this,e),t.name="canvas-renderer",t.options=n,t}return Ve(e,r),fe(e,[{key:"init",value:function(){var n,i=Ge({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),a=this.context.imagePool,s=new X1(a),o=(n={},Me(Me(Me(Me(Me(Me(Me(Me(Me(Me(n,re.CIRCLE,s),re.ELLIPSE,s),re.RECT,s),re.IMAGE,new j4(a)),re.TEXT,new q4(a)),re.LINE,s),re.POLYLINE,s),re.POLYGON,s),re.PATH,s),re.GROUP,void 0),Me(Me(Me(n,re.HTML,void 0),re.MESH,void 0),re.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=o,this.context.styleRendererFactory=o,this.addRenderingPlugin(new TP(i))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])}(ga);/*!
 * @antv/g-plugin-dom-interaction
 * @description A G plugin
 * @version 2.1.21
 * @date 1/23/2025, 8:33:09 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var PP=function(){function r(){de(this,r)}return fe(r,[{key:"apply",value:function(t,n){var i=this,a=t.renderingService,s=t.renderingContext,o=t.config;this.context=t;var l=s.root.ownerDocument.defaultView,u=function(k){a.hooks.pointerMove.call(k)},c=function(k){a.hooks.pointerUp.call(k)},h=function(k){a.hooks.pointerDown.call(k)},d=function(k){a.hooks.pointerOver.call(k)},f=function(k){a.hooks.pointerOut.call(k)},g=function(k){a.hooks.pointerCancel.call(k)},v=function(k){a.hooks.pointerWheel.call(k)},p=function(k){a.hooks.click.call(k)},y=function(k){n.globalThis.document.addEventListener("pointermove",u,!0),k.addEventListener("pointerdown",h,!0),k.addEventListener("pointerleave",f,!0),k.addEventListener("pointerover",d,!0),n.globalThis.addEventListener("pointerup",c,!0),n.globalThis.addEventListener("pointercancel",g,!0)},m=function(k){k.addEventListener("touchstart",h,!0),k.addEventListener("touchend",c,!0),k.addEventListener("touchmove",u,!0),k.addEventListener("touchcancel",g,!0)},w=function(k){n.globalThis.document.addEventListener("mousemove",u,!0),k.addEventListener("mousedown",h,!0),k.addEventListener("mouseout",f,!0),k.addEventListener("mouseover",d,!0),n.globalThis.addEventListener("mouseup",c,!0)},S=function(k){n.globalThis.document.removeEventListener("pointermove",u,!0),k.removeEventListener("pointerdown",h,!0),k.removeEventListener("pointerleave",f,!0),k.removeEventListener("pointerover",d,!0),n.globalThis.removeEventListener("pointerup",c,!0),n.globalThis.removeEventListener("pointercancel",g,!0)},_=function(k){k.removeEventListener("touchstart",h,!0),k.removeEventListener("touchend",c,!0),k.removeEventListener("touchmove",u,!0),k.removeEventListener("touchcancel",g,!0)},O=function(k){n.globalThis.document.removeEventListener("mousemove",u,!0),k.removeEventListener("mousedown",h,!0),k.removeEventListener("mouseout",f,!0),k.removeEventListener("mouseover",d,!0),n.globalThis.removeEventListener("mouseup",c,!0)};a.hooks.init.tap(r.tag,function(){var T=i.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(T.style.msContentZooming="none",T.style.msTouchAction="none"):l.supportsPointerEvents&&(T.style.touchAction="none"),l.supportsPointerEvents?y(T):w(T),l.supportsTouchEvents&&m(T),o.useNativeClickEvent&&T.addEventListener("click",p,!0),T.addEventListener("wheel",v,{passive:!0,capture:!0})}),a.hooks.destroy.tap(r.tag,function(){var T=i.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(T.style.msContentZooming="",T.style.msTouchAction=""):l.supportsPointerEvents&&(T.style.touchAction=""),l.supportsPointerEvents?S(T):O(T),l.supportsTouchEvents&&_(T),o.useNativeClickEvent&&T.removeEventListener("click",p,!0),T.removeEventListener("wheel",v,!0)})}}])}();PP.tag="DOMInteraction";var G4=function(r){function e(){var t;de(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=We(this,e,[].concat(i)),t.name="dom-interaction",t}return Ve(e,r),fe(e,[{key:"init",value:function(){this.addRenderingPlugin(new PP)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(ga);/*!
 * @antv/g-plugin-html-renderer
 * @description A G plugin for rendering HTML
 * @version 2.1.21
 * @date 1/23/2025, 8:33:20 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var W4="g-canvas-camera",CP=function(){function r(){de(this,r),this.displayObjectHTMLElementMap=new WeakMap}return fe(r,[{key:"joinTransformMatrix",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return"matrix(".concat([t[0],t[1],t[4],t[5],t[12]+n[0],t[13]+n[1]].join(","),")")}},{key:"apply",value:function(t,n){var i=this,a=t.camera,s=t.renderingContext,o=t.renderingService;this.context=t;var l=s.root.ownerDocument.defaultView,u=l.context.eventService.nativeHTMLMap,c=function(y,m){m.style.transform=i.joinTransformMatrix(y.getWorldTransform(),y.getOrigin())},h=function(y){var m=y.target;if(m.nodeName===re.HTML){i.$camera||(i.$camera=i.createCamera(a));var w=i.getOrCreateEl(m);i.$camera.appendChild(w),Object.keys(m.attributes).forEach(function(S){i.updateAttribute(S,m)}),c(m,w),u.set(w,m)}},d=function(y){var m=y.target;if(m.nodeName===re.HTML&&i.$camera){var w=i.getOrCreateEl(m);w&&(w.remove(),u.delete(w))}},f=function(y){var m=y.target;if(m.nodeName===re.HTML){var w=y.attrName;i.updateAttribute(w,m)}},g=function(y){var m=y.target,w=m.nodeName===re.FRAGMENT?m.childNodes:[m];w.forEach(function(S){if(S.nodeName===re.HTML){var _=i.getOrCreateEl(S);c(S,_)}})},v=function(){if(i.$camera){var y=i.context.config,m=y.width,w=y.height;i.$camera.parentElement.style.width="".concat(m||0,"px"),i.$camera.parentElement.style.height="".concat(w||0,"px")}};o.hooks.init.tap(r.tag,function(){l.addEventListener(or.RESIZE,v),l.addEventListener(Ke.MOUNTED,h),l.addEventListener(Ke.UNMOUNTED,d),l.addEventListener(Ke.ATTR_MODIFIED,f),l.addEventListener(Ke.BOUNDS_CHANGED,g)}),o.hooks.endFrame.tap(r.tag,function(){i.$camera&&s.renderReasons.has(Ns.CAMERA_CHANGED)&&(i.$camera.style.transform=i.joinTransformMatrix(a.getOrthoMatrix()))}),o.hooks.destroy.tap(r.tag,function(){i.$camera&&i.$camera.remove(),l.removeEventListener(or.RESIZE,v),l.removeEventListener(Ke.MOUNTED,h),l.removeEventListener(Ke.UNMOUNTED,d),l.removeEventListener(Ke.ATTR_MODIFIED,f),l.removeEventListener(Ke.BOUNDS_CHANGED,g)})}},{key:"createCamera",value:function(t){var n=this.context.config,i=n.document,a=n.width,s=n.height,o=this.context.contextService.getDomElement(),l=o.parentNode;if(l){var u=W4,c=l.querySelector("#".concat(u));if(!c){var h=(i||document).createElement("div");h.style.overflow="hidden",h.style.pointerEvents="none",h.style.position="absolute",h.style.left="0px",h.style.top="0px",h.style.width="".concat(a||0,"px"),h.style.height="".concat(s||0,"px");var d=(i||document).createElement("div");c=d,d.id=u,d.style.position="absolute",d.style.left="".concat(o.offsetLeft||0,"px"),d.style.top="".concat(o.offsetTop||0,"px"),d.style.transformOrigin="left top",d.style.transform=this.joinTransformMatrix(t.getOrthoMatrix()),d.style.pointerEvents="none",d.style.width="100%",d.style.height="100%",h.appendChild(d),l.appendChild(h)}return c}return null}},{key:"getOrCreateEl",value:function(t){var n=this.context.config.document,i=this.displayObjectHTMLElementMap.get(t);return i||(i=(n||document).createElement("div"),t.parsedStyle.$el=i,this.displayObjectHTMLElementMap.set(t,i),t.id&&(i.id=t.id),t.name&&i.setAttribute("name",t.name),t.className&&(i.className=t.className),i.style.position="absolute",i.style["will-change"]="transform",i.style.transform=this.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())),i}},{key:"updateAttribute",value:function(t,n){var i=this.getOrCreateEl(n);switch(t){case"innerHTML":var a=n.parsedStyle.innerHTML;rt(a)?i.innerHTML=a:(i.innerHTML="",i.appendChild(a));break;case"x":i.style.left="".concat(n.parsedStyle.x,"px");break;case"y":i.style.top="".concat(n.parsedStyle.y,"px");break;case"transformOrigin":var s=n.parsedStyle.transformOrigin;i.style["transform-origin"]="".concat(s[0].buildCSSText(null,null,"")," ").concat(s[1].buildCSSText(null,null,""));break;case"width":var o=n.parsedStyle.width;i.style.width=_e(o)?"".concat(o,"px"):o.toString();break;case"height":var l=n.parsedStyle.height;i.style.height=_e(l)?"".concat(l,"px"):l.toString();break;case"zIndex":var u=n.parsedStyle.zIndex;i.style["z-index"]="".concat(u);break;case"visibility":var c=n.parsedStyle.visibility;i.style.visibility=c;break;case"pointerEvents":var h=n.parsedStyle.pointerEvents,d=h===void 0?"auto":h;i.style.pointerEvents=d;break;case"opacity":var f=n.parsedStyle.opacity;i.style.opacity="".concat(f);break;case"fill":var g=n.parsedStyle.fill,v="";rc(g)?g.isNone?v="transparent":v=n.getAttribute("fill"):Array.isArray(g)?v=n.getAttribute("fill"):Va(g),i.style.background=v;break;case"stroke":var p=n.parsedStyle.stroke,y="";rc(p)?p.isNone?y="transparent":y=n.getAttribute("stroke"):Array.isArray(p)?y=n.getAttribute("stroke"):Va(p),i.style["border-color"]=y,i.style["border-style"]="solid";break;case"lineWidth":var m=n.parsedStyle.lineWidth;i.style["border-width"]="".concat(m||0,"px");break;case"lineDash":i.style["border-style"]="dashed";break;case"filter":var w=n.style.filter;i.style.filter=w;break;default:!Le(n.style[t])&&n.style[t]!==""&&(i.style[t]=n.style[t])}}}])}();CP.tag="HTMLRendering";var V4=function(r){function e(){var t;de(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=We(this,e,[].concat(i)),t.name="html-renderer",t}return Ve(e,r),fe(e,[{key:"init",value:function(){this.addRenderingPlugin(new CP)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(ga);/*!
 * @antv/g-canvas
 * @description A renderer implemented by Canvas 2D API
 * @version 2.0.40
 * @date 2/27/2025, 8:29:44 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var U4=function(){function r(e){de(this,r),this.renderingContext=e.renderingContext,this.canvasConfig=e.config}return fe(r,[{key:"init",value:function(){var t=this.canvasConfig,n=t.container,i=t.canvas;if(i)this.$canvas=i,n&&i.parentElement!==n&&n.appendChild(i),this.$container=i.parentElement,this.canvasConfig.container=this.$container;else if(n&&(this.$container=rt(n)?document.getElementById(n):n,this.$container)){var a=document.createElement("canvas");this.$container.appendChild(a),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=a}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(t,n){var i=this.canvasConfig.devicePixelRatio;this.dpr=i,this.$canvas&&(this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*n,E6(this.$canvas,t,n)),this.renderingContext.renderReasons.add(Ns.CAMERA_CHANGED)}},{key:"applyCursorStyle",value:function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)}},{key:"toDataURL",value:function(){var e=ha(_n().mark(function n(){var i,a,s,o=arguments;return _n().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return i=o.length>0&&o[0]!==void 0?o[0]:{},a=i.type,s=i.encoderOptions,u.abrupt("return",this.context.canvas.toDataURL(a,s));case 3:case"end":return u.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()}])}(),H4=function(r){function e(){var t;de(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=We(this,e,[].concat(i)),t.name="canvas-context-register",t}return Ve(e,r),fe(e,[{key:"init",value:function(){this.context.ContextService=U4}},{key:"destroy",value:function(){delete this.context.ContextService}}])}(ga),Vo=function(r){function e(t){var n;return de(this,e),n=We(this,e,[t]),n.registerPlugin(new H4),n.registerPlugin(new D4),n.registerPlugin(new f4),n.registerPlugin(new $4),n.registerPlugin(new G4),n.registerPlugin(new N4),n.registerPlugin(new V4),n}return Ve(e,r),fe(e)}(EI),Y4=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class $c extends Vr{constructor(e){super(Object.assign(Object.assign({},e),{style:Object.assign({},$c.defaultStyleProps,e.style)})),this.rootPointerEvent=new sc(null),this.forwardEvents=t=>{const n=this.context.canvas,i=n.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(t,i).forEach(s=>{const o=this.bootstrapEvent(this.rootPointerEvent,s,i,t);Bo(n.context.eventService,"mappingTable.pointerupoutside",[]),n.context.eventService.mapEvent(o)})}}get eventService(){return this.context.canvas.context.eventService}get events(){return[ie.CLICK,ie.POINTER_DOWN,ie.POINTER_MOVE,ie.POINTER_UP,ie.POINTER_OVER,ie.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}render(e=this.parsedAttributes,t=this){this.drawKeyShape(e,t),this.drawPortShapes(e,t)}getKeyStyle(e){const t=Ga(e,["dx","dy","innerHTML","pointerEvents","cursor"]),{dx:n=0,dy:i=0}=t,a=Y4(t,["dx","dy"]),[s,o]=this.getSize(e);return Object.assign(Object.assign({x:n,y:i},a),{width:s,height:o})}drawKeyShape(e,t){const n=this.getKeyStyle(e),{x:i,y:a,width:s=0,height:o=0}=n,l=this.upsert("key-container",Mn,{x:i,y:a,width:s,height:o,opacity:0},t);return this.upsert("key",ll,n,l)}connectedCallback(){if(!(this.context.canvas.getRenderer("main")instanceof Vo))return;const n=this.getDomElement();this.events.forEach(i=>{n.addEventListener(i,this.forwardEvents)})}attributeChangedCallback(e,t,n){e==="zIndex"&&t!==n&&(this.getDomElement().style.zIndex=n)}destroy(){const e=this.getDomElement();this.events.forEach(t=>{e.removeEventListener(t,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(e,t){const n=[];if(t.isTouchEvent(e))for(let i=0;i<e.changedTouches.length;i++){const a=e.changedTouches[i];Be(a.button)&&(a.button=0),Be(a.buttons)&&(a.buttons=1),Be(a.isPrimary)&&(a.isPrimary=e.touches.length===1&&e.type==="touchstart"),Be(a.width)&&(a.width=a.radiusX||1),Be(a.height)&&(a.height=a.radiusY||1),Be(a.tiltX)&&(a.tiltX=0),Be(a.tiltY)&&(a.tiltY=0),Be(a.pointerType)&&(a.pointerType="touch"),Be(a.pointerId)&&(a.pointerId=a.identifier||0),Be(a.pressure)&&(a.pressure=a.force||.5),Be(a.twist)&&(a.twist=0),Be(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,a.type=e.type,n.push(a)}else if(t.isMouseEvent(e)){const i=e;Be(i.isPrimary)&&(i.isPrimary=!0),Be(i.width)&&(i.width=1),Be(i.height)&&(i.height=1),Be(i.tiltX)&&(i.tiltX=0),Be(i.tiltY)&&(i.tiltY=0),Be(i.pointerType)&&(i.pointerType="mouse"),Be(i.pointerId)&&(i.pointerId=1),Be(i.pressure)&&(i.pressure=.5),Be(i.twist)&&(i.twist=0),Be(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,n.push(i)}else n.push(e);return n}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null}bootstrapEvent(e,t,n,i){e.view=n,e.originalEvent=null,e.nativeEvent=i,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);const{x:a,y:s}=this.getViewportXY(t);e.viewport.x=a,e.viewport.y=s;const[o,l]=this.context.canvas.getCanvasByViewport([a,s]);return e.canvas.x=o,e.canvas.y=l,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=i.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e}getViewportXY(e){let t,n;const{offsetX:i,offsetY:a,clientX:s,clientY:o}=e;if(!Le(i)&&!Le(a))t=i,n=a;else{const l=this.eventService.client2Viewport({x:s,y:o});t=l.x,n=l.y}return{x:t,y:n}}onframe(){super.onframe();const{opacity:e}=this.attributes;this.getDomElement().style.opacity=`${e}`}}$c.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};var lx=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};let NP=class RP extends Vr{constructor(e){super(mn({style:RP.defaultStyleProps},e))}getKeyStyle(e){const[t,n]=this.getSize(e),i=super.getKeyStyle(e),{fillOpacity:a,opacity:s=a}=i,o=lx(i,["fillOpacity","opacity"]);return Object.assign(Object.assign({opacity:s},o),{width:t,height:n,x:-t/2,y:-n/2})}getHaloStyle(e){if(e.halo===!1)return!1;const t=this.getShape("key").attributes,{fill:n,stroke:i}=t;lx(t,["fill","stroke"]);const a=en(this.getGraphicStyle(e),"halo"),s=Number(a.lineWidth),[o,l]=$e(this.getSize(e),[s,s]);return Object.assign(Object.assign({},a),{width:o,height:l,fill:"transparent",x:-o/2,y:-l/2})}getIconStyle(e){const t=super.getIconStyle(e),[n,i]=this.getSize(e);return t?Object.assign({width:n*Li,height:i*Li},t):!1}drawKeyShape(e,t){const n=this.upsert("key",V1,this.getKeyStyle(e),t);return U1(this),n}drawHaloShape(e,t){this.upsert("halo",Mn,this.getHaloStyle(e),t)}update(e){super.update(e),e&&("x"in e||"y"in e||"z"in e)&&H1(this)}};NP.defaultStyleProps={size:32};class X4 extends Vr{constructor(e){super(e)}getKeyStyle(e){const[t,n]=this.getSize(e);return Object.assign(Object.assign({},super.getKeyStyle(e)),{width:t,height:n,x:-t/2,y:-n/2})}getIconStyle(e){const t=super.getIconStyle(e),{width:n,height:i}=this.getShape("key").attributes;return t?Object.assign({width:n*Li,height:i*Li},t):!1}drawKeyShape(e,t){return this.upsert("key",Mn,this.getKeyStyle(e),t)}}class K4 extends zc{constructor(e){super(e)}getInnerR(e){return e.innerR||this.getOuterR(e)*3/8}getOuterR(e){return Math.min(...this.getSize(e))/2}getPoints(e){return Rz(this.getOuterR(e),this.getInnerR(e))}getIconStyle(e){const t=super.getIconStyle(e),n=this.getInnerR(e)*2*Li;return t?Object.assign({width:n,height:n},t):!1}getPortXY(e,t){const{placement:n="top"}=t,i=this.getShape("key").getLocalBounds(),a=Lz(this.getOuterR(e),this.getInnerR(e));return J1(i,n,a,!1)}}class Gc extends zc{constructor(e){super(mn({style:Gc.defaultStyleProps},e))}getPoints(e){const{direction:t}=e,[n,i]=this.getSize(e);return Iz(n,i,t)}getPortXY(e,t){const{direction:n}=e,{placement:i="top"}=t,a=this.getShape("key").getLocalBounds(),[s,o]=this.getSize(e),l=Dz(s,o,n);return J1(a,i,l,!1)}getIconStyle(e){const{icon:t,iconText:n,iconSrc:i,direction:a}=e;if(t===!1||ai(n||i))return!1;const s=en(this.getGraphicStyle(e),"icon"),o=this.getShape("key").getLocalBounds(),[l,u]=QB(o,a),c=e5(o,a)*2*Li;return Object.assign({x:l,y:u,width:c,height:c},s)}}Gc.defaultStyleProps={size:40,direction:"up"};var ux=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Vs extends Vr{constructor(e){super(mn({style:Vs.defaultStyleProps},e)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}getKeySize(e){const{collapsed:t,childrenNode:n=[]}=e;return n.length===0?this.getEmptyKeySize(e):t?this.getCollapsedKeySize(e):this.getExpandedKeySize(e)}getEmptyKeySize(e){const{padding:t,collapsedSize:n}=e,[i,a,s,o]=pi(t);return $e(dr(n),[o+a,i+s,0])}getCollapsedKeySize(e){return dr(e.collapsedSize)}getExpandedKeySize(e){const t=this.getContentBBox(e);return[vi(t),yi(t),0]}getContentBBox(e){const{childrenNode:t=[],padding:n}=e,i=t.map(s=>this.context.element.getElement(s)).filter(Boolean);if(i.length===0){const s=new pt,{x:o=0,y:l=0,size:u}=e,[c,h]=dr(u);return s.setMinMax([o-c/2,l-h/2,0],[o+c/2,l+h/2,0]),s}const a=cl(i.map(s=>s.getBounds()));return n?va(a,n):a}drawCollapsedMarkerShape(e,t){const n=this.getCollapsedMarkerStyle(e);this.upsert("collapsed-marker",xP,n,t),U1(this)}getCollapsedMarkerStyle(e){if(!e.collapsed||!e.collapsedMarker)return!1;const t=en(this.getGraphicStyle(e),"collapsedMarker"),{type:n}=t,i=ux(t,["type"]),a=this.getShape("key"),[s,o]=Mi(a.getLocalBounds(),"center"),l=Object.assign(Object.assign({},i),{x:s,y:o});if(n){const u=this.getCollapsedMarkerText(n,e);Object.assign(l,{text:u})}return l}getCollapsedMarkerText(e,t){const{childrenData:n=[]}=t,{model:i}=this.context;return e==="descendant-count"?i.getDescendantsData(this.id).length.toString():e==="child-count"?n.length.toString():e==="node-count"?i.getDescendantsData(this.id).filter(a=>i.getElementType(J(a))==="node").length.toString():Te(e)?e(n):""}getComboPosition(e){const{x:t=0,y:n=0,collapsed:i,childrenData:a=[]}=e;if(a.length===0)return[+t,+n,0];if(i){const{model:s}=this.context,o=s.getDescendantsData(this.id).filter(l=>!s.isCombo(J(l)));if(o.length>0&&o.some(k5)){const l=o.reduce((u,c)=>$e(u,un(c)),[0,0,0]);return Gr(l,o.length)}return[+t,+n,0]}return this.getContentBBox(e).center}getComboStyle(e){const[t,n]=this.getComboPosition(e);return{x:t,y:n,transform:[["translate",t,n]]}}updateComboPosition(e){const t=this.getComboStyle(e);Object.assign(this.style,t);const{x:n,y:i}=t;this.context.model.syncNodeLikeDatum({id:this.id,style:{x:n,y:i}}),H1(this)}render(e,t=this){super.render(e,t),this.drawCollapsedMarkerShape(e,t)}update(e={}){super.update(e),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(e,t){const n=super.animate(this.attributes.collapsed?e:e.map(i=>{var{x:a,y:s,z:o,transform:l}=i,u=ux(i,["x","y","z","transform"]);return u}),t);return n&&new Proxy(n,{set:(i,a,s)=>(a==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(i,a,s))})}}Vs.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};class Z4 extends Vs{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert("key",Fi,this.getKeyStyle(e),t)}getKeyStyle(e){const{collapsed:t}=e,n=super.getKeyStyle(e),[i]=this.getKeySize(e);return Object.assign(Object.assign(Object.assign({},n),t&&en(n,"collapsed")),{r:i/2})}getCollapsedKeySize(e){const[t,n]=dr(e.collapsedSize),i=Math.max(t,n)/2;return[i*2,i*2,0]}getExpandedKeySize(e){const t=this.getContentBBox(e),[n,i]=pa(t),a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2))/2;return[a*2,a*2,0]}getIntersectPoint(e,t=!1){const n=this.getShape("key").getBounds();return Fc(e,n,t)}}class J4 extends Vs{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert("key",Mn,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e),[n,i]=this.getKeySize(e);return Object.assign(Object.assign(Object.assign({},t),e.collapsed&&en(t,"collapsed")),{width:n,height:i,x:-n/2,y:-i/2})}}const Q4={padding:10};function cx(r,e,t,n,i,a){const{padding:s}=Object.assign(Q4,a),o=Ji(t,s),l=Ji(n,s),u=[r,...i,e];let c=null;const h=[];for(let d=0,f=u.length;d<f-1;d++){const g=d+1,v=u[d],p=u[g],y=P5(v,p);let m=null;if(d===0)if(g===f-1)if(o.intersects(l))m=Ud(v,p,o,l);else if(!uc(v,o)&&!uc(p,l)){const w=Ba(v,o),S=Ba(p,l);m=dx(w,S,jn(w,S)),m.points.unshift(w),m.points.push(S)}else y||(m=tz(v,p,o,l));else $r(p,o)?m=Ud(v,p,o,Ji(p,s),c):y||(m=Lu(v,p,o));else g===f-1?$r(v,l)?m=Ud(v,p,Ji(v,s),l,c):y||(m=LP(v,p,l,c)):y||(m=dx(v,p,c));m?(h.push(...m.points),c=m.direction):c=jn(v,p),g<f-1&&h.push(p)}return h.map(Ya)}const ez={N:"S",S:"N",W:"E",E:"W"},hx={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function jn(r,e){const[t,n]=r,[i,a]=e;return t===i?n>a?"N":"S":n===a?t>i?"W":"E":null}function zm(r,e){return e==="N"||e==="S"?yi(r):vi(r)}function dx(r,e,t){const n=[r[0],e[1]],i=[e[0],r[1]],a=jn(r,n),s=jn(r,i),o=t?ez[t]:null,l=a===t||a!==o&&s!==t?n:i;return{points:[l],direction:jn(l,e)}}function Lu(r,e,t){if(uc(r,t)){const n=Uo(r,e,t);return{points:[n],direction:jn(n,e)}}else{const n=Ba(r,t),a=["left","right"].includes(Ro(r,t))?[e[0],n[1]]:[n[0],e[1]];return{points:[a],direction:jn(a,e)}}}function LP(r,e,t,n){const i=uc(e,t)?e:Ba(e,t),a=[[i[0],r[1]],[r[0],i[1]]],s=a.filter(l=>JB(l,t)&&!QA(l,t,!0)),o=s.filter(l=>jn(l,r)!==n);if(o.length>0){const l=o.find(u=>jn(r,u)===n)||o[0];return{points:[l],direction:jn(l,e)}}else{const l=s3(a,s)[0],u=oa(e,l,zm(t,n)/2);return{points:[Uo(u,r,t),u],direction:jn(u,e)}}}function tz(r,e,t,n){let i=Lu(r,e,t);const a=Wo(i.points[0]);if($r(a,n)){i=Lu(e,r,n);const s=Wo(i.points[0]);if($r(s,t)){const o=oa(r,a,zm(t,jn(r,a))/2),l=oa(e,s,zm(n,jn(e,s))/2),u=[(o[0]+l[0])/2,(o[1]+l[1])/2],c=Lu(r,u,t),h=LP(u,e,n,c.direction);i.points=[c.points[0],h.points[0]],i.direction=h.direction}}return i}function Ud(r,e,t,n,i){const s=cl([t,n]),o=bt(e,s.center)>bt(r,s.center),[l,u]=o?[e,r]:[r,e],c=yi(s)+vi(s);let h;if(i){const g=[l[0]+c*Math.cos(hx[i]),l[1]+c*Math.sin(hx[i])];h=oa(Ba(g,s),g,.01)}else h=oa(Ba(l,s),l,-.01);let d=Uo(h,u,s),f=[uo(h,2),uo(d,2)];if(zt(uo(h),uo(d))){const g=$1(ut(h,l),[1,0,0])+Math.PI/2;d=[u[0]+c*Math.cos(g),u[1]+c*Math.sin(g),0],d=uo(oa(Ba(d,s),u,-.01),2);const v=Uo(h,d,s);f=[h,v,d]}return{points:o?f.reverse():f,direction:jn(o?h:d,e)}}function Uo(r,e,t){let n=[r[0],e[1]];return $r(n,t)&&(n=[e[0],r[1]]),n}function IP(r,e,t,n,i){let l=typeof e=="number"?e:.5;e==="start"&&(l=0),e==="end"&&(l=.99);const u=Sn(r.getPoint(l)),c=Sn(r.getPoint(l+.01));let h=e==="start"?"left":e==="end"?"right":"center";if(cP(u,c)||!t){const[y,m]=fx(r,l,n,i);return{transform:[["translate",y,m]],textAlign:h}}let d=Math.atan2(c[1]-u[1],c[0]-u[0]);c[0]<u[0]&&(h=h==="center"?h:h==="left"?"right":"left",n*=-1,d+=Math.PI);const[g,v]=fx(r,l,n,i,d),p=[["translate",g,v],["rotate",d/Math.PI*180]];return{textAlign:h,transform:p}}function nz(r,e,t,n,i){var a,s;const o=((a=r.badge)===null||a===void 0?void 0:a.getGeometryBounds().halfExtents[0])*2||0,l=((s=r.label)===null||s===void 0?void 0:s.getGeometryBounds().halfExtents[0])*2||0;return IP(r.key,t,!0,(l?(l/2+o/2)*(e==="suffix"?1:-1):0)+n,i)}function fx(r,e,t,n,i){const[a,s]=Sn(r.getPoint(e));let o=t,l=n;return i&&(o=t*Math.cos(i)-n*Math.sin(i),l=t*Math.sin(i)+n*Math.cos(i)),[a+o,s+l]}function jm(r,e,t,n){if(zt(r,e))return r;const i=ut(e,r),a=[r[0]+t*i[0],r[1]+t*i[1]],s=Ci(Dc(i,!1));return a[0]+=n*s[0],a[1]+=n*s[1],a}function rz(r){return _e(r)?[r,-r]:r}function iz(r){return _e(r)?[r,1-r]:r}function az(r,e,t){return[["M",r[0],r[1]],["Q",t[0],t[1],e[0],e[1]]]}function DP(r,e,t){return[["M",r[0],r[1]],["C",t[0][0],t[0][1],t[1][0],t[1][1],e[0],e[1]]]}function K1(r,e=0,t=!1){const n=r[0],i=r[r.length-1],a=r.slice(1,r.length-1),s=[["M",n[0],n[1]]];return a.forEach((o,l)=>{const u=a[l-1]||n,c=a[l+1]||i;if(!hP(u,o,c)&&e){const[h,d]=sz(u,o,c,e);s.push(["L",h[0],h[1]],["Q",o[0],o[1],d[0],d[1]],["L",d[0],d[1]])}else s.push(["L",o[0],o[1]])}),s.push(["L",i[0],i[1]]),t&&s.push(["Z"]),s}function sz(r,e,t,n){const i=cc(r,e),a=cc(t,e),s=Math.min(n,Math.min(i,a)/2),o=[e[0]-s/i*(e[0]-r[0]),e[1]-s/i*(e[1]-r[1])],l=[e[0]-s/a*(e[0]-t[0]),e[1]-s/a*(e[1]-t[1])];return[o,l]}const oz=r=>{const e=Math.PI/2,t=yi(r)/2,n=vi(r)/2,i=Math.atan2(t,n)/2,a=Math.atan2(n,t)/2;return{top:[-e-a,-e+a],"top-right":[-e+a,-i],"right-top":[-e+a,-i],right:[-i,i],"bottom-right":[i,e-a],"right-bottom":[i,e-a],bottom:[e-a,e+a],"bottom-left":[e+a,Math.PI-i],"left-bottom":[e+a,Math.PI-i],left:[Math.PI-i,Math.PI+i],"top-left":[Math.PI+i,-e-a],"left-top":[Math.PI+i,-e-a]}};function FP(r,e,t,n,i){const a=Ji(r),s=r.getCenter();let o=n&&da(n),l=i&&da(i);if(!o||!l){const u=oz(a),c=u[e][0],h=u[e][1],[d,f]=pa(a),g=Math.max(d,f),v=$e(s,[g*Math.cos(c),g*Math.sin(c),0]),p=$e(s,[g*Math.cos(h),g*Math.sin(h),0]);o=$m(r,v),l=$m(r,p),t||([o,l]=[l,o])}return[o,l]}function lz(r,e,t,n,i,a){const s=r.getPorts()[i||a],o=r.getPorts()[a||i];let[l,u]=FP(r,e,t,s,o);const c=uz(r,l,u,n);return s&&(l=Ho(s,c[0])),o&&(u=Ho(o,c[c.length-1])),DP(l,u,c)}function uz(r,e,t,n){const i=r.getCenter();if(zt(e,t)){const a=ut(e,i),s=[n*Math.sign(a[0])||n/2,n*Math.sign(a[1])||-n/2,0];return[$e(e,s),$e(t,_i(s,[1,-1,1]))]}return[oa(i,e,bt(i,e)+n),oa(i,t,bt(i,t)+n)]}function cz(r,e,t,n,i,a,s){const o=Q1(r),l=o[a||s],u=o[s||a];let[c,h]=FP(r,t,n,l,u);const d=hz(r,c,h,i);return l&&(c=Ho(l,d[0])),u&&(h=Ho(u,d[d.length-1])),K1([c,...d,h],e)}function hz(r,e,t,n){const i=[],a=Ji(r);if(zt(e,t))switch(Ro(e,a)){case"left":i.push([e[0]-n,e[1]]),i.push([e[0]-n,e[1]+n]),i.push([e[0],e[1]+n]);break;case"right":i.push([e[0]+n,e[1]]),i.push([e[0]+n,e[1]+n]),i.push([e[0],e[1]+n]);break;case"top":i.push([e[0],e[1]-n]),i.push([e[0]+n,e[1]-n]),i.push([e[0]+n,e[1]]);break;case"bottom":i.push([e[0],e[1]+n]),i.push([e[0]+n,e[1]+n]),i.push([e[0]+n,e[1]]);break}else{const s=Ro(e,a),o=Ro(t,a);if(s===o){const l=s;let u,c;switch(l){case"left":u=Math.min(e[0],t[0])-n,i.push([u,e[1]]),i.push([u,t[1]]);break;case"right":u=Math.max(e[0],t[0])+n,i.push([u,e[1]]),i.push([u,t[1]]);break;case"top":c=Math.min(e[1],t[1])-n,i.push([e[0],c]),i.push([t[0],c]);break;case"bottom":c=Math.max(e[1],t[1])+n,i.push([e[0],c]),i.push([t[0],c]);break}}else{const l=(d,f)=>({left:[f[0]-n,f[1]],right:[f[0]+n,f[1]],top:[f[0],f[1]-n],bottom:[f[0],f[1]+n]})[d],u=l(s,e),c=l(o,t),h=Uo(u,c,a);i.push(u,h,c)}}return i}function qm(r,e){const t=new Set,n=new Set,i=new Set;return r.forEach(a=>{e(a).forEach(o=>{t.add(o),r.includes(o.source)&&r.includes(o.target)?n.add(o):i.add(o)})}),{edges:Array.from(t),internal:Array.from(n),external:Array.from(i)}}function gx(r,e){const t=[];let n=r;for(;n;){t.push(n);const i=e(J(n));if(i)n=i;else break}if(t.some(i=>{var a;return(a=i.style)===null||a===void 0?void 0:a.collapsed})){const i=t.reverse().findIndex(Jn);return t[i]||t.at(-1)}return r}function dz(r,e){return e||(r<4?10:r===4?12:r*2.5)}const fz=(r,e)=>{const t=Math.max(r,e)/2;return[["M",-r/2,0],["A",t,t,0,1,0,2*t-r/2,0],["A",t,t,0,1,0,-r/2,0],["Z"]]},BP=(r,e)=>[["M",-r/2,0],["L",r/2,-e/2],["L",r/2,e/2],["Z"]],gz=(r,e)=>[["M",-r/2,0],["L",0,-e/2],["L",r/2,0],["L",0,e/2],["Z"]],pz=(r,e)=>[["M",-r/2,0],["L",r/2,-e/2],["L",4*r/5-r/2,0],["L",r/2,e/2],["Z"]],vz=(r,e)=>[["M",-r/2,-e/2],["L",r/2,-e/2],["L",r/2,e/2],["L",-r/2,e/2],["Z"]],yz=(r,e)=>{const t=r/2,n=r/7,i=r-n;return[["M",-t,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",i-t,-e/2],["L",i+n-t,-e/2],["L",i+n-t,e/2],["L",i-t,e/2],["Z"]]},mz=(r,e)=>[["M",r/2,-e/2],["L",-r/2,0],["L",r/2,0],["L",-r/2,0],["L",r/2,e/2]],bz=Object.freeze(Object.defineProperty({__proto__:null,circle:fz,diamond:gz,rect:vz,simple:mz,triangle:BP,triangleRect:yz,vee:pz},Symbol.toStringTag,{value:"Module"}));var pu=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class ma extends EP{constructor(e){super(mn({style:ma.defaultStyleProps},e)),this.type="edge"}get sourceNode(){const{sourceNode:e}=this.parsedAttributes;return this.context.element.getElement(e)}get targetNode(){const{targetNode:e}=this.parsedAttributes;return this.context.element.getElement(e)}getKeyStyle(e){const t=this.getGraphicStyle(e),{loop:n}=t,i=pu(t,["loop"]),{sourceNode:a,targetNode:s}=this,l={d:n&&Az(a,s)?this.getLoopPath(e):this.getKeyPath(e)};return ur.PARSED_STYLE_LIST.forEach(u=>{u in i&&(l[u]=i[u])}),l}getLoopPath(e){const{sourcePort:t,targetPort:n}=e,i=this.sourceNode,a=Ji(i),s=Math.max(vi(a),yi(a)),{placement:o,clockwise:l,dist:u=s}=en(this.getGraphicStyle(e),"loop");return lz(i,o,l,u,t,n)}getEndpoints(e,t=!0,n=[]){const{sourcePort:i,targetPort:a}=e,{sourceNode:s,targetNode:o}=this,[l,u]=Cz(s,o,i,a);if(!t){const f=l?da(l):s.getCenter(),g=u?da(u):o.getCenter();return[f,g]}const c=typeof n=="function"?n():n,h=bx(l||s,c[0]||u||o),d=bx(u||o,c[c.length-1]||l||s);return[h,d]}getHaloStyle(e){if(e.halo===!1)return!1;const t=this.getKeyStyle(e),n=en(this.getGraphicStyle(e),"halo");return Object.assign(Object.assign({},t),n)}getLabelStyle(e){if(e.label===!1||!e.labelText)return!1;const t=en(this.getGraphicStyle(e),"label"),{placement:n,offsetX:i,offsetY:a,autoRotate:s,maxWidth:o}=t,l=pu(t,["placement","offsetX","offsetY","autoRotate","maxWidth"]),u=IP(this.shapeMap.key,n,s,i,a),c=this.shapeMap.key.getLocalBounds(),h=W5([c.min,c.max],o);return Object.assign({wordWrapWidth:h},u,l)}getBadgeStyle(e){if(e.badge===!1||!e.badgeText)return!1;const t=en(e,"badge"),{offsetX:n,offsetY:i,placement:a}=t,s=pu(t,["offsetX","offsetY","placement"]);return Object.assign(s,nz(this.shapeMap,a,e.labelPlacement,n,i))}drawArrow(e,t){var n;const i=t==="start",s=e[t==="start"?"startArrow":"endArrow"],o=this.shapeMap.key;if(s){const l=this.getArrowStyle(e,i),[u,c,h]=i?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],d=o.parsedStyle[u];if(d)d.attr(l);else{const f=l.src?ul:ur,g=new f({style:l});o.style[u]=g}o.style[c]=e[h]||l.width/2+ +l.lineWidth}else{const l=i?"markerStart":"markerEnd";(n=o.style[l])===null||n===void 0||n.destroy(),o.style[l]=null}}getArrowStyle(e,t){const n=this.getShape("key").attributes,i=t?"startArrow":"endArrow",a=en(this.getGraphicStyle(e),i),{size:s,type:o}=a,l=pu(a,["size","type"]),[u,c]=dr(dz(n.lineWidth,s)),d=(Te(o)?o:bz[o]||BP)(u,c);return Object.assign(Ga(n,["stroke","strokeOpacity","fillOpacity"]),{width:u,height:c},Object.assign({},d&&{d,fill:o==="simple"?"":n.stroke}),l)}drawLabelShape(e,t){const n=this.getLabelStyle(e);this.upsert("label",ya,n,t)}drawHaloShape(e,t){const n=this.getHaloStyle(e);this.upsert("halo",ur,n,t)}drawBadgeShape(e,t){const n=this.getBadgeStyle(e);this.upsert("badge",Ws,n,t)}drawSourceArrow(e){this.drawArrow(e,"start")}drawTargetArrow(e){this.drawArrow(e,"end")}drawKeyShape(e,t){const n=this.getKeyStyle(e);return this.upsert("key",ur,n,t)}render(e=this.parsedAttributes,t=this){this.drawKeyShape(e,t),this.getShape("key")&&(this.drawSourceArrow(e),this.drawTargetArrow(e),this.drawLabelShape(e,t),this.drawHaloShape(e,t),this.drawBadgeShape(e,t))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(e,t){const n=super.animate(e,t);return n&&new Proxy(n,{set:(i,a,s)=>(a==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(i,a,s))})}}ma.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class ns extends ma{constructor(e){super(mn({style:ns.defaultStyleProps},e))}getKeyPath(e){const[t,n]=this.getEndpoints(e),{controlPoints:i,curvePosition:a,curveOffset:s}=e,o=this.getControlPoints(t,n,iz(a),rz(s),i);return DP(t,n,o)}getControlPoints(e,t,n,i,a){return(a==null?void 0:a.length)===2?a:[jm(e,t,n[0],i[0]),jm(e,t,n[1],i[1])]}}ns.defaultStyleProps={curvePosition:.5,curveOffset:20};class Wc extends ns{constructor(e){super(mn({style:Wc.defaultStyleProps},e))}getControlPoints(e,t,n,i){const a=t[0]-e[0];return[[e[0]+a*n[0]+i[0],e[1]],[t[0]-a*n[1]+i[1],t[1]]]}}Wc.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class Vc extends ns{constructor(e){super(mn({style:Vc.defaultStyleProps},e))}get ref(){return this.context.model.getRootsData()[0]}getEndpoints(e){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(e);const t=un(this.ref),n=this.sourceNode.getIntersectPoint(t,!0),i=this.targetNode.getIntersectPoint(t);return[n,i]}toRadialCoordinate(e){const t=un(this.ref),n=bt(e,t),i=oP(ut(e,t));return[n,i]}getControlPoints(e,t,n,i){const[a,s]=this.toRadialCoordinate(e),[o]=this.toRadialCoordinate(t),l=o-a;return[[e[0]+(l*n[0]+i[0])*Math.cos(s),e[1]+(l*n[0]+i[0])*Math.sin(s)],[t[0]-(l*n[1]-i[0])*Math.cos(s),t[1]-(l*n[1]-i[0])*Math.sin(s)]]}}Vc.defaultStyleProps={curvePosition:.5,curveOffset:20};class Uc extends ns{constructor(e){super(mn({style:Uc.defaultStyleProps},e))}getControlPoints(e,t,n,i){const a=t[1]-e[1];return[[e[0],e[1]+a*n[0]+i[0]],[t[0],t[1]-a*n[1]+i[1]]]}}Uc.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};let zP=class jP extends ma{constructor(e){super(mn({style:jP.defaultStyleProps},e))}getKeyPath(e){const[t,n]=this.getEndpoints(e);return[["M",t[0],t[1]],["L",n[0],n[1]]]}};zP.defaultStyleProps={};const wz={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:cc},Ei=r=>`${Math.round(r[0])}|||${Math.round(r[1])}`;function La(r,e){const t=n=>Math.round(n/e);return _e(r)?t(r):r.map(t)}function xz(r,e){const t=Math.abs(r-e);return t>Math.PI?2*Math.PI-t:t}function px(r,e){const t=e[0]-r[0],n=e[1]-r[1];return!t&&!n?0:Math.atan2(n,t)}function qP(r,e,t,n){const i=px(r,e),a=t[Ei(r)],o=px(a||n,r);return xz(o,i)}const Ez=(r,e)=>{const{offset:t,gridSize:n}=e,i={};return r.forEach(a=>{if(!a||a.destroyed||!a.isVisible())return;const s=va(a.getRenderBounds(),t);for(let o=La(s.min[0],n);o<=La(s.max[0],n);o+=1)for(let l=La(s.min[1],n);l<=La(s.max[1],n);l+=1)i[`${o}|||${l}`]=!0}),i};function vx(r,e,t){return Math.min(...e.map(n=>t(r,n)))}function Sz(r,e,t){let n=r[0],i=t(r[0],e);for(let a=0;a<r.length;a++){const s=r[a],o=t(s,e);o<i&&(n=s,i=o)}return n}const yx=(r,e,t,n)=>{if(!e)return[r];const{directionMap:i,offset:a}=n,s=va(e.getRenderBounds(),a),o=Object.keys(i).reduce((l,u)=>{if(t.includes(u)){const c=i[u],[h,d]=pa(s),f=[r[0]+c.stepX*h,r[1]+c.stepY*d],g=t5(s);for(let v=0;v<g.length;v++){const p=G1([r,f],g[v]);p&&QA(p,s)&&l.push(p)}}return l},[]);return $r(r,s)||o.push(r),o.map(l=>La(l,n.gridSize))},_z=(r,e,t,n,i,a,s)=>{const o=[];let l=[a[0]===n[0]?n[0]:r[0]*s,a[1]===n[1]?n[1]:r[1]*s];o.unshift(l);let u=r,c=e[Ei(u)];for(;c;){const f=c,g=u;qP(f,g,e,t)&&(l=[f[0]===g[0]?l[0]:f[0]*s,f[1]===g[1]?l[1]:f[1]*s],o.unshift(l)),c=e[Ei(f)],u=f}const h=i.map(f=>[f[0]*s,f[1]*s]),d=Sz(h,l,cc);return o.unshift(d),o};function Mz(r,e,t,n){const i=Ya(r.getCenter()),a=Ya(e.getCenter()),s=Object.assign(wz,n),{gridSize:o}=s,l=s.enableObstacleAvoidance?t:[r,e],u=Ez(l,s),c=La(i,o),h=La(a,o),d=yx(i,r,s.startDirections,s),f=yx(a,e,s.endDirections,s);d.forEach(k=>delete u[Ei(k)]),f.forEach(k=>delete u[Ei(k)]);const g={},v={},p={},y={},m={},w=new Oz;for(let k=0;k<d.length;k++){const P=d[k],C=Ei(P);g[C]=P,y[C]=0,m[C]=vx(P,f,s.distFunc),w.add({id:C,value:m[C]})}const S=f.map(k=>Ei(k));let _=s.maximumLoops,O,T=1/0;for(const[k,P]of Object.entries(g))m[k]<=T&&(T=m[k],O=P);for(;Object.keys(g).length>0&&_>0;){const k=w.minId(!1);if(k)O=g[k];else break;const P=Ei(O);if(S.includes(P))return _z(O,p,c,a,d,h,o);delete g[P],w.remove(P),v[P]=!0;for(const C of Object.values(s.directionMap)){const N=$e(O,[C.stepX,C.stepY]),L=Ei(N);if(v[L])continue;const F=qP(O,N,p,c);if(F>s.maxAllowedDirectionChange||u[L])continue;g[L]||(g[L]=N);const G=s.penalties[F],V=s.distFunc(O,N)+(isNaN(G)?o:G),U=y[P]+V,$=y[L];$&&U>=$||(p[L]=O,y[L]=U,m[L]=U+vx(N,f,s.distFunc),w.add({id:L,value:m[L]}))}_-=1}return[]}class Oz{constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}_innerAdd(e,t){let n=0,i=t-1;for(;i-n>1;){const a=Math.floor((n+i)/2);if(this.arr[a].value>e.value)i=a;else if(this.arr[a].value<e.value)n=a;else{this.arr.splice(a,0,e),this.map[e.id]=!0;return}}this.arr.splice(i,0,e),this.map[e.id]=!0}add(e){delete this.map[e.id];const t=this.arr.length;if(!t||this.arr[t-1].value<e.value){this.arr.push(e),this.map[e.id]=!0;return}this._innerAdd(e,t)}remove(e){this.map[e]&&delete this.map[e]}_clearAndGetMinId(){let e;for(let t=this.arr.length-1;t>=0;t--)this.map[this.arr[t].id]?e=this.arr[t].id:this.arr.splice(t,1);return e}_findFirstId(){for(;this.arr.length;){const e=this.arr.shift();if(this.map[e.id])return e.id}}minId(e){return e?this._clearAndGetMinId():this._findFirstId()}}class Hc extends ma{constructor(e){super(mn({style:Hc.defaultStyleProps},e))}getControlPoints(e){const{router:t}=e,{sourceNode:n,targetNode:i}=this,[a,s]=this.getEndpoints(e,!1);let o=[];if(!t)o=e.controlPoints;else if(t.type==="shortest-path"){const l=this.context.element.getNodes();o=Mz(n,i,l,t),o.length||(o=cx(a,s,n,i,e.controlPoints,{padding:t.offset}))}else t.type==="orth"&&(o=cx(a,s,n,i,e.controlPoints,t));return o}getPoints(e){const t=this.getControlPoints(e),[n,i]=this.getEndpoints(e,!0,t);return[n,...t,i]}getKeyPath(e){const t=this.getPoints(e);return K1(t,e.radius)}getLoopPath(e){const{sourcePort:t,targetPort:n,radius:i}=e,a=this.sourceNode,s=Ji(a),o=Math.max(vi(s),yi(s))/4,{placement:l,clockwise:u,dist:c=o}=en(this.getGraphicStyle(e),"loop");return cz(a,i,l,u,c,t,n)}}Hc.defaultStyleProps={radius:0,controlPoints:[],router:!1};class Yc extends ma{constructor(e){super(mn({style:Yc.defaultStyleProps},e))}getKeyPath(e){const{curvePosition:t,curveOffset:n}=e,[i,a]=this.getEndpoints(e),s=e.controlPoint||jm(i,a,t,n);return az(i,a,s)}}Yc.defaultStyleProps={curvePosition:.5,curveOffset:30};var kz=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function pl(r){return r instanceof Vr&&r.type==="node"}function $P(r){return r instanceof ma}function Z1(r){return r instanceof Vs}function Tz(r){return pl(r)||$P(r)||Z1(r)}function Az(r,e){return!r||!e?!1:r===e}const Pz={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],default:[.5,.5]};function J1(r,e,t=Pz,n=!0){const i=[.5,.5],a=rt(e)?Bn(t,e.toLocaleLowerCase(),i):e;if(!n&&rt(e))return a;const[s,o]=a||i;return[r.min[0]+vi(r)*s,r.min[1]+yi(r)*o]}function Q1(r){if(!r)return{};const e=r.getPorts();return(r.attributes.ports||[]).forEach((n,i)=>{var a;const{key:s,placement:o}=n;GP(n)&&(e[a=s||i]||(e[a]=Mi(r.getShape("key").getBounds(),o)))}),e}function GP(r){const{r:e}=r;return!e||Number(e)===0}function da(r){return zs(r)?r:r.getPosition()}function Cz(r,e,t,n){const i=mx(r,e,t,n),a=mx(e,r,n,t);return[i,a]}function mx(r,e,t,n){const i=Q1(r);if(t)return i[t];const a=Object.values(i);if(a.length===0)return;const s=a.map(u=>da(u)),o=Nz(e,n),[l]=R5(s,o);return a.find(u=>da(u)===l)}function Nz(r,e){const t=Q1(r);if(e)return[da(t[e])];const n=Object.values(t);return n.length>0?n.map(i=>da(i)):[r.getCenter()]}function bx(r,e){return Z1(r)||pl(r)?$m(r,e):Ho(r,e)}function Ho(r,e){if(!r||!e)return[0,0,0];if(zs(r))return r;if(r.attributes.linkToCenter)return r.getPosition();const t=zs(e)?e:pl(e)?e.getCenter():e.getPosition();return Fc(t,r.getBounds())}function $m(r,e){if(!r||!e)return[0,0,0];const t=zs(e)?e:pl(e)?e.getCenter():e.getPosition();return r.getIntersectPoint(t)||r.getCenter()}function wx(r,e="bottom",t=0,n=0,i=!1){const a=e.split("-"),[s,o]=Mi(r,e),l=a.includes("left")?"right":a.includes("right")?"left":"center";let u=a.includes("top")?"bottom":a.includes("bottom")?"top":"middle";return i&&(u=u==="top"?"bottom":u==="bottom"?"top":u),{transform:[["translate",s+t,o+n]],textBaseline:u,textAlign:l}}function Rz(r,e){return[[0,-r],[e*Math.cos(3*Math.PI/10),-e*Math.sin(3*Math.PI/10)],[r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],[e*Math.cos(Math.PI/10),e*Math.sin(Math.PI/10)],[r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],[0,e],[-r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],[-e*Math.cos(Math.PI/10),e*Math.sin(Math.PI/10)],[-r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],[-e*Math.cos(3*Math.PI/10),-e*Math.sin(3*Math.PI/10)]]}function Lz(r,e){const t={};return t.top=[0,-r],t.left=[-r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],t["left-bottom"]=[-r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],t.bottom=[0,e],t["right-bottom"]=[r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],t.right=t.default=[r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],t}function Iz(r,e,t){const n=e/2,i=r/2,a={up:[[-i,n],[i,n],[0,-n]],left:[[-i,0],[i,n],[i,-n]],right:[[-i,n],[-i,-n],[i,0]],down:[[-i,-n],[i,-n],[0,n]]};return a[t]||a.up}function Dz(r,e,t){const n=e/2,i=r/2,a={};return t==="down"?(a.bottom=a.default=[0,n],a.right=[i,-n],a.left=[-i,-n]):t==="left"?(a.top=[i,-n],a.bottom=[i,n],a.left=a.default=[-i,0]):t==="right"?(a.top=[-i,-n],a.bottom=[-i,n],a.right=a.default=[i,0]):(a.left=[-i,n],a.top=a.default=[0,-n],a.right=[i,n]),a}function Fz(r,e){return[[0,-e/2],[r/2,0],[0,e/2],[-r/2,0]]}function Bz(r){return Bn(r,["style","visibility"])!=="hidden"}function zz(r,e){const{zIndex:t,transform:n,transformOrigin:i,visibility:a,cursor:s,clipPath:o,component:l}=e,u=kz(e,["zIndex","transform","transformOrigin","visibility","cursor","clipPath","component"]);Object.assign(r.attributes,u),n&&r.setAttribute("transform",n),_e(t)&&r.setAttribute("zIndex",t),i&&r.setAttribute("transformOrigin",i),a&&r.setAttribute("visibility",a),s&&r.setAttribute("cursor",s),o&&r.setAttribute("clipPath",o),l&&r.setAttribute("component",l)}function Gm(r,e){"update"in r?r.update(e):r.attr(e)}function jz(r){return[[0,r],[r*Math.sqrt(3)/2,r/2],[r*Math.sqrt(3)/2,-r/2],[0,-r],[-r*Math.sqrt(3)/2,-r/2],[-r*Math.sqrt(3)/2,r/2]]}function qz(r){Bo(r,"__to_be_destroyed__",!0)}function Xc(r){return Bn(r,"__to_be_destroyed__",!1)}var $z=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Kc extends vr{constructor(e,t){super(e,Object.assign({},Kc.defaultOptions,t)),this.onCollapseExpand=n=>$z(this,void 0,void 0,function*(){if(!this.validate(n))return;const{target:i}=n;if(!Tz(i))return;const a=i.id,{model:s,graph:o}=this.context,l=s.getElementDataById(a);if(!l)return!1;const{onCollapse:u,onExpand:c,animation:h,align:d}=this.options;Jn(l)?(yield o.expandElement(a,{animation:h,align:d}),c==null||c(a)):(yield o.collapseElement(a,{animation:h,align:d}),u==null||u(a))}),this.bindEvents()}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}bindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;e.on(`node:${t}`,this.onCollapseExpand),e.on(`combo:${t}`,this.onCollapseExpand)}unbindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;e.off(`node:${t}`,this.onCollapseExpand),e.off(`combo:${t}`,this.onCollapseExpand)}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}destroy(){this.unbindEvents(),super.destroy()}}Kc.defaultOptions={enable:!0,animation:!0,trigger:ie.DBLCLICK,align:!0};var vu=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};const Gz="g6-create-edge-assist-edge-id",yu="g6-create-edge-assist-node-id";class Zc extends vr{constructor(e,t){super(e,Object.assign({},Zc.defaultOptions,t)),this.drop=n=>vu(this,void 0,void 0,function*(){const{targetType:i}=n;["combo","node"].includes(i)&&this.source?yield this.handleCreateEdge(n):yield this.cancelEdge()}),this.handleCreateEdge=n=>vu(this,void 0,void 0,function*(){var i,a,s;if(!this.validate(n))return;const{graph:o,canvas:l,batch:u,element:c}=this.context,{style:h}=this.options;if(this.source){this.createEdge(n),yield this.cancelEdge();return}u.startBatch(),l.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([n.target.id])[0];const d=o.getElementData(this.source);o.addNodeData([{id:yu,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:(i=d.style)===null||i===void 0?void 0:i.x,y:(a=d.style)===null||a===void 0?void 0:a.y}}]),o.addEdgeData([{id:Gz,source:this.source,target:yu,style:Object.assign({pointerEvents:"none"},h)}]),yield(s=c.draw({animation:!1}))===null||s===void 0?void 0:s.finished}),this.updateAssistEdge=n=>vu(this,void 0,void 0,function*(){var i;if(!this.source)return;const{model:a,element:s}=this.context;a.translateNodeTo(yu,[n.canvas.x,n.canvas.y]),yield(i=s.draw({animation:!1,silence:!0}))===null||i===void 0?void 0:i.finished}),this.createEdge=n=>{var i,a;const{graph:s}=this.context,{style:o,onFinish:l,onCreate:u}=this.options;if(((i=n.target)===null||i===void 0?void 0:i.id)===void 0||this.source===void 0)return;const h=(a=this.getSelectedNodeIDs([n.target.id]))===null||a===void 0?void 0:a[0],d=`${this.source}-${h}-${k3()}`,f=u({id:d,source:this.source,target:h,style:o});s.addEdgeData([f]),l(f)},this.cancelEdge=()=>vu(this,void 0,void 0,function*(){var n;if(!this.source)return;const{graph:i,element:a,batch:s}=this.context;i.removeNodeData([yu]),this.source=void 0,yield(n=a.draw({animation:!1}))===null||n===void 0?void 0:n.finished,s.endBatch()}),this.bindEvents()}update(e){super.update(e),this.bindEvents()}bindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;this.unbindEvents(),t==="click"?(e.on(kr.CLICK,this.handleCreateEdge),e.on(Na.CLICK,this.handleCreateEdge),e.on(Ni.CLICK,this.cancelEdge),e.on(lc.CLICK,this.cancelEdge)):(e.on(kr.DRAG_START,this.handleCreateEdge),e.on(Na.DRAG_START,this.handleCreateEdge),e.on(ie.POINTER_UP,this.drop)),e.on(ie.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(e){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(e)))}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}unbindEvents(){const{graph:e}=this.context;e.off(kr.CLICK,this.handleCreateEdge),e.off(Na.CLICK,this.handleCreateEdge),e.off(Ni.CLICK,this.cancelEdge),e.off(lc.CLICK,this.cancelEdge),e.off(kr.DRAG_START,this.handleCreateEdge),e.off(Na.DRAG_START,this.handleCreateEdge),e.off(ie.POINTER_UP,this.drop),e.off(ie.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}}Zc.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:r=>r,onFinish:()=>{}};var xx=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Jc extends vr{constructor(e,t){super(e,Object.assign({},Jc.defaultOptions,t)),this.isDragging=!1,this.onDragStart=n=>{this.validate(n)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=n=>{var i,a,s,o;if(!this.isDragging||Ht.isPinching)return;const l=(a=(i=n.movement)===null||i===void 0?void 0:i.x)!==null&&a!==void 0?a:n.dx,u=(o=(s=n.movement)===null||s===void 0?void 0:s.y)!==null&&o!==void 0?o:n.dy;(l|u)!==0&&this.translate([l,u],!1)},this.onDragEnd=()=>{var n,i;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),(i=(n=this.options).onFinish)===null||i===void 0||i.call(n)},this.invokeOnFinish=rl(()=>{var n,i;(i=(n=this.options).onFinish)===null||i===void 0||i.call(n)},300),this.shortcut=new Gs(e.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}bindEvents(){const{trigger:e}=this.options;if(Yt(e)){const{up:t=[],down:n=[],left:i=[],right:a=[]}=e;this.shortcut.bind(t,s=>this.onTranslate([0,1],s)),this.shortcut.bind(n,s=>this.onTranslate([0,-1],s)),this.shortcut.bind(i,s=>this.onTranslate([1,0],s)),this.shortcut.bind(a,s=>this.onTranslate([-1,0],s))}else{const{graph:t}=this.context;t.on(ie.DRAG_START,this.onDragStart),t.on(ie.DRAG,this.onDrag),t.on(ie.DRAG_END,this.onDragEnd)}}onTranslate(e,t){return xx(this,void 0,void 0,function*(){if(!this.validate(t))return;const{sensitivity:n}=this.options,i=n*-1;yield this.translate(_i(e,i),this.options.animation),this.invokeOnFinish()})}translate(e,t){return xx(this,void 0,void 0,function*(){e=this.clampByDirection(e),e=this.clampByRange(e),yield this.context.graph.translateBy(e,t)})}clampByDirection([e,t]){const{direction:n}=this.options;return n==="x"?t=0:n==="y"&&(e=0),[e,t]}clampByRange([e,t]){const{viewport:n,canvas:i}=this.context,[a,s]=i.getSize(),[o,l,u,c]=pi(this.options.range),h=[s*o,a*l,s*u,a*c],d=va(B1(n.getCanvasCenter()),h),f=ut(n.getViewportCenter(),[e,t,0]);if(!$r(f,d)){const{min:[g,v],max:[p,y]}=d;(f[0]<g&&e>0||f[0]>p&&e<0)&&(e=0),(f[1]<v&&t>0||f[1]>y&&t<0)&&(t=0)}return[e,t]}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return typeof t=="function"?t(e):!!t}unbindEvents(){this.shortcut.unbindAll();const{graph:e}=this.context;e.off(ie.DRAG_START,this.onDragStart),e.off(ie.DRAG,this.onDrag),e.off(ie.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}}Jc.defaultOptions={enable:r=>"targetType"in r?r.targetType==="canvas":!0,sensitivity:10,direction:"both",range:1/0};var Ex=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class vl extends vr{constructor(e,t){super(e,Object.assign({},vl.defaultOptions,t)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=n=>Ex(this,void 0,void 0,function*(){var i;if(this.options.dropEffect!=="link")return;const{model:a,element:s}=this.context,o=n.target.id;this.target.forEach(l=>{const u=a.getParentData(l,ct);u&&J(u)===o&&a.refreshComboData(o),a.setParent(l,o,ct)}),yield(i=s==null?void 0:s.draw({animation:!0}))===null||i===void 0?void 0:i.finished}),this.setCursor=n=>{if(this.isDragging)return;const{type:i}=n,{canvas:a}=this.context,{cursor:s}=this.options;i===ie.POINTER_ENTER?a.setCursor((s==null?void 0:s.grab)||"grab"):a.setCursor((s==null?void 0:s.default)||"default")},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}bindEvents(){const{graph:e,canvas:t}=this.context,n=t.getLayer().getContextService().$canvas;n&&(n.addEventListener("blur",this.onDragEnd),n.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(i=>{e.on(`${i}:${ie.DRAG_START}`,this.onDragStart),e.on(`${i}:${ie.DRAG}`,this.onDrag),e.on(`${i}:${ie.DRAG_END}`,this.onDragEnd),e.on(`${i}:${ie.POINTER_ENTER}`,this.setCursor),e.on(`${i}:${ie.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(e.on(Na.DROP,this.onDrop),e.on(Ni.DROP,this.onDrop))}getSelectedNodeIDs(e){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(e)))}getDelta(e){const t=this.context.graph.getZoom();return Gr([e.dx,e.dy],t)}onDragStart(e){var t;if(this.enable=this.validate(e),!this.enable)return;const{batch:n,canvas:i,graph:a}=this.context;i.setCursor(((t=this.options.cursor)===null||t===void 0?void 0:t.grabbing)||"grabbing"),this.isDragging=!0,n.startBatch();const s=e.target.id;a.getElementState(s).includes(this.options.state)?this.target=this.getSelectedNodeIDs([s]):this.target=[s],this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(e){if(!this.enable)return;const t=this.getDelta(e);this.options.shadow?this.moveShadow(t):this.moveElement(this.target,t)}onDragEnd(){var e,t,n;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:s=0,y:o=0}=this.shadow.attributes,[l,u]=ut([+s,+o],this.shadowOrigin);this.moveElement(this.target,[l,u])}this.showEdges(),(t=(e=this.options).onFinish)===null||t===void 0||t.call(e,this.target);const{batch:i,canvas:a}=this.context;i.endBatch(),a.setCursor(((n=this.options.cursor)===null||n===void 0?void 0:n.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}moveElement(e,t){return Ex(this,void 0,void 0,function*(){const{graph:n,model:i}=this.context,{dropEffect:a}=this.options;a==="move"&&e.forEach(s=>i.refreshComboData(s)),n.translateElementBy(Object.fromEntries(e.map(s=>[s,t])),!1)})}moveShadow(e){if(!this.shadow)return;const{x:t=0,y:n=0}=this.shadow.attributes,[i,a]=e;this.shadow.attr({x:+t+i,y:+n+a})}createShadow(e){const t=en(this.options,"shadow"),n=cl(e.map(u=>this.context.element.getElement(u).getBounds())),[i,a]=n.min;this.shadowOrigin=[i,a];const[s,o]=pa(n),l={width:s,height:o,x:i,y:a};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},t),l),{visibility:"visible"})):(this.shadow=new Mn({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},t),l),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||this.hiddenEdges.length===0||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:e,shadow:t}=this.options;if(e==="none"||t)return;const{graph:n}=this.context;e==="all"?this.hiddenEdges=n.getEdgeData().map(J):this.hiddenEdges=Array.from(new Set(this.target.map(i=>n.getRelatedEdgesData(i,e).map(J)).flat())),n.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:e,canvas:t}=this.context,n=t.getLayer().getContextService().$canvas;n&&(n.removeEventListener("blur",this.onDragEnd),n.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(i=>{e.off(`${i}:${ie.DRAG_START}`,this.onDragStart),e.off(`${i}:${ie.DRAG}`,this.onDrag),e.off(`${i}:${ie.DRAG_END}`,this.onDragEnd),e.off(`${i}:${ie.POINTER_ENTER}`,this.setCursor),e.off(`${i}:${ie.POINTER_LEAVE}`,this.setCursor)}),e.off(`combo:${ie.DROP}`,this.onDrop),e.off(`canvas:${ie.DROP}`,this.onDrop)}destroy(){var e;this.unbindEvents(),(e=this.shadow)===null||e===void 0||e.destroy(),super.destroy()}}vl.defaultOptions={animation:!0,enable:r=>["node","combo"].includes(r.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var Wz="*",Qc=function(){function r(){this._events={}}return r.prototype.on=function(e,t,n){return this._events[e]||(this._events[e]=[]),this._events[e].push({callback:t,once:!!n}),this},r.prototype.once=function(e,t){return this.on(e,t,!0)},r.prototype.emit=function(e){for(var t=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var a=this._events[e]||[],s=this._events[Wz]||[],o=function(l){for(var u=l.length,c=0;c<u;c++)if(l[c]){var h=l[c],d=h.callback,f=h.once;f&&(l.splice(c,1),l.length===0&&delete t._events[e],u--,c--),d.apply(t,n)}};o(a),o(s)},r.prototype.off=function(e,t){if(!e)this._events={};else if(!t)delete this._events[e];else{for(var n=this._events[e]||[],i=n.length,a=0;a<i;a++)n[a].callback===t&&(n.splice(a,1),i--,a--);n.length===0&&delete this._events[e]}return this},r.prototype.getEvents=function(){return this._events},r}();function Wm(r,e,t,n){for(;r.length;){const i=r.shift();if(t(i))return!0;e.add(i.id),n(i.id).forEach(s=>{e.has(s.id)||(e.add(s.id),r.push(s))})}return!1}function vc(r,e,t,n){if(t(r))return!0;e.add(r.id);for(const a of n(r.id))if(!e.has(a.id)&&vc(a,e,t,n))return!0;return!1}const Sx=()=>!0;class Vz{constructor(e){St(this,"graph");St(this,"nodeFilter");St(this,"edgeFilter");St(this,"cacheEnabled");St(this,"inEdgesMap",new Map);St(this,"outEdgesMap",new Map);St(this,"bothEdgesMap",new Map);St(this,"allNodesMap",new Map);St(this,"allEdgesMap",new Map);St(this,"clearCache",()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear()});St(this,"refreshCache",()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map(e=>e.id))});St(this,"updateCache",e=>{const t=new Set;e.forEach(n=>{const i=this.bothEdgesMap.get(n);if(i&&i.forEach(a=>t.add(a.id)),!this.hasNode(n))this.inEdgesMap.delete(n),this.outEdgesMap.delete(n),this.bothEdgesMap.delete(n),this.allNodesMap.delete(n);else{const a=this.graph.getRelatedEdges(n,"in").filter(this.edgeFilter),s=this.graph.getRelatedEdges(n,"out").filter(this.edgeFilter),o=Array.from(new Set([...a,...s]));o.forEach(l=>t.add(l.id)),this.inEdgesMap.set(n,a),this.outEdgesMap.set(n,s),this.bothEdgesMap.set(n,o),this.allNodesMap.set(n,this.graph.getNode(n))}}),t.forEach(n=>{this.hasEdge(n)?this.allEdgesMap.set(n,this.graph.getEdge(n)):this.allEdgesMap.delete(n)})});St(this,"handleGraphChanged",e=>{const t=new Set;e.changes.forEach(n=>{switch(n.type){case"NodeAdded":t.add(n.value.id);break;case"NodeDataUpdated":t.add(n.id);break;case"EdgeAdded":t.add(n.value.source),t.add(n.value.target);break;case"EdgeUpdated":(n.propertyName==="source"||n.propertyName==="target")&&(t.add(n.oldValue),t.add(n.newValue));break;case"EdgeDataUpdated":if(e.graph.hasEdge(n.id)){const i=e.graph.getEdge(n.id);t.add(i.source),t.add(i.target)}break;case"EdgeRemoved":t.add(n.value.source),t.add(n.value.target);break;case"NodeRemoved":t.add(n.value.id);break}}),this.updateCache(t)});this.graph=e.graph;const t=e.nodeFilter||Sx,n=e.edgeFilter||Sx;this.nodeFilter=t,this.edgeFilter=i=>{const{source:a,target:s}=this.graph.getEdgeDetail(i.id);return!t(a)||!t(s)?!1:n(i,a,s)},e.cache==="auto"?(this.cacheEnabled=!0,this.startAutoCache()):e.cache==="manual"?this.cacheEnabled=!0:this.cacheEnabled=!1}startAutoCache(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged)}stopAutoCache(){this.graph.off("changed",this.handleGraphChanged)}checkNodeExistence(e){this.getNode(e)}hasNode(e){if(!this.graph.hasNode(e))return!1;const t=this.graph.getNode(e);return this.nodeFilter(t)}areNeighbors(e,t){return this.checkNodeExistence(e),this.getNeighbors(t).some(n=>n.id===e)}getNode(e){const t=this.graph.getNode(e);if(!this.nodeFilter(t))throw new Error("Node not found for id: "+e);return t}getRelatedEdges(e,t){return this.checkNodeExistence(e),this.cacheEnabled?t==="in"?this.inEdgesMap.get(e):t==="out"?this.outEdgesMap.get(e):this.bothEdgesMap.get(e):this.graph.getRelatedEdges(e,t).filter(this.edgeFilter)}getDegree(e,t){return this.getRelatedEdges(e,t).length}getSuccessors(e){const n=this.getRelatedEdges(e,"out").map(i=>this.getNode(i.target));return Array.from(new Set(n))}getPredecessors(e){const n=this.getRelatedEdges(e,"in").map(i=>this.getNode(i.source));return Array.from(new Set(n))}getNeighbors(e){const t=this.getPredecessors(e),n=this.getSuccessors(e);return Array.from(new Set([...t,...n]))}hasEdge(e){if(!this.graph.hasEdge(e))return!1;const t=this.graph.getEdge(e);return this.edgeFilter(t)}getEdge(e){const t=this.graph.getEdge(e);if(!this.edgeFilter(t))throw new Error("Edge not found for id: "+e);return t}getEdgeDetail(e){const t=this.getEdge(e);return{edge:t,source:this.getNode(t.source),target:this.getNode(t.target)}}hasTreeStructure(e){return this.graph.hasTreeStructure(e)}getRoots(e){return this.graph.getRoots(e).filter(this.nodeFilter)}getChildren(e,t){return this.checkNodeExistence(e),this.graph.getChildren(e,t).filter(this.nodeFilter)}getParent(e,t){this.checkNodeExistence(e);const n=this.graph.getParent(e,t);return!n||!this.nodeFilter(n)?null:n}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}bfs(e,t,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];Wm([this.getNode(e)],new Set,t,i)}dfs(e,t,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];vc(this.getNode(e),new Set,t,i)}}let dn=class WP extends Qc{constructor(t){super();St(this,"nodeMap",new Map);St(this,"edgeMap",new Map);St(this,"inEdgesMap",new Map);St(this,"outEdgesMap",new Map);St(this,"bothEdgesMap",new Map);St(this,"treeIndices",new Map);St(this,"changes",[]);St(this,"batchCount",0);St(this,"onChanged",()=>{});St(this,"batch",t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()});t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}commit(){const t=this.changes;this.changes=[];const n={graph:this,changes:t};this.emit("changed",n),this.onChanged(n)}reduceChanges(t){let n=[];return t.forEach(i=>{switch(i.type){case"NodeRemoved":{let a=!1;n=n.filter(s=>{if(s.type==="NodeAdded"){const o=s.value.id===i.value.id;return o&&(a=!0),!o}else{if(s.type==="NodeDataUpdated")return s.id!==i.value.id;if(s.type==="TreeStructureChanged")return s.nodeId!==i.value.id}return!0}),a||n.push(i);break}case"EdgeRemoved":{let a=!1;n=n.filter(s=>{if(s.type==="EdgeAdded"){const o=s.value.id===i.value.id;return o&&(a=!0),!o}else if(s.type==="EdgeDataUpdated"||s.type==="EdgeUpdated")return s.id!==i.value.id;return!0}),a||n.push(i);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const a=n.findIndex(o=>o.type===i.type&&o.id===i.id&&(i.propertyName===void 0||o.propertyName===i.propertyName)),s=n[a];s?i.propertyName!==void 0?s.newValue=i.newValue:(n.splice(a,1),n.push(i)):n.push(i);break}case"TreeStructureDetached":{n=n.filter(a=>a.type==="TreeStructureAttached"||a.type==="TreeStructureChanged"?a.treeKey!==i.treeKey:!0),n.push(i);break}case"TreeStructureChanged":{const a=n.find(s=>s.type==="TreeStructureChanged"&&s.treeKey===i.treeKey&&s.nodeId===i.nodeId);a?a.newParentId=i.newParentId:n.push(i);break}default:n.push(i);break}}),n}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,n){return this.getNeighbors(n).some(i=>i.id===t)}getNode(t){const n=this.nodeMap.get(t);if(!n)throw new Error("Node not found for id: "+t);return n}getRelatedEdges(t,n){if(this.checkNodeExistence(t),n==="in"){const i=this.inEdgesMap.get(t);return Array.from(i)}else if(n==="out"){const i=this.outEdgesMap.get(t);return Array.from(i)}else{const i=this.bothEdgesMap.get(t);return Array.from(i)}}getDegree(t,n){return this.getRelatedEdges(t,n).length}getSuccessors(t){const i=this.getRelatedEdges(t,"out").map(a=>this.getNode(a.target));return Array.from(new Set(i))}getPredecessors(t){const i=this.getRelatedEdges(t,"in").map(a=>this.getNode(a.source));return Array.from(new Set(i))}getNeighbors(t){const n=this.getPredecessors(t),i=this.getSuccessors(t);return Array.from(new Set([...n,...i]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach(n=>{n.childrenMap.set(t.id,new Set)}),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch(()=>{for(const n of t)this.doAddNode(n)})}addNode(t){this.addNodes([t])}doRemoveNode(t){const n=this.getNode(t),i=this.bothEdgesMap.get(t);i==null||i.forEach(a=>this.doRemoveEdge(a.id)),this.nodeMap.delete(t),this.treeIndices.forEach(a=>{var o,l;(o=a.childrenMap.get(t))==null||o.forEach(u=>{a.parentMap.delete(u.id)});const s=a.parentMap.get(t);s&&((l=a.childrenMap.get(s.id))==null||l.delete(n)),a.parentMap.delete(t),a.childrenMap.delete(t)}),this.bothEdgesMap.delete(t),this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.changes.push({type:"NodeRemoved",value:n})}removeNodes(t){this.batch(()=>{t.forEach(n=>this.doRemoveNode(n))})}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,n,i){const a=this.getNode(t);this.batch(()=>{const s=a.data[n],o=i;a.data[n]=o,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:n,oldValue:s,newValue:o})})}mergeNodeData(t,n){this.batch(()=>{Object.entries(n).forEach(([i,a])=>{this.updateNodeDataProperty(t,i,a)})})}updateNodeData(...t){const n=t[0],i=this.getNode(n);if(typeof t[1]=="string"){this.updateNodeDataProperty(n,t[1],t[2]);return}let a;if(typeof t[1]=="function"){const s=t[1];a=s(i.data)}else typeof t[1]=="object"&&(a=t[1]);this.batch(()=>{const s=i.data,o=a;i.data=a,this.changes.push({type:"NodeDataUpdated",id:n,oldValue:s,newValue:o})})}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const n=this.getEdge(t);return{edge:n,source:this.getNode(n.source),target:this.getNode(n.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const n=this.inEdgesMap.get(t.target),i=this.outEdgesMap.get(t.source),a=this.bothEdgesMap.get(t.source),s=this.bothEdgesMap.get(t.target);n.add(t),i.add(t),a.add(t),s.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch(()=>{for(const n of t)this.doAddEdge(n)})}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const n=this.getEdge(t),i=this.outEdgesMap.get(n.source),a=this.inEdgesMap.get(n.target),s=this.bothEdgesMap.get(n.source),o=this.bothEdgesMap.get(n.target);i.delete(n),a.delete(n),s.delete(n),o.delete(n),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:n})}removeEdges(t){this.batch(()=>{t.forEach(n=>this.doRemoveEdge(n))})}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,n){const i=this.getEdge(t);this.checkNodeExistence(n);const a=i.source,s=n;this.outEdgesMap.get(a).delete(i),this.bothEdgesMap.get(a).delete(i),this.outEdgesMap.get(s).add(i),this.bothEdgesMap.get(s).add(i),i.source=n,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:a,newValue:s})})}updateEdgeTarget(t,n){const i=this.getEdge(t);this.checkNodeExistence(n);const a=i.target,s=n;this.inEdgesMap.get(a).delete(i),this.bothEdgesMap.get(a).delete(i),this.inEdgesMap.get(s).add(i),this.bothEdgesMap.get(s).add(i),i.target=n,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:a,newValue:s})})}updateEdgeDataProperty(t,n,i){const a=this.getEdge(t);this.batch(()=>{const s=a.data[n],o=i;a.data[n]=o,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:n,oldValue:s,newValue:o})})}updateEdgeData(...t){const n=t[0],i=this.getEdge(n);if(typeof t[1]=="string"){this.updateEdgeDataProperty(n,t[1],t[2]);return}let a;if(typeof t[1]=="function"){const s=t[1];a=s(i.data)}else typeof t[1]=="object"&&(a=t[1]);this.batch(()=>{const s=i.data,o=a;i.data=a,this.changes.push({type:"EdgeDataUpdated",id:n,oldValue:s,newValue:o})})}mergeEdgeData(t,n){this.batch(()=>{Object.entries(n).forEach(([i,a])=>{this.updateEdgeDataProperty(t,i,a)})})}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})}))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})})}addTree(t,n){this.batch(()=>{this.attachTreeStructure(n);const i=[],a=Array.isArray(t)?t:[t];for(;a.length;){const s=a.shift();i.push(s),s.children&&a.push(...s.children)}this.addNodes(i),i.forEach(s=>{var o;(o=s.children)==null||o.forEach(l=>{this.setParent(l.id,s.id,n)})})})}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter(n=>!this.getParent(n.id,t))}getChildren(t,n){this.checkNodeExistence(t),this.checkTreeExistence(n);const a=this.treeIndices.get(n).childrenMap.get(t);return Array.from(a||[])}getParent(t,n){return this.checkNodeExistence(t),this.checkTreeExistence(n),this.treeIndices.get(n).parentMap.get(t)||null}getAncestors(t,n){const i=[];let a=this.getNode(t),s;for(;s=this.getParent(a.id,n);)i.push(s),a=s;return i}setParent(t,n,i){var c,h;this.checkTreeExistence(i);const a=this.treeIndices.get(i);if(!a)return;const s=this.getNode(t),o=a.parentMap.get(t);if((o==null?void 0:o.id)===n)return;if(n==null){o&&((c=a.childrenMap.get(o.id))==null||c.delete(s)),a.parentMap.delete(t);return}const l=this.getNode(n);a.parentMap.set(t,l),o&&((h=a.childrenMap.get(o.id))==null||h.delete(s));let u=a.childrenMap.get(l.id);u||(u=new Set,a.childrenMap.set(l.id,u)),u.add(s),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:i,nodeId:t,oldParentId:o==null?void 0:o.id,newParentId:l.id})})}dfsTree(t,n,i){const a=s=>this.getChildren(s,i);return vc(this.getNode(t),new Set,n,a)}bfsTree(t,n,i){const a=s=>this.getChildren(s,i);return Wm([this.getNode(t)],new Set,n,a)}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,n,i="out"){const a={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[i];return Wm([this.getNode(t)],new Set,n,a)}dfs(t,n,i="out"){const a={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[i];return vc(this.getNode(t),new Set,n,a)}clone(){const t=this.getAllNodes().map(a=>({...a,data:{...a.data}})),n=this.getAllEdges().map(a=>({...a,data:{...a.data}})),i=new WP({nodes:t,edges:n});return this.treeIndices.forEach(({parentMap:a,childrenMap:s},o)=>{const l=new Map;a.forEach((c,h)=>{l.set(h,i.getNode(c.id))});const u=new Map;s.forEach((c,h)=>{u.set(h,new Set(Array.from(c).map(d=>i.getNode(d.id))))}),i.treeIndices.set(o,{parentMap:l,childrenMap:u})}),i}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}createView(t){return new Vz({graph:this,...t})}};class eh{constructor(e,t){this.context=e,this.options=t||{}}}var Uz=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},Hz=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function Yz(r){const{type:e}=r;return["compact-box","mindmap","dendrogram","indented"].includes(e)}function Xz(r){return!Array.isArray(r)&&(r==null?void 0:r.preLayout)}function Iu(r){const{nodes:e,edges:t}=r,n={nodes:[],edges:[],combos:[]};return e.forEach(i=>{const a=i.data._isCombo?n.combos:n.nodes,{x:s,y:o,z:l=0}=i.data;a==null||a.push({id:i.id,style:{x:s,y:o,z:l}})}),t.forEach(i=>{const{id:a,source:s,target:o,data:{points:l=[],controlPoints:u=l.slice(1,l.length-1)}}=i;n.edges.push({id:a,source:s,target:o,style:Object.assign({},u!=null&&u.length?{controlPoints:u.map(Sn)}:{})})}),n}function Kz(r,e){class t extends eh{constructor(i,a){if(super(i,a),this.instance=new r({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const s=this.instance;this.stop=s.stop.bind(s),this.tick=o=>{const l=s.tick(o);return Iu(l)}}}execute(i,a){return Uz(this,void 0,void 0,function*(){return Iu(yield this.instance.execute(this.graphData2LayoutModel(i),this.transformOptions($n({},this.options,a))))})}transformOptions(i){const{onTick:a}=i;return a&&(i.onTick=s=>a(Iu(s))),i}graphData2LayoutModel(i){const{nodes:a=[],edges:s=[],combos:o=[]}=i,l=a.map(f=>{const g=J(f),{data:v,style:p,combo:y}=f,m=Hz(f,["data","style","combo"]),w={id:g,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},v),{data:v}),y?{parentId:y}:{}),{style:p}),m)};return p!=null&&p.x&&Object.assign(w.data,{x:p.x}),p!=null&&p.y&&Object.assign(w.data,{y:p.y}),p!=null&&p.z&&Object.assign(w.data,{z:p.z}),w}),u=new Map(l.map(f=>[f.id,f])),c=s.filter(f=>{const{source:g,target:v}=f;return u.has(g)&&u.has(v)}).map(f=>{const{source:g,target:v,data:p,style:y}=f;return{id:J(f),source:g,target:v,data:Object.assign({},p),style:Object.assign({},y)}}),h=o.map(f=>({id:J(f),data:Object.assign({_isCombo:!0},f.data),style:Object.assign({},f.style)})),d=new dn({nodes:[...l,...h],edges:c});return e.model.model.hasTreeStructure(ct)&&(d.attachTreeStructure(ct),l.forEach(f=>{const g=e.model.model.getParent(f.id,ct);g&&d.hasNode(g.id)&&d.setParent(f.id,g.id,ct)})),d}}return t}function Hd(r,e,...t){if(e in r)return r[e](...t);if("instance"in r){const n=r.instance;if(e in n)return n[e](...t)}return null}function _x(r,e){if(e in r)return r[e];if("instance"in r){const t=r.instance;if(e in t)return t[e]}return null}var Zz=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Jz extends vl{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(e=>["d3-force","d3-force-3d"].includes(e==null?void 0:e.id))}validate(e){return this.context.layout?this.forceLayoutInstance?super.validate(e):(gi.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1):!1}moveElement(e,t){return Zz(this,void 0,void 0,function*(){const n=this.forceLayoutInstance;this.context.graph.getNodeData(e).forEach((i,a)=>{const{x:s=0,y:o=0}=i.style||{};n&&Hd(n,"setFixedPosition",e[a],[...$e([+s,+o],t)])})})}onDragStart(e){if(this.enable=this.validate(e),!this.enable)return;this.target=this.getSelectedNodeIDs([e.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const t=this.forceLayoutInstance;t&&_x(t,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(n=>{const{x:i=0,y:a=0}=n.style||{};t&&Hd(t,"setFixedPosition",J(n),[+i,+a])})}onDrag(e){if(!this.enable)return;const t=this.getDelta(e);this.moveElement(this.target,t)}onDragEnd(){const e=this.forceLayoutInstance;e&&_x(e,"simulation").alphaTarget(0),!this.options.fixed&&this.context.graph.getNodeData(this.target).forEach(t=>{e&&Hd(e,"setFixedPosition",J(t),[null,null,null])})}}var Mx=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class th extends vr{constructor(e,t){super(e,Object.assign({},th.defaultOptions,t)),this.isZoomEvent=n=>!!(n.data&&"scale"in n.data),this.relatedEdgeToUpdate=new Set,this.zoom=this.context.graph.getZoom(),this.fixElementSize=n=>Mx(this,void 0,void 0,function*(){if(!this.validate(n))return;const{graph:i}=this.context,{state:a,nodeFilter:s,edgeFilter:o,comboFilter:l}=this.options,u=(a?i.getElementDataByState("node",a):i.getNodeData()).filter(s),c=(a?i.getElementDataByState("edge",a):i.getEdgeData()).filter(o),h=(a?i.getElementDataByState("combo",a):i.getComboData()).filter(l),d=this.isZoomEvent(n)?this.zoom=Math.max(.01,Math.min(n.data.scale,10)):this.zoom,f=[...u,...h];f.length>0&&f.forEach(g=>this.fixNodeLike(g,d)),this.updateRelatedEdges(),c.length>0&&c.forEach(g=>this.fixEdge(g,d))}),this.cachedStyles=new Map,this.getOriginalFieldValue=(n,i,a)=>{var s;const o=this.cachedStyles.get(n)||[],l=((s=o.find(u=>u.shape===i))===null||s===void 0?void 0:s.style)||{};return a in l||(l[a]=i.attributes[a],this.cachedStyles.set(n,[...o.filter(u=>u.shape!==i),{shape:i,style:l}])),l[a]},this.scaleEntireElement=(n,i,a)=>{i.setLocalScale(1/a);const s=this.cachedStyles.get(n)||[];s.push({shape:i}),this.cachedStyles.set(n,s)},this.scaleSpecificShapes=(n,i,a)=>{const s=Z5(n);(Array.isArray(a)?a:[a]).forEach(l=>{const{shape:u,fields:c}=l,h=typeof u=="function"?u(s):n.getShape(u);if(h){if(!c){this.scaleEntireElement(n.id,h,i);return}c.forEach(d=>{const f=this.getOriginalFieldValue(n.id,h,d);_e(f)&&(h.style[d]=f/i)})}})},this.skipIfExceedViewport=n=>{const{viewport:i}=this.context;return!(i!=null&&i.isInViewport(n.getRenderBounds(),!1,30))},this.fixNodeLike=(n,i)=>{const a=J(n),{element:s,model:o}=this.context,l=s.getElement(a);if(!l||this.skipIfExceedViewport(l))return;o.getRelatedEdgesData(a).forEach(h=>this.relatedEdgeToUpdate.add(J(h)));const c=this.options[l.type];if(!c){this.scaleEntireElement(a,l,i);return}this.scaleSpecificShapes(l,i,c)},this.fixEdge=(n,i)=>{const a=J(n),s=this.context.element.getElement(a);if(!s||this.skipIfExceedViewport(s))return;const o=this.options.edge;if(!o){s.style.transformOrigin="center",this.scaleEntireElement(a,s,i);return}this.scaleSpecificShapes(s,i,o)},this.updateRelatedEdges=()=>{const{element:n}=this.context;this.relatedEdgeToUpdate.size>0&&this.relatedEdgeToUpdate.forEach(i=>{const a=n.getElement(i);a==null||a.update({})}),this.relatedEdgeToUpdate.clear()},this.resetTransform=n=>Mx(this,void 0,void 0,function*(){var i;!((i=n.data)===null||i===void 0)&&i.firstRender||(this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}}))}),this.bindEvents()}restoreCachedStyles(){if(this.cachedStyles.size>0){this.cachedStyles.forEach(i=>{i.forEach(({shape:a,style:s})=>{if(ai(s))a.setLocalScale(1);else{if(this.options.state)return;Object.entries(s).forEach(([o,l])=>a.style[o]=l)}})});const{graph:e,element:t}=this.context,n=Object.keys(Object.fromEntries(this.cachedStyles)).filter(i=>i&&e.getElementType(i)==="node");if(n.length>0){const i=new Set;n.forEach(a=>{e.getRelatedEdgesData(a).forEach(s=>i.add(J(s)))}),i.forEach(a=>{const s=t==null?void 0:t.getElement(a);s==null||s.update({})})}}}bindEvents(){const{graph:e}=this.context;e.on(ye.AFTER_DRAW,this.resetTransform),e.on(ye.AFTER_TRANSFORM,this.fixElementSize)}unbindEvents(){const{graph:e}=this.context;e.off(ye.AFTER_DRAW,this.resetTransform),e.off(ye.AFTER_TRANSFORM,this.fixElementSize)}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}destroy(){this.unbindEvents(),super.destroy()}}th.defaultOptions={enable:r=>r.data.scale<1,nodeFilter:()=>!0,edgeFilter:()=>!0,comboFilter:()=>!0,edge:[{shape:"key",fields:["lineWidth"]},{shape:"halo",fields:["lineWidth"]},{shape:"label"}],reset:!1};var Qz=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class nh extends vr{constructor(e,t){super(e,Object.assign({},nh.defaultOptions,t)),this.focus=n=>Qz(this,void 0,void 0,function*(){if(!this.validate(n))return;const{graph:i}=this.context;yield i.focusElement(n.target.id,this.options.animation)}),this.bindEvents()}bindEvents(){const{graph:e}=this.context;this.unbindEvents(),Xa.forEach(t=>{e.on(`${t}:${ie.CLICK}`,this.focus)})}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}unbindEvents(){const{graph:e}=this.context;Xa.forEach(t=>{e.off(`${t}:${ie.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}}nh.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};class rh extends vr{constructor(e,t){super(e,Object.assign({},rh.defaultOptions,t)),this.isFrozen=!1,this.toggleFrozen=n=>{this.isFrozen=n.type==="dragstart"},this.hoverElement=n=>{if(!this.validate(n))return;const i=n.type===ie.POINTER_ENTER;this.updateElementsState(n,i);const{onHover:a,onHoverEnd:s}=this.options;i?a==null||a(n):s==null||s(n)},this.updateElementsState=(n,i)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:a}=this.context,{state:s,animation:o,inactiveState:l}=this.options,u=this.getActiveIds(n),c={};if(s&&Object.assign(c,this.getElementsState(u,s,i)),l){const h=iP(a.getData(),!0).filter(d=>!u.includes(d));Object.assign(c,this.getElementsState(h,l,i))}a.setElementState(c,o)},this.getElementsState=(n,i,a)=>{const{graph:s}=this.context,o={};return n.forEach(l=>{const u=s.getElementState(l);a?o[l]=u.includes(i)?u:[...u,i]:o[l]=u.filter(c=>c!==i)}),o},this.bindEvents()}bindEvents(){const{graph:e}=this.context;this.unbindEvents(),Xa.forEach(n=>{e.on(`${n}:${ie.POINTER_ENTER}`,this.hoverElement),e.on(`${n}:${ie.POINTER_LEAVE}`,this.hoverElement)});const t=this.context.canvas.document;t.addEventListener(`${ie.DRAG_START}`,this.toggleFrozen),t.addEventListener(`${ie.DRAG_END}`,this.toggleFrozen)}getActiveIds(e){const{graph:t}=this.context,{degree:n,direction:i}=this.options,a=e.target.id;return n?pP(t,e.targetType,a,typeof n=="function"?n(e):n,i):[a]}validate(e){if(this.destroyed||this.isFrozen||Xc(e.target)||this.context.graph.isCollapsingExpanding)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}unbindEvents(){const{graph:e}=this.context;Xa.forEach(n=>{e.off(`${n}:${ie.POINTER_ENTER}`,this.hoverElement),e.off(`${n}:${ie.POINTER_LEAVE}`,this.hoverElement)});const t=this.context.canvas.document;t.removeEventListener(`${ie.DRAG_START}`,this.toggleFrozen),t.removeEventListener(`${ie.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}}rh.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};class ej extends hl{onPointerDown(e){if(!super.validate(e)||!super.isKeydown()||this.points)return;const{canvas:t}=this.context;this.pathShape=new ur({id:"g6-lasso-select",style:this.options.style}),t.appendChild(this.pathShape),this.points=[hc(e)]}onPointerMove(e){var t;if(!this.points)return;const{immediately:n,mode:i}=this.options;this.points.push(hc(e)),(t=this.pathShape)===null||t===void 0||t.setAttribute("d",U5(this.points)),n&&i==="default"&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var e;(e=this.pathShape)===null||e===void 0||e.remove(),this.pathShape=void 0,this.points=void 0}}class ih extends vr{constructor(e,t){super(e,Object.assign({},ih.defaultOptions,t)),this.hiddenShapes=[],this.isVisible=!0,this.setElementsVisibility=(n,i,a)=>{n.filter(Boolean).forEach(s=>{i==="hidden"&&!s.isVisible()?this.hiddenShapes.push(s):i==="visible"&&this.hiddenShapes.includes(s)?this.hiddenShapes.splice(this.hiddenShapes.indexOf(s),1):Ha(s,i,a)})},this.filterShapes=(n,i)=>{if(Te(i))return s=>!i(n,s);const a=i==null?void 0:i[n];return s=>s.className?!(a!=null&&a.includes(s.className)):!0},this.hideShapes=n=>{if(!this.validate(n)||!this.isVisible)return;const{element:i}=this.context,{shapes:a={}}=this.options;this.setElementsVisibility(i.getNodes(),"hidden",this.filterShapes("node",a)),this.setElementsVisibility(i.getEdges(),"hidden",this.filterShapes("edge",a)),this.setElementsVisibility(i.getCombos(),"hidden",this.filterShapes("combo",a)),this.isVisible=!1},this.showShapes=rl(n=>{if(!this.validate(n)||this.isVisible)return;const{element:i}=this.context;this.setElementsVisibility(i.getNodes(),"visible"),this.setElementsVisibility(i.getEdges(),"visible"),this.setElementsVisibility(i.getCombos(),"visible"),this.isVisible=!0},this.options.debounce),this.bindEvents()}bindEvents(){const{graph:e}=this.context;e.on(ye.BEFORE_TRANSFORM,this.hideShapes),e.on(ye.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:e}=this.context;e.off(ye.BEFORE_TRANSFORM,this.hideShapes),e.off(ye.AFTER_TRANSFORM,this.showShapes)}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}ih.defaultOptions={enable:!0,debounce:200,shapes:r=>r==="node"};var Ox=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class ah extends vr{constructor(e,t){super(e,Object.assign({},ah.defaultOptions,t)),this.onWheel=n=>Ox(this,void 0,void 0,function*(){this.options.preventDefault&&n.preventDefault();const i=n.deltaX,a=n.deltaY;yield this.scroll([-i,-a],n)}),this.shortcut=new Gs(e.graph),this.bindEvents()}update(e){super.update(e),this.bindEvents()}bindEvents(){var e,t;const{trigger:n}=this.options;if(this.shortcut.unbindAll(),Yt(n)){(e=this.graphDom)===null||e===void 0||e.removeEventListener(ie.WHEEL,this.onWheel);const{up:i=[],down:a=[],left:s=[],right:o=[]}=n;this.shortcut.bind(i,l=>this.scroll([0,-10],l)),this.shortcut.bind(a,l=>this.scroll([0,10],l)),this.shortcut.bind(s,l=>this.scroll([-10,0],l)),this.shortcut.bind(o,l=>this.scroll([10,0],l))}else(t=this.graphDom)===null||t===void 0||t.addEventListener(ie.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(e){const{sensitivity:t}=this.options;return e=_i(e,t),e=this.clampByDirection(e),e=this.clampByRange(e),e}clampByDirection([e,t]){const{direction:n}=this.options;return n==="x"?t=0:n==="y"&&(e=0),[e,t]}clampByRange([e,t]){const{viewport:n,canvas:i}=this.context,[a,s]=i.getSize(),[o,l,u,c]=pi(this.options.range),h=[s*o,a*l,s*u,a*c],d=va(B1(n.getCanvasCenter()),h),f=ut(n.getViewportCenter(),[e,t,0]);if(!$r(f,d)){const{min:[g,v],max:[p,y]}=d;(f[0]<g&&e>0||f[0]>p&&e<0)&&(e=0),(f[1]<v&&t>0||f[1]>y&&t<0)&&(t=0)}return[e,t]}scroll(e,t){return Ox(this,void 0,void 0,function*(){if(!this.validate(t))return;const{onFinish:n}=this.options,i=this.context.graph,a=this.formatDisplacement(e);yield i.translateBy(a,!1),n==null||n()})}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}destroy(){var e;this.shortcut.destroy(),(e=this.graphDom)===null||e===void 0||e.removeEventListener(ie.WHEEL,this.onWheel),super.destroy()}}ah.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var kx=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class sh extends vr{constructor(e,t){super(e,Object.assign({},sh.defaultOptions,t)),this.zoom=(n,i,a)=>kx(this,void 0,void 0,function*(){if(!this.validate(i))return;const{graph:s}=this.context;let o;"viewport"in i&&(o=Sn(i.viewport));const{sensitivity:l,onFinish:u}=this.options,c=1+Bt(n,-50,50)*l/100,h=s.getZoom();yield s.zoomTo(h*c,a,o),u==null||u()}),this.onReset=()=>kx(this,void 0,void 0,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}),this.preventDefault=n=>{this.options.preventDefault&&n.preventDefault()},this.shortcut=new Gs(e.graph),this.bindEvents()}update(e){super.update(e),this.bindEvents()}bindEvents(){const{trigger:e}=this.options;if(this.shortcut.unbindAll(),Array.isArray(e))if(e.includes(ie.PINCH))this.shortcut.bind([ie.PINCH],t=>{this.zoom(t.scale,t,!1)});else{const t=this.context.canvas.getContainer();t==null||t.addEventListener(ie.WHEEL,this.preventDefault),this.shortcut.bind([...e,ie.WHEEL],n=>{const{deltaX:i,deltaY:a}=n;this.zoom(-(a??i),n,!1)})}if(typeof e=="object"){const{zoomIn:t=[],zoomOut:n=[],reset:i=[]}=e;this.shortcut.bind(t,a=>this.zoom(10,a,this.options.animation)),this.shortcut.bind(n,a=>this.zoom(-10,a,this.options.animation)),this.shortcut.bind(i,this.onReset)}}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}destroy(){var e;this.shortcut.destroy(),(e=this.context.canvas.getContainer())===null||e===void 0||e.removeEventListener(ie.WHEEL,this.preventDefault),super.destroy()}}sh.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var Yd,Tx;function ba(){if(Tx)return Yd;Tx=1;function r(e,t,n,i){return i===void 0&&(i="height"),n==="center"?(e[i]+t[i])/2:e.height}return Yd={assign:Object.assign,getHeight:r},Yd}var Xd,Ax;function VP(){if(Ax)return Xd;Ax=1;var r=ba(),e=18,t=e*2,n=e,i={getId:function(l){return l.id||l.name},getPreH:function(l){return l.preH||0},getPreV:function(l){return l.preV||0},getHGap:function(l){return l.hgap||n},getVGap:function(l){return l.vgap||n},getChildren:function(l){return l.children},getHeight:function(l){return l.height||t},getWidth:function(l){var u=l.label||" ";return l.width||u.split("").length*e}};function a(o,l){var u=this;if(u.vgap=u.hgap=0,o instanceof a)return o;u.data=o;var c=l.getHGap(o),h=l.getVGap(o);return u.preH=l.getPreH(o),u.preV=l.getPreV(o),u.width=l.getWidth(o),u.height=l.getHeight(o),u.width+=u.preH,u.height+=u.preV,u.id=l.getId(o),u.x=u.y=0,u.depth=0,u.children||(u.children=[]),u.addGap(c,h),u}r.assign(a.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(l,u){var c=this;c.hgap+=l,c.vgap+=u,c.width+=2*l,c.height+=2*u},eachNode:function(l){for(var u=this,c=[u],h;h=c.shift();)l(h),c=h.children.concat(c)},DFTraverse:function(l){this.eachNode(l)},BFTraverse:function(l){for(var u=this,c=[u],h;h=c.shift();)l(h),c=c.concat(h.children)},getBoundingBox:function(){var l={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(u){l.left=Math.min(l.left,u.x),l.top=Math.min(l.top,u.y),l.width=Math.max(l.width,u.x+u.width),l.height=Math.max(l.height,u.y+u.height)}),l},translate:function(l,u){l===void 0&&(l=0),u===void 0&&(u=0),this.eachNode(function(c){c.x+=l,c.y+=u,c.x+=c.preH,c.y+=c.preV})},right2left:function(){var l=this,u=l.getBoundingBox();l.eachNode(function(c){c.x=c.x-(c.x-u.left)*2-c.width}),l.translate(u.width,0)},bottom2top:function(){var l=this,u=l.getBoundingBox();l.eachNode(function(c){c.y=c.y-(c.y-u.top)*2-c.height}),l.translate(0,u.height)}});function s(o,l,u){l===void 0&&(l={}),l=r.assign({},i,l);var c=new a(o,l),h=[c],d;if(!u&&!o.collapsed){for(;d=h.shift();)if(!d.data.collapsed){var f=l.getChildren(d.data),g=f?f.length:0;if(d.children=new Array(g),f&&g)for(var v=0;v<g;v++){var p=new a(f[v],l);d.children[v]=p,h.push(p),p.parent=d,p.depth=d.depth+1}}}return c}return Xd=s,Xd}var Kd,Px;function oh(){if(Px)return Kd;Px=1;var r=VP(),e=function(){function t(i,a){a===void 0&&(a={});var s=this;s.options=a,s.rootNode=r(i,a)}var n=t.prototype;return n.execute=function(){throw new Error("please override this method")},t}();return Kd=e,Kd}var Zd,Cx;function tj(){if(Cx)return Zd;Cx=1;function r(s,o,l,u){u===void 0&&(u=[]);var c=this;c.w=s||0,c.h=o||0,c.y=l||0,c.x=0,c.c=u||[],c.cs=u.length,c.prelim=0,c.mod=0,c.shift=0,c.change=0,c.tl=null,c.tr=null,c.el=null,c.er=null,c.msel=0,c.mser=0}r.fromNode=function(s,o){if(!s)return null;var l=[];return s.children.forEach(function(u){l.push(r.fromNode(u,o))}),o?new r(s.height,s.width,s.x,l):new r(s.width,s.height,s.y,l)};function e(s,o,l){l?s.y+=o:s.x+=o,s.children.forEach(function(u){e(u,o,l)})}function t(s,o){var l=o?s.y:s.x;return s.children.forEach(function(u){l=Math.min(t(u,o),l)}),l}function n(s,o){var l=t(s,o);e(s,-l,o)}function i(s,o,l){l?o.y=s.x:o.x=s.x,s.c.forEach(function(u,c){i(u,o.children[c],l)})}function a(s,o,l){l===void 0&&(l=0),o?(s.x=l,l+=s.width):(s.y=l,l+=s.height),s.children.forEach(function(u){a(u,o,l)})}return Zd=function(s,o){o===void 0&&(o={});var l=o.isHorizontal;function u(k){if(k.cs===0){c(k);return}u(k.c[0]);for(var P=O(v(k.c[0].el),0,null),C=1;C<k.cs;++C){u(k.c[C]);var N=v(k.c[C].er);h(k,C,P),P=O(N,C,P)}m(k),c(k)}function c(k){k.cs===0?(k.el=k,k.er=k,k.msel=k.mser=0):(k.el=k.c[0].el,k.msel=k.c[0].msel,k.er=k.c[k.cs-1].er,k.mser=k.c[k.cs-1].mser)}function h(k,P,C){for(var N=k.c[P-1],L=N.mod,F=k.c[P],G=F.mod;N!==null&&F!==null;){v(N)>C.low&&(C=C.nxt);var V=L+N.prelim+N.w-(G+F.prelim);V>0&&(G+=V,d(k,P,C.index,V));var U=v(N),$=v(F);U<=$&&(N=g(N),N!==null&&(L+=N.mod)),U>=$&&(F=f(F),F!==null&&(G+=F.mod))}!N&&F?p(k,P,F,G):N&&!F&&y(k,P,N,L)}function d(k,P,C,N){k.c[P].mod+=N,k.c[P].msel+=N,k.c[P].mser+=N,S(k,P,C,N)}function f(k){return k.cs===0?k.tl:k.c[0]}function g(k){return k.cs===0?k.tr:k.c[k.cs-1]}function v(k){return k.y+k.h}function p(k,P,C,N){var L=k.c[0].el;L.tl=C;var F=N-C.mod-k.c[0].msel;L.mod+=F,L.prelim-=F,k.c[0].el=k.c[P].el,k.c[0].msel=k.c[P].msel}function y(k,P,C,N){var L=k.c[P].er;L.tr=C;var F=N-C.mod-k.c[P].mser;L.mod+=F,L.prelim-=F,k.c[P].er=k.c[P-1].er,k.c[P].mser=k.c[P-1].mser}function m(k){k.prelim=(k.c[0].prelim+k.c[0].mod+k.c[k.cs-1].mod+k.c[k.cs-1].prelim+k.c[k.cs-1].w)/2-k.w/2}function w(k,P){P+=k.mod,k.x=k.prelim+P,_(k);for(var C=0;C<k.cs;C++)w(k.c[C],P)}function S(k,P,C,N){if(C!==P-1){var L=P-C;k.c[C+1].shift+=N/L,k.c[P].shift-=N/L,k.c[P].change-=N-N/L}}function _(k){for(var P=0,C=0,N=0;N<k.cs;N++)P+=k.c[N].shift,C+=P+k.c[N].change,k.c[N].mod+=C}function O(k,P,C){for(;C!==null&&k>=C.low;)C=C.nxt;return{low:k,index:P,nxt:C}}a(s,l);var T=r.fromNode(s,l);return u(T),w(T,0),i(T,s,l),n(s,l),s},Zd}var Jd,Nx;function UP(){if(Nx)return Jd;Nx=1;var r=VP();return Jd=function(e,t){for(var n=r(e.data,t,!0),i=r(e.data,t,!0),a=e.children.length,s=Math.round(a/2),o=t.getSide||function(h,d){return d<s?"right":"left"},l=0;l<a;l++){var u=e.children[l],c=o(u,l);c==="right"?i.children.push(u):n.children.push(u)}return n.eachNode(function(h){h.isRoot()||(h.side="left")}),i.eachNode(function(h){h.isRoot()||(h.side="right")}),{left:n,right:i}},Jd}var Qd,Rx;function eb(){if(Rx)return Qd;Rx=1;var r=UP(),e=["LR","RL","TB","BT","H","V"],t=["LR","RL","H"],n=function(o){return t.indexOf(o)>-1},i=e[0];Qd=function(s,o,l){var u=o.direction||i;if(o.isHorizontal=n(u),e.indexOf(u)===-1)throw new TypeError("Invalid direction: "+u);if(u===e[0])l(s,o);else if(u===e[1])l(s,o),s.right2left();else if(u===e[2])l(s,o);else if(u===e[3])l(s,o),s.bottom2top();else if(u===e[4]||u===e[5]){var c=r(s,o),h=c.left,d=c.right;l(h,o),l(d,o),o.isHorizontal?h.right2left():h.bottom2top(),d.translate(h.x-d.x,h.y-d.y),s.x=h.x,s.y=d.y;var f=s.getBoundingBox();o.isHorizontal?f.top<0&&s.translate(0,-f.top):f.left<0&&s.translate(-f.left,0)}var g=o.fixedRoot;return g===void 0&&(g=!0),g&&s.translate(-(s.x+s.width/2+s.hgap),-(s.y+s.height/2+s.vgap)),a(s,o),s};function a(s,o){if(o.radial){var l=o.isHorizontal?["x","y"]:["y","x"],u=l[0],c=l[1],h={x:1/0,y:1/0},d={x:-1/0,y:-1/0},f=0;s.DFTraverse(function(p){f++;var y=p.x,m=p.y;h.x=Math.min(h.x,y),h.y=Math.min(h.y,m),d.x=Math.max(d.x,y),d.y=Math.max(d.y,m)});var g=d[c]-h[c];if(g===0)return;var v=Math.PI*2/f;s.DFTraverse(function(p){var y=(p[c]-h[c])/g*(Math.PI*2-v)+v,m=p[u]-s[u];p.x=Math.cos(y)*m,p.y=Math.sin(y)*m})}}return Qd}var ef,Lx;function nj(){if(Lx)return ef;Lx=1;function r(u,c){u.prototype=Object.create(c.prototype),u.prototype.constructor=u,e(u,c)}function e(u,c){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,d){return h.__proto__=d,h},e(u,c)}var t=oh(),n=tj(),i=eb(),a=ba(),s=function(u){function c(){return u.apply(this,arguments)||this}r(c,u);var h=c.prototype;return h.execute=function(){var f=this;return i(f.rootNode,f.options,n)},c}(t),o={};function l(u,c){return c=a.assign({},o,c),new s(u,c).execute()}return ef=l,ef}var tf,Ix;function rj(){if(Ix)return tf;Ix=1;var r=ba();function e(i,a){a===void 0&&(a=[]);var s=this;s.x=s.y=0,s.leftChild=s.rightChild=null,s.height=0,s.children=a}var t={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function n(i,a,s){s?(a.x=i.x,a.y=i.y):(a.x=i.y,a.y=i.x),i.children.forEach(function(o,l){n(o,a.children[l],s)})}return tf=function(i,a){a===void 0&&(a={}),a=r.assign({},t,a);var s=0;function o(d){if(!d)return null;d.width=0,d.depth&&d.depth>s&&(s=d.depth);var f=d.children,g=f.length,v=new e(d.height,[]);return f.forEach(function(p,y){var m=o(p);v.children.push(m),y===0&&(v.leftChild=m),y===g-1&&(v.rightChild=m)}),v.originNode=d,v.isLeaf=d.isLeaf(),v}function l(d){if(d.isLeaf||d.children.length===0)d.drawingDepth=s;else{var f=d.children.map(function(v){return l(v)}),g=Math.min.apply(null,f);d.drawingDepth=g-1}return d.drawingDepth}var u;function c(d){d.x=d.drawingDepth*a.rankSep,d.isLeaf?(d.y=0,u&&(d.y=u.y+u.height+a.nodeSep,d.originNode.parent!==u.originNode.parent&&(d.y+=a.subTreeSep)),u=d):(d.children.forEach(function(f){c(f)}),d.y=(d.leftChild.y+d.rightChild.y)/2)}var h=o(i);return l(h),c(h),n(h,i,a.isHorizontal),i},tf}var nf,Dx;function ij(){if(Dx)return nf;Dx=1;function r(u,c){u.prototype=Object.create(c.prototype),u.prototype.constructor=u,e(u,c)}function e(u,c){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,d){return h.__proto__=d,h},e(u,c)}var t=oh(),n=rj(),i=eb(),a=ba(),s=function(u){function c(){return u.apply(this,arguments)||this}r(c,u);var h=c.prototype;return h.execute=function(){var f=this;return f.rootNode.width=0,i(f.rootNode,f.options,n)},c}(t),o={};function l(u,c){return c=a.assign({},o,c),new s(u,c).execute()}return nf=l,nf}var rf,Fx;function aj(){if(Fx)return rf;Fx=1;var r=ba();function e(t,n,i,a,s){var o=(typeof i=="function"?i(t):i)*t.depth;if(!a)try{if(t.id===t.parent.children[0].id){t.x+=o,t.y=n?n.y:0;return}}catch{}if(t.x+=o,n){if(t.y=n.y+r.getHeight(n,t,s),n.parent&&t.parent.id!==n.parent.id){var l=n.parent,u=l.y+r.getHeight(l,t,s);t.y=u>t.y?u:t.y}}else t.y=0}return rf=function(t,n,i,a){var s=null;t.eachNode(function(o){e(o,s,n,i,a),s=o})},rf}var af,Bx;function sj(){if(Bx)return af;Bx=1;function r(h,d){h.prototype=Object.create(d.prototype),h.prototype.constructor=h,e(h,d)}function e(h,d){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(f,g){return f.__proto__=g,f},e(h,d)}var t=oh(),n=aj(),i=UP(),a=ba(),s=["LR","RL","H"],o=s[0],l=function(h){function d(){return h.apply(this,arguments)||this}r(d,h);var f=d.prototype;return f.execute=function(){var v=this,p=v.options,y=v.rootNode;p.isHorizontal=!0;var m=p.indent,w=m===void 0?20:m,S=p.dropCap,_=S===void 0?!0:S,O=p.direction,T=O===void 0?o:O,k=p.align;if(T&&s.indexOf(T)===-1)throw new TypeError("Invalid direction: "+T);if(T===s[0])n(y,w,_,k);else if(T===s[1])n(y,w,_,k),y.right2left();else if(T===s[2]){var P=i(y,p),C=P.left,N=P.right;n(C,w,_,k),C.right2left(),n(N,w,_,k);var L=C.getBoundingBox();N.translate(L.width,0),y.x=N.x-y.width/2}return y},d}(t),u={};function c(h,d){return d=a.assign({},u,d),new l(h,d).execute()}return af=c,af}var sf,zx;function oj(){if(zx)return sf;zx=1;var r=ba();function e(i,a){var s=0;return i.children.length?i.children.forEach(function(o){s+=e(o,a)}):s=i.height,i._subTreeSep=a.getSubTreeSep(i.data),i.totalHeight=Math.max(i.height,s)+2*i._subTreeSep,i.totalHeight}function t(i){var a=i.children,s=a.length;if(s){a.forEach(function(d){t(d)});var o=a[0],l=a[s-1],u=l.y-o.y+l.height,c=0;if(a.forEach(function(d){c+=d.totalHeight}),u>i.height)i.y=o.y+u/2-i.height/2;else if(a.length!==1||i.height>c){var h=i.y+(i.height-u)/2-o.y;a.forEach(function(d){d.translate(0,h)})}else i.y=(o.y+o.height/2+l.y+l.height/2)/2-i.height/2}}var n={getSubTreeSep:function(){return 0}};return sf=function(i,a){a===void 0&&(a={}),a=r.assign({},n,a),i.parent={x:0,width:0,height:0,y:0},i.BFTraverse(function(s){s.x=s.parent.x+s.parent.width}),i.parent=null,e(i,a),i.startY=0,i.y=i.totalHeight/2-i.height/2,i.eachNode(function(s){var o=s.children,l=o.length;if(l){var u=o[0];if(u.startY=s.startY+s._subTreeSep,l===1)u.y=s.y+s.height/2-u.height/2;else{u.y=u.startY+u.totalHeight/2-u.height/2;for(var c=1;c<l;c++){var h=o[c];h.startY=o[c-1].startY+o[c-1].totalHeight,h.y=h.startY+h.totalHeight/2-h.height/2}}}}),t(i)},sf}var of,jx;function lj(){if(jx)return of;jx=1;function r(u,c){u.prototype=Object.create(c.prototype),u.prototype.constructor=u,e(u,c)}function e(u,c){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,d){return h.__proto__=d,h},e(u,c)}var t=oh(),n=oj(),i=eb(),a=ba(),s=function(u){function c(){return u.apply(this,arguments)||this}r(c,u);var h=c.prototype;return h.execute=function(){var f=this;return i(f.rootNode,f.options,n)},c}(t),o={};function l(u,c){return c=a.assign({},o,c),new s(u,c).execute()}return of=l,of}var lf,qx;function uj(){if(qx)return lf;qx=1;var r={compactBox:nj(),dendrogram:ij(),indented:sj(),mindmap:lj()};return lf=r,lf}var mu=uj();const cj=(r,e)=>{if(r!=="next"&&r!=="prev")return e},$x=r=>{r.prev.next=r.next,r.next.prev=r.prev,delete r.next,delete r.prev};let hj=class{constructor(){const e={};e.prev=e,e.next=e.prev,this.shortcut=e}dequeue(){const e=this.shortcut,t=e.prev;if(t&&t!==e)return $x(t),t}enqueue(e){const t=this.shortcut;e.prev&&e.next&&$x(e),e.next=t.next,t.next.prev=e,t.next=e,e.prev=t}toString(){const e=[],t=this.shortcut;let n=t.prev;for(;n!==t;)e.push(JSON.stringify(n,cj)),n=n==null?void 0:n.prev;return`[${e.join(", ")}]`}};class dj extends hj{}const fj=()=>1,gj=(r,e)=>{var t;if(r.getAllNodes().length<=1)return[];const n=vj(r,e||fj);return(t=pj(n.graph,n.buckets,n.zeroIdx).map(a=>r.getRelatedEdges(a.v,"out").filter(({target:s})=>s===a.w)))===null||t===void 0?void 0:t.flat()},pj=(r,e,t)=>{let n=[];const i=e[e.length-1],a=e[0];let s;for(;r.getAllNodes().length;){for(;s=a.dequeue();)uf(r,e,t,s);for(;s=i.dequeue();)uf(r,e,t,s);if(r.getAllNodes().length){for(let o=e.length-2;o>0;--o)if(s=e[o].dequeue(),s){n=n.concat(uf(r,e,t,s,!0));break}}}return n},uf=(r,e,t,n,i)=>{var a,s;const o=[];return r.hasNode(n.v)&&((a=r.getRelatedEdges(n.v,"in"))===null||a===void 0||a.forEach(l=>{const u=l.data.weight,c=r.getNode(l.source);i&&o.push({v:l.source,w:l.target,in:0,out:0}),c.data.out===void 0&&(c.data.out=0),c.data.out-=u,Vm(e,t,Object.assign({v:c.id},c.data))}),(s=r.getRelatedEdges(n.v,"out"))===null||s===void 0||s.forEach(l=>{const u=l.data.weight,c=l.target,h=r.getNode(c);h.data.in===void 0&&(h.data.in=0),h.data.in-=u,Vm(e,t,Object.assign({v:h.id},h.data))}),r.removeNode(n.v)),i?o:void 0},vj=(r,e)=>{const t=new dn;let n=0,i=0;r.getAllNodes().forEach(l=>{t.addNode({id:l.id,data:{v:l.id,in:0,out:0}})}),r.getAllEdges().forEach(l=>{const u=t.getRelatedEdges(l.source,"out").find(h=>h.target===l.target),c=(e==null?void 0:e(l))||1;u?t.updateEdgeData(u==null?void 0:u.id,Object.assign(Object.assign({},u.data),{weight:u.data.weight+c})):t.addEdge({id:l.id,source:l.source,target:l.target,data:{weight:c}}),i=Math.max(i,t.getNode(l.source).data.out+=c),n=Math.max(n,t.getNode(l.target).data.in+=c)});const a=[],s=i+n+3;for(let l=0;l<s;l++)a.push(new dj);const o=n+1;return t.getAllNodes().forEach(l=>{Vm(a,o,Object.assign({v:l.id},t.getNode(l.id).data))}),{buckets:a,zeroIdx:o,graph:t}},Vm=(r,e,t)=>{t.out?t.in?r[t.out-t.in+e].enqueue(t):r[r.length-1].enqueue(t):r[0].enqueue(t)},yj=(r,e)=>{const n=gj(r,(i=>a=>a.data.weight||1)());n==null||n.forEach(i=>{const a=i.data;r.removeEdge(i.id),a.forwardName=i.data.name,a.reversed=!0,r.addEdge({id:i.id,source:i.target,target:i.source,data:Object.assign({},a)})})},mj=r=>{r.getAllEdges().forEach(e=>{const t=e.data;if(t.reversed){r.removeEdge(e.id);const n=t.forwardName;delete t.reversed,delete t.forwardName,r.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign(Object.assign({},t),{forwardName:n})})}})},bj=(r,e)=>Number(r)-Number(e),Us=(r,e,t,n)=>{let i;do i=`${n}${Math.random()}`;while(r.hasNode(i));return t.dummy=e,r.addNode({id:i,data:t}),i},wj=r=>{const e=new dn;return r.getAllNodes().forEach(t=>{e.addNode(Object.assign({},t))}),r.getAllEdges().forEach(t=>{const n=e.getRelatedEdges(t.source,"out").find(i=>i.target===t.target);n?e.updateEdgeData(n==null?void 0:n.id,Object.assign(Object.assign({},n.data),{weight:n.data.weight+t.data.weight||0,minlen:Math.max(n.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})}),e},HP=r=>{const e=new dn;return r.getAllNodes().forEach(t=>{r.getChildren(t.id).length||e.addNode(Object.assign({},t))}),r.getAllEdges().forEach(t=>{e.addEdge(t)}),e},xj=(r,e)=>r==null?void 0:r.reduce((t,n,i)=>(t[n]=e[i],t),{}),Gx=(r,e)=>{const t=Number(r.x),n=Number(r.y),i=Number(e.x)-t,a=Number(e.y)-n;let s=Number(r.width)/2,o=Number(r.height)/2;if(!i&&!a)return{x:0,y:0};let l,u;return Math.abs(a)*s>Math.abs(i)*o?(a<0&&(o=-o),l=o*i/a,u=o):(i<0&&(s=-s),l=s,u=s*a/i),{x:t+l,y:n+u}},Yo=r=>{const e=[],t=YP(r)+1;for(let n=0;n<t;n++)e.push([]);r.getAllNodes().forEach(n=>{const i=n.data.rank;i!==void 0&&e[i]&&e[i].push(n.id)});for(let n=0;n<t;n++)e[n]=e[n].sort((i,a)=>bj(r.getNode(i).data.order,r.getNode(a).data.order));return e},Ej=r=>{const e=r.getAllNodes().filter(n=>n.data.rank!==void 0).map(n=>n.data.rank),t=Math.min(...e);r.getAllNodes().forEach(n=>{n.data.hasOwnProperty("rank")&&t!==1/0&&(n.data.rank-=t)})},Sj=(r,e=0)=>{const t=r.getAllNodes(),n=t.filter(o=>o.data.rank!==void 0).map(o=>o.data.rank),i=Math.min(...n),a=[];t.forEach(o=>{const l=(o.data.rank||0)-i;a[l]||(a[l]=[]),a[l].push(o.id)});let s=0;for(let o=0;o<a.length;o++){const l=a[o];l===void 0?o%e!==0&&(s-=1):s&&(l==null||l.forEach(u=>{const c=r.getNode(u);c&&(c.data.rank=c.data.rank||0,c.data.rank+=s)}))}},Wx=(r,e,t,n)=>{const i={width:0,height:0};return _e(t)&&_e(n)&&(i.rank=t,i.order=n),Us(r,"border",i,e)},YP=r=>{let e;return r.getAllNodes().forEach(t=>{const n=t.data.rank;n!==void 0&&(e===void 0||n>e)&&(e=n)}),e||(e=0),e},_j=(r,e)=>{const t={lhs:[],rhs:[]};return r==null||r.forEach(n=>{e(n)?t.lhs.push(n):t.rhs.push(n)}),t},tb=(r,e)=>r.reduce((t,n)=>{const i=e(t),a=e(n);return i>a?n:t}),XP=(r,e,t,n,i,a)=>{n.includes(e.id)||(n.push(e.id),t||a.push(e.id),i(e.id).forEach(s=>XP(r,s,t,n,i,a)),t&&a.push(e.id))},KP=(r,e,t,n)=>{const i=Array.isArray(e)?e:[e],a=l=>r.getNeighbors(l),s=[],o=[];return i.forEach(l=>{if(r.hasNode(l.id))XP(r,l,t==="post",o,a,s);else throw new Error(`Graph does not have node: ${l}`)}),s},Mj=r=>{const e=t=>{const n=r.getChildren(t),i=r.getNode(t);if(n!=null&&n.length&&n.forEach(a=>e(a.id)),i.data.hasOwnProperty("minRank")){i.data.borderLeft=[],i.data.borderRight=[];for(let a=i.data.minRank,s=i.data.maxRank+1;a<s;a+=1)Vx(r,"borderLeft","_bl",t,i,a),Vx(r,"borderRight","_br",t,i,a)}};r.getRoots().forEach(t=>e(t.id))},Vx=(r,e,t,n,i,a)=>{const s={rank:a,borderType:e,width:0,height:0},o=i.data[e][a-1],l=Us(r,"border",s,t);i.data[e][a]=l,r.setParent(l,n),o&&r.addEdge({id:`e${Math.random()}`,source:o,target:l,data:{weight:1}})},Oj=(r,e)=>{const t=e.toLowerCase();(t==="lr"||t==="rl")&&ZP(r)},kj=(r,e)=>{const t=e.toLowerCase();(t==="bt"||t==="rl")&&Tj(r),(t==="lr"||t==="rl")&&(Aj(r),ZP(r))},ZP=r=>{r.getAllNodes().forEach(e=>{Ux(e)}),r.getAllEdges().forEach(e=>{Ux(e)})},Ux=r=>{const e=r.data.width;r.data.width=r.data.height,r.data.height=e},Tj=r=>{r.getAllNodes().forEach(e=>{cf(e.data)}),r.getAllEdges().forEach(e=>{var t;(t=e.data.points)===null||t===void 0||t.forEach(n=>cf(n)),e.data.hasOwnProperty("y")&&cf(e.data)})},cf=r=>{r!=null&&r.y&&(r.y=-r.y)},Aj=r=>{r.getAllNodes().forEach(e=>{hf(e.data)}),r.getAllEdges().forEach(e=>{var t;(t=e.data.points)===null||t===void 0||t.forEach(n=>hf(n)),e.data.hasOwnProperty("x")&&hf(e.data)})},hf=r=>{const e=r.x;r.x=r.y,r.y=e},Pj=r=>{const e=Us(r,"root",{},"_root"),t=Cj(r);let n=Math.max(...Object.values(t));Math.abs(n)===1/0&&(n=1);const i=n-1,a=2*i+1;r.getAllEdges().forEach(o=>{o.data.minlen*=a});const s=Nj(r)+1;return r.getRoots().forEach(o=>{JP(r,e,a,s,i,t,o.id)}),{nestingRoot:e,nodeRankFactor:a}},JP=(r,e,t,n,i,a,s)=>{const o=r.getChildren(s);if(!(o!=null&&o.length)){s!==e&&r.addEdge({id:`e${Math.random()}`,source:e,target:s,data:{weight:0,minlen:t}});return}const l=Wx(r,"_bt"),u=Wx(r,"_bb"),c=r.getNode(s);r.setParent(l,s),c.data.borderTop=l,r.setParent(u,s),c.data.borderBottom=u,o==null||o.forEach(h=>{JP(r,e,t,n,i,a,h.id);const d=h.data.borderTop?h.data.borderTop:h.id,f=h.data.borderBottom?h.data.borderBottom:h.id,g=h.data.borderTop?n:2*n,v=d!==f?1:i-a[s]+1;r.addEdge({id:`e${Math.random()}`,source:l,target:d,data:{minlen:v,weight:g,nestingEdge:!0}}),r.addEdge({id:`e${Math.random()}`,source:f,target:u,data:{minlen:v,weight:g,nestingEdge:!0}})}),r.getParent(s)||r.addEdge({id:`e${Math.random()}`,source:e,target:l,data:{weight:0,minlen:i+a[s]}})},Cj=r=>{const e={},t=(n,i)=>{const a=r.getChildren(n);a==null||a.forEach(s=>t(s.id,i+1)),e[n]=i};return r.getRoots().forEach(n=>t(n.id,1)),e},Nj=r=>{let e=0;return r.getAllEdges().forEach(t=>{e+=t.data.weight}),e},Rj=(r,e)=>{e&&r.removeNode(e),r.getAllEdges().forEach(t=>{t.data.nestingEdge&&r.removeEdge(t.id)})},Lj="edge",QP="edge-label",Ij=(r,e)=>{r.getAllEdges().forEach(t=>Dj(r,t,e))},Dj=(r,e,t)=>{let n=e.source,i=r.getNode(n).data.rank;const a=e.target,s=r.getNode(a).data.rank,o=e.data.labelRank;if(s===i+1)return;r.removeEdge(e.id);let l,u,c;for(c=0,++i;i<s;++c,++i)e.data.points=[],u={originalEdge:e,width:0,height:0,rank:i},l=Us(r,Lj,u,"_d"),i===o&&(u.width=e.data.width,u.height=e.data.height,u.dummy=QP,u.labelpos=e.data.labelpos),r.addEdge({id:`e${Math.random()}`,source:n,target:l,data:{weight:e.data.weight}}),c===0&&t.push(l),n=l;r.addEdge({id:`e${Math.random()}`,source:n,target:a,data:{weight:e.data.weight}})},Fj=(r,e)=>{e.forEach(t=>{let n=r.getNode(t);const{data:i}=n,a=i.originalEdge;let s;a&&r.addEdge(a);let o=t;for(;n.data.dummy;)s=r.getSuccessors(o)[0],r.removeNode(o),a.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===QP&&(a.data.x=n.data.x,a.data.y=n.data.y,a.data.width=n.data.width,a.data.height=n.data.height),o=s.id,n=r.getNode(o)})},Bj=(r,e,t)=>{const n={};let i;t==null||t.forEach(a=>{let s=r.getParent(a),o,l;for(;s;){if(o=r.getParent(s.id),o?(l=n[o.id],n[o.id]=s.id):(l=i,i=s.id),l&&l!==s.id){e.hasNode(l)||e.addNode({id:l,data:{}}),e.hasNode(s.id)||e.addNode({id:s.id,data:{}}),e.hasEdge(`e${l}-${s.id}`)||e.addEdge({id:`e${l}-${s.id}`,source:l,target:s.id,data:{}});return}s=o}})},zj=(r,e,t)=>{const n=jj(r),i=new dn({tree:[{id:n,children:[],data:{}}]});return r.getAllNodes().forEach(a=>{const s=r.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(Object.assign({},a)),s!=null&&s.id&&!i.hasNode(s==null?void 0:s.id)&&i.addNode(Object.assign({},s)),i.setParent(a.id,(s==null?void 0:s.id)||n),r.getRelatedEdges(a.id,t).forEach(o=>{const l=o.source===a.id?o.target:o.source;i.hasNode(l)||i.addNode(Object.assign({},r.getNode(l)));const u=i.getRelatedEdges(l,"out").find(({target:h})=>h===a.id),c=u!==void 0?u.data.weight:0;u?i.updateEdgeData(u.id,Object.assign(Object.assign({},u.data),{weight:o.data.weight+c})):i.addEdge({id:o.id,source:l,target:a.id,data:{weight:o.data.weight+c}})}),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,Object.assign(Object.assign({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))}),i},jj=r=>{let e;for(;r.hasNode(e=`_root${Math.random()}`););return e},qj=(r,e,t)=>{const n=xj(t,t.map((c,h)=>h)),a=e.map(c=>{const h=r.getRelatedEdges(c,"out").map(d=>({pos:n[d.target]||0,weight:d.data.weight}));return h==null?void 0:h.sort((d,f)=>d.pos-f.pos)}).flat().filter(c=>c!==void 0);let s=1;for(;s<t.length;)s<<=1;const o=2*s-1;s-=1;const l=Array(o).fill(0,0,o);let u=0;return a==null||a.forEach(c=>{if(c){let h=c.pos+s;l[h]+=c.weight;let d=0;for(;h>0;)h%2&&(d+=l[h+1]),h=h-1>>1,l[h]+=c.weight;u+=c.weight*d}}),u},Hx=(r,e)=>{let t=0;for(let n=1;n<(e==null?void 0:e.length);n+=1)t+=qj(r,e[n-1],e[n]);return t},Yx=r=>{const e={},t=r.getAllNodes(),n=t.map(u=>{var c;return(c=u.data.rank)!==null&&c!==void 0?c:-1/0}),i=Math.max(...n),a=[];for(let u=0;u<i+1;u++)a.push([]);const s=t.sort((u,c)=>r.getNode(u.id).data.rank-r.getNode(c.id).data.rank),l=s.filter(u=>r.getNode(u.id).data.fixorder!==void 0).sort((u,c)=>r.getNode(u.id).data.fixorder-r.getNode(c.id).data.fixorder);return l==null||l.forEach(u=>{isNaN(r.getNode(u.id).data.rank)||a[r.getNode(u.id).data.rank].push(u.id),e[u.id]=!0}),s==null||s.forEach(u=>r.dfsTree(u.id,c=>{if(e.hasOwnProperty(c.id))return!0;e[c.id]=!0,isNaN(c.data.rank)||a[c.data.rank].push(c.id)})),a},$j=(r,e)=>e.map(t=>{const n=r.getRelatedEdges(t,"in");if(!(n!=null&&n.length))return{v:t};const i={sum:0,weight:0};return n==null||n.forEach(a=>{const s=r.getNode(a.source);i.sum+=a.data.weight*s.data.order,i.weight+=a.data.weight}),{v:t,barycenter:i.sum/i.weight,weight:i.weight}}),Gj=(r,e)=>{var t,n,i;const a={};r==null||r.forEach((o,l)=>{a[o.v]={i:l,indegree:0,in:[],out:[],vs:[o.v]};const u=a[o.v];o.barycenter!==void 0&&(u.barycenter=o.barycenter,u.weight=o.weight)}),(t=e.getAllEdges())===null||t===void 0||t.forEach(o=>{const l=a[o.source],u=a[o.target];l!==void 0&&u!==void 0&&(u.indegree++,l.out.push(a[o.target]))});const s=(i=(n=Object.values(a)).filter)===null||i===void 0?void 0:i.call(n,o=>!o.indegree);return Wj(s)},Wj=r=>{var e,t;const n=[],i=l=>u=>{u.merged||(u.barycenter===void 0||l.barycenter===void 0||u.barycenter>=l.barycenter)&&Vj(l,u)},a=l=>u=>{u.in.push(l),--u.indegree===0&&r.push(u)};for(;r!=null&&r.length;){const l=r.pop();n.push(l),(e=l.in.reverse())===null||e===void 0||e.forEach(u=>i(l)(u)),(t=l.out)===null||t===void 0||t.forEach(u=>a(l)(u))}const s=n.filter(l=>!l.merged),o=["vs","i","barycenter","weight"];return s.map(l=>{const u={};return o==null||o.forEach(c=>{l[c]!==void 0&&(u[c]=l[c])}),u})},Vj=(r,e)=>{var t;let n=0,i=0;r.weight&&(n+=r.barycenter*r.weight,i+=r.weight),e.weight&&(n+=e.barycenter*e.weight,i+=e.weight),r.vs=(t=e.vs)===null||t===void 0?void 0:t.concat(r.vs),r.barycenter=n/i,r.weight=i,r.i=Math.min(e.i,r.i),e.merged=!0},Uj=(r,e,t,n)=>{const i=_j(r,d=>{const f=d.hasOwnProperty("fixorder")&&!isNaN(d.fixorder);return n?!f&&d.hasOwnProperty("barycenter"):f||d.hasOwnProperty("barycenter")}),a=i.lhs,s=i.rhs.sort((d,f)=>-d.i- -f.i),o=[];let l=0,u=0,c=0;a==null||a.sort(Hj(!!e,!!t)),c=Xx(o,s,c),a==null||a.forEach(d=>{var f;c+=(f=d.vs)===null||f===void 0?void 0:f.length,o.push(d.vs),l+=d.barycenter*d.weight,u+=d.weight,c=Xx(o,s,c)});const h={vs:o.flat()};return u&&(h.barycenter=l/u,h.weight=u),h},Xx=(r,e,t)=>{let n=t,i;for(;e.length&&(i=e[e.length-1]).i<=n;)e.pop(),r==null||r.push(i.vs),n++;return n},Hj=(r,e)=>(t,n)=>{if(t.fixorder!==void 0&&n.fixorder!==void 0)return t.fixorder-n.fixorder;if(t.barycenter<n.barycenter)return-1;if(t.barycenter>n.barycenter)return 1;if(e&&t.order!==void 0&&n.order!==void 0){if(t.order<n.order)return-1;if(t.order>n.order)return 1}return r?n.i-t.i:t.i-n.i},eC=(r,e,t,n,i,a)=>{var s,o,l,u;let c=r.getChildren(e).map(m=>m.id);const h=r.getNode(e),d=h?h.data.borderLeft:void 0,f=h?h.data.borderRight:void 0,g={};d&&(c=c==null?void 0:c.filter(m=>m!==d&&m!==f));const v=$j(r,c||[]);v==null||v.forEach(m=>{var w;if(!((w=r.getChildren(m.v))===null||w===void 0)&&w.length){const S=eC(r,m.v,t,n,a);g[m.v]=S,S.hasOwnProperty("barycenter")&&Xj(m,S)}});const p=Gj(v,t);Yj(p,g),(s=p.filter(m=>m.vs.length>0))===null||s===void 0||s.forEach(m=>{const w=r.getNode(m.vs[0]);w&&(m.fixorder=w.data.fixorder,m.order=w.data.order)});const y=Uj(p,n,i,a);if(d&&(y.vs=[d,y.vs,f].flat(),!((o=r.getPredecessors(d))===null||o===void 0)&&o.length)){const m=r.getNode(((l=r.getPredecessors(d))===null||l===void 0?void 0:l[0].id)||""),w=r.getNode(((u=r.getPredecessors(f))===null||u===void 0?void 0:u[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Yj=(r,e)=>{r==null||r.forEach(t=>{var n;const i=(n=t.vs)===null||n===void 0?void 0:n.map(a=>e[a]?e[a].vs:a);t.vs=i.flat()})},Xj=(r,e)=>{r.barycenter!==void 0?(r.barycenter=(r.barycenter*r.weight+e.barycenter*e.weight)/(r.weight+e.weight),r.weight+=e.weight):(r.barycenter=e.barycenter,r.weight=e.weight)},Kj=(r,e)=>{const t=YP(r),n=[],i=[];for(let c=1;c<t+1;c++)n.push(c);for(let c=t-1;c>-1;c--)i.push(c);const a=Kx(r,n,"in"),s=Kx(r,i,"out");let o=Yx(r);df(r,o);let l=Number.POSITIVE_INFINITY,u;for(let c=0,h=0;h<4;++c,++h){Zx(c%2?a:s,c%4>=2,!1,e),o=Yo(r);const d=Hx(r,o);d<l&&(h=0,u=ca(o),l=d)}o=Yx(r),df(r,o);for(let c=0,h=0;h<4;++c,++h){Zx(c%2?a:s,c%4>=2,!0,e),o=Yo(r);const d=Hx(r,o);d<l&&(h=0,u=ca(o),l=d)}df(r,u)},Kx=(r,e,t)=>e.map(n=>zj(r,n,t)),Zx=(r,e,t,n)=>{const i=new dn;r==null||r.forEach(a=>{var s;const o=a.getRoots()[0].id,l=eC(a,o,i,e,t,n);for(let u=0;u<((s=l.vs)===null||s===void 0?void 0:s.length);u++){const c=a.getNode(l.vs[u]);c&&(c.data.order=u)}Bj(a,i,l.vs)})},df=(r,e)=>{e==null||e.forEach(t=>{t==null||t.forEach((n,i)=>{r.getNode(n).data.order=i})})},Zj=(r,e)=>{const n=r.getAllNodes().filter(s=>{var o;return!(!((o=r.getChildren(s.id))===null||o===void 0)&&o.length)}).map(s=>s.data.rank),i=Math.max(...n),a=[];for(let s=0;s<i+1;s++)a[s]=[];e==null||e.forEach(s=>{const o=r.getNode(s);!o||o.data.dummy||isNaN(o.data.rank)||(o.data.fixorder=a[o.data.rank].length,a[o.data.rank].push(s))})},Jj=r=>{const e={};let t=0;const n=i=>{const a=t;r.getChildren(i).forEach(s=>n(s.id)),e[i]={low:a,lim:t++}};return r.getRoots().forEach(i=>n(i.id)),e},Qj=(r,e,t,n)=>{var i,a;const s=[],o=[],l=Math.min(e[t].low,e[n].low),u=Math.max(e[t].lim,e[n].lim);let c,h;c=t;do c=(i=r.getParent(c))===null||i===void 0?void 0:i.id,s.push(c);while(c&&(e[c].low>l||u>e[c].lim));for(h=c,c=n;c&&c!==h;)o.push(c),c=(a=r.getParent(c))===null||a===void 0?void 0:a.id;return{lca:h,path:s.concat(o.reverse())}},e8=(r,e)=>{const t=Jj(r);e.forEach(n=>{var i,a;let s=n,o=r.getNode(s);const l=o.data.originalEdge;if(!l)return;const u=Qj(r,t,l.source,l.target),c=u.path,h=u.lca;let d=0,f=c[d],g=!0;for(;s!==l.target;){if(o=r.getNode(s),g){for(;f!==h&&((i=r.getNode(f))===null||i===void 0?void 0:i.data.maxRank)<o.data.rank;)d++,f=c[d];f===h&&(g=!1)}if(!g){for(;d<c.length-1&&((a=r.getNode(c[d+1]))===null||a===void 0?void 0:a.data.minRank)<=o.data.rank;)d++;f=c[d]}r.hasNode(f)&&r.setParent(s,f),s=r.getSuccessors(s)[0].id}})},t8=(r,e)=>{const t={},n=(i,a)=>{let s=0,o=0;const l=i.length,u=a==null?void 0:a[(a==null?void 0:a.length)-1];return a==null||a.forEach((c,h)=>{var d;const f=r8(r,c),g=f?r.getNode(f.id).data.order:l;(f||c===u)&&((d=a.slice(o,h+1))===null||d===void 0||d.forEach(v=>{var p;(p=r.getPredecessors(v))===null||p===void 0||p.forEach(y=>{var m;const w=r.getNode(y.id),S=w.data.order;(S<s||g<S)&&!(w.data.dummy&&(!((m=r.getNode(v))===null||m===void 0)&&m.data.dummy))&&tC(t,y.id,v)})}),o=h+1,s=g)}),a};return e!=null&&e.length&&e.reduce(n),t},n8=(r,e)=>{const t={};function n(o,l,u,c,h){var d,f;let g;for(let v=l;v<u;v++)g=o[v],!((d=r.getNode(g))===null||d===void 0)&&d.data.dummy&&((f=r.getPredecessors(g))===null||f===void 0||f.forEach(p=>{const y=r.getNode(p.id);y.data.dummy&&(y.data.order<c||y.data.order>h)&&tC(t,p.id,g)}))}function i(o){return JSON.stringify(o.slice(1))}function a(o,l){const u=i(o);l.get(u)||(n(...o),l.set(u,!0))}const s=(o,l)=>{let u=-1,c,h=0;const d=new Map;return l==null||l.forEach((f,g)=>{var v;if(((v=r.getNode(f))===null||v===void 0?void 0:v.data.dummy)==="border"){const p=r.getPredecessors(f)||[];p.length&&(c=r.getNode(p[0].id).data.order,a([l,h,g,u,c],d),h=g,u=c)}a([l,h,l.length,c,o.length],d)}),l};return e!=null&&e.length&&e.reduce(s),t},r8=(r,e)=>{var t,n;if(!((t=r.getNode(e))===null||t===void 0)&&t.data.dummy)return(n=r.getPredecessors(e))===null||n===void 0?void 0:n.find(i=>r.getNode(i.id).data.dummy)},tC=(r,e,t)=>{let n=e,i=t;if(n>i){const s=n;n=i,i=s}let a=r[n];a||(r[n]=a={}),a[i]=!0},i8=(r,e,t)=>{let n=e,i=t;if(n>i){const a=e;n=i,i=a}return!!r[n]},a8=(r,e,t,n)=>{const i={},a={},s={};return e==null||e.forEach(o=>{o==null||o.forEach((l,u)=>{i[l]=l,a[l]=l,s[l]=u})}),e==null||e.forEach(o=>{let l=-1;o==null||o.forEach(u=>{let c=n(u).map(h=>h.id);if(c.length){c=c.sort((d,f)=>s[d]-s[f]);const h=(c.length-1)/2;for(let d=Math.floor(h),f=Math.ceil(h);d<=f;++d){const g=c[d];a[u]===u&&l<s[g]&&!i8(t,u,g)&&(a[g]=u,a[u]=i[u]=i[g],l=s[g])}}})}),{root:i,align:a}},s8=(r,e,t,n,i,a,s)=>{var o;const l={},u=o8(r,e,t,i,a,s),c=s?"borderLeft":"borderRight",h=(g,v)=>{let p=u.getAllNodes(),y=p.pop();const m={};for(;y;)m[y.id]?g(y.id):(m[y.id]=!0,p.push(y),p=p.concat(v(y.id))),y=p.pop()},d=g=>{l[g]=(u.getRelatedEdges(g,"in")||[]).reduce((v,p)=>Math.max(v,(l[p.source]||0)+p.data.weight),0)},f=g=>{const v=(u.getRelatedEdges(g,"out")||[]).reduce((y,m)=>Math.min(y,(l[m.target]||0)-m.data.weight),Number.POSITIVE_INFINITY),p=r.getNode(g);v!==Number.POSITIVE_INFINITY&&p.data.borderType!==c&&(l[g]=Math.max(l[g],v))};return h(d,u.getPredecessors.bind(u)),h(f,u.getSuccessors.bind(u)),(o=Object.values(n))===null||o===void 0||o.forEach(g=>{l[g]=l[t[g]]}),l},o8=(r,e,t,n,i,a)=>{const s=new dn,o=h8(n,i,a);return e==null||e.forEach(l=>{let u;l==null||l.forEach(c=>{const h=t[c];if(s.hasNode(h)||s.addNode({id:h,data:{}}),u){const d=t[u],f=s.getRelatedEdges(d,"out").find(g=>g.target===h);f?s.updateEdgeData(f.id,Object.assign(Object.assign({},f.data),{weight:Math.max(o(r,c,u),f.data.weight||0)})):s.addEdge({id:`e${Math.random()}`,source:d,target:h,data:{weight:Math.max(o(r,c,u),0)}})}u=c})}),s},l8=(r,e)=>tb(Object.values(e),t=>{var n;let i=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY;return(n=Object.keys(t))===null||n===void 0||n.forEach(s=>{const o=t[s],l=d8(r,s)/2;i=Math.max(o+l,i),a=Math.min(o-l,a)}),i-a});function u8(r,e){const t=Object.values(e),n=Math.min(...t),i=Math.max(...t);["u","d"].forEach(a=>{["l","r"].forEach(s=>{const o=a+s,l=r[o];let u;if(l===e)return;const c=Object.values(l);u=s==="l"?n-Math.min(...c):i-Math.max(...c),u&&(r[o]={},Object.keys(l).forEach(h=>{r[o][h]=l[h]+u}))})})}const c8=(r,e)=>{const t={};return Object.keys(r.ul).forEach(n=>{if(e)t[n]=r[e.toLowerCase()][n];else{const i=Object.values(r).map(a=>a[n]);t[n]=(i[0]+i[1])/2}}),t},h8=(r,e,t)=>(n,i,a)=>{const s=n.getNode(i),o=n.getNode(a);let l=0,u=0;if(l+=s.data.width/2,s.data.hasOwnProperty("labelpos"))switch((s.data.labelpos||"").toLowerCase()){case"l":u=-s.data.width/2;break;case"r":u=s.data.width/2;break}if(u&&(l+=t?u:-u),u=0,l+=(s.data.dummy?e:r)/2,l+=(o.data.dummy?e:r)/2,l+=o.data.width/2,o.data.labelpos)switch((o.data.labelpos||"").toLowerCase()){case"l":u=o.data.width/2;break;case"r":u=-o.data.width/2;break}return u&&(l+=t?u:-u),u=0,l},d8=(r,e)=>r.getNode(e).data.width||0,f8=(r,e)=>{const{ranksep:t=0}=e||{},n=Yo(r);let i=0;n==null||n.forEach(a=>{const s=a.map(l=>r.getNode(l).data.height),o=Math.max(...s,0);a==null||a.forEach(l=>{r.getNode(l).data.y=i+o/2}),i+=o+t})},g8=(r,e)=>{const{align:t,nodesep:n=0,edgesep:i=0}=e||{},a=Yo(r),s=Object.assign(t8(r,a),n8(r,a)),o={};let l=[];["u","d"].forEach(c=>{l=c==="u"?a:Object.values(a).reverse(),["l","r"].forEach(h=>{h==="r"&&(l=l.map(v=>Object.values(v).reverse()));const d=(c==="u"?r.getPredecessors:r.getSuccessors).bind(r),f=a8(r,l,s,d),g=s8(r,l,f.root,f.align,n,i,h==="r");h==="r"&&Object.keys(g).forEach(v=>g[v]=-g[v]),o[c+h]=g})});const u=l8(r,o);return u&&u8(o,u),c8(o,t)},p8=(r,e)=>{var t;const n=HP(r);f8(n,e);const i=g8(n,e);(t=Object.keys(i))===null||t===void 0||t.forEach(a=>{n.getNode(a).data.x=i[a]})},nC=r=>{const e={},t=n=>{var i;const a=r.getNode(n);if(!a)return 0;if(e[n])return a.data.rank;e[n]=!0;let s;return(i=r.getRelatedEdges(n,"out"))===null||i===void 0||i.forEach(o=>{const l=t(o.target),u=o.data.minlen,c=l-u;c&&(s===void 0||c<s)&&(s=c)}),s||(s=0),a.data.rank=s,s};r.getAllNodes().filter(n=>r.getRelatedEdges(n.id,"in").length===0).forEach(n=>t(n.id))},v8=r=>{const e={};let t;const n=s=>{var o;const l=r.getNode(s);if(!l)return 0;if(e[s])return l.data.rank;e[s]=!0;let u;return(o=r.getRelatedEdges(s,"out"))===null||o===void 0||o.forEach(c=>{const h=n(c.target),d=c.data.minlen,f=h-d;f&&(u===void 0||f<u)&&(u=f)}),u||(u=0),(t===void 0||u<t)&&(t=u),l.data.rank=u,u};r.getAllNodes().filter(s=>r.getRelatedEdges(s.id,"in").length===0).forEach(s=>{s&&n(s.id)}),t===void 0&&(t=0);const i={},a=(s,o)=>{var l;const u=r.getNode(s),c=isNaN(u.data.layer)?o:u.data.layer;(u.data.rank===void 0||u.data.rank<c)&&(u.data.rank=c),!i[s]&&(i[s]=!0,(l=r.getRelatedEdges(s,"out"))===null||l===void 0||l.forEach(h=>{a(h.target,c+h.data.minlen)}))};r.getAllNodes().forEach(s=>{const o=s.data;o&&(isNaN(o.layer)?o.rank-=t:a(s.id,o.layer))})},fa=(r,e)=>r.getNode(e.target).data.rank-r.getNode(e.source).data.rank-e.data.minlen,y8=r=>{const e=new dn({tree:[]}),t=r.getAllNodes()[0],n=r.getAllNodes().length;e.addNode(t);let i,a;for(;m8(e,r)<n;)i=rC(e,r),a=e.hasNode(i.source)?fa(r,i):-fa(r,i),iC(e,r,a);return e},m8=(r,e)=>{const t=n=>{e.getRelatedEdges(n,"both").forEach(i=>{const a=i.source,s=n===a?i.target:a;!r.hasNode(s)&&!fa(e,i)&&(r.addNode({id:s,data:{}}),r.addEdge({id:i.id,source:n,target:s,data:{}}),t(s))})};return r.getAllNodes().forEach(n=>t(n.id)),r.getAllNodes().length},b8=r=>{const e=new dn({tree:[]}),t=r.getAllNodes()[0],n=r.getAllNodes().length;e.addNode(t);let i,a;for(;w8(e,r)<n;)i=rC(e,r),a=e.hasNode(i.source)?fa(r,i):-fa(r,i),iC(e,r,a);return e},w8=(r,e)=>{const t=n=>{var i;(i=e.getRelatedEdges(n,"both"))===null||i===void 0||i.forEach(a=>{const s=a.source,o=n===s?a.target:s;!r.hasNode(o)&&(e.getNode(o).data.layer!==void 0||!fa(e,a))&&(r.addNode({id:o,data:{}}),r.addEdge({id:a.id,source:n,target:o,data:{}}),t(o))})};return r.getAllNodes().forEach(n=>t(n.id)),r.getAllNodes().length},rC=(r,e)=>tb(e.getAllEdges(),t=>r.hasNode(t.source)!==r.hasNode(t.target)?fa(e,t):1/0),iC=(r,e,t)=>{r.getAllNodes().forEach(n=>{const i=e.getNode(n.id);i.data.rank||(i.data.rank=0),i.data.rank+=t})},x8=r=>{const e=wj(r);nC(e);const t=y8(e);sC(t),aC(t,e);let n,i;for(;n=_8(t);)i=M8(t,e,n),O8(t,e,n,i)},aC=(r,e)=>{let t=KP(r,r.getAllNodes(),"post");t=t.slice(0,(t==null?void 0:t.length)-1),t.forEach(n=>{E8(r,e,n)})},E8=(r,e,t)=>{const i=r.getNode(t).data.parent,a=r.getRelatedEdges(t,"both").find(s=>s.target===i||s.source===i);a.data.cutvalue=S8(r,e,t)},S8=(r,e,t)=>{const i=r.getNode(t).data.parent;let a=!0,s=e.getRelatedEdges(t,"out").find(l=>l.target===i),o=0;return s||(a=!1,s=e.getRelatedEdges(i,"out").find(l=>l.target===t)),o=s.data.weight,e.getRelatedEdges(t,"both").forEach(l=>{const u=l.source===t,c=u?l.target:l.source;if(c!==i){const h=u===a,d=l.data.weight;if(o+=h?d:-d,T8(r,t,c)){const f=r.getRelatedEdges(t,"both").find(g=>g.source===c||g.target===c).data.cutvalue;o+=h?-f:f}}}),o},sC=(r,e=r.getAllNodes()[0].id)=>{oC(r,{},1,e)},oC=(r,e,t,n,i)=>{var a;const s=t;let o=t;const l=r.getNode(n);return e[n]=!0,(a=r.getNeighbors(n))===null||a===void 0||a.forEach(u=>{e[u.id]||(o=oC(r,e,o,u.id,n))}),l.data.low=s,l.data.lim=o++,i?l.data.parent=i:delete l.data.parent,o},_8=r=>r.getAllEdges().find(e=>e.data.cutvalue<0),M8=(r,e,t)=>{let n=t.source,i=t.target;e.getRelatedEdges(n,"out").find(c=>c.target===i)||(n=t.target,i=t.source);const a=r.getNode(n),s=r.getNode(i);let o=a,l=!1;a.data.lim>s.data.lim&&(o=s,l=!0);const u=e.getAllEdges().filter(c=>l===Jx(r.getNode(c.source),o)&&l!==Jx(r.getNode(c.target),o));return tb(u,c=>fa(e,c))},O8=(r,e,t,n)=>{const i=r.getRelatedEdges(t.source,"both").find(a=>a.source===t.target||a.target===t.target);i&&r.removeEdge(i.id),r.addEdge({id:`e${Math.random()}`,source:n.source,target:n.target,data:{}}),sC(r),aC(r,e),k8(r,e)},k8=(r,e)=>{const t=r.getAllNodes().find(i=>!i.data.parent);let n=KP(r,t,"pre");n=n.slice(1),n.forEach(i=>{const a=r.getNode(i).data.parent;let s=e.getRelatedEdges(i,"out").find(l=>l.target===a),o=!1;!s&&e.hasNode(a)&&(s=e.getRelatedEdges(a,"out").find(l=>l.target===i),o=!0),e.getNode(i).data.rank=(e.hasNode(a)&&e.getNode(a).data.rank||0)+(o?s==null?void 0:s.data.minlen:-(s==null?void 0:s.data.minlen))})},T8=(r,e,t)=>r.getRelatedEdges(e,"both").find(n=>n.source===t||n.target===t),Jx=(r,e)=>e.data.low<=r.data.lim&&r.data.lim<=e.data.lim,A8=(r,e)=>{switch(e){case"network-simplex":C8(r);break;case"tight-tree":Qx(r);break;case"longest-path":P8(r);break;default:Qx(r)}},P8=nC,Qx=r=>{v8(r),b8(r)},C8=r=>{x8(r)},N8=(r,e)=>{const{edgeLabelSpace:t,keepNodeOrder:n,prevGraph:i,rankdir:a,ranksep:s}=e;!n&&i&&L8(r,i);const o=j8(r);t&&(e.ranksep=q8(o,{rankdir:a,ranksep:s}));let l;try{l=R8(o,e)}catch(u){if(u.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,u);return}throw u}return I8(r,o),l},R8=(r,e)=>{const{ranker:t,rankdir:n="tb",nodeOrder:i,keepNodeOrder:a,align:s,nodesep:o=50,edgesep:l=20,ranksep:u=50}=e;K8(r),yj(r);const{nestingRoot:c,nodeRankFactor:h}=Pj(r);A8(HP(r),t),$8(r),Sj(r,h),Rj(r,c),Ej(r),G8(r),W8(r);const d=[];Ij(r,d),e8(r,d),Mj(r),a&&Zj(r,i),Kj(r,a),Z8(r),Oj(r,n),p8(r,{align:s,nodesep:o,edgesep:l,ranksep:u}),J8(r),X8(r),Fj(r,d),H8(r),kj(r,n);const{width:f,height:g}=V8(r);return U8(r),Y8(r),mj(r),{width:f,height:g}},L8=(r,e)=>{r.getAllNodes().forEach(t=>{const n=r.getNode(t.id);if(e.hasNode(t.id)){const i=e.getNode(t.id);n.data.fixorder=i.data._order,delete i.data._order}else delete n.data.fixorder})},I8=(r,e)=>{r.getAllNodes().forEach(t=>{var n;const i=r.getNode(t.id);if(i){const a=e.getNode(t.id);i.data.x=a.data.x,i.data.y=a.data.y,i.data._order=a.data.order,i.data._rank=a.data.rank,!((n=e.getChildren(t.id))===null||n===void 0)&&n.length&&(i.data.width=a.data.width,i.data.height=a.data.height)}}),r.getAllEdges().forEach(t=>{const n=r.getEdge(t.id),i=e.getEdge(t.id);n.data.points=i?i.data.points:[],i&&i.data.hasOwnProperty("x")&&(n.data.x=i.data.x,n.data.y=i.data.y)})},D8=["width","height","layer","fixorder"],F8={width:0,height:0},B8=["minlen","weight","width","height","labeloffset"],z8={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},ff=["labelpos"],j8=r=>{const e=new dn({tree:[]});return r.getAllNodes().forEach(t=>{const n=tE(r.getNode(t.id).data),i=Object.assign(Object.assign({},F8),n),a=eE(i,D8);e.hasNode(t.id)||e.addNode({id:t.id,data:Object.assign({},a)});const s=r.hasTreeStructure("combo")?r.getParent(t.id,"combo"):r.getParent(t.id);Le(s)||(e.hasNode(s.id)||e.addNode(Object.assign({},s)),e.setParent(t.id,s.id))}),r.getAllEdges().forEach(t=>{const n=tE(r.getEdge(t.id).data),i={};ff==null||ff.forEach(a=>{n[a]!==void 0&&(i[a]=n[a])}),e.addEdge({id:t.id,source:t.source,target:t.target,data:Object.assign({},z8,eE(n,B8),i)})}),e},q8=(r,e)=>{const{ranksep:t=0,rankdir:n}=e;return r.getAllNodes().forEach(i=>{isNaN(i.data.layer)||i.data.layer||(i.data.layer=0)}),r.getAllEdges().forEach(i=>{var a;i.data.minlen*=2,((a=i.data.labelpos)===null||a===void 0?void 0:a.toLowerCase())!=="c"&&(n==="TB"||n==="BT"?i.data.width+=i.data.labeloffset:i.data.height+=i.data.labeloffset)}),t/2},$8=r=>{r.getAllEdges().forEach(e=>{if(e.data.width&&e.data.height){const t=r.getNode(e.source),n=r.getNode(e.target),i={e,rank:(n.data.rank-t.data.rank)/2+t.data.rank};Us(r,"edge-proxy",i,"_ep")}})},G8=r=>{let e=0;return r.getAllNodes().forEach(t=>{var n,i;t.data.borderTop&&(t.data.minRank=(n=r.getNode(t.data.borderTop))===null||n===void 0?void 0:n.data.rank,t.data.maxRank=(i=r.getNode(t.data.borderBottom))===null||i===void 0?void 0:i.data.rank,e=Math.max(e,t.data.maxRank||-1/0))}),e},W8=r=>{r.getAllNodes().forEach(e=>{e.data.dummy==="edge-proxy"&&(r.getEdge(e.data.e.id).data.labelRank=e.data.rank,r.removeNode(e.id))})},V8=(r,e)=>{let t,n=0,i,a=0;const{marginx:s=0,marginy:o=0}={},l=u=>{if(!u.data)return;const c=u.data.x,h=u.data.y,d=u.data.width,f=u.data.height;!isNaN(c)&&!isNaN(d)&&(t===void 0&&(t=c-d/2),t=Math.min(t,c-d/2),n=Math.max(n,c+d/2)),!isNaN(h)&&!isNaN(f)&&(i===void 0&&(i=h-f/2),i=Math.min(i,h-f/2),a=Math.max(a,h+f/2))};return r.getAllNodes().forEach(u=>{l(u)}),r.getAllEdges().forEach(u=>{u!=null&&u.data.hasOwnProperty("x")&&l(u)}),t-=s,i-=o,r.getAllNodes().forEach(u=>{u.data.x-=t,u.data.y-=i}),r.getAllEdges().forEach(u=>{var c;(c=u.data.points)===null||c===void 0||c.forEach(h=>{h.x-=t,h.y-=i}),u.data.hasOwnProperty("x")&&(u.data.x-=t),u.data.hasOwnProperty("y")&&(u.data.y-=i)}),{width:n-t+s,height:a-i+o}},U8=r=>{r.getAllEdges().forEach(e=>{const t=r.getNode(e.source),n=r.getNode(e.target);let i,a;e.data.points?(i=e.data.points[0],a=e.data.points[e.data.points.length-1]):(e.data.points=[],i={x:n.data.x,y:n.data.y},a={x:t.data.x,y:t.data.y}),e.data.points.unshift(Gx(t.data,i)),e.data.points.push(Gx(n.data,a))})},H8=r=>{r.getAllEdges().forEach(e=>{if(e.data.hasOwnProperty("x"))switch((e.data.labelpos==="l"||e.data.labelpos==="r")&&(e.data.width-=e.data.labeloffset),e.data.labelpos){case"l":e.data.x-=e.data.width/2+e.data.labeloffset;break;case"r":e.data.x+=e.data.width/2+e.data.labeloffset;break}})},Y8=r=>{r.getAllEdges().forEach(e=>{var t;e.data.reversed&&((t=e.data.points)===null||t===void 0||t.reverse())})},X8=r=>{r.getAllNodes().forEach(e=>{var t,n,i;if(!((t=r.getChildren(e.id))===null||t===void 0)&&t.length){const a=r.getNode(e.id),s=r.getNode(a.data.borderTop),o=r.getNode(a.data.borderBottom),l=r.getNode(a.data.borderLeft[((n=a.data.borderLeft)===null||n===void 0?void 0:n.length)-1]),u=r.getNode(a.data.borderRight[((i=a.data.borderRight)===null||i===void 0?void 0:i.length)-1]);a.data.width=Math.abs((u==null?void 0:u.data.x)-(l==null?void 0:l.data.x))||10,a.data.height=Math.abs((o==null?void 0:o.data.y)-(s==null?void 0:s.data.y))||10,a.data.x=((l==null?void 0:l.data.x)||0)+a.data.width/2,a.data.y=((s==null?void 0:s.data.y)||0)+a.data.height/2}}),r.getAllNodes().forEach(e=>{e.data.dummy==="border"&&r.removeNode(e.id)})},K8=r=>{r.getAllEdges().forEach(e=>{if(e.source===e.target){const t=r.getNode(e.source);t.data.selfEdges||(t.data.selfEdges=[]),t.data.selfEdges.push(e),r.removeEdge(e.id)}})},Z8=r=>{const e=Yo(r);e==null||e.forEach(t=>{let n=0;t==null||t.forEach((i,a)=>{var s;const o=r.getNode(i);o.data.order=a+n,(s=o.data.selfEdges)===null||s===void 0||s.forEach(l=>{Us(r,"selfedge",{width:l.data.width,height:l.data.height,rank:o.data.rank,order:a+ ++n,e:l},"_se")}),delete o.data.selfEdges})})},J8=r=>{r.getAllNodes().forEach(e=>{const t=r.getNode(e.id);if(t.data.dummy==="selfedge"){const n=r.getNode(t.data.e.source),i=n.data.x+n.data.width/2,a=n.data.y,s=t.data.x-i,o=n.data.height/2;r.hasEdge(t.data.e.id)?r.updateEdgeData(t.data.e.id,t.data.e.data):r.addEdge({id:t.data.e.id,source:t.data.e.source,target:t.data.e.target,data:t.data.e.data}),r.removeNode(e.id),t.data.e.data.points=[{x:i+2*s/3,y:a-o},{x:i+5*s/6,y:a-o},{y:a,x:i+s},{x:i+5*s/6,y:a+o},{x:i+2*s/3,y:a+o}],t.data.e.data.x=t.data.x,t.data.e.data.y=t.data.y}})},eE=(r,e)=>{const t={};return e==null||e.forEach(n=>{r[n]!==void 0&&(t[n]=+r[n])}),t},tE=(r={})=>{const e={};return Object.keys(r).forEach(t=>{e[t.toLowerCase()]=r[t]}),e},Oi=Array.isArray,lC=r=>{const e=[],t=r.length;for(let n=0;n<t;n+=1){e[n]=[];for(let i=0;i<t;i+=1)n===i?e[n][i]=0:r[n][i]===0||!r[n][i]?e[n][i]=1/0:e[n][i]=r[n][i]}for(let n=0;n<t;n+=1)for(let i=0;i<t;i+=1)for(let a=0;a<t;a+=1)e[i][a]>e[i][n]+e[n][a]&&(e[i][a]=e[i][n]+e[n][a]);return e},uC=(r,e)=>{const{nodes:t,edges:n}=r,i=[],a={};if(!t)throw new Error("invalid nodes data!");return t&&t.forEach((s,o)=>{a[s.id]=o;const l=[];i.push(l)}),n==null||n.forEach(s=>{const{source:o,target:l}=s,u=a[o],c=a[l];u===void 0||c===void 0||(i[u][c]=1,i[c][u]=1)}),i},Q8=(r,e)=>{const t=[];return r.forEach(n=>{const i=[];n.forEach(a=>{i.push(a*e)}),t.push(i)}),t},e9=r=>{let e=1/0,t=1/0,n=-1/0,i=-1/0;return r.forEach(a=>{let s=a.data.size;Oi(s)?s.length===1&&(s=[s[0],s[0]]):_e(s)?s=[s,s]:(s===void 0||isNaN(s))&&(s=[30,30]);const o=[s[0]/2,s[1]/2],l=a.data.x-o[0],u=a.data.x+o[0],c=a.data.y-o[1],h=a.data.y+o[1];e>l&&(e=l),t>c&&(t=c),n<u&&(n=u),i<h&&(i=h)}),{minX:e,minY:t,maxX:n,maxY:i}},nE=(r,e)=>Math.sqrt((r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y)),Um=(r,e,t,n="TB",i,a={})=>{if(!(e!=null&&e.length))return;const{stopBranchFn:s,stopAllFn:o}=a;for(let l=0;l<e.length;l++){const u=e[l];if(r.hasNode(u.id)&&!(s!=null&&s(u))){if(o!=null&&o(u))return;n==="TB"&&t(u),Um(r,r.getChildren(u.id,i),t,n,i,a),n!=="TB"&&t(u)}}},Hm=r=>{if(r===null)return r;if(r instanceof Date)return new Date(r.getTime());if(r instanceof Array){const e=[];return r.forEach(t=>{e.push(t)}),e.map(t=>Hm(t))}if(typeof r=="object"){const e={};return Object.keys(r).forEach(t=>{e[t]=Hm(r[t])}),e}return r},cr=(r,e)=>{const t=Hm(r);return t.data=t.data||{},e&&(_e(t.data.x)||(t.data.x=Math.random()*e[0]),_e(t.data.y)||(t.data.y=Math.random()*e[1])),t};function yl(r){if(!r)return[0,0,0];if(_e(r))return[r,r,r];if(r.length===0)return[0,0,0];const[e,t=e,n=e]=r;return[e,t,n]}function ja(r,e){let t;return Te(e)?t=e:_e(e)?t=()=>e:t=()=>r,t}function nb(r,e,t=!0){return!e&&e!==0?n=>{const{size:i}=n.data||{};return i?Array.isArray(i)?t?Math.max(...i)||r:i:Yt(i)&&i.width&&i.height?t?Math.max(i.width,i.height)||r:[i.width,i.height]:i:r}:Te(e)?e:_e(e)?()=>e:Array.isArray(e)?()=>t?Math.max(...e)||r:e:Yt(e)&&e.width&&e.height?()=>t?Math.max(e.width,e.height)||r:[e.width,e.height]:()=>r}const rb=(r,e,t=10)=>{let n;const i=typeof e=="function"?e:()=>e||0;return r?Array.isArray(r)?n=s=>r:Te(r)?n=r:n=s=>r:n=s=>{var o,l,u;if(!((o=s.data)===null||o===void 0)&&o.bboxSize)return(l=s.data)===null||l===void 0?void 0:l.bboxSize;if(!((u=s.data)===null||u===void 0)&&u.size){const c=s.data.size;return Array.isArray(c)?c:Yt(c)?[c.width,c.height]:c}return t},s=>{const o=n(s),l=i(s);return Math.max(...yl(o))+l}},t9={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:"tight-tree",controlPoints:!1,radial:!1,focusNode:null};class n9{constructor(e={}){this.options=e,this.id="antv-dagre",this.options=Object.assign(Object.assign({},t9),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,e,t)})}genericDagreLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{nodeSize:a,align:s,rankdir:o="TB",ranksep:l,nodesep:u,ranksepFunc:c,nodesepFunc:h,edgeLabelSpace:d,ranker:f,nodeOrder:g,begin:v,controlPoints:p,radial:y,sortByCombo:m,preset:w}=i,S=new dn({tree:[]}),_=ja(l||50,c),O=ja(u||50,h);let T=O,k=_;(o==="LR"||o==="RL")&&(T=_,k=O);const P=nb(10,a,!1),C=t.getAllNodes(),N=t.getAllEdges();C.forEach(j=>{const Z=yl(P(j)),ne=k(j),oe=T(j),le=Z[0]+2*oe,Ce=Z[1]+2*ne,K=j.data.layer;_e(K)?S.addNode({id:j.id,data:{width:le,height:Ce,layer:K}}):S.addNode({id:j.id,data:{width:le,height:Ce}})}),m&&(S.attachTreeStructure("combo"),C.forEach(j=>{const{parentId:Z}=j.data;Z!==void 0&&S.hasNode(Z)&&S.setParent(j.id,Z,"combo")})),N.forEach(j=>{S.addEdge({id:j.id,source:j.source,target:j.target,data:{weight:j.data.weight||1}})});let L;w!=null&&w.length&&(L=new dn({nodes:w})),N8(S,{prevGraph:L,edgeLabelSpace:d,keepNodeOrder:!!g,nodeOrder:g||[],acyclicer:"greedy",ranker:f,rankdir:o,nodesep:u,align:s});const F=[0,0];if(v){let j=1/0,Z=1/0;S.getAllNodes().forEach(ne=>{j>ne.data.x&&(j=ne.data.x),Z>ne.data.y&&(Z=ne.data.y)}),S.getAllEdges().forEach(ne=>{var oe;(oe=ne.data.points)===null||oe===void 0||oe.forEach(le=>{j>le.x&&(j=le.x),Z>le.y&&(Z=le.y)})}),F[0]=v[0]-j,F[1]=v[1]-Z}const G=o==="LR"||o==="RL";if(!y){const j=new Set,ne=o==="BT"||o==="RL"?(K,W)=>W-K:(K,W)=>K-W;S.getAllNodes().forEach(K=>{K.data.x=K.data.x+F[0],K.data.y=K.data.y+F[1],j.add(G?K.data.x:K.data.y)});const oe=Array.from(j).sort(ne),le=G?(K,W)=>K.x!==W.x:(K,W)=>K.y!==W.y,Ce=G?(K,W,ee)=>{const he=Math.max(W.y,ee.y),Se=Math.min(W.y,ee.y);return K.filter(Ne=>Ne.y<=he&&Ne.y>=Se)}:(K,W,ee)=>{const he=Math.max(W.x,ee.x),Se=Math.min(W.x,ee.x);return K.filter(Ne=>Ne.x<=he&&Ne.x>=Se)};S.getAllEdges().forEach((K,W)=>{var ee;d&&p&&K.data.type!=="loop"&&(K.data.controlPoints=r9((ee=K.data.points)===null||ee===void 0?void 0:ee.map(({x:he,y:Se})=>({x:he+F[0],y:Se+F[1]})),S.getNode(K.source),S.getNode(K.target),oe,G,le,Ce))})}let V=[];V=S.getAllNodes().map(j=>cr(j));const U=S.getAllEdges();return e&&(V.forEach(j=>{t.mergeNodeData(j.id,{x:j.data.x,y:j.data.y})}),U.forEach(j=>{t.mergeEdgeData(j.id,{controlPoints:j.data.controlPoints})})),{nodes:V,edges:U}})}}const r9=(r,e,t,n,i,a,s)=>{let o=(r==null?void 0:r.slice(1,r.length-1))||[];if(e&&t){let{x:l,y:u}=e.data,{x:c,y:h}=t.data;if(i&&(l=e.data.y,u=e.data.x,c=t.data.y,h=t.data.x),h!==u&&l!==c){const d=n.indexOf(u),f=n[d+1];if(f){const p=o[0],y=i?{x:(u+f)/2,y:(p==null?void 0:p.y)||c}:{x:(p==null?void 0:p.x)||c,y:(u+f)/2};(!p||a(p,y))&&o.unshift(y)}const g=n.indexOf(h),v=Math.abs(g-d);if(v===1)o=s(o,e.data,t.data),o.length||o.push(i?{x:(u+h)/2,y:l}:{x:l,y:(u+h)/2});else if(v>1){const p=n[g-1];if(p){const y=o[o.length-1],m=i?{x:(h+p)/2,y:(y==null?void 0:y.y)||c}:{x:(y==null?void 0:y.x)||l,y:(h+p)/2};(!y||a(y,m))&&o.push(m)}}}}return o},rs=(r,e,t)=>{const n=r.getAllNodes(),i=r.getAllEdges();if(!(n!=null&&n.length))return{nodes:[],edges:i};if(n.length===1)return e&&r.mergeNodeData(n[0].id,{x:t[0],y:t[1]}),{nodes:[Object.assign(Object.assign({},n[0]),{data:Object.assign(Object.assign({},n[0].data),{x:t[0],y:t[1]})})],edges:i}},i9={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1};class a9{constructor(e={}){this.options=e,this.id="circular",this.options=Object.assign(Object.assign({},i9),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericCircularLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericCircularLayout(!0,e,t)})}genericCircularLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{width:a,height:s,center:o,divisions:l,startAngle:u=0,endAngle:c=2*Math.PI,angleRatio:h,ordering:d,clockwise:f,nodeSpacing:g,nodeSize:v}=i,p=t.getAllNodes(),y=t.getAllEdges(),[m,w,S]=o9(a,s,o),_=p==null?void 0:p.length;if(!_||_===1)return rs(t,e,S);const O=(c-u)/_;let{radius:T,startRadius:k,endRadius:P}=i;if(g){const G=ja(10,g),V=nb(10,v);let U=-1/0;p.forEach(j=>{const Z=V(j);U<Z&&(U=Z)});let $=0;p.forEach((j,Z)=>{Z===0?$+=U||10:$+=(G(j)||0)+(U||10)}),T=$/(2*Math.PI)}else!T&&!k&&!P?T=Math.min(w,m)/2:!k&&P?k=P:k&&!P&&(P=k);const C=O*h;let N=[];d==="topology"?N=rE(t,p):d==="topology-directed"?N=rE(t,p,!0):d==="degree"?N=s9(t,p):N=p.map(G=>cr(G));const L=Math.ceil(_/l);for(let G=0;G<_;++G){let V=T;!V&&k!==null&&P!==null&&(V=k+G*(P-k)/(_-1)),V||(V=10+G*100/(_-1));let U=u+G%L*C+2*Math.PI/l*Math.floor(G/L);f||(U=c-G%L*C-2*Math.PI/l*Math.floor(G/L)),N[G].data.x=S[0]+Math.cos(U)*V,N[G].data.y=S[1]+Math.sin(U)*V}return e&&N.forEach(G=>{t.mergeNodeData(G.id,{x:G.data.x,y:G.data.y})}),{nodes:N,edges:y}})}}const rE=(r,e,t=!1)=>{const n=[cr(e[0])],i={},a=e.length;i[e[0].id]=!0;let s=0;return e.forEach((o,l)=>{if(l!==0)if((l===a-1||r.getDegree(o.id,"both")!==r.getDegree(e[l+1].id,"both")||r.areNeighbors(n[s].id,o.id))&&!i[o.id])n.push(cr(o)),i[o.id]=!0,s++;else{const u=t?r.getSuccessors(n[s].id):r.getNeighbors(n[s].id);let c=!1;for(let d=0;d<u.length;d++){const f=u[d];if(r.getDegree(f.id)===r.getDegree(o.id)&&!i[f.id]){n.push(cr(f)),i[f.id]=!0,c=!0;break}}let h=0;for(;!c&&(i[e[h].id]||(n.push(cr(e[h])),i[e[h].id]=!0,c=!0),h++,h!==a););}}),n};function s9(r,e){const t=[];return e.forEach((n,i)=>{t.push(cr(n))}),t.sort((n,i)=>r.getDegree(n.id,"both")-r.getDegree(i.id,"both")),t}const o9=(r,e,t)=>{let n=r,i=e,a=t;return!n&&typeof window<"u"&&(n=window.innerWidth),!i&&typeof window<"u"&&(i=window.innerHeight),a||(a=[n/2,i/2]),[n,i,a]},l9={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"};class Ym{constructor(e={}){this.options=e,this.id="concentric",this.options=Object.assign(Object.assign({},l9),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericConcentricLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericConcentricLayout(!0,e,t)})}genericConcentricLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{center:a,width:s,height:o,sortBy:l,maxLevelDiff:u,sweep:c,clockwise:h,equidistant:d,preventOverlap:f,startAngle:g=3/2*Math.PI,nodeSize:v,nodeSpacing:p}=i,y=t.getAllNodes(),m=t.getAllEdges(),w=!s&&typeof window<"u"?window.innerWidth:s,S=!o&&typeof window<"u"?window.innerHeight:o,_=a||[w/2,S/2];if(!(y!=null&&y.length)||y.length===1)return rs(t,e,_);const O=[];let T,k=0;Oi(v)?T=Math.max(v[0],v[1]):Te(v)?(T=-1/0,y.forEach(j=>{const Z=Math.max(...yl(v(j)));Z>T&&(T=Z)})):T=v,Oi(p)?k=Math.max(p[0],p[1]):_e(p)&&(k=p),y.forEach(j=>{const Z=cr(j);O.push(Z);let ne=T;const{data:oe}=Z;Oi(oe.size)?ne=Math.max(oe.size[0],oe.size[1]):_e(oe.size)?ne=oe.size:Yt(oe.size)&&(ne=Math.max(oe.size.width,oe.size.height)),T=Math.max(T,ne),Te(p)&&(k=Math.max(p(j),k))});const P={};O.forEach((j,Z)=>{P[j.id]=Z});let C=l;(!rt(C)||O[0].data[C]===void 0)&&(C="degree"),C==="degree"?O.sort((j,Z)=>t.getDegree(Z.id,"both")-t.getDegree(j.id,"both")):O.sort((j,Z)=>Z.data[C]-j.data[C]);const N=O[0],L=(u||(C==="degree"?t.getDegree(N.id,"both"):N.data[C]))/4,F=[{nodes:[]}];let G=F[0];O.forEach(j=>{if(G.nodes.length>0){const Z=Math.abs(C==="degree"?t.getDegree(G.nodes[0].id,"both")-t.getDegree(j.id,"both"):G.nodes[0].data[C]-j.data[C]);L&&Z>=L&&(G={nodes:[]},F.push(G))}G.nodes.push(j)});let V=T+k;if(!f){const j=F.length>0&&F[0].nodes.length>1,ne=(Math.min(w,S)/2-V)/(F.length+(j?1:0));V=Math.min(V,ne)}let U=0;if(F.forEach(j=>{const Z=c===void 0?2*Math.PI-2*Math.PI/j.nodes.length:c;if(j.dTheta=Z/Math.max(1,j.nodes.length-1),j.nodes.length>1&&f){const ne=Math.cos(j.dTheta)-Math.cos(0),oe=Math.sin(j.dTheta)-Math.sin(0),le=Math.sqrt(V*V/(ne*ne+oe*oe));U=Math.max(le,U)}j.r=U,U+=V}),d){let j=0,Z=0;for(let ne=0;ne<F.length;ne++){const le=(F[ne].r||0)-Z;j=Math.max(j,le)}Z=0,F.forEach((ne,oe)=>{oe===0&&(Z=ne.r||0),ne.r=Z,Z+=j})}return F.forEach(j=>{const Z=j.dTheta||0,ne=j.r||0;j.nodes.forEach((oe,le)=>{const Ce=g+(h?1:-1)*Z*le;oe.data.x=_[0]+ne*Math.cos(Ce),oe.data.y=_[1]+ne*Math.sin(Ce)})}),e&&O.forEach(j=>t.mergeNodeData(j.id,{x:j.data.x,y:j.data.y})),{nodes:O,edges:m}})}}function u9(r){const e=+this._x.call(null,r),t=+this._y.call(null,r);return cC(this.cover(e,t),e,t,r)}function cC(r,e,t,n){if(isNaN(e)||isNaN(t))return r;var i,a=r._root,s={data:n},o=r._x0,l=r._y0,u=r._x1,c=r._y1,h,d,f,g,v,p,y,m;if(!a)return r._root=s,r;for(;a.length;)if((v=e>=(h=(o+u)/2))?o=h:u=h,(p=t>=(d=(l+c)/2))?l=d:c=d,i=a,!(a=a[y=p<<1|v]))return i[y]=s,r;if(f=+r._x.call(null,a.data),g=+r._y.call(null,a.data),e===f&&t===g)return s.next=a,i?i[y]=s:r._root=s,r;do i=i?i[y]=new Array(4):r._root=new Array(4),(v=e>=(h=(o+u)/2))?o=h:u=h,(p=t>=(d=(l+c)/2))?l=d:c=d;while((y=p<<1|v)===(m=(g>=d)<<1|f>=h));return i[m]=a,i[y]=s,r}function c9(r){var e,t,n=r.length,i,a,s=new Array(n),o=new Array(n),l=1/0,u=1/0,c=-1/0,h=-1/0;for(t=0;t<n;++t)isNaN(i=+this._x.call(null,e=r[t]))||isNaN(a=+this._y.call(null,e))||(s[t]=i,o[t]=a,i<l&&(l=i),i>c&&(c=i),a<u&&(u=a),a>h&&(h=a));if(l>c||u>h)return this;for(this.cover(l,u).cover(c,h),t=0;t<n;++t)cC(this,s[t],o[t],r[t]);return this}function h9(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var t=this._x0,n=this._y0,i=this._x1,a=this._y1;if(isNaN(t))i=(t=Math.floor(r))+1,a=(n=Math.floor(e))+1;else{for(var s=i-t||1,o=this._root,l,u;t>r||r>=i||n>e||e>=a;)switch(u=(e<n)<<1|r<t,l=new Array(4),l[u]=o,o=l,s*=2,u){case 0:i=t+s,a=n+s;break;case 1:t=i-s,a=n+s;break;case 2:i=t+s,n=a-s;break;case 3:t=i-s,n=a-s;break}this._root&&this._root.length&&(this._root=o)}return this._x0=t,this._y0=n,this._x1=i,this._y1=a,this}function d9(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function f9(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function zn(r,e,t,n,i){this.node=r,this.x0=e,this.y0=t,this.x1=n,this.y1=i}function g9(r,e,t){var n,i=this._x0,a=this._y0,s,o,l,u,c=this._x1,h=this._y1,d=[],f=this._root,g,v;for(f&&d.push(new zn(f,i,a,c,h)),t==null?t=1/0:(i=r-t,a=e-t,c=r+t,h=e+t,t*=t);g=d.pop();)if(!(!(f=g.node)||(s=g.x0)>c||(o=g.y0)>h||(l=g.x1)<i||(u=g.y1)<a))if(f.length){var p=(s+l)/2,y=(o+u)/2;d.push(new zn(f[3],p,y,l,u),new zn(f[2],s,y,p,u),new zn(f[1],p,o,l,y),new zn(f[0],s,o,p,y)),(v=(e>=y)<<1|r>=p)&&(g=d[d.length-1],d[d.length-1]=d[d.length-1-v],d[d.length-1-v]=g)}else{var m=r-+this._x.call(null,f.data),w=e-+this._y.call(null,f.data),S=m*m+w*w;if(S<t){var _=Math.sqrt(t=S);i=r-_,a=e-_,c=r+_,h=e+_,n=f.data}}return n}function p9(r){if(isNaN(c=+this._x.call(null,r))||isNaN(h=+this._y.call(null,r)))return this;var e,t=this._root,n,i,a,s=this._x0,o=this._y0,l=this._x1,u=this._y1,c,h,d,f,g,v,p,y;if(!t)return this;if(t.length)for(;;){if((g=c>=(d=(s+l)/2))?s=d:l=d,(v=h>=(f=(o+u)/2))?o=f:u=f,e=t,!(t=t[p=v<<1|g]))return this;if(!t.length)break;(e[p+1&3]||e[p+2&3]||e[p+3&3])&&(n=e,y=p)}for(;t.data!==r;)if(i=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,i?(a?i.next=a:delete i.next,this):e?(a?e[p]=a:delete e[p],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[y]=t:this._root=t),this):(this._root=a,this)}function v9(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this}function y9(){return this._root}function m9(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function b9(r){var e=[],t,n=this._root,i,a,s,o,l;for(n&&e.push(new zn(n,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!r(n=t.node,a=t.x0,s=t.y0,o=t.x1,l=t.y1)&&n.length){var u=(a+o)/2,c=(s+l)/2;(i=n[3])&&e.push(new zn(i,u,c,o,l)),(i=n[2])&&e.push(new zn(i,a,c,u,l)),(i=n[1])&&e.push(new zn(i,u,s,o,c)),(i=n[0])&&e.push(new zn(i,a,s,u,c))}return this}function w9(r){var e=[],t=[],n;for(this._root&&e.push(new zn(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var a,s=n.x0,o=n.y0,l=n.x1,u=n.y1,c=(s+l)/2,h=(o+u)/2;(a=i[0])&&e.push(new zn(a,s,o,c,h)),(a=i[1])&&e.push(new zn(a,c,o,l,h)),(a=i[2])&&e.push(new zn(a,s,h,c,u)),(a=i[3])&&e.push(new zn(a,c,h,l,u))}t.push(n)}for(;n=t.pop();)r(n.node,n.x0,n.y0,n.x1,n.y1);return this}function x9(r){return r[0]}function E9(r){return arguments.length?(this._x=r,this):this._x}function S9(r){return r[1]}function _9(r){return arguments.length?(this._y=r,this):this._y}function lh(r,e,t){var n=new ib(e??x9,t??S9,NaN,NaN,NaN,NaN);return r==null?n:n.addAll(r)}function ib(r,e,t,n,i,a){this._x=r,this._y=e,this._x0=t,this._y0=n,this._x1=i,this._y1=a,this._root=void 0}function iE(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var Gn=lh.prototype=ib.prototype;Gn.copy=function(){var r=new ib(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,n;if(!e)return r;if(!e.length)return r._root=iE(e),r;for(t=[{source:e,target:r._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(n=e.source[i])&&(n.length?t.push({source:n,target:e.target[i]=new Array(4)}):e.target[i]=iE(n));return r};Gn.add=u9;Gn.addAll=c9;Gn.cover=h9;Gn.data=d9;Gn.extent=f9;Gn.find=g9;Gn.remove=p9;Gn.removeAll=v9;Gn.root=y9;Gn.size=m9;Gn.visit=b9;Gn.visitAfter=w9;Gn.x=E9;Gn.y=_9;function M9(r){const e=+this._x.call(null,r),t=+this._y.call(null,r),n=+this._z.call(null,r);return hC(this.cover(e,t,n),e,t,n,r)}function hC(r,e,t,n,i){if(isNaN(e)||isNaN(t)||isNaN(n))return r;var a,s=r._root,o={data:i},l=r._x0,u=r._y0,c=r._z0,h=r._x1,d=r._y1,f=r._z1,g,v,p,y,m,w,S,_,O,T,k;if(!s)return r._root=o,r;for(;s.length;)if((S=e>=(g=(l+h)/2))?l=g:h=g,(_=t>=(v=(u+d)/2))?u=v:d=v,(O=n>=(p=(c+f)/2))?c=p:f=p,a=s,!(s=s[T=O<<2|_<<1|S]))return a[T]=o,r;if(y=+r._x.call(null,s.data),m=+r._y.call(null,s.data),w=+r._z.call(null,s.data),e===y&&t===m&&n===w)return o.next=s,a?a[T]=o:r._root=o,r;do a=a?a[T]=new Array(8):r._root=new Array(8),(S=e>=(g=(l+h)/2))?l=g:h=g,(_=t>=(v=(u+d)/2))?u=v:d=v,(O=n>=(p=(c+f)/2))?c=p:f=p;while((T=O<<2|_<<1|S)===(k=(w>=p)<<2|(m>=v)<<1|y>=g));return a[k]=s,a[T]=o,r}function O9(r){Array.isArray(r)||(r=Array.from(r));const e=r.length,t=new Float64Array(e),n=new Float64Array(e),i=new Float64Array(e);let a=1/0,s=1/0,o=1/0,l=-1/0,u=-1/0,c=-1/0;for(let h=0,d,f,g,v;h<e;++h)isNaN(f=+this._x.call(null,d=r[h]))||isNaN(g=+this._y.call(null,d))||isNaN(v=+this._z.call(null,d))||(t[h]=f,n[h]=g,i[h]=v,f<a&&(a=f),f>l&&(l=f),g<s&&(s=g),g>u&&(u=g),v<o&&(o=v),v>c&&(c=v));if(a>l||s>u||o>c)return this;this.cover(a,s,o).cover(l,u,c);for(let h=0;h<e;++h)hC(this,t[h],n[h],i[h],r[h]);return this}function k9(r,e,t){if(isNaN(r=+r)||isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,a=this._z0,s=this._x1,o=this._y1,l=this._z1;if(isNaN(n))s=(n=Math.floor(r))+1,o=(i=Math.floor(e))+1,l=(a=Math.floor(t))+1;else{for(var u=s-n||1,c=this._root,h,d;n>r||r>=s||i>e||e>=o||a>t||t>=l;)switch(d=(t<a)<<2|(e<i)<<1|r<n,h=new Array(8),h[d]=c,c=h,u*=2,d){case 0:s=n+u,o=i+u,l=a+u;break;case 1:n=s-u,o=i+u,l=a+u;break;case 2:s=n+u,i=o-u,l=a+u;break;case 3:n=s-u,i=o-u,l=a+u;break;case 4:s=n+u,o=i+u,a=l-u;break;case 5:n=s-u,o=i+u,a=l-u;break;case 6:s=n+u,i=o-u,a=l-u;break;case 7:n=s-u,i=o-u,a=l-u;break}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=l,this}function T9(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function A9(r){return arguments.length?this.cover(+r[0][0],+r[0][1],+r[0][2]).cover(+r[1][0],+r[1][1],+r[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function vt(r,e,t,n,i,a,s){this.node=r,this.x0=e,this.y0=t,this.z0=n,this.x1=i,this.y1=a,this.z1=s}function P9(r,e,t,n){var i,a=this._x0,s=this._y0,o=this._z0,l,u,c,h,d,f,g=this._x1,v=this._y1,p=this._z1,y=[],m=this._root,w,S;for(m&&y.push(new vt(m,a,s,o,g,v,p)),n==null?n=1/0:(a=r-n,s=e-n,o=t-n,g=r+n,v=e+n,p=t+n,n*=n);w=y.pop();)if(!(!(m=w.node)||(l=w.x0)>g||(u=w.y0)>v||(c=w.z0)>p||(h=w.x1)<a||(d=w.y1)<s||(f=w.z1)<o))if(m.length){var _=(l+h)/2,O=(u+d)/2,T=(c+f)/2;y.push(new vt(m[7],_,O,T,h,d,f),new vt(m[6],l,O,T,_,d,f),new vt(m[5],_,u,T,h,O,f),new vt(m[4],l,u,T,_,O,f),new vt(m[3],_,O,c,h,d,T),new vt(m[2],l,O,c,_,d,T),new vt(m[1],_,u,c,h,O,T),new vt(m[0],l,u,c,_,O,T)),(S=(t>=T)<<2|(e>=O)<<1|r>=_)&&(w=y[y.length-1],y[y.length-1]=y[y.length-1-S],y[y.length-1-S]=w)}else{var k=r-+this._x.call(null,m.data),P=e-+this._y.call(null,m.data),C=t-+this._z.call(null,m.data),N=k*k+P*P+C*C;if(N<n){var L=Math.sqrt(n=N);a=r-L,s=e-L,o=t-L,g=r+L,v=e+L,p=t+L,i=m.data}}return i}const C9=(r,e,t,n,i,a)=>Math.sqrt((r-n)**2+(e-i)**2+(t-a)**2);function N9(r,e,t,n){const i=[],a=r-n,s=e-n,o=t-n,l=r+n,u=e+n,c=t+n;return this.visit((h,d,f,g,v,p,y)=>{if(!h.length)do{const m=h.data;C9(r,e,t,this._x(m),this._y(m),this._z(m))<=n&&i.push(m)}while(h=h.next);return d>l||f>u||g>c||v<a||p<s||y<o}),i}function R9(r){if(isNaN(d=+this._x.call(null,r))||isNaN(f=+this._y.call(null,r))||isNaN(g=+this._z.call(null,r)))return this;var e,t=this._root,n,i,a,s=this._x0,o=this._y0,l=this._z0,u=this._x1,c=this._y1,h=this._z1,d,f,g,v,p,y,m,w,S,_,O;if(!t)return this;if(t.length)for(;;){if((m=d>=(v=(s+u)/2))?s=v:u=v,(w=f>=(p=(o+c)/2))?o=p:c=p,(S=g>=(y=(l+h)/2))?l=y:h=y,e=t,!(t=t[_=S<<2|w<<1|m]))return this;if(!t.length)break;(e[_+1&7]||e[_+2&7]||e[_+3&7]||e[_+4&7]||e[_+5&7]||e[_+6&7]||e[_+7&7])&&(n=e,O=_)}for(;t.data!==r;)if(i=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,i?(a?i.next=a:delete i.next,this):e?(a?e[_]=a:delete e[_],(t=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&t===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[O]=t:this._root=t),this):(this._root=a,this)}function L9(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this}function I9(){return this._root}function D9(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function F9(r){var e=[],t,n=this._root,i,a,s,o,l,u,c;for(n&&e.push(new vt(n,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=e.pop();)if(!r(n=t.node,a=t.x0,s=t.y0,o=t.z0,l=t.x1,u=t.y1,c=t.z1)&&n.length){var h=(a+l)/2,d=(s+u)/2,f=(o+c)/2;(i=n[7])&&e.push(new vt(i,h,d,f,l,u,c)),(i=n[6])&&e.push(new vt(i,a,d,f,h,u,c)),(i=n[5])&&e.push(new vt(i,h,s,f,l,d,c)),(i=n[4])&&e.push(new vt(i,a,s,f,h,d,c)),(i=n[3])&&e.push(new vt(i,h,d,o,l,u,f)),(i=n[2])&&e.push(new vt(i,a,d,o,h,u,f)),(i=n[1])&&e.push(new vt(i,h,s,o,l,d,f)),(i=n[0])&&e.push(new vt(i,a,s,o,h,d,f))}return this}function B9(r){var e=[],t=[],n;for(this._root&&e.push(new vt(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();){var i=n.node;if(i.length){var a,s=n.x0,o=n.y0,l=n.z0,u=n.x1,c=n.y1,h=n.z1,d=(s+u)/2,f=(o+c)/2,g=(l+h)/2;(a=i[0])&&e.push(new vt(a,s,o,l,d,f,g)),(a=i[1])&&e.push(new vt(a,d,o,l,u,f,g)),(a=i[2])&&e.push(new vt(a,s,f,l,d,c,g)),(a=i[3])&&e.push(new vt(a,d,f,l,u,c,g)),(a=i[4])&&e.push(new vt(a,s,o,g,d,f,h)),(a=i[5])&&e.push(new vt(a,d,o,g,u,f,h)),(a=i[6])&&e.push(new vt(a,s,f,g,d,c,h)),(a=i[7])&&e.push(new vt(a,d,f,g,u,c,h))}t.push(n)}for(;n=t.pop();)r(n.node,n.x0,n.y0,n.z0,n.x1,n.y1,n.z1);return this}function z9(r){return r[0]}function j9(r){return arguments.length?(this._x=r,this):this._x}function q9(r){return r[1]}function $9(r){return arguments.length?(this._y=r,this):this._y}function G9(r){return r[2]}function W9(r){return arguments.length?(this._z=r,this):this._z}function dC(r,e,t,n){var i=new ab(e??z9,t??q9,n??G9,NaN,NaN,NaN,NaN,NaN,NaN);return r==null?i:i.addAll(r)}function ab(r,e,t,n,i,a,s,o,l){this._x=r,this._y=e,this._z=t,this._x0=n,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=l,this._root=void 0}function aE(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var kn=dC.prototype=ab.prototype;kn.copy=function(){var r=new ab(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,t,n;if(!e)return r;if(!e.length)return r._root=aE(e),r;for(t=[{source:e,target:r._root=new Array(8)}];e=t.pop();)for(var i=0;i<8;++i)(n=e.source[i])&&(n.length?t.push({source:n,target:e.target[i]=new Array(8)}):e.target[i]=aE(n));return r};kn.add=M9;kn.addAll=O9;kn.cover=k9;kn.data=T9;kn.extent=A9;kn.find=P9;kn.findAllWithinRadius=N9;kn.remove=R9;kn.removeAll=L9;kn.root=I9;kn.size=D9;kn.visit=F9;kn.visitAfter=B9;kn.x=j9;kn.y=$9;kn.z=W9;const V9=.81,gf=.1;function U9(r,e,t,n,i=2){const a=e/t,s=r.getAllNodes(),o=s.map((c,h)=>{const{nodeStrength:d,x:f,y:g,z:v,size:p}=c.data;return{x:f,y:g,z:v,size:p,index:h,id:c.id,vx:0,vy:0,vz:0,weight:a*d}}),l=(i===2?lh(o,c=>c.x,c=>c.y):dC(o,c=>c.x,c=>c.y,c=>c.z)).visitAfter(H9),u=new Map;return o.forEach(c=>{u.set(c.id,c),X9(c,l,i)}),o.map((c,h)=>{const{id:d,data:f}=s[h],{mass:g=1}=f;n[d]={x:c.vx/g,y:c.vy/g,z:c.vz/g}}),n}function H9(r){let e=0,t=0,n=0,i=0,a=0;const s=r.length;if(s){for(let o=0;o<s;o++){const l=r[o];l&&l.weight&&(e+=l.weight,t+=l.x*l.weight,n+=l.y*l.weight,i+=l.z*l.weight,a+=l.size*l.weight)}r.x=t/e,r.y=n/e,r.z=i/e,r.size=a/e,r.weight=e}else{const o=r;r.x=o.data.x,r.y=o.data.y,r.z=o.data.z,r.size=o.data.size,r.weight=o.data.weight}}const Y9=(r,e,t,n,i,a,s)=>{var o;if(((o=r.data)===null||o===void 0?void 0:o.id)===a.id)return;const l=[t,n,i][s-1],u=a.x-r.x||gf,c=a.y-r.y||gf,h=a.z-r.z||gf,d=[u,c,h],f=l-e;let g=0;for(let y=0;y<s;y++)g+=d[y]*d[y];const p=Math.sqrt(g)*g;if(f*f*V9<g){const y=r.weight/p;return a.vx+=u*y,a.vy+=c*y,a.vz+=h*y,!0}if(r.length)return!1;if(r.data!==a){const y=r.data.weight/p;a.vx+=u*y,a.vy+=c*y,a.vz+=h*y}};function X9(r,e,t){e.visit((n,i,a,s,o)=>Y9(n,i,a,s,o,r,t))}const K9={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"};class fC{constructor(e={}){this.options=e,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=Object.assign(Object.assign({},K9),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericForceLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericForceLayout(!0,e,t)})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1}tick(e=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let n=0;(this.judgingDistance>this.lastOptions.minMovement||n<1)&&n<e;n++)this.runOneStep(this.lastCalcGraph,this.lastGraph,n,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);const t={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&t.nodes.forEach(n=>this.lastGraph.mergeNodeData(n.id,{x:n.data.x,y:n.data.y,z:this.options.dimensions===3?n.data.z:void 0})),t}genericForceLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),a=t.getAllNodes(),s=t.getAllEdges(),o=this.formatOptions(i,t),{dimensions:l,width:u,height:c,nodeSize:h,getMass:d,nodeStrength:f,edgeStrength:g,linkDistance:v}=o,p=a.map((k,P)=>Object.assign(Object.assign({},k),{data:Object.assign(Object.assign({},k.data),{x:_e(k.data.x)?k.data.x:Math.random()*u,y:_e(k.data.y)?k.data.y:Math.random()*c,z:_e(k.data.z)?k.data.z:Math.random()*Math.sqrt(u*c),size:h(k)||30,mass:d(k),nodeStrength:f(k)})})),y=s.map(k=>Object.assign(Object.assign({},k),{data:Object.assign(Object.assign({},k.data),{edgeStrength:g(k),linkDistance:v(k,t.getNode(k.source),t.getNode(k.target))})}));if(!(a!=null&&a.length))return this.lastResult={nodes:[],edges:s},{nodes:[],edges:s};const m={};a.forEach((k,P)=>{m[k.id]={x:0,y:0,z:0}});const w=new dn({nodes:p,edges:y});this.formatCentripetal(o,w);const{maxIteration:S,minMovement:_,onTick:O}=o;if(this.lastLayoutNodes=p,this.lastLayoutEdges=y,this.lastAssign=e,this.lastGraph=t,this.lastCalcGraph=w,this.lastOptions=o,this.lastVelMap=m,typeof window>"u")return;let T=0;return new Promise(k=>{this.timeInterval=window.setInterval(()=>{(!a||!this.running)&&k({nodes:pf(t,p),edges:s}),this.runOneStep(w,t,T,m,o),this.updatePosition(t,w,m,o),e&&p.forEach(P=>t.mergeNodeData(P.id,{x:P.data.x,y:P.data.y,z:l===3?P.data.z:void 0})),O==null||O({nodes:pf(t,p),edges:s}),T++,(T>=S||this.judgingDistance<_)&&(window.clearInterval(this.timeInterval),k({nodes:pf(t,p),edges:s}))},0),this.running=!0})})}formatOptions(e,t){const n=Object.assign({},e),{width:i,height:a,getMass:s}=e;n.width=!i&&typeof window<"u"?window.innerWidth:i,n.height=!a&&typeof window<"u"?window.innerHeight:a,e.center||(n.center=[n.width/2,n.height/2]),s||(n.getMass=l=>{let u=1;_e(l==null?void 0:l.data.mass)&&(u=l==null?void 0:l.data.mass);const c=t.getDegree(l.id,"both");return!c||c<5?u:c*5*u}),n.nodeSize=rb(e.nodeSize,e.nodeSpacing);const o=e.linkDistance?ja(1,e.linkDistance):l=>1+n.nodeSize(t.getNode(l.source))+n.nodeSize(t.getNode(l.target));return n.linkDistance=o,n.nodeStrength=ja(1,e.nodeStrength),n.edgeStrength=ja(1,e.edgeStrength),n}formatCentripetal(e,t){const{dimensions:n,centripetalOptions:i,center:a,clusterNodeStrength:s,leafCluster:o,clustering:l,nodeClusterBy:u}=e,c=t.getAllNodes(),h=i||{leaf:2,single:2,others:1,center:y=>({x:a[0],y:a[1],z:n===3?a[2]:void 0})};typeof s!="function"&&(e.clusterNodeStrength=y=>s);let d,f;if(o&&u&&(d=sE(t,u),f=Array.from(new Set(c==null?void 0:c.map(y=>y.data[u])))||[],e.centripetalOptions=Object.assign(h,{single:100,leaf:y=>{const{siblingLeaves:m,sameTypeLeaves:w}=d[y.id]||{};return(w==null?void 0:w.length)===(m==null?void 0:m.length)||(f==null?void 0:f.length)===1?1:e.clusterNodeStrength(y)},others:1,center:y=>{const m=t.getDegree(y.id,"both");if(!m)return{x:100,y:100,z:0};let w;if(m===1){const{sameTypeLeaves:S=[]}=d[y.id]||{};S.length===1?w=void 0:S.length>1&&(w=oE(S))}else w=void 0;return{x:w==null?void 0:w.x,y:w==null?void 0:w.y,z:w==null?void 0:w.z}}})),l&&u){d||(d=sE(t,u)),f||(f=Array.from(new Set(c.map(m=>m.data[u])))),f=f.filter(m=>m!==void 0);const y={};f.forEach(m=>{const w=c.filter(S=>S.data[u]===m).map(S=>t.getNode(S.id));y[m]=oE(w)}),e.centripetalOptions=Object.assign(h,{single:m=>e.clusterNodeStrength(m),leaf:m=>e.clusterNodeStrength(m),others:m=>e.clusterNodeStrength(m),center:m=>{const w=y[m.data[u]];return{x:w==null?void 0:w.x,y:w==null?void 0:w.y,z:w==null?void 0:w.z}}})}const{leaf:g,single:v,others:p}=e.centripetalOptions||{};g&&typeof g!="function"&&(e.centripetalOptions.leaf=()=>g),v&&typeof v!="function"&&(e.centripetalOptions.single=()=>v),p&&typeof p!="function"&&(e.centripetalOptions.others=()=>p)}runOneStep(e,t,n,i,a){const s={},o=e.getAllNodes(),l=e.getAllEdges();if(!(o!=null&&o.length))return;const{monitor:u}=a;if(this.calRepulsive(e,s,a),l&&this.calAttractive(e,s,a),this.calGravity(e,t,s,a),this.updateVelocity(e,s,i,a),u){const c=this.calTotalEnergy(s,o);u({energy:c,nodes:t.getAllNodes(),edges:t.getAllEdges(),iterations:n})}}calTotalEnergy(e,t){if(!(t!=null&&t.length))return 0;let n=0;return t.forEach((i,a)=>{const s=e[i.id].x,o=e[i.id].y,l=this.options.dimensions===3?e[i.id].z:0,u=s*s+o*o+l*l,{mass:c=1}=i.data;n+=c*u*.5}),n}calRepulsive(e,t,n){const{dimensions:i,factor:a,coulombDisScale:s}=n;U9(e,a,s*s,t,i)}calAttractive(e,t,n){const{dimensions:i,nodeSize:a}=n;e.getAllEdges().forEach((s,o)=>{const{source:l,target:u}=s,c=e.getNode(l),h=e.getNode(u);if(!c||!h)return;let d=h.data.x-c.data.x,f=h.data.y-c.data.y,g=i===3?h.data.z-c.data.z:0;!d&&!f&&(d=Math.random()*.01,f=Math.random()*.01,i===3&&!g&&(g=Math.random()*.01));const v=Math.sqrt(d*d+f*f+g*g);if(v<a(c)+a(h))return;const p=d/v,y=f/v,m=g/v,{linkDistance:w=200,edgeStrength:S=200}=s.data||{},O=(w-v)*S,T=c.data.mass||1,k=h.data.mass||1,P=1/T,C=1/k,N=p*O,L=y*O,F=m*O;t[l].x-=N*P,t[l].y-=L*P,t[l].z-=F*P,t[u].x+=N*C,t[u].y+=L*C,t[u].z+=F*C})}calGravity(e,t,n,i){const{getCenter:a}=i,s=e.getAllNodes(),o=t.getAllNodes(),l=t.getAllEdges(),{width:u,height:c,center:h,gravity:d,centripetalOptions:f}=i;s&&s.forEach(g=>{const{id:v,data:p}=g,{mass:y,x:m,y:w,z:S}=p,_=t.getNode(v);let O=0,T=0,k=0,P=d;const C=e.getDegree(v,"in"),N=e.getDegree(v,"out"),L=e.getDegree(v,"both"),F=a==null?void 0:a(_,L);if(F){const[G,V,U]=F;O=m-G,T=w-V,P=U}else O=m-h[0],T=w-h[1],k=S-h[2];if(P&&(n[v].x-=P*O/y,n[v].y-=P*T/y,n[v].z-=P*k/y),f){const{leaf:G,single:V,others:U,center:$}=f,{x:j,y:Z,z:ne,centerStrength:oe}=($==null?void 0:$(_,o,l,u,c))||{x:0,y:0,z:0,centerStrength:0};if(!_e(j)||!_e(Z))return;const le=(m-j)/y,Ce=(w-Z)/y,K=(S-ne)/y;if(oe&&(n[v].x-=oe*le,n[v].y-=oe*Ce,n[v].z-=oe*K),L===0){const ee=V(_);if(!ee)return;n[v].x-=ee*le,n[v].y-=ee*Ce,n[v].z-=ee*K;return}if(C===0||N===0){const ee=G(_,o,l);if(!ee)return;n[v].x-=ee*le,n[v].y-=ee*Ce,n[v].z-=ee*K;return}const W=U(_);if(!W)return;n[v].x-=W*le,n[v].y-=W*Ce,n[v].z-=W*K}})}updateVelocity(e,t,n,i){const{damping:a,maxSpeed:s,interval:o,dimensions:l}=i,u=e.getAllNodes();u!=null&&u.length&&u.forEach(c=>{const{id:h}=c;let d=(n[h].x+t[h].x*o)*a||.01,f=(n[h].y+t[h].y*o)*a||.01,g=l===3?(n[h].z+t[h].z*o)*a||.01:0;const v=Math.sqrt(d*d+f*f+g*g);if(v>s){const p=s/v;d=p*d,f=p*f,g=p*g}n[h]={x:d,y:f,z:g}})}updatePosition(e,t,n,i){const{distanceThresholdMode:a,interval:s,dimensions:o}=i,l=t.getAllNodes();if(!(l!=null&&l.length)){this.judgingDistance=0;return}let u=0;a==="max"?this.judgingDistance=-1/0:a==="min"&&(this.judgingDistance=1/0),l.forEach(c=>{const{id:h}=c,d=e.getNode(h);if(_e(d.data.fx)&&_e(d.data.fy)){t.mergeNodeData(h,{x:d.data.fx,y:d.data.fy,z:o===3?d.data.fz:void 0});return}const f=n[h].x*s,g=n[h].y*s,v=o===3?n[h].z*s:0;t.mergeNodeData(h,{x:c.data.x+f,y:c.data.y+g,z:c.data.z+v});const p=Math.sqrt(f*f+g*g+v*v);switch(a){case"max":this.judgingDistance<p&&(this.judgingDistance=p);break;case"min":this.judgingDistance>p&&(this.judgingDistance=p);break;default:u=u+p;break}}),(!a||a==="mean")&&(this.judgingDistance=u/l.length)}}const sE=(r,e)=>{const t=r.getAllNodes();if(!(t!=null&&t.length))return{};const n={};return t.forEach((i,a)=>{r.getDegree(i.id,"both")===1&&(n[i.id]=Z9(r,"leaf",i,e))}),n},Z9=(r,e,t,n)=>{const i=r.getDegree(t.id,"in"),a=r.getDegree(t.id,"out");let s=t,o=[];i===0?(s=r.getSuccessors(t.id)[0],o=r.getNeighbors(s.id)):a===0&&(s=r.getPredecessors(t.id)[0],o=r.getNeighbors(s.id)),o=o.filter(u=>r.getDegree(u.id,"in")===0||r.getDegree(u.id,"out")===0);const l=J9(r,e,n,t,o);return{coreNode:s,siblingLeaves:o,sameTypeLeaves:l}},J9=(r,e,t,n,i)=>{const a=n.data[t]||"";let s=(i==null?void 0:i.filter(o=>o.data[t]===a))||[];return s=s.filter(o=>r.getDegree(o.id,"in")===0||r.getDegree(o.id,"out")===0),s},oE=r=>{const e={x:0,y:0};r.forEach(n=>{const{x:i,y:a}=n.data;e.x+=i||0,e.y+=a||0});const t=r.length||1;return{x:e.x/t,y:e.y/t}},pf=(r,e)=>e.map(t=>{const{id:n,data:i}=t,a=r.getNode(n);return Object.assign(Object.assign({},a),{data:Object.assign(Object.assign({},a.data),{x:i.x,y:i.y,z:i.z})})});var Je={};const Q9=Object.prototype.toString;function Xo(r){const e=Q9.call(r);return e.endsWith("Array]")&&!e.includes("Big")}const eq=Object.freeze(Object.defineProperty({__proto__:null,isAnyArray:Xo},Symbol.toStringTag,{value:"Module"})),tq=bT(eq);function nq(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Xo(r))throw new TypeError("input must be an array");if(r.length===0)throw new TypeError("input must not be empty");var t=e.fromIndex,n=t===void 0?0:t,i=e.toIndex,a=i===void 0?r.length:i;if(n<0||n>=r.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=n||a>r.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=r[n],o=n+1;o<a;o++)r[o]>s&&(s=r[o]);return s}function rq(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Xo(r))throw new TypeError("input must be an array");if(r.length===0)throw new TypeError("input must not be empty");var t=e.fromIndex,n=t===void 0?0:t,i=e.toIndex,a=i===void 0?r.length:i;if(n<0||n>=r.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=n||a>r.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=r[n],o=n+1;o<a;o++)r[o]<s&&(s=r[o]);return s}function iq(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Xo(r)){if(r.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var t;if(e.output!==void 0){if(!Xo(e.output))throw new TypeError("output option must be an array if specified");t=e.output}else t=new Array(r.length);var n=rq(r),i=nq(r);if(n===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var a=e.min,s=a===void 0?e.autoMinMax?n:0:a,o=e.max,l=o===void 0?e.autoMinMax?i:1:o;if(s>=l)throw new RangeError("min option must be smaller than max option");for(var u=(l-s)/(i-n),c=0;c<r.length;c++)t[c]=(r[c]-n)*u+s;return t}const aq=Object.freeze(Object.defineProperty({__proto__:null,default:iq},Symbol.toStringTag,{value:"Module"})),sq=bT(aq);var lE;function oq(){var ro,Xm,An;if(lE)return Je;lE=1,Object.defineProperty(Je,"__esModule",{value:!0});var r=tq,e=sq;const t=" ".repeat(2),n=" ".repeat(4);function i(){return a(this)}function a(R,M={}){const{maxRows:x=15,maxColumns:b=10,maxNumSize:E=8,padMinus:A="auto"}=M;return`${R.constructor.name} {
${t}[
${n}${s(R,x,b,E,A)}
${t}]
${t}rows: ${R.rows}
${t}columns: ${R.columns}
}`}function s(R,M,x,b,E){const{rows:A,columns:I}=R,D=Math.min(A,M),B=Math.min(I,x),z=[];if(E==="auto"){E=!1;e:for(let Q=0;Q<D;Q++)for(let H=0;H<B;H++)if(R.get(Q,H)<0){E=!0;break e}}for(let Q=0;Q<D;Q++){let H=[];for(let se=0;se<B;se++)H.push(o(R.get(Q,se),b,E));z.push(`${H.join(" ")}`)}return B!==I&&(z[z.length-1]+=` ... ${I-x} more columns`),D!==A&&z.push(`... ${A-M} more rows`),z.join(`
${n}`)}function o(R,M,x){return(R>=0&&x?` ${l(R,M-1)}`:l(R,M)).padEnd(M)}function l(R,M){let x=R.toString();if(x.length<=M)return x;let b=R.toFixed(M);if(b.length>M&&(b=R.toFixed(Math.max(0,M-(b.length-M)))),b.length<=M&&!b.startsWith("0.000")&&!b.startsWith("-0.000"))return b;let E=R.toExponential(M);return E.length>M&&(E=R.toExponential(Math.max(0,M-(E.length-M)))),E.slice(0)}function u(R,M){R.prototype.add=function(b){return typeof b=="number"?this.addS(b):this.addM(b)},R.prototype.addS=function(b){for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)+b);return this},R.prototype.addM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)+b.get(E,A));return this},R.add=function(b,E){return new M(b).add(E)},R.prototype.sub=function(b){return typeof b=="number"?this.subS(b):this.subM(b)},R.prototype.subS=function(b){for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)-b);return this},R.prototype.subM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)-b.get(E,A));return this},R.sub=function(b,E){return new M(b).sub(E)},R.prototype.subtract=R.prototype.sub,R.prototype.subtractS=R.prototype.subS,R.prototype.subtractM=R.prototype.subM,R.subtract=R.sub,R.prototype.mul=function(b){return typeof b=="number"?this.mulS(b):this.mulM(b)},R.prototype.mulS=function(b){for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)*b);return this},R.prototype.mulM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)*b.get(E,A));return this},R.mul=function(b,E){return new M(b).mul(E)},R.prototype.multiply=R.prototype.mul,R.prototype.multiplyS=R.prototype.mulS,R.prototype.multiplyM=R.prototype.mulM,R.multiply=R.mul,R.prototype.div=function(b){return typeof b=="number"?this.divS(b):this.divM(b)},R.prototype.divS=function(b){for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)/b);return this},R.prototype.divM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)/b.get(E,A));return this},R.div=function(b,E){return new M(b).div(E)},R.prototype.divide=R.prototype.div,R.prototype.divideS=R.prototype.divS,R.prototype.divideM=R.prototype.divM,R.divide=R.div,R.prototype.mod=function(b){return typeof b=="number"?this.modS(b):this.modM(b)},R.prototype.modS=function(b){for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)%b);return this},R.prototype.modM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)%b.get(E,A));return this},R.mod=function(b,E){return new M(b).mod(E)},R.prototype.modulus=R.prototype.mod,R.prototype.modulusS=R.prototype.modS,R.prototype.modulusM=R.prototype.modM,R.modulus=R.mod,R.prototype.and=function(b){return typeof b=="number"?this.andS(b):this.andM(b)},R.prototype.andS=function(b){for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)&b);return this},R.prototype.andM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)&b.get(E,A));return this},R.and=function(b,E){return new M(b).and(E)},R.prototype.or=function(b){return typeof b=="number"?this.orS(b):this.orM(b)},R.prototype.orS=function(b){for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)|b);return this},R.prototype.orM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)|b.get(E,A));return this},R.or=function(b,E){return new M(b).or(E)},R.prototype.xor=function(b){return typeof b=="number"?this.xorS(b):this.xorM(b)},R.prototype.xorS=function(b){for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)^b);return this},R.prototype.xorM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)^b.get(E,A));return this},R.xor=function(b,E){return new M(b).xor(E)},R.prototype.leftShift=function(b){return typeof b=="number"?this.leftShiftS(b):this.leftShiftM(b)},R.prototype.leftShiftS=function(b){for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)<<b);return this},R.prototype.leftShiftM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)<<b.get(E,A));return this},R.leftShift=function(b,E){return new M(b).leftShift(E)},R.prototype.signPropagatingRightShift=function(b){return typeof b=="number"?this.signPropagatingRightShiftS(b):this.signPropagatingRightShiftM(b)},R.prototype.signPropagatingRightShiftS=function(b){for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)>>b);return this},R.prototype.signPropagatingRightShiftM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)>>b.get(E,A));return this},R.signPropagatingRightShift=function(b,E){return new M(b).signPropagatingRightShift(E)},R.prototype.rightShift=function(b){return typeof b=="number"?this.rightShiftS(b):this.rightShiftM(b)},R.prototype.rightShiftS=function(b){for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)>>>b);return this},R.prototype.rightShiftM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)>>>b.get(E,A));return this},R.rightShift=function(b,E){return new M(b).rightShift(E)},R.prototype.zeroFillRightShift=R.prototype.rightShift,R.prototype.zeroFillRightShiftS=R.prototype.rightShiftS,R.prototype.zeroFillRightShiftM=R.prototype.rightShiftM,R.zeroFillRightShift=R.rightShift,R.prototype.not=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,~this.get(b,E));return this},R.not=function(b){return new M(b).not()},R.prototype.abs=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.abs(this.get(b,E)));return this},R.abs=function(b){return new M(b).abs()},R.prototype.acos=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.acos(this.get(b,E)));return this},R.acos=function(b){return new M(b).acos()},R.prototype.acosh=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.acosh(this.get(b,E)));return this},R.acosh=function(b){return new M(b).acosh()},R.prototype.asin=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.asin(this.get(b,E)));return this},R.asin=function(b){return new M(b).asin()},R.prototype.asinh=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.asinh(this.get(b,E)));return this},R.asinh=function(b){return new M(b).asinh()},R.prototype.atan=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.atan(this.get(b,E)));return this},R.atan=function(b){return new M(b).atan()},R.prototype.atanh=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.atanh(this.get(b,E)));return this},R.atanh=function(b){return new M(b).atanh()},R.prototype.cbrt=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.cbrt(this.get(b,E)));return this},R.cbrt=function(b){return new M(b).cbrt()},R.prototype.ceil=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.ceil(this.get(b,E)));return this},R.ceil=function(b){return new M(b).ceil()},R.prototype.clz32=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.clz32(this.get(b,E)));return this},R.clz32=function(b){return new M(b).clz32()},R.prototype.cos=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.cos(this.get(b,E)));return this},R.cos=function(b){return new M(b).cos()},R.prototype.cosh=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.cosh(this.get(b,E)));return this},R.cosh=function(b){return new M(b).cosh()},R.prototype.exp=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.exp(this.get(b,E)));return this},R.exp=function(b){return new M(b).exp()},R.prototype.expm1=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.expm1(this.get(b,E)));return this},R.expm1=function(b){return new M(b).expm1()},R.prototype.floor=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.floor(this.get(b,E)));return this},R.floor=function(b){return new M(b).floor()},R.prototype.fround=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.fround(this.get(b,E)));return this},R.fround=function(b){return new M(b).fround()},R.prototype.log=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.log(this.get(b,E)));return this},R.log=function(b){return new M(b).log()},R.prototype.log1p=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.log1p(this.get(b,E)));return this},R.log1p=function(b){return new M(b).log1p()},R.prototype.log10=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.log10(this.get(b,E)));return this},R.log10=function(b){return new M(b).log10()},R.prototype.log2=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.log2(this.get(b,E)));return this},R.log2=function(b){return new M(b).log2()},R.prototype.round=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.round(this.get(b,E)));return this},R.round=function(b){return new M(b).round()},R.prototype.sign=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.sign(this.get(b,E)));return this},R.sign=function(b){return new M(b).sign()},R.prototype.sin=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.sin(this.get(b,E)));return this},R.sin=function(b){return new M(b).sin()},R.prototype.sinh=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.sinh(this.get(b,E)));return this},R.sinh=function(b){return new M(b).sinh()},R.prototype.sqrt=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.sqrt(this.get(b,E)));return this},R.sqrt=function(b){return new M(b).sqrt()},R.prototype.tan=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.tan(this.get(b,E)));return this},R.tan=function(b){return new M(b).tan()},R.prototype.tanh=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.tanh(this.get(b,E)));return this},R.tanh=function(b){return new M(b).tanh()},R.prototype.trunc=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.trunc(this.get(b,E)));return this},R.trunc=function(b){return new M(b).trunc()},R.pow=function(b,E){return new M(b).pow(E)},R.prototype.pow=function(b){return typeof b=="number"?this.powS(b):this.powM(b)},R.prototype.powS=function(b){for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)**b);return this},R.prototype.powM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let A=0;A<this.columns;A++)this.set(E,A,this.get(E,A)**b.get(E,A));return this}}function c(R,M,x){let b=x?R.rows:R.rows-1;if(M<0||M>b)throw new RangeError("Row index out of range")}function h(R,M,x){let b=x?R.columns:R.columns-1;if(M<0||M>b)throw new RangeError("Column index out of range")}function d(R,M){if(M.to1DArray&&(M=M.to1DArray()),M.length!==R.columns)throw new RangeError("vector size must be the same as the number of columns");return M}function f(R,M){if(M.to1DArray&&(M=M.to1DArray()),M.length!==R.rows)throw new RangeError("vector size must be the same as the number of rows");return M}function g(R,M){if(!r.isAnyArray(M))throw new TypeError("row indices must be an array");for(let x=0;x<M.length;x++)if(M[x]<0||M[x]>=R.rows)throw new RangeError("row indices are out of range")}function v(R,M){if(!r.isAnyArray(M))throw new TypeError("column indices must be an array");for(let x=0;x<M.length;x++)if(M[x]<0||M[x]>=R.columns)throw new RangeError("column indices are out of range")}function p(R,M,x,b,E){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(m("startRow",M),m("endRow",x),m("startColumn",b),m("endColumn",E),M>x||b>E||M<0||M>=R.rows||x<0||x>=R.rows||b<0||b>=R.columns||E<0||E>=R.columns)throw new RangeError("Submatrix indices are out of range")}function y(R,M=0){let x=[];for(let b=0;b<R;b++)x.push(M);return x}function m(R,M){if(typeof M!="number")throw new TypeError(`${R} must be a number`)}function w(R){if(R.isEmpty())throw new Error("Empty matrix has no elements to index")}function S(R){let M=y(R.rows);for(let x=0;x<R.rows;++x)for(let b=0;b<R.columns;++b)M[x]+=R.get(x,b);return M}function _(R){let M=y(R.columns);for(let x=0;x<R.rows;++x)for(let b=0;b<R.columns;++b)M[b]+=R.get(x,b);return M}function O(R){let M=0;for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)M+=R.get(x,b);return M}function T(R){let M=y(R.rows,1);for(let x=0;x<R.rows;++x)for(let b=0;b<R.columns;++b)M[x]*=R.get(x,b);return M}function k(R){let M=y(R.columns,1);for(let x=0;x<R.rows;++x)for(let b=0;b<R.columns;++b)M[b]*=R.get(x,b);return M}function P(R){let M=1;for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)M*=R.get(x,b);return M}function C(R,M,x){const b=R.rows,E=R.columns,A=[];for(let I=0;I<b;I++){let D=0,B=0,z=0;for(let Q=0;Q<E;Q++)z=R.get(I,Q)-x[I],D+=z,B+=z*z;M?A.push((B-D*D/E)/(E-1)):A.push((B-D*D/E)/E)}return A}function N(R,M,x){const b=R.rows,E=R.columns,A=[];for(let I=0;I<E;I++){let D=0,B=0,z=0;for(let Q=0;Q<b;Q++)z=R.get(Q,I)-x[I],D+=z,B+=z*z;M?A.push((B-D*D/b)/(b-1)):A.push((B-D*D/b)/b)}return A}function L(R,M,x){const b=R.rows,E=R.columns,A=b*E;let I=0,D=0,B=0;for(let z=0;z<b;z++)for(let Q=0;Q<E;Q++)B=R.get(z,Q)-x,I+=B,D+=B*B;return M?(D-I*I/A)/(A-1):(D-I*I/A)/A}function F(R,M){for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)R.set(x,b,R.get(x,b)-M[x])}function G(R,M){for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)R.set(x,b,R.get(x,b)-M[b])}function V(R,M){for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)R.set(x,b,R.get(x,b)-M)}function U(R){const M=[];for(let x=0;x<R.rows;x++){let b=0;for(let E=0;E<R.columns;E++)b+=R.get(x,E)**2/(R.columns-1);M.push(Math.sqrt(b))}return M}function $(R,M){for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)R.set(x,b,R.get(x,b)/M[x])}function j(R){const M=[];for(let x=0;x<R.columns;x++){let b=0;for(let E=0;E<R.rows;E++)b+=R.get(E,x)**2/(R.rows-1);M.push(Math.sqrt(b))}return M}function Z(R,M){for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)R.set(x,b,R.get(x,b)/M[b])}function ne(R){const M=R.size-1;let x=0;for(let b=0;b<R.columns;b++)for(let E=0;E<R.rows;E++)x+=R.get(E,b)**2/M;return Math.sqrt(x)}function oe(R,M){for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)R.set(x,b,R.get(x,b)/M)}class le{static from1DArray(M,x,b){if(M*x!==b.length)throw new RangeError("data length does not match given dimensions");let A=new W(M,x);for(let I=0;I<M;I++)for(let D=0;D<x;D++)A.set(I,D,b[I*x+D]);return A}static rowVector(M){let x=new W(1,M.length);for(let b=0;b<M.length;b++)x.set(0,b,M[b]);return x}static columnVector(M){let x=new W(M.length,1);for(let b=0;b<M.length;b++)x.set(b,0,M[b]);return x}static zeros(M,x){return new W(M,x)}static ones(M,x){return new W(M,x).fill(1)}static rand(M,x,b={}){if(typeof b!="object")throw new TypeError("options must be an object");const{random:E=Math.random}=b;let A=new W(M,x);for(let I=0;I<M;I++)for(let D=0;D<x;D++)A.set(I,D,E());return A}static randInt(M,x,b={}){if(typeof b!="object")throw new TypeError("options must be an object");const{min:E=0,max:A=1e3,random:I=Math.random}=b;if(!Number.isInteger(E))throw new TypeError("min must be an integer");if(!Number.isInteger(A))throw new TypeError("max must be an integer");if(E>=A)throw new RangeError("min must be smaller than max");let D=A-E,B=new W(M,x);for(let z=0;z<M;z++)for(let Q=0;Q<x;Q++){let H=E+Math.round(I()*D);B.set(z,Q,H)}return B}static eye(M,x,b){x===void 0&&(x=M),b===void 0&&(b=1);let E=Math.min(M,x),A=this.zeros(M,x);for(let I=0;I<E;I++)A.set(I,I,b);return A}static diag(M,x,b){let E=M.length;x===void 0&&(x=E),b===void 0&&(b=x);let A=Math.min(E,x,b),I=this.zeros(x,b);for(let D=0;D<A;D++)I.set(D,D,M[D]);return I}static min(M,x){M=this.checkMatrix(M),x=this.checkMatrix(x);let b=M.rows,E=M.columns,A=new W(b,E);for(let I=0;I<b;I++)for(let D=0;D<E;D++)A.set(I,D,Math.min(M.get(I,D),x.get(I,D)));return A}static max(M,x){M=this.checkMatrix(M),x=this.checkMatrix(x);let b=M.rows,E=M.columns,A=new this(b,E);for(let I=0;I<b;I++)for(let D=0;D<E;D++)A.set(I,D,Math.max(M.get(I,D),x.get(I,D)));return A}static checkMatrix(M){return le.isMatrix(M)?M:new W(M)}static isMatrix(M){return M!=null&&M.klass==="Matrix"}get size(){return this.rows*this.columns}apply(M){if(typeof M!="function")throw new TypeError("callback must be a function");for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)M.call(this,x,b);return this}to1DArray(){let M=[];for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)M.push(this.get(x,b));return M}to2DArray(){let M=[];for(let x=0;x<this.rows;x++){M.push([]);for(let b=0;b<this.columns;b++)M[x].push(this.get(x,b))}return M}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let M=0;M<this.rows;M++)for(let x=0;x<=M;x++)if(this.get(M,x)!==this.get(x,M))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let M=0;M<this.rows;M++)if(this.get(M,M)!==0)return!1;return!0}isEchelonForm(){let M=0,x=0,b=-1,E=!0,A=!1;for(;M<this.rows&&E;){for(x=0,A=!1;x<this.columns&&A===!1;)this.get(M,x)===0?x++:this.get(M,x)===1&&x>b?(A=!0,b=x):(E=!1,A=!0);M++}return E}isReducedEchelonForm(){let M=0,x=0,b=-1,E=!0,A=!1;for(;M<this.rows&&E;){for(x=0,A=!1;x<this.columns&&A===!1;)this.get(M,x)===0?x++:this.get(M,x)===1&&x>b?(A=!0,b=x):(E=!1,A=!0);for(let I=x+1;I<this.rows;I++)this.get(M,I)!==0&&(E=!1);M++}return E}echelonForm(){let M=this.clone(),x=0,b=0;for(;x<M.rows&&b<M.columns;){let E=x;for(let A=x;A<M.rows;A++)M.get(A,b)>M.get(E,b)&&(E=A);if(M.get(E,b)===0)b++;else{M.swapRows(x,E);let A=M.get(x,b);for(let I=b;I<M.columns;I++)M.set(x,I,M.get(x,I)/A);for(let I=x+1;I<M.rows;I++){let D=M.get(I,b)/M.get(x,b);M.set(I,b,0);for(let B=b+1;B<M.columns;B++)M.set(I,B,M.get(I,B)-M.get(x,B)*D)}x++,b++}}return M}reducedEchelonForm(){let M=this.echelonForm(),x=M.columns,b=M.rows,E=b-1;for(;E>=0;)if(M.maxRow(E)===0)E--;else{let A=0,I=!1;for(;A<b&&I===!1;)M.get(E,A)===1?I=!0:A++;for(let D=0;D<E;D++){let B=M.get(D,A);for(let z=A;z<x;z++){let Q=M.get(D,z)-B*M.get(E,z);M.set(D,z,Q)}}E--}return M}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(M={}){if(typeof M!="object")throw new TypeError("options must be an object");const{rows:x=1,columns:b=1}=M;if(!Number.isInteger(x)||x<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(b)||b<=0)throw new TypeError("columns must be a positive integer");let E=new W(this.rows*x,this.columns*b);for(let A=0;A<x;A++)for(let I=0;I<b;I++)E.setSubMatrix(this,this.rows*A,this.columns*I);return E}fill(M){for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,M);return this}neg(){return this.mulS(-1)}getRow(M){c(this,M);let x=[];for(let b=0;b<this.columns;b++)x.push(this.get(M,b));return x}getRowVector(M){return W.rowVector(this.getRow(M))}setRow(M,x){c(this,M),x=d(this,x);for(let b=0;b<this.columns;b++)this.set(M,b,x[b]);return this}swapRows(M,x){c(this,M),c(this,x);for(let b=0;b<this.columns;b++){let E=this.get(M,b);this.set(M,b,this.get(x,b)),this.set(x,b,E)}return this}getColumn(M){h(this,M);let x=[];for(let b=0;b<this.rows;b++)x.push(this.get(b,M));return x}getColumnVector(M){return W.columnVector(this.getColumn(M))}setColumn(M,x){h(this,M),x=f(this,x);for(let b=0;b<this.rows;b++)this.set(b,M,x[b]);return this}swapColumns(M,x){h(this,M),h(this,x);for(let b=0;b<this.rows;b++){let E=this.get(b,M);this.set(b,M,this.get(b,x)),this.set(b,x,E)}return this}addRowVector(M){M=d(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)+M[b]);return this}subRowVector(M){M=d(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)-M[b]);return this}mulRowVector(M){M=d(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)*M[b]);return this}divRowVector(M){M=d(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)/M[b]);return this}addColumnVector(M){M=f(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)+M[x]);return this}subColumnVector(M){M=f(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)-M[x]);return this}mulColumnVector(M){M=f(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)*M[x]);return this}divColumnVector(M){M=f(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)/M[x]);return this}mulRow(M,x){c(this,M);for(let b=0;b<this.columns;b++)this.set(M,b,this.get(M,b)*x);return this}mulColumn(M,x){h(this,M);for(let b=0;b<this.rows;b++)this.set(b,M,this.get(b,M)*x);return this}max(M){if(this.isEmpty())return NaN;switch(M){case"row":{const x=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)>x[b]&&(x[b]=this.get(b,E));return x}case"column":{const x=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)>x[E]&&(x[E]=this.get(b,E));return x}case void 0:{let x=this.get(0,0);for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)>x&&(x=this.get(b,E));return x}default:throw new Error(`invalid option: ${M}`)}}maxIndex(){w(this);let M=this.get(0,0),x=[0,0];for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)>M&&(M=this.get(b,E),x[0]=b,x[1]=E);return x}min(M){if(this.isEmpty())return NaN;switch(M){case"row":{const x=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)<x[b]&&(x[b]=this.get(b,E));return x}case"column":{const x=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)<x[E]&&(x[E]=this.get(b,E));return x}case void 0:{let x=this.get(0,0);for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)<x&&(x=this.get(b,E));return x}default:throw new Error(`invalid option: ${M}`)}}minIndex(){w(this);let M=this.get(0,0),x=[0,0];for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)<M&&(M=this.get(b,E),x[0]=b,x[1]=E);return x}maxRow(M){if(c(this,M),this.isEmpty())return NaN;let x=this.get(M,0);for(let b=1;b<this.columns;b++)this.get(M,b)>x&&(x=this.get(M,b));return x}maxRowIndex(M){c(this,M),w(this);let x=this.get(M,0),b=[M,0];for(let E=1;E<this.columns;E++)this.get(M,E)>x&&(x=this.get(M,E),b[1]=E);return b}minRow(M){if(c(this,M),this.isEmpty())return NaN;let x=this.get(M,0);for(let b=1;b<this.columns;b++)this.get(M,b)<x&&(x=this.get(M,b));return x}minRowIndex(M){c(this,M),w(this);let x=this.get(M,0),b=[M,0];for(let E=1;E<this.columns;E++)this.get(M,E)<x&&(x=this.get(M,E),b[1]=E);return b}maxColumn(M){if(h(this,M),this.isEmpty())return NaN;let x=this.get(0,M);for(let b=1;b<this.rows;b++)this.get(b,M)>x&&(x=this.get(b,M));return x}maxColumnIndex(M){h(this,M),w(this);let x=this.get(0,M),b=[0,M];for(let E=1;E<this.rows;E++)this.get(E,M)>x&&(x=this.get(E,M),b[0]=E);return b}minColumn(M){if(h(this,M),this.isEmpty())return NaN;let x=this.get(0,M);for(let b=1;b<this.rows;b++)this.get(b,M)<x&&(x=this.get(b,M));return x}minColumnIndex(M){h(this,M),w(this);let x=this.get(0,M),b=[0,M];for(let E=1;E<this.rows;E++)this.get(E,M)<x&&(x=this.get(E,M),b[0]=E);return b}diag(){let M=Math.min(this.rows,this.columns),x=[];for(let b=0;b<M;b++)x.push(this.get(b,b));return x}norm(M="frobenius"){switch(M){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${M}`)}}cumulativeSum(){let M=0;for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)M+=this.get(x,b),this.set(x,b,M);return this}dot(M){le.isMatrix(M)&&(M=M.to1DArray());let x=this.to1DArray();if(x.length!==M.length)throw new RangeError("vectors do not have the same size");let b=0;for(let E=0;E<x.length;E++)b+=x[E]*M[E];return b}mmul(M){M=W.checkMatrix(M);let x=this.rows,b=this.columns,E=M.columns,A=new W(x,E),I=new Float64Array(b);for(let D=0;D<E;D++){for(let B=0;B<b;B++)I[B]=M.get(B,D);for(let B=0;B<x;B++){let z=0;for(let Q=0;Q<b;Q++)z+=this.get(B,Q)*I[Q];A.set(B,D,z)}}return A}mpow(M){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(M)||M<0)throw new RangeError("Exponent must be a non-negative integer");let x=W.eye(this.rows),b=this;for(let E=M;E>=1;E/=2)(E&1)!==0&&(x=x.mmul(b)),b=b.mmul(b);return x}strassen2x2(M){M=W.checkMatrix(M);let x=new W(2,2);const b=this.get(0,0),E=M.get(0,0),A=this.get(0,1),I=M.get(0,1),D=this.get(1,0),B=M.get(1,0),z=this.get(1,1),Q=M.get(1,1),H=(b+z)*(E+Q),se=(D+z)*E,be=b*(I-Q),te=z*(B-E),ue=(b+A)*Q,Oe=(D-b)*(E+I),Y=(A-z)*(B+Q),me=H+te-ue+Y,Pe=be+ue,Fe=se+te,je=H-se+be+Oe;return x.set(0,0,me),x.set(0,1,Pe),x.set(1,0,Fe),x.set(1,1,je),x}strassen3x3(M){M=W.checkMatrix(M);let x=new W(3,3);const b=this.get(0,0),E=this.get(0,1),A=this.get(0,2),I=this.get(1,0),D=this.get(1,1),B=this.get(1,2),z=this.get(2,0),Q=this.get(2,1),H=this.get(2,2),se=M.get(0,0),be=M.get(0,1),te=M.get(0,2),ue=M.get(1,0),Oe=M.get(1,1),Y=M.get(1,2),me=M.get(2,0),Pe=M.get(2,1),Fe=M.get(2,2),je=(b+E+A-I-D-Q-H)*Oe,Pt=(b-I)*(-be+Oe),Re=D*(-se+be+ue-Oe-Y-me+Fe),Ie=(-b+I+D)*(se-be+Oe),dt=(I+D)*(-se+be),X=b*se,pe=(-b+z+Q)*(se-te+Y),ke=(-b+z)*(te-Y),ve=(z+Q)*(-se+te),Ct=(b+E+A-D-B-z-Q)*Y,it=Q*(-se+te+ue-Oe-Y-me+Pe),Et=(-A+Q+H)*(Oe+me-Pe),Nt=(A-H)*(Oe-Pe),bn=A*me,Nr=(Q+H)*(-me+Pe),an=(-A+D+B)*(Y+me-Fe),Qr=(A-B)*(Y-Fe),wi=(D+B)*(-me+Fe),tt=E*ue,wn=B*Pe,nr=I*te,rr=z*be,sn=H*Fe,QR=X+bn+tt,eL=je+Ie+dt+X+Et+bn+Nr,tL=X+pe+ve+Ct+bn+an+wi,nL=Pt+Re+Ie+X+bn+an+Qr,rL=Pt+Ie+dt+X+wn,iL=bn+an+Qr+wi+nr,aL=X+pe+ke+it+Et+Nt+bn,sL=Et+Nt+bn+Nr+rr,oL=X+pe+ke+ve+sn;return x.set(0,0,QR),x.set(0,1,eL),x.set(0,2,tL),x.set(1,0,nL),x.set(1,1,rL),x.set(1,2,iL),x.set(2,0,aL),x.set(2,1,sL),x.set(2,2,oL),x}mmulStrassen(M){M=W.checkMatrix(M);let x=this.clone(),b=x.rows,E=x.columns,A=M.rows,I=M.columns;E!==A&&console.warn(`Multiplying ${b} x ${E} and ${A} x ${I} matrix: dimensions do not match.`);function D(H,se,be){let te=H.rows,ue=H.columns;if(te===se&&ue===be)return H;{let Oe=le.zeros(se,be);return Oe=Oe.setSubMatrix(H,0,0),Oe}}let B=Math.max(b,A),z=Math.max(E,I);x=D(x,B,z),M=D(M,B,z);function Q(H,se,be,te){if(be<=512||te<=512)return H.mmul(se);be%2===1&&te%2===1?(H=D(H,be+1,te+1),se=D(se,be+1,te+1)):be%2===1?(H=D(H,be+1,te),se=D(se,be+1,te)):te%2===1&&(H=D(H,be,te+1),se=D(se,be,te+1));let ue=parseInt(H.rows/2,10),Oe=parseInt(H.columns/2,10),Y=H.subMatrix(0,ue-1,0,Oe-1),me=se.subMatrix(0,ue-1,0,Oe-1),Pe=H.subMatrix(0,ue-1,Oe,H.columns-1),Fe=se.subMatrix(0,ue-1,Oe,se.columns-1),je=H.subMatrix(ue,H.rows-1,0,Oe-1),Pt=se.subMatrix(ue,se.rows-1,0,Oe-1),Re=H.subMatrix(ue,H.rows-1,Oe,H.columns-1),Ie=se.subMatrix(ue,se.rows-1,Oe,se.columns-1),dt=Q(le.add(Y,Re),le.add(me,Ie),ue,Oe),X=Q(le.add(je,Re),me,ue,Oe),pe=Q(Y,le.sub(Fe,Ie),ue,Oe),ke=Q(Re,le.sub(Pt,me),ue,Oe),ve=Q(le.add(Y,Pe),Ie,ue,Oe),Ct=Q(le.sub(je,Y),le.add(me,Fe),ue,Oe),it=Q(le.sub(Pe,Re),le.add(Pt,Ie),ue,Oe),Et=le.add(dt,ke);Et.sub(ve),Et.add(it);let Nt=le.add(pe,ve),bn=le.add(X,ke),Nr=le.sub(dt,X);Nr.add(pe),Nr.add(Ct);let an=le.zeros(2*Et.rows,2*Et.columns);return an=an.setSubMatrix(Et,0,0),an=an.setSubMatrix(Nt,Et.rows,0),an=an.setSubMatrix(bn,0,Et.columns),an=an.setSubMatrix(Nr,Et.rows,Et.columns),an.subMatrix(0,be-1,0,te-1)}return Q(x,M,B,z)}scaleRows(M={}){if(typeof M!="object")throw new TypeError("options must be an object");const{min:x=0,max:b=1}=M;if(!Number.isFinite(x))throw new TypeError("min must be a number");if(!Number.isFinite(b))throw new TypeError("max must be a number");if(x>=b)throw new RangeError("min must be smaller than max");let E=new W(this.rows,this.columns);for(let A=0;A<this.rows;A++){const I=this.getRow(A);I.length>0&&e(I,{min:x,max:b,output:I}),E.setRow(A,I)}return E}scaleColumns(M={}){if(typeof M!="object")throw new TypeError("options must be an object");const{min:x=0,max:b=1}=M;if(!Number.isFinite(x))throw new TypeError("min must be a number");if(!Number.isFinite(b))throw new TypeError("max must be a number");if(x>=b)throw new RangeError("min must be smaller than max");let E=new W(this.rows,this.columns);for(let A=0;A<this.columns;A++){const I=this.getColumn(A);I.length&&e(I,{min:x,max:b,output:I}),E.setColumn(A,I)}return E}flipRows(){const M=Math.ceil(this.columns/2);for(let x=0;x<this.rows;x++)for(let b=0;b<M;b++){let E=this.get(x,b),A=this.get(x,this.columns-1-b);this.set(x,b,A),this.set(x,this.columns-1-b,E)}return this}flipColumns(){const M=Math.ceil(this.rows/2);for(let x=0;x<this.columns;x++)for(let b=0;b<M;b++){let E=this.get(b,x),A=this.get(this.rows-1-b,x);this.set(b,x,A),this.set(this.rows-1-b,x,E)}return this}kroneckerProduct(M){M=W.checkMatrix(M);let x=this.rows,b=this.columns,E=M.rows,A=M.columns,I=new W(x*E,b*A);for(let D=0;D<x;D++)for(let B=0;B<b;B++)for(let z=0;z<E;z++)for(let Q=0;Q<A;Q++)I.set(E*D+z,A*B+Q,this.get(D,B)*M.get(z,Q));return I}kroneckerSum(M){if(M=W.checkMatrix(M),!this.isSquare()||!M.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let x=this.rows,b=M.rows,E=this.kroneckerProduct(W.eye(b,b)),A=W.eye(x,x).kroneckerProduct(M);return E.add(A)}transpose(){let M=new W(this.columns,this.rows);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)M.set(b,x,this.get(x,b));return M}sortRows(M=Ce){for(let x=0;x<this.rows;x++)this.setRow(x,this.getRow(x).sort(M));return this}sortColumns(M=Ce){for(let x=0;x<this.columns;x++)this.setColumn(x,this.getColumn(x).sort(M));return this}subMatrix(M,x,b,E){p(this,M,x,b,E);let A=new W(x-M+1,E-b+1);for(let I=M;I<=x;I++)for(let D=b;D<=E;D++)A.set(I-M,D-b,this.get(I,D));return A}subMatrixRow(M,x,b){if(x===void 0&&(x=0),b===void 0&&(b=this.columns-1),x>b||x<0||x>=this.columns||b<0||b>=this.columns)throw new RangeError("Argument out of range");let E=new W(M.length,b-x+1);for(let A=0;A<M.length;A++)for(let I=x;I<=b;I++){if(M[A]<0||M[A]>=this.rows)throw new RangeError(`Row index out of range: ${M[A]}`);E.set(A,I-x,this.get(M[A],I))}return E}subMatrixColumn(M,x,b){if(x===void 0&&(x=0),b===void 0&&(b=this.rows-1),x>b||x<0||x>=this.rows||b<0||b>=this.rows)throw new RangeError("Argument out of range");let E=new W(b-x+1,M.length);for(let A=0;A<M.length;A++)for(let I=x;I<=b;I++){if(M[A]<0||M[A]>=this.columns)throw new RangeError(`Column index out of range: ${M[A]}`);E.set(I-x,A,this.get(I,M[A]))}return E}setSubMatrix(M,x,b){if(M=W.checkMatrix(M),M.isEmpty())return this;let E=x+M.rows-1,A=b+M.columns-1;p(this,x,E,b,A);for(let I=0;I<M.rows;I++)for(let D=0;D<M.columns;D++)this.set(x+I,b+D,M.get(I,D));return this}selection(M,x){g(this,M),v(this,x);let b=new W(M.length,x.length);for(let E=0;E<M.length;E++){let A=M[E];for(let I=0;I<x.length;I++){let D=x[I];b.set(E,I,this.get(A,D))}}return b}trace(){let M=Math.min(this.rows,this.columns),x=0;for(let b=0;b<M;b++)x+=this.get(b,b);return x}clone(){return this.constructor.copy(this,new W(this.rows,this.columns))}static copy(M,x){for(const[b,E,A]of M.entries())x.set(b,E,A);return x}sum(M){switch(M){case"row":return S(this);case"column":return _(this);case void 0:return O(this);default:throw new Error(`invalid option: ${M}`)}}product(M){switch(M){case"row":return T(this);case"column":return k(this);case void 0:return P(this);default:throw new Error(`invalid option: ${M}`)}}mean(M){const x=this.sum(M);switch(M){case"row":{for(let b=0;b<this.rows;b++)x[b]/=this.columns;return x}case"column":{for(let b=0;b<this.columns;b++)x[b]/=this.rows;return x}case void 0:return x/this.size;default:throw new Error(`invalid option: ${M}`)}}variance(M,x={}){if(typeof M=="object"&&(x=M,M=void 0),typeof x!="object")throw new TypeError("options must be an object");const{unbiased:b=!0,mean:E=this.mean(M)}=x;if(typeof b!="boolean")throw new TypeError("unbiased must be a boolean");switch(M){case"row":{if(!r.isAnyArray(E))throw new TypeError("mean must be an array");return C(this,b,E)}case"column":{if(!r.isAnyArray(E))throw new TypeError("mean must be an array");return N(this,b,E)}case void 0:{if(typeof E!="number")throw new TypeError("mean must be a number");return L(this,b,E)}default:throw new Error(`invalid option: ${M}`)}}standardDeviation(M,x){typeof M=="object"&&(x=M,M=void 0);const b=this.variance(M,x);if(M===void 0)return Math.sqrt(b);for(let E=0;E<b.length;E++)b[E]=Math.sqrt(b[E]);return b}center(M,x={}){if(typeof M=="object"&&(x=M,M=void 0),typeof x!="object")throw new TypeError("options must be an object");const{center:b=this.mean(M)}=x;switch(M){case"row":{if(!r.isAnyArray(b))throw new TypeError("center must be an array");return F(this,b),this}case"column":{if(!r.isAnyArray(b))throw new TypeError("center must be an array");return G(this,b),this}case void 0:{if(typeof b!="number")throw new TypeError("center must be a number");return V(this,b),this}default:throw new Error(`invalid option: ${M}`)}}scale(M,x={}){if(typeof M=="object"&&(x=M,M=void 0),typeof x!="object")throw new TypeError("options must be an object");let b=x.scale;switch(M){case"row":{if(b===void 0)b=U(this);else if(!r.isAnyArray(b))throw new TypeError("scale must be an array");return $(this,b),this}case"column":{if(b===void 0)b=j(this);else if(!r.isAnyArray(b))throw new TypeError("scale must be an array");return Z(this,b),this}case void 0:{if(b===void 0)b=ne(this);else if(typeof b!="number")throw new TypeError("scale must be a number");return oe(this,b),this}default:throw new Error(`invalid option: ${M}`)}}toString(M){return a(this,M)}[Symbol.iterator](){return this.entries()}*entries(){for(let M=0;M<this.rows;M++)for(let x=0;x<this.columns;x++)yield[M,x,this.get(M,x)]}*values(){for(let M=0;M<this.rows;M++)for(let x=0;x<this.columns;x++)yield this.get(M,x)}}le.prototype.klass="Matrix",typeof Symbol<"u"&&(le.prototype[Symbol.for("nodejs.util.inspect.custom")]=i);function Ce(R,M){return R-M}function K(R){return R.every(M=>typeof M=="number")}le.random=le.rand,le.randomInt=le.randInt,le.diagonal=le.diag,le.prototype.diagonal=le.prototype.diag,le.identity=le.eye,le.prototype.negate=le.prototype.neg,le.prototype.tensorProduct=le.prototype.kroneckerProduct;const Al=class Al extends le{constructor(x,b){super();gd(this,ro);St(this,"data");if(Al.isMatrix(x))pd(this,ro,Xm).call(this,x.rows,x.columns),Al.copy(x,this);else if(Number.isInteger(x)&&x>=0)pd(this,ro,Xm).call(this,x,b);else if(r.isAnyArray(x)){const E=x;if(x=E.length,b=x?E[0].length:0,typeof b!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let A=0;A<x;A++){if(E[A].length!==b)throw new RangeError("Inconsistent array dimensions");if(!K(E[A]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(E[A]))}this.rows=x,this.columns=b}else throw new TypeError("First argument must be a positive number or an array")}set(x,b,E){return this.data[x][b]=E,this}get(x,b){return this.data[x][b]}removeRow(x){return c(this,x),this.data.splice(x,1),this.rows-=1,this}addRow(x,b){return b===void 0&&(b=x,x=this.rows),c(this,x,!0),b=Float64Array.from(d(this,b)),this.data.splice(x,0,b),this.rows+=1,this}removeColumn(x){h(this,x);for(let b=0;b<this.rows;b++){const E=new Float64Array(this.columns-1);for(let A=0;A<x;A++)E[A]=this.data[b][A];for(let A=x+1;A<this.columns;A++)E[A-1]=this.data[b][A];this.data[b]=E}return this.columns-=1,this}addColumn(x,b){typeof b>"u"&&(b=x,x=this.columns),h(this,x,!0),b=f(this,b);for(let E=0;E<this.rows;E++){const A=new Float64Array(this.columns+1);let I=0;for(;I<x;I++)A[I]=this.data[E][I];for(A[I++]=b[E];I<this.columns+1;I++)A[I]=this.data[E][I-1];this.data[E]=A}return this.columns+=1,this}};ro=new WeakSet,Xm=function(x,b){if(this.data=[],Number.isInteger(b)&&b>=0)for(let E=0;E<x;E++)this.data.push(new Float64Array(b));else throw new TypeError("nColumns must be a positive integer");this.rows=x,this.columns=b};let W=Al;u(le,W);const Pl=class Pl extends le{constructor(x){super();gd(this,An);if(W.isMatrix(x)){if(!x.isSymmetric())throw new TypeError("not symmetric data");Cl(this,An,W.copy(x,new W(x.rows,x.rows)))}else if(Number.isInteger(x)&&x>=0)Cl(this,An,new W(x,x));else if(Cl(this,An,new W(x)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return Rr(this,An).size}get rows(){return Rr(this,An).rows}get columns(){return Rr(this,An).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(x){return W.isMatrix(x)&&x.klassType==="SymmetricMatrix"}static zeros(x){return new this(x)}static ones(x){return new this(x).fill(1)}clone(){const x=new Pl(this.diagonalSize);for(const[b,E,A]of this.upperRightEntries())x.set(b,E,A);return x}toMatrix(){return new W(this)}get(x,b){return Rr(this,An).get(x,b)}set(x,b,E){return Rr(this,An).set(x,b,E),Rr(this,An).set(b,x,E),this}removeCross(x){return Rr(this,An).removeRow(x),Rr(this,An).removeColumn(x),this}addCross(x,b){b===void 0&&(b=x,x=this.diagonalSize);const E=b.slice();return E.splice(x,1),Rr(this,An).addRow(x,E),Rr(this,An).addColumn(x,b),this}applyMask(x){if(x.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const b=[];for(const[E,A]of x.entries())A||b.push(E);b.reverse();for(const E of b)this.removeCross(E);return this}toCompact(){const{diagonalSize:x}=this,b=new Array(x*(x+1)/2);for(let E=0,A=0,I=0;I<b.length;I++)b[I]=this.get(A,E),++E>=x&&(E=++A);return b}static fromCompact(x){const b=x.length,E=(Math.sqrt(8*b+1)-1)/2;if(!Number.isInteger(E))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(x)}`);const A=new Pl(E);for(let I=0,D=0,B=0;B<b;B++)A.set(I,D,x[B]),++I>=E&&(I=++D);return A}*upperRightEntries(){for(let x=0,b=0;x<this.diagonalSize;void 0){const E=this.get(x,b);yield[x,b,E],++b>=this.diagonalSize&&(b=++x)}}*upperRightValues(){for(let x=0,b=0;x<this.diagonalSize;void 0)yield this.get(x,b),++b>=this.diagonalSize&&(b=++x)}};An=new WeakMap;let ee=Pl;ee.prototype.klassType="SymmetricMatrix";class he extends ee{static isDistanceMatrix(M){return ee.isSymmetricMatrix(M)&&M.klassSubType==="DistanceMatrix"}constructor(M){if(super(M),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(M,x,b){return M===x&&(b=0),super.set(M,x,b)}addCross(M,x){return x===void 0&&(x=M,M=this.diagonalSize),x=x.slice(),x[M]=0,super.addCross(M,x)}toSymmetricMatrix(){return new ee(this)}clone(){const M=new he(this.diagonalSize);for(const[x,b,E]of this.upperRightEntries())x!==b&&M.set(x,b,E);return M}toCompact(){const{diagonalSize:M}=this,x=(M-1)*M/2,b=new Array(x);for(let E=1,A=0,I=0;I<b.length;I++)b[I]=this.get(A,E),++E>=M&&(E=++A+1);return b}static fromCompact(M){const x=M.length;if(x===0)return new this(0);const b=(Math.sqrt(8*x+1)+1)/2;if(!Number.isInteger(b))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(M)}`);const E=new this(b);for(let A=1,I=0,D=0;D<x;D++)E.set(A,I,M[D]),++A>=b&&(A=++I+1);return E}}he.prototype.klassSubType="DistanceMatrix";class Se extends le{constructor(M,x,b){super(),this.matrix=M,this.rows=x,this.columns=b}}class Ne extends Se{constructor(M,x){h(M,x),super(M,M.rows,1),this.column=x}set(M,x,b){return this.matrix.set(M,this.column,b),this}get(M){return this.matrix.get(M,this.column)}}class Ue extends Se{constructor(M,x){v(M,x),super(M,M.rows,x.length),this.columnIndices=x}set(M,x,b){return this.matrix.set(M,this.columnIndices[x],b),this}get(M,x){return this.matrix.get(M,this.columnIndices[x])}}class Tt extends Se{constructor(M){super(M,M.rows,M.columns)}set(M,x,b){return this.matrix.set(M,this.columns-x-1,b),this}get(M,x){return this.matrix.get(M,this.columns-x-1)}}class fn extends Se{constructor(M){super(M,M.rows,M.columns)}set(M,x,b){return this.matrix.set(this.rows-M-1,x,b),this}get(M,x){return this.matrix.get(this.rows-M-1,x)}}class At extends Se{constructor(M,x){c(M,x),super(M,1,M.columns),this.row=x}set(M,x,b){return this.matrix.set(this.row,x,b),this}get(M,x){return this.matrix.get(this.row,x)}}class Kt extends Se{constructor(M,x){g(M,x),super(M,x.length,M.columns),this.rowIndices=x}set(M,x,b){return this.matrix.set(this.rowIndices[M],x,b),this}get(M,x){return this.matrix.get(this.rowIndices[M],x)}}class Ze extends Se{constructor(M,x,b){g(M,x),v(M,b),super(M,x.length,b.length),this.rowIndices=x,this.columnIndices=b}set(M,x,b){return this.matrix.set(this.rowIndices[M],this.columnIndices[x],b),this}get(M,x){return this.matrix.get(this.rowIndices[M],this.columnIndices[x])}}class yr extends Se{constructor(M,x,b,E,A){p(M,x,b,E,A),super(M,b-x+1,A-E+1),this.startRow=x,this.startColumn=E}set(M,x,b){return this.matrix.set(this.startRow+M,this.startColumn+x,b),this}get(M,x){return this.matrix.get(this.startRow+M,this.startColumn+x)}}class et extends Se{constructor(M){super(M,M.columns,M.rows)}set(M,x,b){return this.matrix.set(x,M,b),this}get(M,x){return this.matrix.get(x,M)}}class mr extends le{constructor(M,x={}){const{rows:b=1}=x;if(M.length%b!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=b,this.columns=M.length/b,this.data=M}set(M,x,b){let E=this._calculateIndex(M,x);return this.data[E]=b,this}get(M,x){let b=this._calculateIndex(M,x);return this.data[b]}_calculateIndex(M,x){return M*this.columns+x}}class xt extends le{constructor(M){super(),this.data=M,this.rows=M.length,this.columns=M[0].length}set(M,x,b){return this.data[M][x]=b,this}get(M,x){return this.data[M][x]}}function ls(R,M){if(r.isAnyArray(R))return R[0]&&r.isAnyArray(R[0])?new xt(R):new mr(R,M);throw new Error("the argument is not an array")}class br{constructor(M){M=xt.checkMatrix(M);let x=M.clone(),b=x.rows,E=x.columns,A=new Float64Array(b),I=1,D,B,z,Q,H,se,be,te,ue;for(D=0;D<b;D++)A[D]=D;for(te=new Float64Array(b),B=0;B<E;B++){for(D=0;D<b;D++)te[D]=x.get(D,B);for(D=0;D<b;D++){for(ue=Math.min(D,B),H=0,z=0;z<ue;z++)H+=x.get(D,z)*te[z];te[D]-=H,x.set(D,B,te[D])}for(Q=B,D=B+1;D<b;D++)Math.abs(te[D])>Math.abs(te[Q])&&(Q=D);if(Q!==B){for(z=0;z<E;z++)se=x.get(Q,z),x.set(Q,z,x.get(B,z)),x.set(B,z,se);be=A[Q],A[Q]=A[B],A[B]=be,I=-I}if(B<b&&x.get(B,B)!==0)for(D=B+1;D<b;D++)x.set(D,B,x.get(D,B)/x.get(B,B))}this.LU=x,this.pivotVector=A,this.pivotSign=I}isSingular(){let M=this.LU,x=M.columns;for(let b=0;b<x;b++)if(M.get(b,b)===0)return!0;return!1}solve(M){M=W.checkMatrix(M);let x=this.LU;if(x.rows!==M.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let E=M.columns,A=M.subMatrixRow(this.pivotVector,0,E-1),I=x.columns,D,B,z;for(z=0;z<I;z++)for(D=z+1;D<I;D++)for(B=0;B<E;B++)A.set(D,B,A.get(D,B)-A.get(z,B)*x.get(D,z));for(z=I-1;z>=0;z--){for(B=0;B<E;B++)A.set(z,B,A.get(z,B)/x.get(z,z));for(D=0;D<z;D++)for(B=0;B<E;B++)A.set(D,B,A.get(D,B)-A.get(z,B)*x.get(D,z))}return A}get determinant(){let M=this.LU;if(!M.isSquare())throw new Error("Matrix must be square");let x=this.pivotSign,b=M.columns;for(let E=0;E<b;E++)x*=M.get(E,E);return x}get lowerTriangularMatrix(){let M=this.LU,x=M.rows,b=M.columns,E=new W(x,b);for(let A=0;A<x;A++)for(let I=0;I<b;I++)A>I?E.set(A,I,M.get(A,I)):A===I?E.set(A,I,1):E.set(A,I,0);return E}get upperTriangularMatrix(){let M=this.LU,x=M.rows,b=M.columns,E=new W(x,b);for(let A=0;A<x;A++)for(let I=0;I<b;I++)A<=I?E.set(A,I,M.get(A,I)):E.set(A,I,0);return E}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function Wt(R,M){let x=0;return Math.abs(R)>Math.abs(M)?(x=M/R,Math.abs(R)*Math.sqrt(1+x*x)):M!==0?(x=R/M,Math.abs(M)*Math.sqrt(1+x*x)):0}class It{constructor(M){M=xt.checkMatrix(M);let x=M.clone(),b=M.rows,E=M.columns,A=new Float64Array(E),I,D,B,z;for(B=0;B<E;B++){let Q=0;for(I=B;I<b;I++)Q=Wt(Q,x.get(I,B));if(Q!==0){for(x.get(B,B)<0&&(Q=-Q),I=B;I<b;I++)x.set(I,B,x.get(I,B)/Q);for(x.set(B,B,x.get(B,B)+1),D=B+1;D<E;D++){for(z=0,I=B;I<b;I++)z+=x.get(I,B)*x.get(I,D);for(z=-z/x.get(B,B),I=B;I<b;I++)x.set(I,D,x.get(I,D)+z*x.get(I,B))}}A[B]=-Q}this.QR=x,this.Rdiag=A}solve(M){M=W.checkMatrix(M);let x=this.QR,b=x.rows;if(M.rows!==b)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let E=M.columns,A=M.clone(),I=x.columns,D,B,z,Q;for(z=0;z<I;z++)for(B=0;B<E;B++){for(Q=0,D=z;D<b;D++)Q+=x.get(D,z)*A.get(D,B);for(Q=-Q/x.get(z,z),D=z;D<b;D++)A.set(D,B,A.get(D,B)+Q*x.get(D,z))}for(z=I-1;z>=0;z--){for(B=0;B<E;B++)A.set(z,B,A.get(z,B)/this.Rdiag[z]);for(D=0;D<z;D++)for(B=0;B<E;B++)A.set(D,B,A.get(D,B)-A.get(z,B)*x.get(D,z))}return A.subMatrix(0,I-1,0,E-1)}isFullRank(){let M=this.QR.columns;for(let x=0;x<M;x++)if(this.Rdiag[x]===0)return!1;return!0}get upperTriangularMatrix(){let M=this.QR,x=M.columns,b=new W(x,x),E,A;for(E=0;E<x;E++)for(A=0;A<x;A++)E<A?b.set(E,A,M.get(E,A)):E===A?b.set(E,A,this.Rdiag[E]):b.set(E,A,0);return b}get orthogonalMatrix(){let M=this.QR,x=M.rows,b=M.columns,E=new W(x,b),A,I,D,B;for(D=b-1;D>=0;D--){for(A=0;A<x;A++)E.set(A,D,0);for(E.set(D,D,1),I=D;I<b;I++)if(M.get(D,D)!==0){for(B=0,A=D;A<x;A++)B+=M.get(A,D)*E.get(A,I);for(B=-B/M.get(D,D),A=D;A<x;A++)E.set(A,I,E.get(A,I)+B*M.get(A,D))}}return E}}class Wn{constructor(M,x={}){if(M=xt.checkMatrix(M),M.isEmpty())throw new Error("Matrix must be non-empty");let b=M.rows,E=M.columns;const{computeLeftSingularVectors:A=!0,computeRightSingularVectors:I=!0,autoTranspose:D=!1}=x;let B=!!A,z=!!I,Q=!1,H;if(b<E)if(!D)H=M.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{H=M.transpose(),b=H.rows,E=H.columns,Q=!0;let X=B;B=z,z=X}else H=M.clone();let se=Math.min(b,E),be=Math.min(b+1,E),te=new Float64Array(be),ue=new W(b,se),Oe=new W(E,E),Y=new Float64Array(E),me=new Float64Array(b),Pe=new Float64Array(be);for(let X=0;X<be;X++)Pe[X]=X;let Fe=Math.min(b-1,E),je=Math.max(0,Math.min(E-2,b)),Pt=Math.max(Fe,je);for(let X=0;X<Pt;X++){if(X<Fe){te[X]=0;for(let pe=X;pe<b;pe++)te[X]=Wt(te[X],H.get(pe,X));if(te[X]!==0){H.get(X,X)<0&&(te[X]=-te[X]);for(let pe=X;pe<b;pe++)H.set(pe,X,H.get(pe,X)/te[X]);H.set(X,X,H.get(X,X)+1)}te[X]=-te[X]}for(let pe=X+1;pe<E;pe++){if(X<Fe&&te[X]!==0){let ke=0;for(let ve=X;ve<b;ve++)ke+=H.get(ve,X)*H.get(ve,pe);ke=-ke/H.get(X,X);for(let ve=X;ve<b;ve++)H.set(ve,pe,H.get(ve,pe)+ke*H.get(ve,X))}Y[pe]=H.get(X,pe)}if(B&&X<Fe)for(let pe=X;pe<b;pe++)ue.set(pe,X,H.get(pe,X));if(X<je){Y[X]=0;for(let pe=X+1;pe<E;pe++)Y[X]=Wt(Y[X],Y[pe]);if(Y[X]!==0){Y[X+1]<0&&(Y[X]=0-Y[X]);for(let pe=X+1;pe<E;pe++)Y[pe]/=Y[X];Y[X+1]+=1}if(Y[X]=-Y[X],X+1<b&&Y[X]!==0){for(let pe=X+1;pe<b;pe++)me[pe]=0;for(let pe=X+1;pe<b;pe++)for(let ke=X+1;ke<E;ke++)me[pe]+=Y[ke]*H.get(pe,ke);for(let pe=X+1;pe<E;pe++){let ke=-Y[pe]/Y[X+1];for(let ve=X+1;ve<b;ve++)H.set(ve,pe,H.get(ve,pe)+ke*me[ve])}}if(z)for(let pe=X+1;pe<E;pe++)Oe.set(pe,X,Y[pe])}}let Re=Math.min(E,b+1);if(Fe<E&&(te[Fe]=H.get(Fe,Fe)),b<Re&&(te[Re-1]=0),je+1<Re&&(Y[je]=H.get(je,Re-1)),Y[Re-1]=0,B){for(let X=Fe;X<se;X++){for(let pe=0;pe<b;pe++)ue.set(pe,X,0);ue.set(X,X,1)}for(let X=Fe-1;X>=0;X--)if(te[X]!==0){for(let pe=X+1;pe<se;pe++){let ke=0;for(let ve=X;ve<b;ve++)ke+=ue.get(ve,X)*ue.get(ve,pe);ke=-ke/ue.get(X,X);for(let ve=X;ve<b;ve++)ue.set(ve,pe,ue.get(ve,pe)+ke*ue.get(ve,X))}for(let pe=X;pe<b;pe++)ue.set(pe,X,-ue.get(pe,X));ue.set(X,X,1+ue.get(X,X));for(let pe=0;pe<X-1;pe++)ue.set(pe,X,0)}else{for(let pe=0;pe<b;pe++)ue.set(pe,X,0);ue.set(X,X,1)}}if(z)for(let X=E-1;X>=0;X--){if(X<je&&Y[X]!==0)for(let pe=X+1;pe<E;pe++){let ke=0;for(let ve=X+1;ve<E;ve++)ke+=Oe.get(ve,X)*Oe.get(ve,pe);ke=-ke/Oe.get(X+1,X);for(let ve=X+1;ve<E;ve++)Oe.set(ve,pe,Oe.get(ve,pe)+ke*Oe.get(ve,X))}for(let pe=0;pe<E;pe++)Oe.set(pe,X,0);Oe.set(X,X,1)}let Ie=Re-1,dt=Number.EPSILON;for(;Re>0;){let X,pe;for(X=Re-2;X>=-1&&X!==-1;X--){const ke=Number.MIN_VALUE+dt*Math.abs(te[X]+Math.abs(te[X+1]));if(Math.abs(Y[X])<=ke||Number.isNaN(Y[X])){Y[X]=0;break}}if(X===Re-2)pe=4;else{let ke;for(ke=Re-1;ke>=X&&ke!==X;ke--){let ve=(ke!==Re?Math.abs(Y[ke]):0)+(ke!==X+1?Math.abs(Y[ke-1]):0);if(Math.abs(te[ke])<=dt*ve){te[ke]=0;break}}ke===X?pe=3:ke===Re-1?pe=1:(pe=2,X=ke)}switch(X++,pe){case 1:{let ke=Y[Re-2];Y[Re-2]=0;for(let ve=Re-2;ve>=X;ve--){let Ct=Wt(te[ve],ke),it=te[ve]/Ct,Et=ke/Ct;if(te[ve]=Ct,ve!==X&&(ke=-Et*Y[ve-1],Y[ve-1]=it*Y[ve-1]),z)for(let Nt=0;Nt<E;Nt++)Ct=it*Oe.get(Nt,ve)+Et*Oe.get(Nt,Re-1),Oe.set(Nt,Re-1,-Et*Oe.get(Nt,ve)+it*Oe.get(Nt,Re-1)),Oe.set(Nt,ve,Ct)}break}case 2:{let ke=Y[X-1];Y[X-1]=0;for(let ve=X;ve<Re;ve++){let Ct=Wt(te[ve],ke),it=te[ve]/Ct,Et=ke/Ct;if(te[ve]=Ct,ke=-Et*Y[ve],Y[ve]=it*Y[ve],B)for(let Nt=0;Nt<b;Nt++)Ct=it*ue.get(Nt,ve)+Et*ue.get(Nt,X-1),ue.set(Nt,X-1,-Et*ue.get(Nt,ve)+it*ue.get(Nt,X-1)),ue.set(Nt,ve,Ct)}break}case 3:{const ke=Math.max(Math.abs(te[Re-1]),Math.abs(te[Re-2]),Math.abs(Y[Re-2]),Math.abs(te[X]),Math.abs(Y[X])),ve=te[Re-1]/ke,Ct=te[Re-2]/ke,it=Y[Re-2]/ke,Et=te[X]/ke,Nt=Y[X]/ke,bn=((Ct+ve)*(Ct-ve)+it*it)/2,Nr=ve*it*(ve*it);let an=0;(bn!==0||Nr!==0)&&(bn<0?an=0-Math.sqrt(bn*bn+Nr):an=Math.sqrt(bn*bn+Nr),an=Nr/(bn+an));let Qr=(Et+ve)*(Et-ve)+an,wi=Et*Nt;for(let tt=X;tt<Re-1;tt++){let wn=Wt(Qr,wi);wn===0&&(wn=Number.MIN_VALUE);let nr=Qr/wn,rr=wi/wn;if(tt!==X&&(Y[tt-1]=wn),Qr=nr*te[tt]+rr*Y[tt],Y[tt]=nr*Y[tt]-rr*te[tt],wi=rr*te[tt+1],te[tt+1]=nr*te[tt+1],z)for(let sn=0;sn<E;sn++)wn=nr*Oe.get(sn,tt)+rr*Oe.get(sn,tt+1),Oe.set(sn,tt+1,-rr*Oe.get(sn,tt)+nr*Oe.get(sn,tt+1)),Oe.set(sn,tt,wn);if(wn=Wt(Qr,wi),wn===0&&(wn=Number.MIN_VALUE),nr=Qr/wn,rr=wi/wn,te[tt]=wn,Qr=nr*Y[tt]+rr*te[tt+1],te[tt+1]=-rr*Y[tt]+nr*te[tt+1],wi=rr*Y[tt+1],Y[tt+1]=nr*Y[tt+1],B&&tt<b-1)for(let sn=0;sn<b;sn++)wn=nr*ue.get(sn,tt)+rr*ue.get(sn,tt+1),ue.set(sn,tt+1,-rr*ue.get(sn,tt)+nr*ue.get(sn,tt+1)),ue.set(sn,tt,wn)}Y[Re-2]=Qr;break}case 4:{if(te[X]<=0&&(te[X]=te[X]<0?-te[X]:0,z))for(let ke=0;ke<=Ie;ke++)Oe.set(ke,X,-Oe.get(ke,X));for(;X<Ie&&!(te[X]>=te[X+1]);){let ke=te[X];if(te[X]=te[X+1],te[X+1]=ke,z&&X<E-1)for(let ve=0;ve<E;ve++)ke=Oe.get(ve,X+1),Oe.set(ve,X+1,Oe.get(ve,X)),Oe.set(ve,X,ke);if(B&&X<b-1)for(let ve=0;ve<b;ve++)ke=ue.get(ve,X+1),ue.set(ve,X+1,ue.get(ve,X)),ue.set(ve,X,ke);X++}Re--;break}}}if(Q){let X=Oe;Oe=ue,ue=X}this.m=b,this.n=E,this.s=te,this.U=ue,this.V=Oe}solve(M){let x=M,b=this.threshold,E=this.s.length,A=W.zeros(E,E);for(let se=0;se<E;se++)Math.abs(this.s[se])<=b?A.set(se,se,0):A.set(se,se,1/this.s[se]);let I=this.U,D=this.rightSingularVectors,B=D.mmul(A),z=D.rows,Q=I.rows,H=W.zeros(z,Q);for(let se=0;se<z;se++)for(let be=0;be<Q;be++){let te=0;for(let ue=0;ue<E;ue++)te+=B.get(se,ue)*I.get(be,ue);H.set(se,be,te)}return H.mmul(x)}solveForDiagonal(M){return this.solve(W.diag(M))}inverse(){let M=this.V,x=this.threshold,b=M.rows,E=M.columns,A=new W(b,this.s.length);for(let Q=0;Q<b;Q++)for(let H=0;H<E;H++)Math.abs(this.s[H])>x&&A.set(Q,H,M.get(Q,H)/this.s[H]);let I=this.U,D=I.rows,B=I.columns,z=new W(b,D);for(let Q=0;Q<b;Q++)for(let H=0;H<D;H++){let se=0;for(let be=0;be<B;be++)se+=A.get(Q,be)*I.get(H,be);z.set(Q,H,se)}return z}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let M=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,x=0,b=this.s;for(let E=0,A=b.length;E<A;E++)b[E]>M&&x++;return x}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return W.diag(this.s)}}function Vn(R,M=!1){return R=xt.checkMatrix(R),M?new Wn(R).inverse():wr(R,W.eye(R.rows))}function wr(R,M,x=!1){return R=xt.checkMatrix(R),M=xt.checkMatrix(M),x?new Wn(R).solve(M):R.isSquare()?new br(R).solve(M):new It(R).solve(M)}function bi(R){if(R=W.checkMatrix(R),R.isSquare()){if(R.columns===0)return 1;let M,x,b,E;if(R.columns===2)return M=R.get(0,0),x=R.get(0,1),b=R.get(1,0),E=R.get(1,1),M*E-x*b;if(R.columns===3){let A,I,D;return A=new Ze(R,[1,2],[1,2]),I=new Ze(R,[1,2],[0,2]),D=new Ze(R,[1,2],[0,1]),M=R.get(0,0),x=R.get(0,1),b=R.get(0,2),M*bi(A)-x*bi(I)+b*bi(D)}else return new br(R).determinant}else throw Error("determinant can only be calculated for a square matrix")}function Kr(R,M){let x=[];for(let b=0;b<R;b++)b!==M&&x.push(b);return x}function us(R,M,x,b=1e-9,E=1e-9){if(R>E)return new Array(M.rows+1).fill(0);{let A=M.addRow(x,[0]);for(let I=0;I<A.rows;I++)Math.abs(A.get(I,0))<b&&A.set(I,0,0);return A.to1DArray()}}function cs(R,M={}){const{thresholdValue:x=1e-9,thresholdError:b=1e-9}=M;R=W.checkMatrix(R);let E=R.rows,A=new W(E,E);for(let I=0;I<E;I++){let D=W.columnVector(R.getRow(I)),B=R.subMatrixRow(Kr(E,I)).transpose(),Q=new Wn(B).solve(D),H=W.sub(D,B.mmul(Q)).abs().max();A.setRow(I,us(H,Q,I,x,b))}return A}function dd(R,M=Number.EPSILON){if(R=W.checkMatrix(R),R.isEmpty())return R.transpose();let x=new Wn(R,{autoTranspose:!0}),b=x.leftSingularVectors,E=x.rightSingularVectors,A=x.diagonal;for(let I=0;I<A.length;I++)Math.abs(A[I])>M?A[I]=1/A[I]:A[I]=0;return E.mmul(W.diag(A).mmul(b.transpose()))}function kl(R,M=R,x={}){R=new W(R);let b=!1;if(typeof M=="object"&&!W.isMatrix(M)&&!r.isAnyArray(M)?(x=M,M=R,b=!0):M=new W(M),R.rows!==M.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:E=!0}=x;E&&(R=R.center("column"),b||(M=M.center("column")));const A=R.transpose().mmul(M);for(let I=0;I<A.rows;I++)for(let D=0;D<A.columns;D++)A.set(I,D,A.get(I,D)*(1/(R.rows-1)));return A}function Zr(R,M=R,x={}){R=new W(R);let b=!1;if(typeof M=="object"&&!W.isMatrix(M)&&!r.isAnyArray(M)?(x=M,M=R,b=!0):M=new W(M),R.rows!==M.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:E=!0,scale:A=!0}=x;E&&(R.center("column"),b||M.center("column")),A&&(R.scale("column"),b||M.scale("column"));const I=R.standardDeviation("column",{unbiased:!0}),D=b?I:M.standardDeviation("column",{unbiased:!0}),B=R.transpose().mmul(M);for(let z=0;z<B.rows;z++)for(let Q=0;Q<B.columns;Q++)B.set(z,Q,B.get(z,Q)*(1/(I[z]*D[Q]))*(1/(R.rows-1)));return B}class Jr{constructor(M,x={}){const{assumeSymmetric:b=!1}=x;if(M=xt.checkMatrix(M),!M.isSquare())throw new Error("Matrix is not a square matrix");if(M.isEmpty())throw new Error("Matrix must be non-empty");let E=M.columns,A=new W(E,E),I=new Float64Array(E),D=new Float64Array(E),B=M,z,Q,H=!1;if(b?H=!0:H=M.isSymmetric(),H){for(z=0;z<E;z++)for(Q=0;Q<E;Q++)A.set(z,Q,B.get(z,Q));XR(E,D,I,A),KR(E,D,I,A)}else{let se=new W(E,E),be=new Float64Array(E);for(Q=0;Q<E;Q++)for(z=0;z<E;z++)se.set(z,Q,B.get(z,Q));ZR(E,se,be,A),JR(E,D,I,A,se)}this.n=E,this.e=D,this.d=I,this.V=A}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let M=this.n,x=this.e,b=this.d,E=new W(M,M),A,I;for(A=0;A<M;A++){for(I=0;I<M;I++)E.set(A,I,0);E.set(A,A,b[A]),x[A]>0?E.set(A,A+1,x[A]):x[A]<0&&E.set(A,A-1,x[A])}return E}}function XR(R,M,x,b){let E,A,I,D,B,z,Q,H;for(B=0;B<R;B++)x[B]=b.get(R-1,B);for(D=R-1;D>0;D--){for(H=0,I=0,z=0;z<D;z++)H=H+Math.abs(x[z]);if(H===0)for(M[D]=x[D-1],B=0;B<D;B++)x[B]=b.get(D-1,B),b.set(D,B,0),b.set(B,D,0);else{for(z=0;z<D;z++)x[z]/=H,I+=x[z]*x[z];for(E=x[D-1],A=Math.sqrt(I),E>0&&(A=-A),M[D]=H*A,I=I-E*A,x[D-1]=E-A,B=0;B<D;B++)M[B]=0;for(B=0;B<D;B++){for(E=x[B],b.set(B,D,E),A=M[B]+b.get(B,B)*E,z=B+1;z<=D-1;z++)A+=b.get(z,B)*x[z],M[z]+=b.get(z,B)*E;M[B]=A}for(E=0,B=0;B<D;B++)M[B]/=I,E+=M[B]*x[B];for(Q=E/(I+I),B=0;B<D;B++)M[B]-=Q*x[B];for(B=0;B<D;B++){for(E=x[B],A=M[B],z=B;z<=D-1;z++)b.set(z,B,b.get(z,B)-(E*M[z]+A*x[z]));x[B]=b.get(D-1,B),b.set(D,B,0)}}x[D]=I}for(D=0;D<R-1;D++){if(b.set(R-1,D,b.get(D,D)),b.set(D,D,1),I=x[D+1],I!==0){for(z=0;z<=D;z++)x[z]=b.get(z,D+1)/I;for(B=0;B<=D;B++){for(A=0,z=0;z<=D;z++)A+=b.get(z,D+1)*b.get(z,B);for(z=0;z<=D;z++)b.set(z,B,b.get(z,B)-A*x[z])}}for(z=0;z<=D;z++)b.set(z,D+1,0)}for(B=0;B<R;B++)x[B]=b.get(R-1,B),b.set(R-1,B,0);b.set(R-1,R-1,1),M[0]=0}function KR(R,M,x,b){let E,A,I,D,B,z,Q,H,se,be,te,ue,Oe,Y,me,Pe;for(I=1;I<R;I++)M[I-1]=M[I];M[R-1]=0;let Fe=0,je=0,Pt=Number.EPSILON;for(z=0;z<R;z++){for(je=Math.max(je,Math.abs(x[z])+Math.abs(M[z])),Q=z;Q<R&&!(Math.abs(M[Q])<=Pt*je);)Q++;if(Q>z)do{for(E=x[z],H=(x[z+1]-E)/(2*M[z]),se=Wt(H,1),H<0&&(se=-se),x[z]=M[z]/(H+se),x[z+1]=M[z]*(H+se),be=x[z+1],A=E-x[z],I=z+2;I<R;I++)x[I]-=A;for(Fe=Fe+A,H=x[Q],te=1,ue=te,Oe=te,Y=M[z+1],me=0,Pe=0,I=Q-1;I>=z;I--)for(Oe=ue,ue=te,Pe=me,E=te*M[I],A=te*H,se=Wt(H,M[I]),M[I+1]=me*se,me=M[I]/se,te=H/se,H=te*x[I]-me*E,x[I+1]=A+me*(te*E+me*x[I]),B=0;B<R;B++)A=b.get(B,I+1),b.set(B,I+1,me*b.get(B,I)+te*A),b.set(B,I,te*b.get(B,I)-me*A);H=-me*Pe*Oe*Y*M[z]/be,M[z]=me*H,x[z]=te*H}while(Math.abs(M[z])>Pt*je);x[z]=x[z]+Fe,M[z]=0}for(I=0;I<R-1;I++){for(B=I,H=x[I],D=I+1;D<R;D++)x[D]<H&&(B=D,H=x[D]);if(B!==I)for(x[B]=x[I],x[I]=H,D=0;D<R;D++)H=b.get(D,I),b.set(D,I,b.get(D,B)),b.set(D,B,H)}}function ZR(R,M,x,b){let E=0,A=R-1,I,D,B,z,Q,H,se;for(H=E+1;H<=A-1;H++){for(se=0,z=H;z<=A;z++)se=se+Math.abs(M.get(z,H-1));if(se!==0){for(B=0,z=A;z>=H;z--)x[z]=M.get(z,H-1)/se,B+=x[z]*x[z];for(D=Math.sqrt(B),x[H]>0&&(D=-D),B=B-x[H]*D,x[H]=x[H]-D,Q=H;Q<R;Q++){for(I=0,z=A;z>=H;z--)I+=x[z]*M.get(z,Q);for(I=I/B,z=H;z<=A;z++)M.set(z,Q,M.get(z,Q)-I*x[z])}for(z=0;z<=A;z++){for(I=0,Q=A;Q>=H;Q--)I+=x[Q]*M.get(z,Q);for(I=I/B,Q=H;Q<=A;Q++)M.set(z,Q,M.get(z,Q)-I*x[Q])}x[H]=se*x[H],M.set(H,H-1,se*D)}}for(z=0;z<R;z++)for(Q=0;Q<R;Q++)b.set(z,Q,z===Q?1:0);for(H=A-1;H>=E+1;H--)if(M.get(H,H-1)!==0){for(z=H+1;z<=A;z++)x[z]=M.get(z,H-1);for(Q=H;Q<=A;Q++){for(D=0,z=H;z<=A;z++)D+=x[z]*b.get(z,Q);for(D=D/x[H]/M.get(H,H-1),z=H;z<=A;z++)b.set(z,Q,b.get(z,Q)+D*x[z])}}}function JR(R,M,x,b,E){let A=R-1,I=0,D=R-1,B=Number.EPSILON,z=0,Q=0,H=0,se=0,be=0,te=0,ue=0,Oe=0,Y,me,Pe,Fe,je,Pt,Re,Ie,dt,X,pe,ke,ve,Ct,it;for(Y=0;Y<R;Y++)for((Y<I||Y>D)&&(x[Y]=E.get(Y,Y),M[Y]=0),me=Math.max(Y-1,0);me<R;me++)Q=Q+Math.abs(E.get(Y,me));for(;A>=I;){for(Fe=A;Fe>I&&(te=Math.abs(E.get(Fe-1,Fe-1))+Math.abs(E.get(Fe,Fe)),te===0&&(te=Q),!(Math.abs(E.get(Fe,Fe-1))<B*te));)Fe--;if(Fe===A)E.set(A,A,E.get(A,A)+z),x[A]=E.get(A,A),M[A]=0,A--,Oe=0;else if(Fe===A-1){if(Re=E.get(A,A-1)*E.get(A-1,A),H=(E.get(A-1,A-1)-E.get(A,A))/2,se=H*H+Re,ue=Math.sqrt(Math.abs(se)),E.set(A,A,E.get(A,A)+z),E.set(A-1,A-1,E.get(A-1,A-1)+z),Ie=E.get(A,A),se>=0){for(ue=H>=0?H+ue:H-ue,x[A-1]=Ie+ue,x[A]=x[A-1],ue!==0&&(x[A]=Ie-Re/ue),M[A-1]=0,M[A]=0,Ie=E.get(A,A-1),te=Math.abs(Ie)+Math.abs(ue),H=Ie/te,se=ue/te,be=Math.sqrt(H*H+se*se),H=H/be,se=se/be,me=A-1;me<R;me++)ue=E.get(A-1,me),E.set(A-1,me,se*ue+H*E.get(A,me)),E.set(A,me,se*E.get(A,me)-H*ue);for(Y=0;Y<=A;Y++)ue=E.get(Y,A-1),E.set(Y,A-1,se*ue+H*E.get(Y,A)),E.set(Y,A,se*E.get(Y,A)-H*ue);for(Y=I;Y<=D;Y++)ue=b.get(Y,A-1),b.set(Y,A-1,se*ue+H*b.get(Y,A)),b.set(Y,A,se*b.get(Y,A)-H*ue)}else x[A-1]=Ie+H,x[A]=Ie+H,M[A-1]=ue,M[A]=-ue;A=A-2,Oe=0}else{if(Ie=E.get(A,A),dt=0,Re=0,Fe<A&&(dt=E.get(A-1,A-1),Re=E.get(A,A-1)*E.get(A-1,A)),Oe===10){for(z+=Ie,Y=I;Y<=A;Y++)E.set(Y,Y,E.get(Y,Y)-Ie);te=Math.abs(E.get(A,A-1))+Math.abs(E.get(A-1,A-2)),Ie=dt=.75*te,Re=-.4375*te*te}if(Oe===30&&(te=(dt-Ie)/2,te=te*te+Re,te>0)){for(te=Math.sqrt(te),dt<Ie&&(te=-te),te=Ie-Re/((dt-Ie)/2+te),Y=I;Y<=A;Y++)E.set(Y,Y,E.get(Y,Y)-te);z+=te,Ie=dt=Re=.964}for(Oe=Oe+1,je=A-2;je>=Fe&&(ue=E.get(je,je),be=Ie-ue,te=dt-ue,H=(be*te-Re)/E.get(je+1,je)+E.get(je,je+1),se=E.get(je+1,je+1)-ue-be-te,be=E.get(je+2,je+1),te=Math.abs(H)+Math.abs(se)+Math.abs(be),H=H/te,se=se/te,be=be/te,!(je===Fe||Math.abs(E.get(je,je-1))*(Math.abs(se)+Math.abs(be))<B*(Math.abs(H)*(Math.abs(E.get(je-1,je-1))+Math.abs(ue)+Math.abs(E.get(je+1,je+1))))));)je--;for(Y=je+2;Y<=A;Y++)E.set(Y,Y-2,0),Y>je+2&&E.set(Y,Y-3,0);for(Pe=je;Pe<=A-1&&(Ct=Pe!==A-1,Pe!==je&&(H=E.get(Pe,Pe-1),se=E.get(Pe+1,Pe-1),be=Ct?E.get(Pe+2,Pe-1):0,Ie=Math.abs(H)+Math.abs(se)+Math.abs(be),Ie!==0&&(H=H/Ie,se=se/Ie,be=be/Ie)),Ie!==0);Pe++)if(te=Math.sqrt(H*H+se*se+be*be),H<0&&(te=-te),te!==0){for(Pe!==je?E.set(Pe,Pe-1,-te*Ie):Fe!==je&&E.set(Pe,Pe-1,-E.get(Pe,Pe-1)),H=H+te,Ie=H/te,dt=se/te,ue=be/te,se=se/H,be=be/H,me=Pe;me<R;me++)H=E.get(Pe,me)+se*E.get(Pe+1,me),Ct&&(H=H+be*E.get(Pe+2,me),E.set(Pe+2,me,E.get(Pe+2,me)-H*ue)),E.set(Pe,me,E.get(Pe,me)-H*Ie),E.set(Pe+1,me,E.get(Pe+1,me)-H*dt);for(Y=0;Y<=Math.min(A,Pe+3);Y++)H=Ie*E.get(Y,Pe)+dt*E.get(Y,Pe+1),Ct&&(H=H+ue*E.get(Y,Pe+2),E.set(Y,Pe+2,E.get(Y,Pe+2)-H*be)),E.set(Y,Pe,E.get(Y,Pe)-H),E.set(Y,Pe+1,E.get(Y,Pe+1)-H*se);for(Y=I;Y<=D;Y++)H=Ie*b.get(Y,Pe)+dt*b.get(Y,Pe+1),Ct&&(H=H+ue*b.get(Y,Pe+2),b.set(Y,Pe+2,b.get(Y,Pe+2)-H*be)),b.set(Y,Pe,b.get(Y,Pe)-H),b.set(Y,Pe+1,b.get(Y,Pe+1)-H*se)}}}if(Q!==0){for(A=R-1;A>=0;A--)if(H=x[A],se=M[A],se===0)for(Fe=A,E.set(A,A,1),Y=A-1;Y>=0;Y--){for(Re=E.get(Y,Y)-H,be=0,me=Fe;me<=A;me++)be=be+E.get(Y,me)*E.get(me,A);if(M[Y]<0)ue=Re,te=be;else if(Fe=Y,M[Y]===0?E.set(Y,A,Re!==0?-be/Re:-be/(B*Q)):(Ie=E.get(Y,Y+1),dt=E.get(Y+1,Y),se=(x[Y]-H)*(x[Y]-H)+M[Y]*M[Y],Pt=(Ie*te-ue*be)/se,E.set(Y,A,Pt),E.set(Y+1,A,Math.abs(Ie)>Math.abs(ue)?(-be-Re*Pt)/Ie:(-te-dt*Pt)/ue)),Pt=Math.abs(E.get(Y,A)),B*Pt*Pt>1)for(me=Y;me<=A;me++)E.set(me,A,E.get(me,A)/Pt)}else if(se<0)for(Fe=A-1,Math.abs(E.get(A,A-1))>Math.abs(E.get(A-1,A))?(E.set(A-1,A-1,se/E.get(A,A-1)),E.set(A-1,A,-(E.get(A,A)-H)/E.get(A,A-1))):(it=Tl(0,-E.get(A-1,A),E.get(A-1,A-1)-H,se),E.set(A-1,A-1,it[0]),E.set(A-1,A,it[1])),E.set(A,A-1,0),E.set(A,A,1),Y=A-2;Y>=0;Y--){for(X=0,pe=0,me=Fe;me<=A;me++)X=X+E.get(Y,me)*E.get(me,A-1),pe=pe+E.get(Y,me)*E.get(me,A);if(Re=E.get(Y,Y)-H,M[Y]<0)ue=Re,be=X,te=pe;else if(Fe=Y,M[Y]===0?(it=Tl(-X,-pe,Re,se),E.set(Y,A-1,it[0]),E.set(Y,A,it[1])):(Ie=E.get(Y,Y+1),dt=E.get(Y+1,Y),ke=(x[Y]-H)*(x[Y]-H)+M[Y]*M[Y]-se*se,ve=(x[Y]-H)*2*se,ke===0&&ve===0&&(ke=B*Q*(Math.abs(Re)+Math.abs(se)+Math.abs(Ie)+Math.abs(dt)+Math.abs(ue))),it=Tl(Ie*be-ue*X+se*pe,Ie*te-ue*pe-se*X,ke,ve),E.set(Y,A-1,it[0]),E.set(Y,A,it[1]),Math.abs(Ie)>Math.abs(ue)+Math.abs(se)?(E.set(Y+1,A-1,(-X-Re*E.get(Y,A-1)+se*E.get(Y,A))/Ie),E.set(Y+1,A,(-pe-Re*E.get(Y,A)-se*E.get(Y,A-1))/Ie)):(it=Tl(-be-dt*E.get(Y,A-1),-te-dt*E.get(Y,A),ue,se),E.set(Y+1,A-1,it[0]),E.set(Y+1,A,it[1]))),Pt=Math.max(Math.abs(E.get(Y,A-1)),Math.abs(E.get(Y,A))),B*Pt*Pt>1)for(me=Y;me<=A;me++)E.set(me,A-1,E.get(me,A-1)/Pt),E.set(me,A,E.get(me,A)/Pt)}for(Y=0;Y<R;Y++)if(Y<I||Y>D)for(me=Y;me<R;me++)b.set(Y,me,E.get(Y,me));for(me=R-1;me>=I;me--)for(Y=I;Y<=D;Y++){for(ue=0,Pe=I;Pe<=Math.min(me,D);Pe++)ue=ue+b.get(Y,Pe)*E.get(Pe,me);b.set(Y,me,ue)}}}function Tl(R,M,x,b){let E,A;return Math.abs(x)>Math.abs(b)?(E=b/x,A=x+E*b,[(R+E*M)/A,(M-E*R)/A]):(E=x/b,A=b+E*x,[(E*R+M)/A,(E*M-R)/A])}class Vb{constructor(M){if(M=xt.checkMatrix(M),!M.isSymmetric())throw new Error("Matrix is not symmetric");let x=M,b=x.rows,E=new W(b,b),A=!0,I,D,B;for(D=0;D<b;D++){let z=0;for(B=0;B<D;B++){let Q=0;for(I=0;I<B;I++)Q+=E.get(B,I)*E.get(D,I);Q=(x.get(D,B)-Q)/E.get(B,B),E.set(D,B,Q),z=z+Q*Q}for(z=x.get(D,D)-z,A&&(A=z>0),E.set(D,D,Math.sqrt(Math.max(z,0))),B=D+1;B<b;B++)E.set(D,B,0)}this.L=E,this.positiveDefinite=A}isPositiveDefinite(){return this.positiveDefinite}solve(M){M=xt.checkMatrix(M);let x=this.L,b=x.rows;if(M.rows!==b)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let E=M.columns,A=M.clone(),I,D,B;for(B=0;B<b;B++)for(D=0;D<E;D++){for(I=0;I<B;I++)A.set(B,D,A.get(B,D)-A.get(I,D)*x.get(B,I));A.set(B,D,A.get(B,D)/x.get(B,B))}for(B=b-1;B>=0;B--)for(D=0;D<E;D++){for(I=B+1;I<b;I++)A.set(B,D,A.get(B,D)-A.get(I,D)*x.get(I,B));A.set(B,D,A.get(B,D)/x.get(B,B))}return A}get lowerTriangularMatrix(){return this.L}}class Ub{constructor(M,x={}){M=xt.checkMatrix(M);let{Y:b}=x;const{scaleScores:E=!1,maxIterations:A=1e3,terminationCriteria:I=1e-10}=x;let D;if(b){if(r.isAnyArray(b)&&typeof b[0]=="number"?b=W.columnVector(b):b=xt.checkMatrix(b),b.rows!==M.rows)throw new Error("Y should have the same number of rows as X");D=b.getColumnVector(0)}else D=M.getColumnVector(0);let B=1,z,Q,H,se;for(let be=0;be<A&&B>I;be++)H=M.transpose().mmul(D).div(D.transpose().mmul(D).get(0,0)),H=H.div(H.norm()),z=M.mmul(H).div(H.transpose().mmul(H).get(0,0)),be>0&&(B=z.clone().sub(se).pow(2).sum()),se=z.clone(),b?(Q=b.transpose().mmul(z).div(z.transpose().mmul(z).get(0,0)),Q=Q.div(Q.norm()),D=b.mmul(Q).div(Q.transpose().mmul(Q).get(0,0))):D=z;if(b){let be=M.transpose().mmul(z).div(z.transpose().mmul(z).get(0,0));be=be.div(be.norm());let te=M.clone().sub(z.clone().mmul(be.transpose())),ue=D.transpose().mmul(z).div(z.transpose().mmul(z).get(0,0)),Oe=b.clone().sub(z.clone().mulS(ue.get(0,0)).mmul(Q.transpose()));this.t=z,this.p=be.transpose(),this.w=H.transpose(),this.q=Q,this.u=D,this.s=z.transpose().mmul(z),this.xResidual=te,this.yResidual=Oe,this.betas=ue}else this.w=H.transpose(),this.s=z.transpose().mmul(z).sqrt(),E?this.t=z.clone().div(this.s.get(0,0)):this.t=z,this.xResidual=M.sub(z.mmul(H.transpose()))}}return Je.AbstractMatrix=le,Je.CHO=Vb,Je.CholeskyDecomposition=Vb,Je.DistanceMatrix=he,Je.EVD=Jr,Je.EigenvalueDecomposition=Jr,Je.LU=br,Je.LuDecomposition=br,Je.Matrix=W,Je.MatrixColumnSelectionView=Ue,Je.MatrixColumnView=Ne,Je.MatrixFlipColumnView=Tt,Je.MatrixFlipRowView=fn,Je.MatrixRowSelectionView=Kt,Je.MatrixRowView=At,Je.MatrixSelectionView=Ze,Je.MatrixSubView=yr,Je.MatrixTransposeView=et,Je.NIPALS=Ub,Je.Nipals=Ub,Je.QR=It,Je.QrDecomposition=It,Je.SVD=Wn,Je.SingularValueDecomposition=Wn,Je.SymmetricMatrix=ee,Je.WrapperMatrix1D=mr,Je.WrapperMatrix2D=xt,Je.correlation=Zr,Je.covariance=kl,Je.default=W,Je.determinant=bi,Je.inverse=Vn,Je.linearDependencies=cs,Je.pseudoInverse=dd,Je.solve=wr,Je.wrap=ls,Je}var uh=oq();const uE=nl(uh),ta=uh.Matrix,gC=uh.SingularValueDecomposition;uE.Matrix?uE.Matrix:uh.Matrix;const lq={center:[0,0],linkDistance:50};class pC{constructor(e={}){this.options=e,this.id="mds",this.options=Object.assign(Object.assign({},lq),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericMDSLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericMDSLayout(!0,e,t)})}genericMDSLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{center:a=[0,0],linkDistance:s=50}=i,o=t.getAllNodes(),l=t.getAllEdges();if(!(o!=null&&o.length)||o.length===1)return rs(t,e,a);const u=uC({nodes:o,edges:l}),c=lC(u);uq(c);const h=Q8(c,s),d=cq(h),f=[];return d.forEach((v,p)=>{const y=cr(o[p]);y.data.x=v[0]+a[0],y.data.y=v[1]+a[1],f.push(y)}),e&&f.forEach(v=>t.mergeNodeData(v.id,{x:v.data.x,y:v.data.y})),{nodes:f,edges:l}})}}const uq=r=>{let e=-999999;r.forEach(t=>{t.forEach(n=>{n!==1/0&&e<n&&(e=n)})}),r.forEach((t,n)=>{t.forEach((i,a)=>{i===1/0&&(r[n][a]=e)})})},cq=r=>{const t=ta.mul(ta.pow(r,2),-.5),n=t.mean("row"),i=t.mean("column"),a=t.mean();t.add(a).subRowVector(n).subColumnVector(i);const s=new gC(t),o=ta.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map(l=>ta.mul([l],[o]).toJSON()[0].splice(0,2))};function Km(r){return!!r.tick&&!!r.stop}const hq={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},dq={center:[0,0],comboPadding:10,treeKey:"combo"};class fq{constructor(e={}){this.options=e,this.id="comboCombined",this.options=Object.assign(Object.assign({},dq),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericComboCombinedLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericComboCombinedLayout(!0,e,t)})}genericComboCombinedLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=this.initVals(Object.assign(Object.assign({},this.options),n)),{center:a,treeKey:s,outerLayout:o}=i,l=t.getAllNodes().filter(k=>!k.data._isCombo),u=t.getAllNodes().filter(k=>k.data._isCombo),c=t.getAllEdges(),h=l==null?void 0:l.length;if(!h||h===1)return rs(t,e,a);const d=[],f=new Map;l.forEach(k=>{f.set(k.id,k)});const g=new Map;u.forEach(k=>{g.set(k.id,k)});const v=new Map,p=this.getInnerGraphs(t,s,f,g,c,i,v);yield Promise.all(p);const y=new Map,m=[],w=new Map;let S=!0;t.getRoots(s).forEach(k=>{const P=v.get(k.id),C=g.get(k.id)||f.get(k.id),N={id:k.id,data:Object.assign(Object.assign({},k.data),{x:P.data.x||C.data.x,y:P.data.y||C.data.y,fx:P.data.fx||C.data.fx,fy:P.data.fy||C.data.fy,mass:P.data.mass||C.data.mass,size:P.data.size})};m.push(N),y.set(k.id,!0),!isNaN(N.data.x)&&N.data.x!==0&&!isNaN(N.data.y)&&N.data.y!==0?S=!1:(N.data.x=Math.random()*100,N.data.y=Math.random()*100),Um(t,[k],L=>{L.id!==k.id&&w.set(L.id,k.id)},"TB",s)});const _=[];c.forEach(k=>{const P=w.get(k.source)||k.source,C=w.get(k.target)||k.target;P!==C&&y.has(P)&&y.has(C)&&_.push({id:k.id,source:P,target:C,data:{}})});let O;if(m!=null&&m.length){if(m.length===1)m[0].data.x=a[0],m[0].data.y=a[1];else{const k=new dn({nodes:m,edges:_}),P=o||new fC;S&&hq[P.id]&&(yield(m.length<100?new pC:new Ym).assign(k));const C=Object.assign({center:a,kg:5,preventOverlap:!0,animate:!1},P.id==="force"?{gravity:1,factor:4,linkDistance:(N,L,F)=>{const G=Math.max(...L.data.size)||32,V=Math.max(...F.data.size)||32;return G/2+V/2+200}}:{});O=yield cE(P,k,C)}v.forEach(k=>{var P;const C=O.nodes.find(F=>F.id===k.id);if(C){const{x:F,y:G}=C.data;k.data.visited=!0,k.data.x=F,k.data.y=G,d.push({id:k.id,data:{x:F,y:G}})}const{x:N,y:L}=k.data;(P=k.data.nodes)===null||P===void 0||P.forEach(F=>{d.push({id:F.id,data:{x:F.data.x+N,y:F.data.y+L}})})}),v.forEach(({data:k})=>{const{x:P,y:C,visited:N,nodes:L}=k;L==null||L.forEach(F=>{if(!N){const G=d.find(V=>V.id===F.id);G.data.x+=P||0,G.data.y+=C||0}})})}return e&&d.forEach(k=>{t.mergeNodeData(k.id,{x:k.data.x,y:k.data.y})}),{nodes:d,edges:c}})}initVals(e){const t=Object.assign({},e),{nodeSize:n,spacing:i,comboPadding:a}=e;let s,o;if(_e(i)?o=()=>i:Te(i)?o=i:o=()=>0,t.spacing=o,!n)s=u=>{const c=o(u);return u.size?Oi(u.size)?((u.size[0]>u.size[1]?u.size[0]:u.size[1])+c)/2:Yt(u.size)?((u.size.width>u.size.height?u.size.width:u.size.height)+c)/2:(u.size+c)/2:32+c/2};else if(Te(n))s=u=>{const c=n(u),h=o(u);return Oi(u.size)?((u.size[0]>u.size[1]?u.size[0]:u.size[1])+h)/2:((c||32)+h)/2};else if(Oi(n)){const c=(n[0]>n[1]?n[0]:n[1])/2;s=h=>c+o(h)/2}else{const u=n/2;s=c=>u+o(c)/2}t.nodeSize=s;let l;return _e(a)?l=()=>a:Oi(a)?l=()=>Math.max.apply(null,a):Te(a)?l=a:l=()=>0,t.comboPadding=l,t}getInnerGraphs(e,t,n,i,a,s,o){const{nodeSize:l,comboPadding:u,spacing:c,innerLayout:h}=s,d=h||new Ym({}),f={center:[0,0],preventOverlap:!0,nodeSpacing:c},g=[],v=p=>{let y=(u==null?void 0:u(p))||10;return Oi(y)&&(y=Math.max(...y)),{size:y?[y*2,y*2]:[30,30],padding:y}};return e.getRoots(t).forEach(p=>{o.set(p.id,{id:p.id,data:{nodes:[],size:v(p).size}});let y=Promise.resolve();Um(e,[p],m=>{var w;if(!m.data._isCombo)return;const{size:S,padding:_}=v(m);if(!(!((w=e.getChildren(m.id,t))===null||w===void 0)&&w.length))o.set(m.id,{id:m.id,data:Object.assign(Object.assign({},m.data),{size:S})});else{const O=o.get(m.id);o.set(m.id,{id:m.id,data:Object.assign({nodes:[]},O==null?void 0:O.data)});const T=new Map,k=e.getChildren(m.id,t).map(N=>{if(N.data._isCombo)return o.has(N.id)||o.set(N.id,{id:N.id,data:Object.assign({},N.data)}),T.set(N.id,!0),o.get(N.id);const L=n.get(N.id)||i.get(N.id);return T.set(N.id,!0),{id:N.id,data:Object.assign(Object.assign({},L.data),N.data)}}),P={nodes:k,edges:a.filter(N=>T.has(N.source)&&T.has(N.target))};let C=1/0;k.forEach(N=>{var L;let{size:F}=N.data;F||(F=((L=o.get(N.id))===null||L===void 0?void 0:L.data.size)||(l==null?void 0:l(N))||[30,30]),_e(F)&&(F=[F,F]);const[G,V]=F;C>G&&(C=G),C>V&&(C=V),N.data.size=F}),y=y.then(()=>Ye(this,void 0,void 0,function*(){const N=new dn(P);yield cE(d,N,f,!0);const{minX:L,minY:F,maxX:G,maxY:V}=e9(k),U={x:(G+L)/2,y:(V+F)/2};P.nodes.forEach(j=>{j.data.x-=U.x,j.data.y-=U.y});const $=[Math.max(G-L,C)+_*2,Math.max(V-F,C)+_*2];o.get(m.id).data.size=$,o.get(m.id).data.nodes=k}))}return!0},"BT",t),g.push(y)}),g}}function cE(r,e,t,n){var i;return Ye(this,void 0,void 0,function*(){return Km(r)?(r.execute(e,t),r.stop(),r.tick((i=t.iterations)!==null&&i!==void 0?i:300)):n?yield r.assign(e,t):yield r.execute(e,t)})}function gq(r,e){var t,n=1;r==null&&(r=0),e==null&&(e=0);function i(){var a,s=t.length,o,l=0,u=0;for(a=0;a<s;++a)o=t[a],l+=o.x,u+=o.y;for(l=(l/s-r)*n,u=(u/s-e)*n,a=0;a<s;++a)o=t[a],o.x-=l,o.y-=u}return i.initialize=function(a){t=a},i.x=function(a){return arguments.length?(r=+a,i):r},i.y=function(a){return arguments.length?(e=+a,i):e},i.strength=function(a){return arguments.length?(n=+a,i):n},i}function cn(r){return function(){return r}}function na(r){return(r()-.5)*1e-6}function pq(r){return r.x+r.vx}function vq(r){return r.y+r.vy}function yq(r){var e,t,n,i=1,a=1;typeof r!="function"&&(r=cn(r==null?1:+r));function s(){for(var u,c=e.length,h,d,f,g,v,p,y=0;y<a;++y)for(h=lh(e,pq,vq).visitAfter(o),u=0;u<c;++u)d=e[u],v=t[d.index],p=v*v,f=d.x+d.vx,g=d.y+d.vy,h.visit(m);function m(w,S,_,O,T){var k=w.data,P=w.r,C=v+P;if(k){if(k.index>d.index){var N=f-k.x-k.vx,L=g-k.y-k.vy,F=N*N+L*L;F<C*C&&(N===0&&(N=na(n),F+=N*N),L===0&&(L=na(n),F+=L*L),F=(C-(F=Math.sqrt(F)))/F*i,d.vx+=(N*=F)*(C=(P*=P)/(p+P)),d.vy+=(L*=F)*C,k.vx-=N*(C=1-C),k.vy-=L*C)}return}return S>f+C||O<f-C||_>g+C||T<g-C}}function o(u){if(u.data)return u.r=t[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(e){var u,c=e.length,h;for(t=new Array(c),u=0;u<c;++u)h=e[u],t[h.index]=+r(h,u,e)}}return s.initialize=function(u,c){e=u,n=c,l()},s.iterations=function(u){return arguments.length?(a=+u,s):a},s.strength=function(u){return arguments.length?(i=+u,s):i},s.radius=function(u){return arguments.length?(r=typeof u=="function"?u:cn(+u),l(),s):r},s}function mq(r){return r.index}function hE(r,e){var t=r.get(e);if(!t)throw new Error("node not found: "+e);return t}function bq(r){var e=mq,t=h,n,i=cn(30),a,s,o,l,u,c=1;r==null&&(r=[]);function h(p){return 1/Math.min(o[p.source.index],o[p.target.index])}function d(p){for(var y=0,m=r.length;y<c;++y)for(var w=0,S,_,O,T,k,P,C;w<m;++w)S=r[w],_=S.source,O=S.target,T=O.x+O.vx-_.x-_.vx||na(u),k=O.y+O.vy-_.y-_.vy||na(u),P=Math.sqrt(T*T+k*k),P=(P-a[w])/P*p*n[w],T*=P,k*=P,O.vx-=T*(C=l[w]),O.vy-=k*C,_.vx+=T*(C=1-C),_.vy+=k*C}function f(){if(s){var p,y=s.length,m=r.length,w=new Map(s.map((_,O)=>[e(_,O,s),_])),S;for(p=0,o=new Array(y);p<m;++p)S=r[p],S.index=p,typeof S.source!="object"&&(S.source=hE(w,S.source)),typeof S.target!="object"&&(S.target=hE(w,S.target)),o[S.source.index]=(o[S.source.index]||0)+1,o[S.target.index]=(o[S.target.index]||0)+1;for(p=0,l=new Array(m);p<m;++p)S=r[p],l[p]=o[S.source.index]/(o[S.source.index]+o[S.target.index]);n=new Array(m),g(),a=new Array(m),v()}}function g(){if(s)for(var p=0,y=r.length;p<y;++p)n[p]=+t(r[p],p,r)}function v(){if(s)for(var p=0,y=r.length;p<y;++p)a[p]=+i(r[p],p,r)}return d.initialize=function(p,y){s=p,u=y,f()},d.links=function(p){return arguments.length?(r=p,f(),d):r},d.id=function(p){return arguments.length?(e=p,d):e},d.iterations=function(p){return arguments.length?(c=+p,d):c},d.strength=function(p){return arguments.length?(t=typeof p=="function"?p:cn(+p),g(),d):t},d.distance=function(p){return arguments.length?(i=typeof p=="function"?p:cn(+p),v(),d):i},d}var wq={value:()=>{}};function vC(){for(var r=0,e=arguments.length,t={},n;r<e;++r){if(!(n=arguments[r]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new Du(t)}function Du(r){this._=r}function xq(r,e){return r.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}Du.prototype=vC.prototype={constructor:Du,on:function(r,e){var t=this._,n=xq(r+"",t),i,a=-1,s=n.length;if(arguments.length<2){for(;++a<s;)if((i=(r=n[a]).type)&&(i=Eq(t[i],r.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(r=n[a]).type)t[i]=dE(t[i],r.name,e);else if(e==null)for(i in t)t[i]=dE(t[i],r.name,null);return this},copy:function(){var r={},e=this._;for(var t in e)r[t]=e[t].slice();return new Du(r)},call:function(r,e){if((i=arguments.length-2)>0)for(var t=new Array(i),n=0,i,a;n<i;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(a=this._[r],n=0,i=a.length;n<i;++n)a[n].value.apply(e,t)},apply:function(r,e,t){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var n=this._[r],i=0,a=n.length;i<a;++i)n[i].value.apply(e,t)}};function Eq(r,e){for(var t=0,n=r.length,i;t<n;++t)if((i=r[t]).name===e)return i.value}function dE(r,e,t){for(var n=0,i=r.length;n<i;++n)if(r[n].name===e){r[n]=wq,r=r.slice(0,n).concat(r.slice(n+1));break}return t!=null&&r.push({name:e,value:t}),r}var js=0,xo=0,co=0,yC=1e3,yc,Eo,mc=0,Ka=0,ch=0,Ko=typeof performance=="object"&&performance.now?performance:Date,mC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function bC(){return Ka||(mC(Sq),Ka=Ko.now()+ch)}function Sq(){Ka=0}function Zm(){this._call=this._time=this._next=null}Zm.prototype=wC.prototype={constructor:Zm,restart:function(r,e,t){if(typeof r!="function")throw new TypeError("callback is not a function");t=(t==null?bC():+t)+(e==null?0:+e),!this._next&&Eo!==this&&(Eo?Eo._next=this:yc=this,Eo=this),this._call=r,this._time=t,Jm()},stop:function(){this._call&&(this._call=null,this._time=1/0,Jm())}};function wC(r,e,t){var n=new Zm;return n.restart(r,e,t),n}function _q(){bC(),++js;for(var r=yc,e;r;)(e=Ka-r._time)>=0&&r._call.call(void 0,e),r=r._next;--js}function fE(){Ka=(mc=Ko.now())+ch,js=xo=0;try{_q()}finally{js=0,Oq(),Ka=0}}function Mq(){var r=Ko.now(),e=r-mc;e>yC&&(ch-=e,mc=r)}function Oq(){for(var r,e=yc,t,n=1/0;e;)e._call?(n>e._time&&(n=e._time),r=e,e=e._next):(t=e._next,e._next=null,e=r?r._next=t:yc=t);Eo=r,Jm(n)}function Jm(r){if(!js){xo&&(xo=clearTimeout(xo));var e=r-Ka;e>24?(r<1/0&&(xo=setTimeout(fE,r-Ko.now()-ch)),co&&(co=clearInterval(co))):(co||(mc=Ko.now(),co=setInterval(Mq,yC)),js=1,mC(fE))}}const kq=1664525,Tq=1013904223,gE=4294967296;function Aq(){let r=1;return()=>(r=(kq*r+Tq)%gE)/gE}function Pq(r){return r.x}function Cq(r){return r.y}var Nq=10,Rq=Math.PI*(3-Math.sqrt(5));function Lq(r){var e,t=1,n=.001,i=1-Math.pow(n,1/300),a=0,s=.6,o=new Map,l=wC(h),u=vC("tick","end"),c=Aq();r==null&&(r=[]);function h(){d(),u.call("tick",e),t<n&&(l.stop(),u.call("end",e))}function d(v){var p,y=r.length,m;v===void 0&&(v=1);for(var w=0;w<v;++w)for(t+=(a-t)*i,o.forEach(function(S){S(t)}),p=0;p<y;++p)m=r[p],m.fx==null?m.x+=m.vx*=s:(m.x=m.fx,m.vx=0),m.fy==null?m.y+=m.vy*=s:(m.y=m.fy,m.vy=0);return e}function f(){for(var v=0,p=r.length,y;v<p;++v){if(y=r[v],y.index=v,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var m=Nq*Math.sqrt(.5+v),w=v*Rq;y.x=m*Math.cos(w),y.y=m*Math.sin(w)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(v){return v.initialize&&v.initialize(r,c),v}return f(),e={tick:d,restart:function(){return l.restart(h),e},stop:function(){return l.stop(),e},nodes:function(v){return arguments.length?(r=v,f(),o.forEach(g),e):r},alpha:function(v){return arguments.length?(t=+v,e):t},alphaMin:function(v){return arguments.length?(n=+v,e):n},alphaDecay:function(v){return arguments.length?(i=+v,e):+i},alphaTarget:function(v){return arguments.length?(a=+v,e):a},velocityDecay:function(v){return arguments.length?(s=1-v,e):1-s},randomSource:function(v){return arguments.length?(c=v,o.forEach(g),e):c},force:function(v,p){return arguments.length>1?(p==null?o.delete(v):o.set(v,g(p)),e):o.get(v)},find:function(v,p,y){var m=0,w=r.length,S,_,O,T,k;for(y==null?y=1/0:y*=y,m=0;m<w;++m)T=r[m],S=v-T.x,_=p-T.y,O=S*S+_*_,O<y&&(k=T,y=O);return k},on:function(v,p){return arguments.length>1?(u.on(v,p),e):u.on(v)}}}function Iq(){var r,e,t,n,i=cn(-30),a,s=1,o=1/0,l=.81;function u(f){var g,v=r.length,p=lh(r,Pq,Cq).visitAfter(h);for(n=f,g=0;g<v;++g)e=r[g],p.visit(d)}function c(){if(r){var f,g=r.length,v;for(a=new Array(g),f=0;f<g;++f)v=r[f],a[v.index]=+i(v,f,r)}}function h(f){var g=0,v,p,y=0,m,w,S;if(f.length){for(m=w=S=0;S<4;++S)(v=f[S])&&(p=Math.abs(v.value))&&(g+=v.value,y+=p,m+=p*v.x,w+=p*v.y);f.x=m/y,f.y=w/y}else{v=f,v.x=v.data.x,v.y=v.data.y;do g+=a[v.data.index];while(v=v.next)}f.value=g}function d(f,g,v,p){if(!f.value)return!0;var y=f.x-e.x,m=f.y-e.y,w=p-g,S=y*y+m*m;if(w*w/l<S)return S<o&&(y===0&&(y=na(t),S+=y*y),m===0&&(m=na(t),S+=m*m),S<s&&(S=Math.sqrt(s*S)),e.vx+=y*f.value*n/S,e.vy+=m*f.value*n/S),!0;if(f.length||S>=o)return;(f.data!==e||f.next)&&(y===0&&(y=na(t),S+=y*y),m===0&&(m=na(t),S+=m*m),S<s&&(S=Math.sqrt(s*S)));do f.data!==e&&(w=a[f.data.index]*n/S,e.vx+=y*w,e.vy+=m*w);while(f=f.next)}return u.initialize=function(f,g){r=f,t=g,c()},u.strength=function(f){return arguments.length?(i=typeof f=="function"?f:cn(+f),c(),u):i},u.distanceMin=function(f){return arguments.length?(s=f*f,u):Math.sqrt(s)},u.distanceMax=function(f){return arguments.length?(o=f*f,u):Math.sqrt(o)},u.theta=function(f){return arguments.length?(l=f*f,u):Math.sqrt(l)},u}function Dq(r,e,t){var n,i=cn(.1),a,s;typeof r!="function"&&(r=cn(+r)),e==null&&(e=0),t==null&&(t=0);function o(u){for(var c=0,h=n.length;c<h;++c){var d=n[c],f=d.x-e||1e-6,g=d.y-t||1e-6,v=Math.sqrt(f*f+g*g),p=(s[c]-v)*a[c]*u/v;d.vx+=f*p,d.vy+=g*p}}function l(){if(n){var u,c=n.length;for(a=new Array(c),s=new Array(c),u=0;u<c;++u)s[u]=+r(n[u],u,n),a[u]=isNaN(s[u])?0:+i(n[u],u,n)}}return o.initialize=function(u){n=u,l()},o.strength=function(u){return arguments.length?(i=typeof u=="function"?u:cn(+u),l(),o):i},o.radius=function(u){return arguments.length?(r=typeof u=="function"?u:cn(+u),l(),o):r},o.x=function(u){return arguments.length?(e=+u,o):e},o.y=function(u){return arguments.length?(t=+u,o):t},o}function Fq(r){var e=cn(.1),t,n,i;typeof r!="function"&&(r=cn(r==null?0:+r));function a(o){for(var l=0,u=t.length,c;l<u;++l)c=t[l],c.vx+=(i[l]-c.x)*n[l]*o}function s(){if(t){var o,l=t.length;for(n=new Array(l),i=new Array(l),o=0;o<l;++o)n[o]=isNaN(i[o]=+r(t[o],o,t))?0:+e(t[o],o,t)}}return a.initialize=function(o){t=o,s()},a.strength=function(o){return arguments.length?(e=typeof o=="function"?o:cn(+o),s(),a):e},a.x=function(o){return arguments.length?(r=typeof o=="function"?o:cn(+o),s(),a):r},a}function Bq(r){var e=cn(.1),t,n,i;typeof r!="function"&&(r=cn(r==null?0:+r));function a(o){for(var l=0,u=t.length,c;l<u;++l)c=t[l],c.vy+=(i[l]-c.y)*n[l]*o}function s(){if(t){var o,l=t.length;for(n=new Array(l),i=new Array(l),o=0;o<l;++o)n[o]=isNaN(i[o]=+r(t[o],o,t))?0:+e(t[o],o,t)}}return a.initialize=function(o){t=o,s()},a.strength=function(o){return arguments.length?(e=typeof o=="function"?o:cn(+o),s(),a):e},a.y=function(o){return arguments.length?(r=typeof o=="function"?o:cn(+o),s(),a):r},a}class zq{constructor(e){this.id="d3-force",this.config={inputNodeAttrs:["x","y","vx","vy","fx","fy"],outputNodeAttrs:["x","y","vx","vy"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource"]},this.forceMap={link:bq,manyBody:Iq,center:gq,collide:yq,radial:Dq,x:Fq,y:Bq},this.options={link:{id:t=>t.id},manyBody:{},center:{x:0,y:0}},this.context={options:{},assign:!1,nodes:[],edges:[]},$n(this.options,e),this.options.forceSimulation&&(this.simulation=this.options.forceSimulation)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericLayout(!0,e,t)})}stop(){this.simulation.stop()}tick(e){return this.simulation.tick(e),this.getResult()}restart(){this.simulation.restart()}setFixedPosition(e,t){const n=this.context.nodes.find(i=>i.id===e);n&&t.forEach((i,a)=>{if(typeof i=="number"||i===null){const s=["fx","fy","fz"][a];n[s]=i}})}getOptions(e){var t,n;const i=$n({},this.options,e);return i.collide&&((t=i.collide)===null||t===void 0?void 0:t.radius)===void 0&&(i.collide=i.collide||{},i.collide.radius=(n=i.nodeSize)!==null&&n!==void 0?n:10),i.iterations===void 0&&(i.link&&i.link.iterations===void 0&&(i.iterations=i.link.iterations),i.collide&&i.collide.iterations===void 0&&(i.iterations=i.collide.iterations)),this.context.options=i,i}genericLayout(e,t,n){var i;return Ye(this,void 0,void 0,function*(){const a=this.getOptions(n),s=t.getAllNodes().map(({id:c,data:h})=>Object.assign(Object.assign({id:c},h),Ga(h.data,this.config.inputNodeAttrs))),o=t.getAllEdges().map(c=>Object.assign({},c));Object.assign(this.context,{assign:e,nodes:s,edges:o,graph:t});const l=new Promise(c=>{this.resolver=c}),u=this.setSimulation(a);return u.nodes(s),(i=u.force("link"))===null||i===void 0||i.links(o),l})}getResult(){const{assign:e,nodes:t,edges:n,graph:i}=this.context,a=t.map(o=>({id:o.id,data:Object.assign(Object.assign({},o.data),Ga(o,this.config.outputNodeAttrs))})),s=n.map(({id:o,source:l,target:u,data:c})=>({id:o,source:typeof l=="object"?l.id:l,target:typeof u=="object"?u.id:u,data:c}));return e&&a.forEach(o=>i.mergeNodeData(o.id,o.data)),{nodes:a,edges:s}}initSimulation(){return Lq()}setSimulation(e){const t=this.simulation||this.options.forceSimulation||this.initSimulation();return this.simulation||(this.simulation=t.on("tick",()=>{var n;return(n=e.onTick)===null||n===void 0?void 0:n.call(e,this.getResult())}).on("end",()=>{var n;return(n=this.resolver)===null||n===void 0?void 0:n.call(this,this.getResult())})),pE(t,this.config.simulationAttrs.map(n=>[n,e[n]])),Object.entries(this.forceMap).forEach(([n,i])=>{const a=n;if(e[n]){let s=t.force(a);s||(s=i(),t.force(a,s)),pE(s,Object.entries(e[a]))}else t.force(a,null)}),t}}const pE=(r,e)=>e.reduce((t,[n,i])=>!t[n]||i===void 0?t:t[n].call(r,i),r);function sb(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var vf,vE;function jq(){if(vE)return vf;vE=1;function r(){this.__data__=[],this.size=0}return vf=r,vf}var yf,yE;function Hs(){if(yE)return yf;yE=1;function r(e,t){return e===t||e!==e&&t!==t}return yf=r,yf}var mf,mE;function hh(){if(mE)return mf;mE=1;var r=Hs();function e(t,n){for(var i=t.length;i--;)if(r(t[i][0],n))return i;return-1}return mf=e,mf}var bf,bE;function qq(){if(bE)return bf;bE=1;var r=hh(),e=Array.prototype,t=e.splice;function n(i){var a=this.__data__,s=r(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():t.call(a,s,1),--this.size,!0}return bf=n,bf}var wf,wE;function $q(){if(wE)return wf;wE=1;var r=hh();function e(t){var n=this.__data__,i=r(n,t);return i<0?void 0:n[i][1]}return wf=e,wf}var xf,xE;function Gq(){if(xE)return xf;xE=1;var r=hh();function e(t){return r(this.__data__,t)>-1}return xf=e,xf}var Ef,EE;function Wq(){if(EE)return Ef;EE=1;var r=hh();function e(t,n){var i=this.__data__,a=r(i,t);return a<0?(++this.size,i.push([t,n])):i[a][1]=n,this}return Ef=e,Ef}var Sf,SE;function dh(){if(SE)return Sf;SE=1;var r=jq(),e=qq(),t=$q(),n=Gq(),i=Wq();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=r,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=n,a.prototype.set=i,Sf=a,Sf}var _f,_E;function Vq(){if(_E)return _f;_E=1;var r=dh();function e(){this.__data__=new r,this.size=0}return _f=e,_f}var Mf,ME;function Uq(){if(ME)return Mf;ME=1;function r(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}return Mf=r,Mf}var Of,OE;function Hq(){if(OE)return Of;OE=1;function r(e){return this.__data__.get(e)}return Of=r,Of}var kf,kE;function Yq(){if(kE)return kf;kE=1;function r(e){return this.__data__.has(e)}return kf=r,kf}var Tf,TE;function xC(){if(TE)return Tf;TE=1;var r=typeof Nl=="object"&&Nl&&Nl.Object===Object&&Nl;return Tf=r,Tf}var Af,AE;function Ur(){if(AE)return Af;AE=1;var r=xC(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=r||e||Function("return this")();return Af=t,Af}var Pf,PE;function Ys(){if(PE)return Pf;PE=1;var r=Ur(),e=r.Symbol;return Pf=e,Pf}var Cf,CE;function Xq(){if(CE)return Cf;CE=1;var r=Ys(),e=Object.prototype,t=e.hasOwnProperty,n=e.toString,i=r?r.toStringTag:void 0;function a(s){var o=t.call(s,i),l=s[i];try{s[i]=void 0;var u=!0}catch{}var c=n.call(s);return u&&(o?s[i]=l:delete s[i]),c}return Cf=a,Cf}var Nf,NE;function Kq(){if(NE)return Nf;NE=1;var r=Object.prototype,e=r.toString;function t(n){return e.call(n)}return Nf=t,Nf}var Rf,RE;function is(){if(RE)return Rf;RE=1;var r=Ys(),e=Xq(),t=Kq(),n="[object Null]",i="[object Undefined]",a=r?r.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?e(o):t(o)}return Rf=s,Rf}var Lf,LE;function Pr(){if(LE)return Lf;LE=1;function r(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return Lf=r,Lf}var If,IE;function ml(){if(IE)return If;IE=1;var r=is(),e=Pr(),t="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!e(o))return!1;var l=r(o);return l==n||l==i||l==t||l==a}return If=s,If}var Df,DE;function Zq(){if(DE)return Df;DE=1;var r=Ur(),e=r["__core-js_shared__"];return Df=e,Df}var Ff,FE;function Jq(){if(FE)return Ff;FE=1;var r=Zq(),e=function(){var n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function t(n){return!!e&&e in n}return Ff=t,Ff}var Bf,BE;function EC(){if(BE)return Bf;BE=1;var r=Function.prototype,e=r.toString;function t(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return Bf=t,Bf}var zf,zE;function Qq(){if(zE)return zf;zE=1;var r=ml(),e=Jq(),t=Pr(),n=EC(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,l=s.toString,u=o.hasOwnProperty,c=RegExp("^"+l.call(u).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(d){if(!t(d)||e(d))return!1;var f=r(d)?c:a;return f.test(n(d))}return zf=h,zf}var jf,jE;function e$(){if(jE)return jf;jE=1;function r(e,t){return e==null?void 0:e[t]}return jf=r,jf}var qf,qE;function as(){if(qE)return qf;qE=1;var r=Qq(),e=e$();function t(n,i){var a=e(n,i);return r(a)?a:void 0}return qf=t,qf}var $f,$E;function ob(){if($E)return $f;$E=1;var r=as(),e=Ur(),t=r(e,"Map");return $f=t,$f}var Gf,GE;function fh(){if(GE)return Gf;GE=1;var r=as(),e=r(Object,"create");return Gf=e,Gf}var Wf,WE;function t$(){if(WE)return Wf;WE=1;var r=fh();function e(){this.__data__=r?r(null):{},this.size=0}return Wf=e,Wf}var Vf,VE;function n$(){if(VE)return Vf;VE=1;function r(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return Vf=r,Vf}var Uf,UE;function r$(){if(UE)return Uf;UE=1;var r=fh(),e="__lodash_hash_undefined__",t=Object.prototype,n=t.hasOwnProperty;function i(a){var s=this.__data__;if(r){var o=s[a];return o===e?void 0:o}return n.call(s,a)?s[a]:void 0}return Uf=i,Uf}var Hf,HE;function i$(){if(HE)return Hf;HE=1;var r=fh(),e=Object.prototype,t=e.hasOwnProperty;function n(i){var a=this.__data__;return r?a[i]!==void 0:t.call(a,i)}return Hf=n,Hf}var Yf,YE;function a$(){if(YE)return Yf;YE=1;var r=fh(),e="__lodash_hash_undefined__";function t(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=r&&i===void 0?e:i,this}return Yf=t,Yf}var Xf,XE;function s$(){if(XE)return Xf;XE=1;var r=t$(),e=n$(),t=r$(),n=i$(),i=a$();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=r,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=n,a.prototype.set=i,Xf=a,Xf}var Kf,KE;function o$(){if(KE)return Kf;KE=1;var r=s$(),e=dh(),t=ob();function n(){this.size=0,this.__data__={hash:new r,map:new(t||e),string:new r}}return Kf=n,Kf}var Zf,ZE;function l$(){if(ZE)return Zf;ZE=1;function r(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return Zf=r,Zf}var Jf,JE;function gh(){if(JE)return Jf;JE=1;var r=l$();function e(t,n){var i=t.__data__;return r(n)?i[typeof n=="string"?"string":"hash"]:i.map}return Jf=e,Jf}var Qf,QE;function u$(){if(QE)return Qf;QE=1;var r=gh();function e(t){var n=r(this,t).delete(t);return this.size-=n?1:0,n}return Qf=e,Qf}var eg,e2;function c$(){if(e2)return eg;e2=1;var r=gh();function e(t){return r(this,t).get(t)}return eg=e,eg}var tg,t2;function h$(){if(t2)return tg;t2=1;var r=gh();function e(t){return r(this,t).has(t)}return tg=e,tg}var ng,n2;function d$(){if(n2)return ng;n2=1;var r=gh();function e(t,n){var i=r(this,t),a=i.size;return i.set(t,n),this.size+=i.size==a?0:1,this}return ng=e,ng}var rg,r2;function lb(){if(r2)return rg;r2=1;var r=o$(),e=u$(),t=c$(),n=h$(),i=d$();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=r,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=n,a.prototype.set=i,rg=a,rg}var ig,i2;function f$(){if(i2)return ig;i2=1;var r=dh(),e=ob(),t=lb(),n=200;function i(a,s){var o=this.__data__;if(o instanceof r){var l=o.__data__;if(!e||l.length<n-1)return l.push([a,s]),this.size=++o.size,this;o=this.__data__=new t(l)}return o.set(a,s),this.size=o.size,this}return ig=i,ig}var ag,a2;function ph(){if(a2)return ag;a2=1;var r=dh(),e=Vq(),t=Uq(),n=Hq(),i=Yq(),a=f$();function s(o){var l=this.__data__=new r(o);this.size=l.size}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,ag=s,ag}var sg,s2;function ub(){if(s2)return sg;s2=1;function r(e,t){for(var n=-1,i=e==null?0:e.length;++n<i&&t(e[n],n,e)!==!1;);return e}return sg=r,sg}var og,o2;function SC(){if(o2)return og;o2=1;var r=as(),e=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch{}}();return og=e,og}var lg,l2;function vh(){if(l2)return lg;l2=1;var r=SC();function e(t,n,i){n=="__proto__"&&r?r(t,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[n]=i}return lg=e,lg}var ug,u2;function yh(){if(u2)return ug;u2=1;var r=vh(),e=Hs(),t=Object.prototype,n=t.hasOwnProperty;function i(a,s,o){var l=a[s];(!(n.call(a,s)&&e(l,o))||o===void 0&&!(s in a))&&r(a,s,o)}return ug=i,ug}var cg,c2;function bl(){if(c2)return cg;c2=1;var r=yh(),e=vh();function t(n,i,a,s){var o=!a;a||(a={});for(var l=-1,u=i.length;++l<u;){var c=i[l],h=s?s(a[c],n[c],c,a,n):void 0;h===void 0&&(h=n[c]),o?e(a,c,h):r(a,c,h)}return a}return cg=t,cg}var hg,h2;function g$(){if(h2)return hg;h2=1;function r(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}return hg=r,hg}var dg,d2;function mi(){if(d2)return dg;d2=1;function r(e){return e!=null&&typeof e=="object"}return dg=r,dg}var fg,f2;function p$(){if(f2)return fg;f2=1;var r=is(),e=mi(),t="[object Arguments]";function n(i){return e(i)&&r(i)==t}return fg=n,fg}var gg,g2;function wl(){if(g2)return gg;g2=1;var r=p$(),e=mi(),t=Object.prototype,n=t.hasOwnProperty,i=t.propertyIsEnumerable,a=r(function(){return arguments}())?r:function(s){return e(s)&&n.call(s,"callee")&&!i.call(s,"callee")};return gg=a,gg}var pg,p2;function rn(){if(p2)return pg;p2=1;var r=Array.isArray;return pg=r,pg}var So={exports:{}},vg,v2;function v$(){if(v2)return vg;v2=1;function r(){return!1}return vg=r,vg}So.exports;var y2;function Xs(){return y2||(y2=1,function(r,e){var t=Ur(),n=v$(),i=e&&!e.nodeType&&e,a=i&&!0&&r&&!r.nodeType&&r,s=a&&a.exports===i,o=s?t.Buffer:void 0,l=o?o.isBuffer:void 0,u=l||n;r.exports=u}(So,So.exports)),So.exports}var yg,m2;function mh(){if(m2)return yg;m2=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(n,i){var a=typeof n;return i=i??r,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return yg=t,yg}var mg,b2;function cb(){if(b2)return mg;b2=1;var r=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=r}return mg=e,mg}var bg,w2;function y$(){if(w2)return bg;w2=1;var r=is(),e=cb(),t=mi(),n="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",o="[object Error]",l="[object Function]",u="[object Map]",c="[object Number]",h="[object Object]",d="[object RegExp]",f="[object Set]",g="[object String]",v="[object WeakMap]",p="[object ArrayBuffer]",y="[object DataView]",m="[object Float32Array]",w="[object Float64Array]",S="[object Int8Array]",_="[object Int16Array]",O="[object Int32Array]",T="[object Uint8Array]",k="[object Uint8ClampedArray]",P="[object Uint16Array]",C="[object Uint32Array]",N={};N[m]=N[w]=N[S]=N[_]=N[O]=N[T]=N[k]=N[P]=N[C]=!0,N[n]=N[i]=N[p]=N[a]=N[y]=N[s]=N[o]=N[l]=N[u]=N[c]=N[h]=N[d]=N[f]=N[g]=N[v]=!1;function L(F){return t(F)&&e(F.length)&&!!N[r(F)]}return bg=L,bg}var wg,x2;function bh(){if(x2)return wg;x2=1;function r(e){return function(t){return e(t)}}return wg=r,wg}var _o={exports:{}};_o.exports;var E2;function hb(){return E2||(E2=1,function(r,e){var t=xC(),n=e&&!e.nodeType&&e,i=n&&!0&&r&&!r.nodeType&&r,a=i&&i.exports===n,s=a&&t.process,o=function(){try{var l=i&&i.require&&i.require("util").types;return l||s&&s.binding&&s.binding("util")}catch{}}();r.exports=o}(_o,_o.exports)),_o.exports}var xg,S2;function xl(){if(S2)return xg;S2=1;var r=y$(),e=bh(),t=hb(),n=t&&t.isTypedArray,i=n?e(n):r;return xg=i,xg}var Eg,_2;function _C(){if(_2)return Eg;_2=1;var r=g$(),e=wl(),t=rn(),n=Xs(),i=mh(),a=xl(),s=Object.prototype,o=s.hasOwnProperty;function l(u,c){var h=t(u),d=!h&&e(u),f=!h&&!d&&n(u),g=!h&&!d&&!f&&a(u),v=h||d||f||g,p=v?r(u.length,String):[],y=p.length;for(var m in u)(c||o.call(u,m))&&!(v&&(m=="length"||f&&(m=="offset"||m=="parent")||g&&(m=="buffer"||m=="byteLength"||m=="byteOffset")||i(m,y)))&&p.push(m);return p}return Eg=l,Eg}var Sg,M2;function wh(){if(M2)return Sg;M2=1;var r=Object.prototype;function e(t){var n=t&&t.constructor,i=typeof n=="function"&&n.prototype||r;return t===i}return Sg=e,Sg}var _g,O2;function MC(){if(O2)return _g;O2=1;function r(e,t){return function(n){return e(t(n))}}return _g=r,_g}var Mg,k2;function m$(){if(k2)return Mg;k2=1;var r=MC(),e=r(Object.keys,Object);return Mg=e,Mg}var Og,T2;function db(){if(T2)return Og;T2=1;var r=wh(),e=m$(),t=Object.prototype,n=t.hasOwnProperty;function i(a){if(!r(a))return e(a);var s=[];for(var o in Object(a))n.call(a,o)&&o!="constructor"&&s.push(o);return s}return Og=i,Og}var kg,A2;function Bi(){if(A2)return kg;A2=1;var r=ml(),e=cb();function t(n){return n!=null&&e(n.length)&&!r(n)}return kg=t,kg}var Tg,P2;function wa(){if(P2)return Tg;P2=1;var r=_C(),e=db(),t=Bi();function n(i){return t(i)?r(i):e(i)}return Tg=n,Tg}var Ag,C2;function b$(){if(C2)return Ag;C2=1;var r=bl(),e=wa();function t(n,i){return n&&r(i,e(i),n)}return Ag=t,Ag}var Pg,N2;function w$(){if(N2)return Pg;N2=1;function r(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}return Pg=r,Pg}var Cg,R2;function x$(){if(R2)return Cg;R2=1;var r=Pr(),e=wh(),t=w$(),n=Object.prototype,i=n.hasOwnProperty;function a(s){if(!r(s))return t(s);var o=e(s),l=[];for(var u in s)u=="constructor"&&(o||!i.call(s,u))||l.push(u);return l}return Cg=a,Cg}var Ng,L2;function ss(){if(L2)return Ng;L2=1;var r=_C(),e=x$(),t=Bi();function n(i){return t(i)?r(i,!0):e(i)}return Ng=n,Ng}var Rg,I2;function E$(){if(I2)return Rg;I2=1;var r=bl(),e=ss();function t(n,i){return n&&r(i,e(i),n)}return Rg=t,Rg}var Mo={exports:{}};Mo.exports;var D2;function OC(){return D2||(D2=1,function(r,e){var t=Ur(),n=e&&!e.nodeType&&e,i=n&&!0&&r&&!r.nodeType&&r,a=i&&i.exports===n,s=a?t.Buffer:void 0,o=s?s.allocUnsafe:void 0;function l(u,c){if(c)return u.slice();var h=u.length,d=o?o(h):new u.constructor(h);return u.copy(d),d}r.exports=l}(Mo,Mo.exports)),Mo.exports}var Lg,F2;function kC(){if(F2)return Lg;F2=1;function r(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}return Lg=r,Lg}var Ig,B2;function TC(){if(B2)return Ig;B2=1;function r(e,t){for(var n=-1,i=e==null?0:e.length,a=0,s=[];++n<i;){var o=e[n];t(o,n,e)&&(s[a++]=o)}return s}return Ig=r,Ig}var Dg,z2;function AC(){if(z2)return Dg;z2=1;function r(){return[]}return Dg=r,Dg}var Fg,j2;function fb(){if(j2)return Fg;j2=1;var r=TC(),e=AC(),t=Object.prototype,n=t.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),r(i(s),function(o){return n.call(s,o)}))}:e;return Fg=a,Fg}var Bg,q2;function S$(){if(q2)return Bg;q2=1;var r=bl(),e=fb();function t(n,i){return r(n,e(n),i)}return Bg=t,Bg}var zg,$2;function gb(){if($2)return zg;$2=1;function r(e,t){for(var n=-1,i=t.length,a=e.length;++n<i;)e[a+n]=t[n];return e}return zg=r,zg}var jg,G2;function xh(){if(G2)return jg;G2=1;var r=MC(),e=r(Object.getPrototypeOf,Object);return jg=e,jg}var qg,W2;function PC(){if(W2)return qg;W2=1;var r=gb(),e=xh(),t=fb(),n=AC(),i=Object.getOwnPropertySymbols,a=i?function(s){for(var o=[];s;)r(o,t(s)),s=e(s);return o}:n;return qg=a,qg}var $g,V2;function _$(){if(V2)return $g;V2=1;var r=bl(),e=PC();function t(n,i){return r(n,e(n),i)}return $g=t,$g}var Gg,U2;function CC(){if(U2)return Gg;U2=1;var r=gb(),e=rn();function t(n,i,a){var s=i(n);return e(n)?s:r(s,a(n))}return Gg=t,Gg}var Wg,H2;function NC(){if(H2)return Wg;H2=1;var r=CC(),e=fb(),t=wa();function n(i){return r(i,t,e)}return Wg=n,Wg}var Vg,Y2;function M$(){if(Y2)return Vg;Y2=1;var r=CC(),e=PC(),t=ss();function n(i){return r(i,t,e)}return Vg=n,Vg}var Ug,X2;function O$(){if(X2)return Ug;X2=1;var r=as(),e=Ur(),t=r(e,"DataView");return Ug=t,Ug}var Hg,K2;function k$(){if(K2)return Hg;K2=1;var r=as(),e=Ur(),t=r(e,"Promise");return Hg=t,Hg}var Yg,Z2;function RC(){if(Z2)return Yg;Z2=1;var r=as(),e=Ur(),t=r(e,"Set");return Yg=t,Yg}var Xg,J2;function T$(){if(J2)return Xg;J2=1;var r=as(),e=Ur(),t=r(e,"WeakMap");return Xg=t,Xg}var Kg,Q2;function Ks(){if(Q2)return Kg;Q2=1;var r=O$(),e=ob(),t=k$(),n=RC(),i=T$(),a=is(),s=EC(),o="[object Map]",l="[object Object]",u="[object Promise]",c="[object Set]",h="[object WeakMap]",d="[object DataView]",f=s(r),g=s(e),v=s(t),p=s(n),y=s(i),m=a;return(r&&m(new r(new ArrayBuffer(1)))!=d||e&&m(new e)!=o||t&&m(t.resolve())!=u||n&&m(new n)!=c||i&&m(new i)!=h)&&(m=function(w){var S=a(w),_=S==l?w.constructor:void 0,O=_?s(_):"";if(O)switch(O){case f:return d;case g:return o;case v:return u;case p:return c;case y:return h}return S}),Kg=m,Kg}var Zg,eS;function A$(){if(eS)return Zg;eS=1;var r=Object.prototype,e=r.hasOwnProperty;function t(n){var i=n.length,a=new n.constructor(i);return i&&typeof n[0]=="string"&&e.call(n,"index")&&(a.index=n.index,a.input=n.input),a}return Zg=t,Zg}var Jg,tS;function LC(){if(tS)return Jg;tS=1;var r=Ur(),e=r.Uint8Array;return Jg=e,Jg}var Qg,nS;function pb(){if(nS)return Qg;nS=1;var r=LC();function e(t){var n=new t.constructor(t.byteLength);return new r(n).set(new r(t)),n}return Qg=e,Qg}var ep,rS;function P$(){if(rS)return ep;rS=1;var r=pb();function e(t,n){var i=n?r(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}return ep=e,ep}var tp,iS;function C$(){if(iS)return tp;iS=1;var r=/\w*$/;function e(t){var n=new t.constructor(t.source,r.exec(t));return n.lastIndex=t.lastIndex,n}return tp=e,tp}var np,aS;function N$(){if(aS)return np;aS=1;var r=Ys(),e=r?r.prototype:void 0,t=e?e.valueOf:void 0;function n(i){return t?Object(t.call(i)):{}}return np=n,np}var rp,sS;function IC(){if(sS)return rp;sS=1;var r=pb();function e(t,n){var i=n?r(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}return rp=e,rp}var ip,oS;function R$(){if(oS)return ip;oS=1;var r=pb(),e=P$(),t=C$(),n=N$(),i=IC(),a="[object Boolean]",s="[object Date]",o="[object Map]",l="[object Number]",u="[object RegExp]",c="[object Set]",h="[object String]",d="[object Symbol]",f="[object ArrayBuffer]",g="[object DataView]",v="[object Float32Array]",p="[object Float64Array]",y="[object Int8Array]",m="[object Int16Array]",w="[object Int32Array]",S="[object Uint8Array]",_="[object Uint8ClampedArray]",O="[object Uint16Array]",T="[object Uint32Array]";function k(P,C,N){var L=P.constructor;switch(C){case f:return r(P);case a:case s:return new L(+P);case g:return e(P,N);case v:case p:case y:case m:case w:case S:case _:case O:case T:return i(P,N);case o:return new L;case l:case h:return new L(P);case u:return t(P);case c:return new L;case d:return n(P)}}return ip=k,ip}var ap,lS;function DC(){if(lS)return ap;lS=1;var r=Pr(),e=Object.create,t=function(){function n(){}return function(i){if(!r(i))return{};if(e)return e(i);n.prototype=i;var a=new n;return n.prototype=void 0,a}}();return ap=t,ap}var sp,uS;function FC(){if(uS)return sp;uS=1;var r=DC(),e=xh(),t=wh();function n(i){return typeof i.constructor=="function"&&!t(i)?r(e(i)):{}}return sp=n,sp}var op,cS;function L$(){if(cS)return op;cS=1;var r=Ks(),e=mi(),t="[object Map]";function n(i){return e(i)&&r(i)==t}return op=n,op}var lp,hS;function I$(){if(hS)return lp;hS=1;var r=L$(),e=bh(),t=hb(),n=t&&t.isMap,i=n?e(n):r;return lp=i,lp}var up,dS;function D$(){if(dS)return up;dS=1;var r=Ks(),e=mi(),t="[object Set]";function n(i){return e(i)&&r(i)==t}return up=n,up}var cp,fS;function F$(){if(fS)return cp;fS=1;var r=D$(),e=bh(),t=hb(),n=t&&t.isSet,i=n?e(n):r;return cp=i,cp}var hp,gS;function BC(){if(gS)return hp;gS=1;var r=ph(),e=ub(),t=yh(),n=b$(),i=E$(),a=OC(),s=kC(),o=S$(),l=_$(),u=NC(),c=M$(),h=Ks(),d=A$(),f=R$(),g=FC(),v=rn(),p=Xs(),y=I$(),m=Pr(),w=F$(),S=wa(),_=ss(),O=1,T=2,k=4,P="[object Arguments]",C="[object Array]",N="[object Boolean]",L="[object Date]",F="[object Error]",G="[object Function]",V="[object GeneratorFunction]",U="[object Map]",$="[object Number]",j="[object Object]",Z="[object RegExp]",ne="[object Set]",oe="[object String]",le="[object Symbol]",Ce="[object WeakMap]",K="[object ArrayBuffer]",W="[object DataView]",ee="[object Float32Array]",he="[object Float64Array]",Se="[object Int8Array]",Ne="[object Int16Array]",Ue="[object Int32Array]",Tt="[object Uint8Array]",fn="[object Uint8ClampedArray]",At="[object Uint16Array]",Kt="[object Uint32Array]",Ze={};Ze[P]=Ze[C]=Ze[K]=Ze[W]=Ze[N]=Ze[L]=Ze[ee]=Ze[he]=Ze[Se]=Ze[Ne]=Ze[Ue]=Ze[U]=Ze[$]=Ze[j]=Ze[Z]=Ze[ne]=Ze[oe]=Ze[le]=Ze[Tt]=Ze[fn]=Ze[At]=Ze[Kt]=!0,Ze[F]=Ze[G]=Ze[Ce]=!1;function yr(et,mr,xt,ls,br,Wt){var It,Wn=mr&O,Vn=mr&T,wr=mr&k;if(xt&&(It=br?xt(et,ls,br,Wt):xt(et)),It!==void 0)return It;if(!m(et))return et;var bi=v(et);if(bi){if(It=d(et),!Wn)return s(et,It)}else{var Kr=h(et),us=Kr==G||Kr==V;if(p(et))return a(et,Wn);if(Kr==j||Kr==P||us&&!br){if(It=Vn||us?{}:g(et),!Wn)return Vn?l(et,i(It,et)):o(et,n(It,et))}else{if(!Ze[Kr])return br?et:{};It=f(et,Kr,Wn)}}Wt||(Wt=new r);var cs=Wt.get(et);if(cs)return cs;Wt.set(et,It),w(et)?et.forEach(function(Zr){It.add(yr(Zr,mr,xt,Zr,et,Wt))}):y(et)&&et.forEach(function(Zr,Jr){It.set(Jr,yr(Zr,mr,xt,Jr,et,Wt))});var dd=wr?Vn?c:u:Vn?_:S,kl=bi?void 0:dd(et);return e(kl||et,function(Zr,Jr){kl&&(Jr=Zr,Zr=et[Jr]),t(It,Jr,yr(Zr,mr,xt,Jr,et,Wt))}),It}return hp=yr,hp}var dp,pS;function B$(){if(pS)return dp;pS=1;var r=BC(),e=4;function t(n){return r(n,e)}return dp=t,dp}var fp,vS;function vb(){if(vS)return fp;vS=1;function r(e){return function(){return e}}return fp=r,fp}var gp,yS;function z$(){if(yS)return gp;yS=1;function r(e){return function(t,n,i){for(var a=-1,s=Object(t),o=i(t),l=o.length;l--;){var u=o[e?l:++a];if(n(s[u],u,s)===!1)break}return t}}return gp=r,gp}var pp,mS;function yb(){if(mS)return pp;mS=1;var r=z$(),e=r();return pp=e,pp}var vp,bS;function mb(){if(bS)return vp;bS=1;var r=yb(),e=wa();function t(n,i){return n&&r(n,i,e)}return vp=t,vp}var yp,wS;function j$(){if(wS)return yp;wS=1;var r=Bi();function e(t,n){return function(i,a){if(i==null)return i;if(!r(i))return t(i,a);for(var s=i.length,o=n?s:-1,l=Object(i);(n?o--:++o<s)&&a(l[o],o,l)!==!1;);return i}}return yp=e,yp}var mp,xS;function Eh(){if(xS)return mp;xS=1;var r=mb(),e=j$(),t=e(r);return mp=t,mp}var bp,ES;function os(){if(ES)return bp;ES=1;function r(e){return e}return bp=r,bp}var wp,SS;function zC(){if(SS)return wp;SS=1;var r=os();function e(t){return typeof t=="function"?t:r}return wp=e,wp}var xp,_S;function jC(){if(_S)return xp;_S=1;var r=ub(),e=Eh(),t=zC(),n=rn();function i(a,s){var o=n(a)?r:e;return o(a,t(s))}return xp=i,xp}var Ep,MS;function qC(){return MS||(MS=1,Ep=jC()),Ep}var Sp,OS;function q$(){if(OS)return Sp;OS=1;var r=Eh();function e(t,n){var i=[];return r(t,function(a,s,o){n(a,s,o)&&i.push(a)}),i}return Sp=e,Sp}var _p,kS;function $$(){if(kS)return _p;kS=1;var r="__lodash_hash_undefined__";function e(t){return this.__data__.set(t,r),this}return _p=e,_p}var Mp,TS;function G$(){if(TS)return Mp;TS=1;function r(e){return this.__data__.has(e)}return Mp=r,Mp}var Op,AS;function $C(){if(AS)return Op;AS=1;var r=lb(),e=$$(),t=G$();function n(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new r;++a<s;)this.add(i[a])}return n.prototype.add=n.prototype.push=e,n.prototype.has=t,Op=n,Op}var kp,PS;function W$(){if(PS)return kp;PS=1;function r(e,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}return kp=r,kp}var Tp,CS;function GC(){if(CS)return Tp;CS=1;function r(e,t){return e.has(t)}return Tp=r,Tp}var Ap,NS;function WC(){if(NS)return Ap;NS=1;var r=$C(),e=W$(),t=GC(),n=1,i=2;function a(s,o,l,u,c,h){var d=l&n,f=s.length,g=o.length;if(f!=g&&!(d&&g>f))return!1;var v=h.get(s),p=h.get(o);if(v&&p)return v==o&&p==s;var y=-1,m=!0,w=l&i?new r:void 0;for(h.set(s,o),h.set(o,s);++y<f;){var S=s[y],_=o[y];if(u)var O=d?u(_,S,y,o,s,h):u(S,_,y,s,o,h);if(O!==void 0){if(O)continue;m=!1;break}if(w){if(!e(o,function(T,k){if(!t(w,k)&&(S===T||c(S,T,l,u,h)))return w.push(k)})){m=!1;break}}else if(!(S===_||c(S,_,l,u,h))){m=!1;break}}return h.delete(s),h.delete(o),m}return Ap=a,Ap}var Pp,RS;function V$(){if(RS)return Pp;RS=1;function r(e){var t=-1,n=Array(e.size);return e.forEach(function(i,a){n[++t]=[a,i]}),n}return Pp=r,Pp}var Cp,LS;function bb(){if(LS)return Cp;LS=1;function r(e){var t=-1,n=Array(e.size);return e.forEach(function(i){n[++t]=i}),n}return Cp=r,Cp}var Np,IS;function U$(){if(IS)return Np;IS=1;var r=Ys(),e=LC(),t=Hs(),n=WC(),i=V$(),a=bb(),s=1,o=2,l="[object Boolean]",u="[object Date]",c="[object Error]",h="[object Map]",d="[object Number]",f="[object RegExp]",g="[object Set]",v="[object String]",p="[object Symbol]",y="[object ArrayBuffer]",m="[object DataView]",w=r?r.prototype:void 0,S=w?w.valueOf:void 0;function _(O,T,k,P,C,N,L){switch(k){case m:if(O.byteLength!=T.byteLength||O.byteOffset!=T.byteOffset)return!1;O=O.buffer,T=T.buffer;case y:return!(O.byteLength!=T.byteLength||!N(new e(O),new e(T)));case l:case u:case d:return t(+O,+T);case c:return O.name==T.name&&O.message==T.message;case f:case v:return O==T+"";case h:var F=i;case g:var G=P&s;if(F||(F=a),O.size!=T.size&&!G)return!1;var V=L.get(O);if(V)return V==T;P|=o,L.set(O,T);var U=n(F(O),F(T),P,C,N,L);return L.delete(O),U;case p:if(S)return S.call(O)==S.call(T)}return!1}return Np=_,Np}var Rp,DS;function H$(){if(DS)return Rp;DS=1;var r=NC(),e=1,t=Object.prototype,n=t.hasOwnProperty;function i(a,s,o,l,u,c){var h=o&e,d=r(a),f=d.length,g=r(s),v=g.length;if(f!=v&&!h)return!1;for(var p=f;p--;){var y=d[p];if(!(h?y in s:n.call(s,y)))return!1}var m=c.get(a),w=c.get(s);if(m&&w)return m==s&&w==a;var S=!0;c.set(a,s),c.set(s,a);for(var _=h;++p<f;){y=d[p];var O=a[y],T=s[y];if(l)var k=h?l(T,O,y,s,a,c):l(O,T,y,a,s,c);if(!(k===void 0?O===T||u(O,T,o,l,c):k)){S=!1;break}_||(_=y=="constructor")}if(S&&!_){var P=a.constructor,C=s.constructor;P!=C&&"constructor"in a&&"constructor"in s&&!(typeof P=="function"&&P instanceof P&&typeof C=="function"&&C instanceof C)&&(S=!1)}return c.delete(a),c.delete(s),S}return Rp=i,Rp}var Lp,FS;function Y$(){if(FS)return Lp;FS=1;var r=ph(),e=WC(),t=U$(),n=H$(),i=Ks(),a=rn(),s=Xs(),o=xl(),l=1,u="[object Arguments]",c="[object Array]",h="[object Object]",d=Object.prototype,f=d.hasOwnProperty;function g(v,p,y,m,w,S){var _=a(v),O=a(p),T=_?c:i(v),k=O?c:i(p);T=T==u?h:T,k=k==u?h:k;var P=T==h,C=k==h,N=T==k;if(N&&s(v)){if(!s(p))return!1;_=!0,P=!1}if(N&&!P)return S||(S=new r),_||o(v)?e(v,p,y,m,w,S):t(v,p,T,y,m,w,S);if(!(y&l)){var L=P&&f.call(v,"__wrapped__"),F=C&&f.call(p,"__wrapped__");if(L||F){var G=L?v.value():v,V=F?p.value():p;return S||(S=new r),w(G,V,y,m,S)}}return N?(S||(S=new r),n(v,p,y,m,w,S)):!1}return Lp=g,Lp}var Ip,BS;function VC(){if(BS)return Ip;BS=1;var r=Y$(),e=mi();function t(n,i,a,s,o){return n===i?!0:n==null||i==null||!e(n)&&!e(i)?n!==n&&i!==i:r(n,i,a,s,t,o)}return Ip=t,Ip}var Dp,zS;function X$(){if(zS)return Dp;zS=1;var r=ph(),e=VC(),t=1,n=2;function i(a,s,o,l){var u=o.length,c=u,h=!l;if(a==null)return!c;for(a=Object(a);u--;){var d=o[u];if(h&&d[2]?d[1]!==a[d[0]]:!(d[0]in a))return!1}for(;++u<c;){d=o[u];var f=d[0],g=a[f],v=d[1];if(h&&d[2]){if(g===void 0&&!(f in a))return!1}else{var p=new r;if(l)var y=l(g,v,f,a,s,p);if(!(y===void 0?e(v,g,t|n,l,p):y))return!1}}return!0}return Dp=i,Dp}var Fp,jS;function UC(){if(jS)return Fp;jS=1;var r=Pr();function e(t){return t===t&&!r(t)}return Fp=e,Fp}var Bp,qS;function K$(){if(qS)return Bp;qS=1;var r=UC(),e=wa();function t(n){for(var i=e(n),a=i.length;a--;){var s=i[a],o=n[s];i[a]=[s,o,r(o)]}return i}return Bp=t,Bp}var zp,$S;function HC(){if($S)return zp;$S=1;function r(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}return zp=r,zp}var jp,GS;function Z$(){if(GS)return jp;GS=1;var r=X$(),e=K$(),t=HC();function n(i){var a=e(i);return a.length==1&&a[0][2]?t(a[0][0],a[0][1]):function(s){return s===i||r(s,i,a)}}return jp=n,jp}var qp,WS;function Zs(){if(WS)return qp;WS=1;var r=is(),e=mi(),t="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&r(i)==t}return qp=n,qp}var $p,VS;function wb(){if(VS)return $p;VS=1;var r=rn(),e=Zs(),t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(r(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||e(a)?!0:n.test(a)||!t.test(a)||s!=null&&a in Object(s)}return $p=i,$p}var Gp,US;function J$(){if(US)return Gp;US=1;var r=lb(),e="Expected a function";function t(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],l=a.cache;if(l.has(o))return l.get(o);var u=n.apply(this,s);return a.cache=l.set(o,u)||l,u};return a.cache=new(t.Cache||r),a}return t.Cache=r,Gp=t,Gp}var Wp,HS;function Q$(){if(HS)return Wp;HS=1;var r=J$(),e=500;function t(n){var i=r(n,function(s){return a.size===e&&a.clear(),s}),a=i.cache;return i}return Wp=t,Wp}var Vp,YS;function eG(){if(YS)return Vp;YS=1;var r=Q$(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,t=/\\(\\)?/g,n=r(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(e,function(s,o,l,u){a.push(l?u.replace(t,"$1"):o||s)}),a});return Vp=n,Vp}var Up,XS;function Sh(){if(XS)return Up;XS=1;function r(e,t){for(var n=-1,i=e==null?0:e.length,a=Array(i);++n<i;)a[n]=t(e[n],n,e);return a}return Up=r,Up}var Hp,KS;function tG(){if(KS)return Hp;KS=1;var r=Ys(),e=Sh(),t=rn(),n=Zs(),i=r?r.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(t(o))return e(o,s)+"";if(n(o))return a?a.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}return Hp=s,Hp}var Yp,ZS;function YC(){if(ZS)return Yp;ZS=1;var r=tG();function e(t){return t==null?"":r(t)}return Yp=e,Yp}var Xp,JS;function _h(){if(JS)return Xp;JS=1;var r=rn(),e=wb(),t=eG(),n=YC();function i(a,s){return r(a)?a:e(a,s)?[a]:t(n(a))}return Xp=i,Xp}var Kp,QS;function El(){if(QS)return Kp;QS=1;var r=Zs();function e(t){if(typeof t=="string"||r(t))return t;var n=t+"";return n=="0"&&1/t==-1/0?"-0":n}return Kp=e,Kp}var Zp,e_;function Mh(){if(e_)return Zp;e_=1;var r=_h(),e=El();function t(n,i){i=r(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[e(i[a++])];return a&&a==s?n:void 0}return Zp=t,Zp}var Jp,t_;function nG(){if(t_)return Jp;t_=1;var r=Mh();function e(t,n,i){var a=t==null?void 0:r(t,n);return a===void 0?i:a}return Jp=e,Jp}var Qp,n_;function rG(){if(n_)return Qp;n_=1;function r(e,t){return e!=null&&t in Object(e)}return Qp=r,Qp}var ev,r_;function XC(){if(r_)return ev;r_=1;var r=_h(),e=wl(),t=rn(),n=mh(),i=cb(),a=El();function s(o,l,u){l=r(l,o);for(var c=-1,h=l.length,d=!1;++c<h;){var f=a(l[c]);if(!(d=o!=null&&u(o,f)))break;o=o[f]}return d||++c!=h?d:(h=o==null?0:o.length,!!h&&i(h)&&n(f,h)&&(t(o)||e(o)))}return ev=s,ev}var tv,i_;function KC(){if(i_)return tv;i_=1;var r=rG(),e=XC();function t(n,i){return n!=null&&e(n,i,r)}return tv=t,tv}var nv,a_;function iG(){if(a_)return nv;a_=1;var r=VC(),e=nG(),t=KC(),n=wb(),i=UC(),a=HC(),s=El(),o=1,l=2;function u(c,h){return n(c)&&i(h)?a(s(c),h):function(d){var f=e(d,c);return f===void 0&&f===h?t(d,c):r(h,f,o|l)}}return nv=u,nv}var rv,s_;function ZC(){if(s_)return rv;s_=1;function r(e){return function(t){return t==null?void 0:t[e]}}return rv=r,rv}var iv,o_;function aG(){if(o_)return iv;o_=1;var r=Mh();function e(t){return function(n){return r(n,t)}}return iv=e,iv}var av,l_;function sG(){if(l_)return av;l_=1;var r=ZC(),e=aG(),t=wb(),n=El();function i(a){return t(a)?r(n(a)):e(a)}return av=i,av}var sv,u_;function zi(){if(u_)return sv;u_=1;var r=Z$(),e=iG(),t=os(),n=rn(),i=sG();function a(s){return typeof s=="function"?s:s==null?t:typeof s=="object"?n(s)?e(s[0],s[1]):r(s):i(s)}return sv=a,sv}var ov,c_;function JC(){if(c_)return ov;c_=1;var r=TC(),e=q$(),t=zi(),n=rn();function i(a,s){var o=n(a)?r:e;return o(a,t(s,3))}return ov=i,ov}var lv,h_;function oG(){if(h_)return lv;h_=1;var r=Object.prototype,e=r.hasOwnProperty;function t(n,i){return n!=null&&e.call(n,i)}return lv=t,lv}var uv,d_;function QC(){if(d_)return uv;d_=1;var r=oG(),e=XC();function t(n,i){return n!=null&&e(n,i,r)}return uv=t,uv}var cv,f_;function lG(){if(f_)return cv;f_=1;var r=db(),e=Ks(),t=wl(),n=rn(),i=Bi(),a=Xs(),s=wh(),o=xl(),l="[object Map]",u="[object Set]",c=Object.prototype,h=c.hasOwnProperty;function d(f){if(f==null)return!0;if(i(f)&&(n(f)||typeof f=="string"||typeof f.splice=="function"||a(f)||o(f)||t(f)))return!f.length;var g=e(f);if(g==l||g==u)return!f.size;if(s(f))return!r(f).length;for(var v in f)if(h.call(f,v))return!1;return!0}return cv=d,cv}var hv,g_;function eN(){if(g_)return hv;g_=1;function r(e){return e===void 0}return hv=r,hv}var dv,p_;function tN(){if(p_)return dv;p_=1;var r=Eh(),e=Bi();function t(n,i){var a=-1,s=e(n)?Array(n.length):[];return r(n,function(o,l,u){s[++a]=i(o,l,u)}),s}return dv=t,dv}var fv,v_;function nN(){if(v_)return fv;v_=1;var r=Sh(),e=zi(),t=tN(),n=rn();function i(a,s){var o=n(a)?r:t;return o(a,e(s,3))}return fv=i,fv}var gv,y_;function uG(){if(y_)return gv;y_=1;function r(e,t,n,i){var a=-1,s=e==null?0:e.length;for(i&&s&&(n=e[++a]);++a<s;)n=t(n,e[a],a,e);return n}return gv=r,gv}var pv,m_;function cG(){if(m_)return pv;m_=1;function r(e,t,n,i,a){return a(e,function(s,o,l){n=i?(i=!1,s):t(n,s,o,l)}),n}return pv=r,pv}var vv,b_;function rN(){if(b_)return vv;b_=1;var r=uG(),e=Eh(),t=zi(),n=cG(),i=rn();function a(s,o,l){var u=i(s)?r:n,c=arguments.length<3;return u(s,t(o,4),l,c,e)}return vv=a,vv}var yv,w_;function hG(){if(w_)return yv;w_=1;var r=is(),e=rn(),t=mi(),n="[object String]";function i(a){return typeof a=="string"||!e(a)&&t(a)&&r(a)==n}return yv=i,yv}var mv,x_;function dG(){if(x_)return mv;x_=1;var r=ZC(),e=r("length");return mv=e,mv}var bv,E_;function fG(){if(E_)return bv;E_=1;var r="\\ud800-\\udfff",e="\\u0300-\\u036f",t="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=e+t+n,a="\\ufe0e\\ufe0f",s="\\u200d",o=RegExp("["+s+r+i+a+"]");function l(u){return o.test(u)}return bv=l,bv}var wv,S_;function gG(){if(S_)return wv;S_=1;var r="\\ud800-\\udfff",e="\\u0300-\\u036f",t="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=e+t+n,a="\\ufe0e\\ufe0f",s="["+r+"]",o="["+i+"]",l="\\ud83c[\\udffb-\\udfff]",u="(?:"+o+"|"+l+")",c="[^"+r+"]",h="(?:\\ud83c[\\udde6-\\uddff]){2}",d="[\\ud800-\\udbff][\\udc00-\\udfff]",f="\\u200d",g=u+"?",v="["+a+"]?",p="(?:"+f+"(?:"+[c,h,d].join("|")+")"+v+g+")*",y=v+g+p,m="(?:"+[c+o+"?",o,h,d,s].join("|")+")",w=RegExp(l+"(?="+l+")|"+m+y,"g");function S(_){for(var O=w.lastIndex=0;w.test(_);)++O;return O}return wv=S,wv}var xv,__;function pG(){if(__)return xv;__=1;var r=dG(),e=fG(),t=gG();function n(i){return e(i)?t(i):r(i)}return xv=n,xv}var Ev,M_;function vG(){if(M_)return Ev;M_=1;var r=db(),e=Ks(),t=Bi(),n=hG(),i=pG(),a="[object Map]",s="[object Set]";function o(l){if(l==null)return 0;if(t(l))return n(l)?i(l):l.length;var u=e(l);return u==a||u==s?l.size:r(l).length}return Ev=o,Ev}var Sv,O_;function yG(){if(O_)return Sv;O_=1;var r=ub(),e=DC(),t=mb(),n=zi(),i=xh(),a=rn(),s=Xs(),o=ml(),l=Pr(),u=xl();function c(h,d,f){var g=a(h),v=g||s(h)||u(h);if(d=n(d,4),f==null){var p=h&&h.constructor;v?f=g?new p:[]:l(h)?f=o(p)?e(i(h)):{}:f={}}return(v?r:t)(h,function(y,m,w){return d(f,y,m,w)}),f}return Sv=c,Sv}var _v,k_;function mG(){if(k_)return _v;k_=1;var r=Ys(),e=wl(),t=rn(),n=r?r.isConcatSpreadable:void 0;function i(a){return t(a)||e(a)||!!(n&&a&&a[n])}return _v=i,_v}var Mv,T_;function xb(){if(T_)return Mv;T_=1;var r=gb(),e=mG();function t(n,i,a,s,o){var l=-1,u=n.length;for(a||(a=e),o||(o=[]);++l<u;){var c=n[l];i>0&&a(c)?i>1?t(c,i-1,a,s,o):r(o,c):s||(o[o.length]=c)}return o}return Mv=t,Mv}var Ov,A_;function bG(){if(A_)return Ov;A_=1;function r(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}return Ov=r,Ov}var kv,P_;function iN(){if(P_)return kv;P_=1;var r=bG(),e=Math.max;function t(n,i,a){return i=e(i===void 0?n.length-1:i,0),function(){for(var s=arguments,o=-1,l=e(s.length-i,0),u=Array(l);++o<l;)u[o]=s[i+o];o=-1;for(var c=Array(i+1);++o<i;)c[o]=s[o];return c[i]=a(u),r(n,this,c)}}return kv=t,kv}var Tv,C_;function wG(){if(C_)return Tv;C_=1;var r=vb(),e=SC(),t=os(),n=e?function(i,a){return e(i,"toString",{configurable:!0,enumerable:!1,value:r(a),writable:!0})}:t;return Tv=n,Tv}var Av,N_;function xG(){if(N_)return Av;N_=1;var r=800,e=16,t=Date.now;function n(i){var a=0,s=0;return function(){var o=t(),l=e-(o-s);if(s=o,l>0){if(++a>=r)return arguments[0]}else a=0;return i.apply(void 0,arguments)}}return Av=n,Av}var Pv,R_;function aN(){if(R_)return Pv;R_=1;var r=wG(),e=xG(),t=e(r);return Pv=t,Pv}var Cv,L_;function Oh(){if(L_)return Cv;L_=1;var r=os(),e=iN(),t=aN();function n(i,a){return t(e(i,a,r),i+"")}return Cv=n,Cv}var Nv,I_;function sN(){if(I_)return Nv;I_=1;function r(e,t,n,i){for(var a=e.length,s=n+(i?1:-1);i?s--:++s<a;)if(t(e[s],s,e))return s;return-1}return Nv=r,Nv}var Rv,D_;function EG(){if(D_)return Rv;D_=1;function r(e){return e!==e}return Rv=r,Rv}var Lv,F_;function SG(){if(F_)return Lv;F_=1;function r(e,t,n){for(var i=n-1,a=e.length;++i<a;)if(e[i]===t)return i;return-1}return Lv=r,Lv}var Iv,B_;function _G(){if(B_)return Iv;B_=1;var r=sN(),e=EG(),t=SG();function n(i,a,s){return a===a?t(i,a,s):r(i,e,s)}return Iv=n,Iv}var Dv,z_;function MG(){if(z_)return Dv;z_=1;var r=_G();function e(t,n){var i=t==null?0:t.length;return!!i&&r(t,n,0)>-1}return Dv=e,Dv}var Fv,j_;function OG(){if(j_)return Fv;j_=1;function r(e,t,n){for(var i=-1,a=e==null?0:e.length;++i<a;)if(n(t,e[i]))return!0;return!1}return Fv=r,Fv}var Bv,q_;function kG(){if(q_)return Bv;q_=1;function r(){}return Bv=r,Bv}var zv,$_;function TG(){if($_)return zv;$_=1;var r=RC(),e=kG(),t=bb(),n=1/0,i=r&&1/t(new r([,-0]))[1]==n?function(a){return new r(a)}:e;return zv=i,zv}var jv,G_;function AG(){if(G_)return jv;G_=1;var r=$C(),e=MG(),t=OG(),n=GC(),i=TG(),a=bb(),s=200;function o(l,u,c){var h=-1,d=e,f=l.length,g=!0,v=[],p=v;if(c)g=!1,d=t;else if(f>=s){var y=u?null:i(l);if(y)return a(y);g=!1,d=n,p=new r}else p=u?[]:v;e:for(;++h<f;){var m=l[h],w=u?u(m):m;if(m=c||m!==0?m:0,g&&w===w){for(var S=p.length;S--;)if(p[S]===w)continue e;u&&p.push(w),v.push(m)}else d(p,w,c)||(p!==v&&p.push(w),v.push(m))}return v}return jv=o,jv}var qv,W_;function oN(){if(W_)return qv;W_=1;var r=Bi(),e=mi();function t(n){return e(n)&&r(n)}return qv=t,qv}var $v,V_;function PG(){if(V_)return $v;V_=1;var r=xb(),e=Oh(),t=AG(),n=oN(),i=e(function(a){return t(r(a,1,n,!0))});return $v=i,$v}var Gv,U_;function CG(){if(U_)return Gv;U_=1;var r=Sh();function e(t,n){return r(n,function(i){return t[i]})}return Gv=e,Gv}var Wv,H_;function lN(){if(H_)return Wv;H_=1;var r=CG(),e=wa();function t(n){return n==null?[]:r(n,e(n))}return Wv=t,Wv}var Vv,Y_;function Cr(){if(Y_)return Vv;Y_=1;var r;if(typeof sb=="function")try{r={clone:B$(),constant:vb(),each:qC(),filter:JC(),has:QC(),isArray:rn(),isEmpty:lG(),isFunction:ml(),isUndefined:eN(),keys:wa(),map:nN(),reduce:rN(),size:vG(),transform:yG(),union:PG(),values:lN()}}catch{}return r||(r=window._),Vv=r,Vv}var Uv,X_;function Eb(){if(X_)return Uv;X_=1;var r=Cr();Uv=i;var e="\0",t="\0",n="";function i(c){this._isDirected=r.has(c,"directed")?c.directed:!0,this._isMultigraph=r.has(c,"multigraph")?c.multigraph:!1,this._isCompound=r.has(c,"compound")?c.compound:!1,this._label=void 0,this._defaultNodeLabelFn=r.constant(void 0),this._defaultEdgeLabelFn=r.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[t]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(c){return this._label=c,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(c){return r.isFunction(c)||(c=r.constant(c)),this._defaultNodeLabelFn=c,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return r.keys(this._nodes)},i.prototype.sources=function(){var c=this;return r.filter(this.nodes(),function(h){return r.isEmpty(c._in[h])})},i.prototype.sinks=function(){var c=this;return r.filter(this.nodes(),function(h){return r.isEmpty(c._out[h])})},i.prototype.setNodes=function(c,h){var d=arguments,f=this;return r.each(c,function(g){d.length>1?f.setNode(g,h):f.setNode(g)}),this},i.prototype.setNode=function(c,h){return r.has(this._nodes,c)?(arguments.length>1&&(this._nodes[c]=h),this):(this._nodes[c]=arguments.length>1?h:this._defaultNodeLabelFn(c),this._isCompound&&(this._parent[c]=t,this._children[c]={},this._children[t][c]=!0),this._in[c]={},this._preds[c]={},this._out[c]={},this._sucs[c]={},++this._nodeCount,this)},i.prototype.node=function(c){return this._nodes[c]},i.prototype.hasNode=function(c){return r.has(this._nodes,c)},i.prototype.removeNode=function(c){var h=this;if(r.has(this._nodes,c)){var d=function(f){h.removeEdge(h._edgeObjs[f])};delete this._nodes[c],this._isCompound&&(this._removeFromParentsChildList(c),delete this._parent[c],r.each(this.children(c),function(f){h.setParent(f)}),delete this._children[c]),r.each(r.keys(this._in[c]),d),delete this._in[c],delete this._preds[c],r.each(r.keys(this._out[c]),d),delete this._out[c],delete this._sucs[c],--this._nodeCount}return this},i.prototype.setParent=function(c,h){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(r.isUndefined(h))h=t;else{h+="";for(var d=h;!r.isUndefined(d);d=this.parent(d))if(d===c)throw new Error("Setting "+h+" as parent of "+c+" would create a cycle");this.setNode(h)}return this.setNode(c),this._removeFromParentsChildList(c),this._parent[c]=h,this._children[h][c]=!0,this},i.prototype._removeFromParentsChildList=function(c){delete this._children[this._parent[c]][c]},i.prototype.parent=function(c){if(this._isCompound){var h=this._parent[c];if(h!==t)return h}},i.prototype.children=function(c){if(r.isUndefined(c)&&(c=t),this._isCompound){var h=this._children[c];if(h)return r.keys(h)}else{if(c===t)return this.nodes();if(this.hasNode(c))return[]}},i.prototype.predecessors=function(c){var h=this._preds[c];if(h)return r.keys(h)},i.prototype.successors=function(c){var h=this._sucs[c];if(h)return r.keys(h)},i.prototype.neighbors=function(c){var h=this.predecessors(c);if(h)return r.union(h,this.successors(c))},i.prototype.isLeaf=function(c){var h;return this.isDirected()?h=this.successors(c):h=this.neighbors(c),h.length===0},i.prototype.filterNodes=function(c){var h=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});h.setGraph(this.graph());var d=this;r.each(this._nodes,function(v,p){c(p)&&h.setNode(p,v)}),r.each(this._edgeObjs,function(v){h.hasNode(v.v)&&h.hasNode(v.w)&&h.setEdge(v,d.edge(v))});var f={};function g(v){var p=d.parent(v);return p===void 0||h.hasNode(p)?(f[v]=p,p):p in f?f[p]:g(p)}return this._isCompound&&r.each(h.nodes(),function(v){h.setParent(v,g(v))}),h},i.prototype.setDefaultEdgeLabel=function(c){return r.isFunction(c)||(c=r.constant(c)),this._defaultEdgeLabelFn=c,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return r.values(this._edgeObjs)},i.prototype.setPath=function(c,h){var d=this,f=arguments;return r.reduce(c,function(g,v){return f.length>1?d.setEdge(g,v,h):d.setEdge(g,v),v}),this},i.prototype.setEdge=function(){var c,h,d,f,g=!1,v=arguments[0];typeof v=="object"&&v!==null&&"v"in v?(c=v.v,h=v.w,d=v.name,arguments.length===2&&(f=arguments[1],g=!0)):(c=v,h=arguments[1],d=arguments[3],arguments.length>2&&(f=arguments[2],g=!0)),c=""+c,h=""+h,r.isUndefined(d)||(d=""+d);var p=o(this._isDirected,c,h,d);if(r.has(this._edgeLabels,p))return g&&(this._edgeLabels[p]=f),this;if(!r.isUndefined(d)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(c),this.setNode(h),this._edgeLabels[p]=g?f:this._defaultEdgeLabelFn(c,h,d);var y=l(this._isDirected,c,h,d);return c=y.v,h=y.w,Object.freeze(y),this._edgeObjs[p]=y,a(this._preds[h],c),a(this._sucs[c],h),this._in[h][p]=y,this._out[c][p]=y,this._edgeCount++,this},i.prototype.edge=function(c,h,d){var f=arguments.length===1?u(this._isDirected,arguments[0]):o(this._isDirected,c,h,d);return this._edgeLabels[f]},i.prototype.hasEdge=function(c,h,d){var f=arguments.length===1?u(this._isDirected,arguments[0]):o(this._isDirected,c,h,d);return r.has(this._edgeLabels,f)},i.prototype.removeEdge=function(c,h,d){var f=arguments.length===1?u(this._isDirected,arguments[0]):o(this._isDirected,c,h,d),g=this._edgeObjs[f];return g&&(c=g.v,h=g.w,delete this._edgeLabels[f],delete this._edgeObjs[f],s(this._preds[h],c),s(this._sucs[c],h),delete this._in[h][f],delete this._out[c][f],this._edgeCount--),this},i.prototype.inEdges=function(c,h){var d=this._in[c];if(d){var f=r.values(d);return h?r.filter(f,function(g){return g.v===h}):f}},i.prototype.outEdges=function(c,h){var d=this._out[c];if(d){var f=r.values(d);return h?r.filter(f,function(g){return g.w===h}):f}},i.prototype.nodeEdges=function(c,h){var d=this.inEdges(c,h);if(d)return d.concat(this.outEdges(c,h))};function a(c,h){c[h]?c[h]++:c[h]=1}function s(c,h){--c[h]||delete c[h]}function o(c,h,d,f){var g=""+h,v=""+d;if(!c&&g>v){var p=g;g=v,v=p}return g+n+v+n+(r.isUndefined(f)?e:f)}function l(c,h,d,f){var g=""+h,v=""+d;if(!c&&g>v){var p=g;g=v,v=p}var y={v:g,w:v};return f&&(y.name=f),y}function u(c,h){return o(c,h.v,h.w,h.name)}return Uv}var Hv,K_;function NG(){return K_||(K_=1,Hv="2.1.8"),Hv}var Yv,Z_;function RG(){return Z_||(Z_=1,Yv={Graph:Eb(),version:NG()}),Yv}var Xv,J_;function LG(){if(J_)return Xv;J_=1;var r=Cr(),e=Eb();Xv={write:t,read:a};function t(s){var o={options:{directed:s.isDirected(),multigraph:s.isMultigraph(),compound:s.isCompound()},nodes:n(s),edges:i(s)};return r.isUndefined(s.graph())||(o.value=r.clone(s.graph())),o}function n(s){return r.map(s.nodes(),function(o){var l=s.node(o),u=s.parent(o),c={v:o};return r.isUndefined(l)||(c.value=l),r.isUndefined(u)||(c.parent=u),c})}function i(s){return r.map(s.edges(),function(o){var l=s.edge(o),u={v:o.v,w:o.w};return r.isUndefined(o.name)||(u.name=o.name),r.isUndefined(l)||(u.value=l),u})}function a(s){var o=new e(s.options).setGraph(s.value);return r.each(s.nodes,function(l){o.setNode(l.v,l.value),l.parent&&o.setParent(l.v,l.parent)}),r.each(s.edges,function(l){o.setEdge({v:l.v,w:l.w,name:l.name},l.value)}),o}return Xv}var Kv,Q_;function IG(){if(Q_)return Kv;Q_=1;var r=Cr();Kv=e;function e(t){var n={},i=[],a;function s(o){r.has(n,o)||(n[o]=!0,a.push(o),r.each(t.successors(o),s),r.each(t.predecessors(o),s))}return r.each(t.nodes(),function(o){a=[],s(o),a.length&&i.push(a)}),i}return Kv}var Zv,eM;function uN(){if(eM)return Zv;eM=1;var r=Cr();Zv=e;function e(){this._arr=[],this._keyIndices={}}return e.prototype.size=function(){return this._arr.length},e.prototype.keys=function(){return this._arr.map(function(t){return t.key})},e.prototype.has=function(t){return r.has(this._keyIndices,t)},e.prototype.priority=function(t){var n=this._keyIndices[t];if(n!==void 0)return this._arr[n].priority},e.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},e.prototype.add=function(t,n){var i=this._keyIndices;if(t=String(t),!r.has(i,t)){var a=this._arr,s=a.length;return i[t]=s,a.push({key:t,priority:n}),this._decrease(s),!0}return!1},e.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},e.prototype.decrease=function(t,n){var i=this._keyIndices[t];if(n>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[i].priority+" New: "+n);this._arr[i].priority=n,this._decrease(i)},e.prototype._heapify=function(t){var n=this._arr,i=2*t,a=i+1,s=t;i<n.length&&(s=n[i].priority<n[s].priority?i:s,a<n.length&&(s=n[a].priority<n[s].priority?a:s),s!==t&&(this._swap(t,s),this._heapify(s)))},e.prototype._decrease=function(t){for(var n=this._arr,i=n[t].priority,a;t!==0&&(a=t>>1,!(n[a].priority<i));)this._swap(t,a),t=a},e.prototype._swap=function(t,n){var i=this._arr,a=this._keyIndices,s=i[t],o=i[n];i[t]=o,i[n]=s,a[o.key]=t,a[s.key]=n},Zv}var Jv,tM;function cN(){if(tM)return Jv;tM=1;var r=Cr(),e=uN();Jv=n;var t=r.constant(1);function n(a,s,o,l){return i(a,String(s),o||t,l||function(u){return a.outEdges(u)})}function i(a,s,o,l){var u={},c=new e,h,d,f=function(g){var v=g.v!==h?g.v:g.w,p=u[v],y=o(g),m=d.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+g+" Weight: "+y);m<p.distance&&(p.distance=m,p.predecessor=h,c.decrease(v,m))};for(a.nodes().forEach(function(g){var v=g===s?0:Number.POSITIVE_INFINITY;u[g]={distance:v},c.add(g,v)});c.size()>0&&(h=c.removeMin(),d=u[h],d.distance!==Number.POSITIVE_INFINITY);)l(h).forEach(f);return u}return Jv}var Qv,nM;function DG(){if(nM)return Qv;nM=1;var r=cN(),e=Cr();Qv=t;function t(n,i,a){return e.transform(n.nodes(),function(s,o){s[o]=r(n,o,i,a)},{})}return Qv}var e0,rM;function hN(){if(rM)return e0;rM=1;var r=Cr();e0=e;function e(t){var n=0,i=[],a={},s=[];function o(l){var u=a[l]={onStack:!0,lowlink:n,index:n++};if(i.push(l),t.successors(l).forEach(function(d){r.has(a,d)?a[d].onStack&&(u.lowlink=Math.min(u.lowlink,a[d].index)):(o(d),u.lowlink=Math.min(u.lowlink,a[d].lowlink))}),u.lowlink===u.index){var c=[],h;do h=i.pop(),a[h].onStack=!1,c.push(h);while(l!==h);s.push(c)}}return t.nodes().forEach(function(l){r.has(a,l)||o(l)}),s}return e0}var t0,iM;function FG(){if(iM)return t0;iM=1;var r=Cr(),e=hN();t0=t;function t(n){return r.filter(e(n),function(i){return i.length>1||i.length===1&&n.hasEdge(i[0],i[0])})}return t0}var n0,aM;function BG(){if(aM)return n0;aM=1;var r=Cr();n0=t;var e=r.constant(1);function t(i,a,s){return n(i,a||e,s||function(o){return i.outEdges(o)})}function n(i,a,s){var o={},l=i.nodes();return l.forEach(function(u){o[u]={},o[u][u]={distance:0},l.forEach(function(c){u!==c&&(o[u][c]={distance:Number.POSITIVE_INFINITY})}),s(u).forEach(function(c){var h=c.v===u?c.w:c.v,d=a(c);o[u][h]={distance:d,predecessor:u}})}),l.forEach(function(u){var c=o[u];l.forEach(function(h){var d=o[h];l.forEach(function(f){var g=d[u],v=c[f],p=d[f],y=g.distance+v.distance;y<p.distance&&(p.distance=y,p.predecessor=v.predecessor)})})}),o}return n0}var r0,sM;function dN(){if(sM)return r0;sM=1;var r=Cr();r0=e,e.CycleException=t;function e(n){var i={},a={},s=[];function o(l){if(r.has(a,l))throw new t;r.has(i,l)||(a[l]=!0,i[l]=!0,r.each(n.predecessors(l),o),delete a[l],s.push(l))}if(r.each(n.sinks(),o),r.size(i)!==n.nodeCount())throw new t;return s}function t(){}return t.prototype=new Error,r0}var i0,oM;function zG(){if(oM)return i0;oM=1;var r=dN();i0=e;function e(t){try{r(t)}catch(n){if(n instanceof r.CycleException)return!1;throw n}return!0}return i0}var a0,lM;function fN(){if(lM)return a0;lM=1;var r=Cr();a0=e;function e(n,i,a){r.isArray(i)||(i=[i]);var s=(n.isDirected()?n.successors:n.neighbors).bind(n),o=[],l={};return r.each(i,function(u){if(!n.hasNode(u))throw new Error("Graph does not have node: "+u);t(n,u,a==="post",l,s,o)}),o}function t(n,i,a,s,o,l){r.has(s,i)||(s[i]=!0,a||l.push(i),r.each(o(i),function(u){t(n,u,a,s,o,l)}),a&&l.push(i))}return a0}var s0,uM;function jG(){if(uM)return s0;uM=1;var r=fN();s0=e;function e(t,n){return r(t,n,"post")}return s0}var o0,cM;function qG(){if(cM)return o0;cM=1;var r=fN();o0=e;function e(t,n){return r(t,n,"pre")}return o0}var l0,hM;function $G(){if(hM)return l0;hM=1;var r=Cr(),e=Eb(),t=uN();l0=n;function n(i,a){var s=new e,o={},l=new t,u;function c(d){var f=d.v===u?d.w:d.v,g=l.priority(f);if(g!==void 0){var v=a(d);v<g&&(o[f]=u,l.decrease(f,v))}}if(i.nodeCount()===0)return s;r.each(i.nodes(),function(d){l.add(d,Number.POSITIVE_INFINITY),s.setNode(d)}),l.decrease(i.nodes()[0],0);for(var h=!1;l.size()>0;){if(u=l.removeMin(),r.has(o,u))s.setEdge(u,o[u]);else{if(h)throw new Error("Input graph is not connected: "+i);h=!0}i.nodeEdges(u).forEach(c)}return s}return l0}var u0,dM;function GG(){return dM||(dM=1,u0={components:IG(),dijkstra:cN(),dijkstraAll:DG(),findCycles:FG(),floydWarshall:BG(),isAcyclic:zG(),postorder:jG(),preorder:qG(),prim:$G(),tarjan:hN(),topsort:dN()}),u0}var c0,fM;function WG(){if(fM)return c0;fM=1;var r=RG();return c0={Graph:r.Graph,json:LG(),alg:GG(),version:r.version},c0}var h0,gM;function Wr(){if(gM)return h0;gM=1;var r;if(typeof sb=="function")try{r=WG()}catch{}return r||(r=window.graphlib),h0=r,h0}var d0,pM;function VG(){if(pM)return d0;pM=1;var r=BC(),e=1,t=4;function n(i){return r(i,e|t)}return d0=n,d0}var f0,vM;function kh(){if(vM)return f0;vM=1;var r=Hs(),e=Bi(),t=mh(),n=Pr();function i(a,s,o){if(!n(o))return!1;var l=typeof s;return(l=="number"?e(o)&&t(s,o.length):l=="string"&&s in o)?r(o[s],a):!1}return f0=i,f0}var g0,yM;function UG(){if(yM)return g0;yM=1;var r=Oh(),e=Hs(),t=kh(),n=ss(),i=Object.prototype,a=i.hasOwnProperty,s=r(function(o,l){o=Object(o);var u=-1,c=l.length,h=c>2?l[2]:void 0;for(h&&t(l[0],l[1],h)&&(c=1);++u<c;)for(var d=l[u],f=n(d),g=-1,v=f.length;++g<v;){var p=f[g],y=o[p];(y===void 0||e(y,i[p])&&!a.call(o,p))&&(o[p]=d[p])}return o});return g0=s,g0}var p0,mM;function HG(){if(mM)return p0;mM=1;var r=zi(),e=Bi(),t=wa();function n(i){return function(a,s,o){var l=Object(a);if(!e(a)){var u=r(s,3);a=t(a),s=function(h){return u(l[h],h,l)}}var c=i(a,s,o);return c>-1?l[u?a[c]:c]:void 0}}return p0=n,p0}var v0,bM;function YG(){if(bM)return v0;bM=1;var r=/\s/;function e(t){for(var n=t.length;n--&&r.test(t.charAt(n)););return n}return v0=e,v0}var y0,wM;function XG(){if(wM)return y0;wM=1;var r=YG(),e=/^\s+/;function t(n){return n&&n.slice(0,r(n)+1).replace(e,"")}return y0=t,y0}var m0,xM;function KG(){if(xM)return m0;xM=1;var r=XG(),e=Pr(),t=Zs(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function l(u){if(typeof u=="number")return u;if(t(u))return n;if(e(u)){var c=typeof u.valueOf=="function"?u.valueOf():u;u=e(c)?c+"":c}if(typeof u!="string")return u===0?u:+u;u=r(u);var h=a.test(u);return h||s.test(u)?o(u.slice(2),h?2:8):i.test(u)?n:+u}return m0=l,m0}var b0,EM;function gN(){if(EM)return b0;EM=1;var r=KG(),e=1/0,t=17976931348623157e292;function n(i){if(!i)return i===0?i:0;if(i=r(i),i===e||i===-1/0){var a=i<0?-1:1;return a*t}return i===i?i:0}return b0=n,b0}var w0,SM;function ZG(){if(SM)return w0;SM=1;var r=gN();function e(t){var n=r(t),i=n%1;return n===n?i?n-i:n:0}return w0=e,w0}var x0,_M;function JG(){if(_M)return x0;_M=1;var r=sN(),e=zi(),t=ZG(),n=Math.max;function i(a,s,o){var l=a==null?0:a.length;if(!l)return-1;var u=o==null?0:t(o);return u<0&&(u=n(l+u,0)),r(a,e(s,3),u)}return x0=i,x0}var E0,MM;function QG(){if(MM)return E0;MM=1;var r=HG(),e=JG(),t=r(e);return E0=t,E0}var S0,OM;function pN(){if(OM)return S0;OM=1;var r=xb();function e(t){var n=t==null?0:t.length;return n?r(t,1):[]}return S0=e,S0}var _0,kM;function eW(){if(kM)return _0;kM=1;var r=yb(),e=zC(),t=ss();function n(i,a){return i==null?i:r(i,e(a),t)}return _0=n,_0}var M0,TM;function tW(){if(TM)return M0;TM=1;function r(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}return M0=r,M0}var O0,AM;function nW(){if(AM)return O0;AM=1;var r=vh(),e=mb(),t=zi();function n(i,a){var s={};return a=t(a,3),e(i,function(o,l,u){r(s,l,a(o,l,u))}),s}return O0=n,O0}var k0,PM;function Sb(){if(PM)return k0;PM=1;var r=Zs();function e(t,n,i){for(var a=-1,s=t.length;++a<s;){var o=t[a],l=n(o);if(l!=null&&(u===void 0?l===l&&!r(l):i(l,u)))var u=l,c=o}return c}return k0=e,k0}var T0,CM;function rW(){if(CM)return T0;CM=1;function r(e,t){return e>t}return T0=r,T0}var A0,NM;function iW(){if(NM)return A0;NM=1;var r=Sb(),e=rW(),t=os();function n(i){return i&&i.length?r(i,t,e):void 0}return A0=n,A0}var P0,RM;function vN(){if(RM)return P0;RM=1;var r=vh(),e=Hs();function t(n,i,a){(a!==void 0&&!e(n[i],a)||a===void 0&&!(i in n))&&r(n,i,a)}return P0=t,P0}var C0,LM;function aW(){if(LM)return C0;LM=1;var r=is(),e=xh(),t=mi(),n="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,o=a.hasOwnProperty,l=s.call(Object);function u(c){if(!t(c)||r(c)!=n)return!1;var h=e(c);if(h===null)return!0;var d=o.call(h,"constructor")&&h.constructor;return typeof d=="function"&&d instanceof d&&s.call(d)==l}return C0=u,C0}var N0,IM;function yN(){if(IM)return N0;IM=1;function r(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}return N0=r,N0}var R0,DM;function sW(){if(DM)return R0;DM=1;var r=bl(),e=ss();function t(n){return r(n,e(n))}return R0=t,R0}var L0,FM;function oW(){if(FM)return L0;FM=1;var r=vN(),e=OC(),t=IC(),n=kC(),i=FC(),a=wl(),s=rn(),o=oN(),l=Xs(),u=ml(),c=Pr(),h=aW(),d=xl(),f=yN(),g=sW();function v(p,y,m,w,S,_,O){var T=f(p,m),k=f(y,m),P=O.get(k);if(P){r(p,m,P);return}var C=_?_(T,k,m+"",p,y,O):void 0,N=C===void 0;if(N){var L=s(k),F=!L&&l(k),G=!L&&!F&&d(k);C=k,L||F||G?s(T)?C=T:o(T)?C=n(T):F?(N=!1,C=e(k,!0)):G?(N=!1,C=t(k,!0)):C=[]:h(k)||a(k)?(C=T,a(T)?C=g(T):(!c(T)||u(T))&&(C=i(k))):N=!1}N&&(O.set(k,C),S(C,k,w,_,O),O.delete(k)),r(p,m,C)}return L0=v,L0}var I0,BM;function lW(){if(BM)return I0;BM=1;var r=ph(),e=vN(),t=yb(),n=oW(),i=Pr(),a=ss(),s=yN();function o(l,u,c,h,d){l!==u&&t(u,function(f,g){if(d||(d=new r),i(f))n(l,u,g,c,o,h,d);else{var v=h?h(s(l,g),f,g+"",l,u,d):void 0;v===void 0&&(v=f),e(l,g,v)}},a)}return I0=o,I0}var D0,zM;function uW(){if(zM)return D0;zM=1;var r=Oh(),e=kh();function t(n){return r(function(i,a){var s=-1,o=a.length,l=o>1?a[o-1]:void 0,u=o>2?a[2]:void 0;for(l=n.length>3&&typeof l=="function"?(o--,l):void 0,u&&e(a[0],a[1],u)&&(l=o<3?void 0:l,o=1),i=Object(i);++s<o;){var c=a[s];c&&n(i,c,s,l)}return i})}return D0=t,D0}var F0,jM;function cW(){if(jM)return F0;jM=1;var r=lW(),e=uW(),t=e(function(n,i,a){r(n,i,a)});return F0=t,F0}var B0,qM;function mN(){if(qM)return B0;qM=1;function r(e,t){return e<t}return B0=r,B0}var z0,$M;function hW(){if($M)return z0;$M=1;var r=Sb(),e=mN(),t=os();function n(i){return i&&i.length?r(i,t,e):void 0}return z0=n,z0}var j0,GM;function dW(){if(GM)return j0;GM=1;var r=Sb(),e=zi(),t=mN();function n(i,a){return i&&i.length?r(i,e(a,2),t):void 0}return j0=n,j0}var q0,WM;function fW(){if(WM)return q0;WM=1;var r=Ur(),e=function(){return r.Date.now()};return q0=e,q0}var $0,VM;function gW(){if(VM)return $0;VM=1;var r=yh(),e=_h(),t=mh(),n=Pr(),i=El();function a(s,o,l,u){if(!n(s))return s;o=e(o,s);for(var c=-1,h=o.length,d=h-1,f=s;f!=null&&++c<h;){var g=i(o[c]),v=l;if(g==="__proto__"||g==="constructor"||g==="prototype")return s;if(c!=d){var p=f[g];v=u?u(p,g,f):void 0,v===void 0&&(v=n(p)?p:t(o[c+1])?[]:{})}r(f,g,v),f=f[g]}return s}return $0=a,$0}var G0,UM;function pW(){if(UM)return G0;UM=1;var r=Mh(),e=gW(),t=_h();function n(i,a,s){for(var o=-1,l=a.length,u={};++o<l;){var c=a[o],h=r(i,c);s(h,c)&&e(u,t(c,i),h)}return u}return G0=n,G0}var W0,HM;function vW(){if(HM)return W0;HM=1;var r=pW(),e=KC();function t(n,i){return r(n,i,function(a,s){return e(n,s)})}return W0=t,W0}var V0,YM;function yW(){if(YM)return V0;YM=1;var r=pN(),e=iN(),t=aN();function n(i){return t(e(i,void 0,r),i+"")}return V0=n,V0}var U0,XM;function mW(){if(XM)return U0;XM=1;var r=vW(),e=yW(),t=e(function(n,i){return n==null?{}:r(n,i)});return U0=t,U0}var H0,KM;function bW(){if(KM)return H0;KM=1;var r=Math.ceil,e=Math.max;function t(n,i,a,s){for(var o=-1,l=e(r((i-n)/(a||1)),0),u=Array(l);l--;)u[s?l:++o]=n,n+=a;return u}return H0=t,H0}var Y0,ZM;function wW(){if(ZM)return Y0;ZM=1;var r=bW(),e=kh(),t=gN();function n(i){return function(a,s,o){return o&&typeof o!="number"&&e(a,s,o)&&(s=o=void 0),a=t(a),s===void 0?(s=a,a=0):s=t(s),o=o===void 0?a<s?1:-1:t(o),r(a,s,o,i)}}return Y0=n,Y0}var X0,JM;function xW(){if(JM)return X0;JM=1;var r=wW(),e=r();return X0=e,X0}var K0,QM;function EW(){if(QM)return K0;QM=1;function r(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}return K0=r,K0}var Z0,eO;function SW(){if(eO)return Z0;eO=1;var r=Zs();function e(t,n){if(t!==n){var i=t!==void 0,a=t===null,s=t===t,o=r(t),l=n!==void 0,u=n===null,c=n===n,h=r(n);if(!u&&!h&&!o&&t>n||o&&l&&c&&!u&&!h||a&&l&&c||!i&&c||!s)return 1;if(!a&&!o&&!h&&t<n||h&&i&&s&&!a&&!o||u&&i&&s||!l&&s||!c)return-1}return 0}return Z0=e,Z0}var J0,tO;function _W(){if(tO)return J0;tO=1;var r=SW();function e(t,n,i){for(var a=-1,s=t.criteria,o=n.criteria,l=s.length,u=i.length;++a<l;){var c=r(s[a],o[a]);if(c){if(a>=u)return c;var h=i[a];return c*(h=="desc"?-1:1)}}return t.index-n.index}return J0=e,J0}var Q0,nO;function MW(){if(nO)return Q0;nO=1;var r=Sh(),e=Mh(),t=zi(),n=tN(),i=EW(),a=bh(),s=_W(),o=os(),l=rn();function u(c,h,d){h.length?h=r(h,function(v){return l(v)?function(p){return e(p,v.length===1?v[0]:v)}:v}):h=[o];var f=-1;h=r(h,a(t));var g=n(c,function(v,p,y){var m=r(h,function(w){return w(v)});return{criteria:m,index:++f,value:v}});return i(g,function(v,p){return s(v,p,d)})}return Q0=u,Q0}var ey,rO;function OW(){if(rO)return ey;rO=1;var r=xb(),e=MW(),t=Oh(),n=kh(),i=t(function(a,s){if(a==null)return[];var o=s.length;return o>1&&n(a,s[0],s[1])?s=[]:o>2&&n(s[0],s[1],s[2])&&(s=[s[0]]),e(a,r(s,1),[])});return ey=i,ey}var ty,iO;function kW(){if(iO)return ty;iO=1;var r=YC(),e=0;function t(n){var i=++e;return r(n)+i}return ty=t,ty}var ny,aO;function TW(){if(aO)return ny;aO=1;function r(e,t,n){for(var i=-1,a=e.length,s=t.length,o={};++i<a;){var l=i<s?t[i]:void 0;n(o,e[i],l)}return o}return ny=r,ny}var ry,sO;function AW(){if(sO)return ry;sO=1;var r=yh(),e=TW();function t(n,i){return e(n||[],i||[],r)}return ry=t,ry}var iy,oO;function Lt(){if(oO)return iy;oO=1;var r;if(typeof sb=="function")try{r={cloneDeep:VG(),constant:vb(),defaults:UG(),each:qC(),filter:JC(),find:QG(),flatten:pN(),forEach:jC(),forIn:eW(),has:QC(),isUndefined:eN(),last:tW(),map:nN(),mapValues:nW(),max:iW(),merge:cW(),min:hW(),minBy:dW(),now:fW(),pick:mW(),range:xW(),reduce:rN(),sortBy:OW(),uniqueId:kW(),values:lN(),zipObject:AW()}}catch{}return r||(r=window._),iy=r,iy}var ay,lO;function PW(){if(lO)return ay;lO=1,ay=r;function r(){var n={};n._next=n._prev=n,this._sentinel=n}r.prototype.dequeue=function(){var n=this._sentinel,i=n._prev;if(i!==n)return e(i),i},r.prototype.enqueue=function(n){var i=this._sentinel;n._prev&&n._next&&e(n),n._next=i._next,i._next._prev=n,i._next=n,n._prev=i},r.prototype.toString=function(){for(var n=[],i=this._sentinel,a=i._prev;a!==i;)n.push(JSON.stringify(a,t)),a=a._prev;return"["+n.join(", ")+"]"};function e(n){n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev}function t(n,i){if(n!=="_next"&&n!=="_prev")return i}return ay}var sy,uO;function CW(){if(uO)return sy;uO=1;var r=Lt(),e=Wr().Graph,t=PW();sy=i;var n=r.constant(1);function i(u,c){if(u.nodeCount()<=1)return[];var h=o(u,c||n),d=a(h.graph,h.buckets,h.zeroIdx);return r.flatten(r.map(d,function(f){return u.outEdges(f.v,f.w)}),!0)}function a(u,c,h){for(var d=[],f=c[c.length-1],g=c[0],v;u.nodeCount();){for(;v=g.dequeue();)s(u,c,h,v);for(;v=f.dequeue();)s(u,c,h,v);if(u.nodeCount()){for(var p=c.length-2;p>0;--p)if(v=c[p].dequeue(),v){d=d.concat(s(u,c,h,v,!0));break}}}return d}function s(u,c,h,d,f){var g=f?[]:void 0;return r.forEach(u.inEdges(d.v),function(v){var p=u.edge(v),y=u.node(v.v);f&&g.push({v:v.v,w:v.w}),y.out-=p,l(c,h,y)}),r.forEach(u.outEdges(d.v),function(v){var p=u.edge(v),y=v.w,m=u.node(y);m.in-=p,l(c,h,m)}),u.removeNode(d.v),g}function o(u,c){var h=new e,d=0,f=0;r.forEach(u.nodes(),function(p){h.setNode(p,{v:p,in:0,out:0})}),r.forEach(u.edges(),function(p){var y=h.edge(p.v,p.w)||0,m=c(p),w=y+m;h.setEdge(p.v,p.w,w),f=Math.max(f,h.node(p.v).out+=m),d=Math.max(d,h.node(p.w).in+=m)});var g=r.range(f+d+3).map(function(){return new t}),v=d+1;return r.forEach(h.nodes(),function(p){l(g,v,h.node(p))}),{graph:h,buckets:g,zeroIdx:v}}function l(u,c,h){h.out?h.in?u[h.out-h.in+c].enqueue(h):u[u.length-1].enqueue(h):u[0].enqueue(h)}return sy}var oy,cO;function NW(){if(cO)return oy;cO=1;var r=Lt(),e=CW();oy={run:t,undo:i};function t(a){var s=a.graph().acyclicer==="greedy"?e(a,o(a)):n(a);r.forEach(s,function(l){var u=a.edge(l);a.removeEdge(l),u.forwardName=l.name,u.reversed=!0,a.setEdge(l.w,l.v,u,r.uniqueId("rev"))});function o(l){return function(u){return l.edge(u).weight}}}function n(a){var s=[],o={},l={};function u(c){r.has(l,c)||(l[c]=!0,o[c]=!0,r.forEach(a.outEdges(c),function(h){r.has(o,h.w)?s.push(h):u(h.w)}),delete o[c])}return r.forEach(a.nodes(),u),s}function i(a){r.forEach(a.edges(),function(s){var o=a.edge(s);if(o.reversed){a.removeEdge(s);var l=o.forwardName;delete o.reversed,delete o.forwardName,a.setEdge(s.w,s.v,o,l)}})}return oy}var ly,hO;function er(){if(hO)return ly;hO=1;var r=Lt(),e=Wr().Graph;ly={addDummyNode:t,simplify:n,asNonCompoundGraph:i,successorWeights:a,predecessorWeights:s,intersectRect:o,buildLayerMatrix:l,normalizeRanks:u,removeEmptyRanks:c,addBorderNode:h,maxRank:d,partition:f,time:g,notime:v};function t(p,y,m,w){var S;do S=r.uniqueId(w);while(p.hasNode(S));return m.dummy=y,p.setNode(S,m),S}function n(p){var y=new e().setGraph(p.graph());return r.forEach(p.nodes(),function(m){y.setNode(m,p.node(m))}),r.forEach(p.edges(),function(m){var w=y.edge(m.v,m.w)||{weight:0,minlen:1},S=p.edge(m);y.setEdge(m.v,m.w,{weight:w.weight+S.weight,minlen:Math.max(w.minlen,S.minlen)})}),y}function i(p){var y=new e({multigraph:p.isMultigraph()}).setGraph(p.graph());return r.forEach(p.nodes(),function(m){p.children(m).length||y.setNode(m,p.node(m))}),r.forEach(p.edges(),function(m){y.setEdge(m,p.edge(m))}),y}function a(p){var y=r.map(p.nodes(),function(m){var w={};return r.forEach(p.outEdges(m),function(S){w[S.w]=(w[S.w]||0)+p.edge(S).weight}),w});return r.zipObject(p.nodes(),y)}function s(p){var y=r.map(p.nodes(),function(m){var w={};return r.forEach(p.inEdges(m),function(S){w[S.v]=(w[S.v]||0)+p.edge(S).weight}),w});return r.zipObject(p.nodes(),y)}function o(p,y){var m=p.x,w=p.y,S=y.x-m,_=y.y-w,O=p.width/2,T=p.height/2;if(!S&&!_)throw new Error("Not possible to find intersection inside of the rectangle");var k,P;return Math.abs(_)*O>Math.abs(S)*T?(_<0&&(T=-T),k=T*S/_,P=T):(S<0&&(O=-O),k=O,P=O*_/S),{x:m+k,y:w+P}}function l(p){var y=r.map(r.range(d(p)+1),function(){return[]});return r.forEach(p.nodes(),function(m){var w=p.node(m),S=w.rank;r.isUndefined(S)||(y[S][w.order]=m)}),y}function u(p){var y=r.min(r.map(p.nodes(),function(m){return p.node(m).rank}));r.forEach(p.nodes(),function(m){var w=p.node(m);r.has(w,"rank")&&(w.rank-=y)})}function c(p){var y=r.min(r.map(p.nodes(),function(_){return p.node(_).rank})),m=[];r.forEach(p.nodes(),function(_){var O=p.node(_).rank-y;m[O]||(m[O]=[]),m[O].push(_)});var w=0,S=p.graph().nodeRankFactor;r.forEach(m,function(_,O){r.isUndefined(_)&&O%S!==0?--w:w&&r.forEach(_,function(T){p.node(T).rank+=w})})}function h(p,y,m,w){var S={width:0,height:0};return arguments.length>=4&&(S.rank=m,S.order=w),t(p,"border",S,y)}function d(p){return r.max(r.map(p.nodes(),function(y){var m=p.node(y).rank;if(!r.isUndefined(m))return m}))}function f(p,y){var m={lhs:[],rhs:[]};return r.forEach(p,function(w){y(w)?m.lhs.push(w):m.rhs.push(w)}),m}function g(p,y){var m=r.now();try{return y()}finally{console.log(p+" time: "+(r.now()-m)+"ms")}}function v(p,y){return y()}return ly}var uy,dO;function RW(){if(dO)return uy;dO=1;var r=Lt(),e=er();uy={run:t,undo:i};function t(a){a.graph().dummyChains=[],r.forEach(a.edges(),function(s){n(a,s)})}function n(a,s){var o=s.v,l=a.node(o).rank,u=s.w,c=a.node(u).rank,h=s.name,d=a.edge(s),f=d.labelRank;if(c!==l+1){a.removeEdge(s);var g,v,p;for(p=0,++l;l<c;++p,++l)d.points=[],v={width:0,height:0,edgeLabel:d,edgeObj:s,rank:l},g=e.addDummyNode(a,"edge",v,"_d"),l===f&&(v.width=d.width,v.height=d.height,v.dummy="edge-label",v.labelpos=d.labelpos),a.setEdge(o,g,{weight:d.weight},h),p===0&&a.graph().dummyChains.push(g),o=g;a.setEdge(o,u,{weight:d.weight},h)}}function i(a){r.forEach(a.graph().dummyChains,function(s){var o=a.node(s),l=o.edgeLabel,u;for(a.setEdge(o.edgeObj,l);o.dummy;)u=a.successors(s)[0],a.removeNode(s),l.points.push({x:o.x,y:o.y}),o.dummy==="edge-label"&&(l.x=o.x,l.y=o.y,l.width=o.width,l.height=o.height),s=u,o=a.node(s)})}return uy}var cy,fO;function bc(){if(fO)return cy;fO=1;var r=Lt();cy={longestPath:e,slack:t};function e(n){var i={};function a(s){var o=n.node(s);if(r.has(i,s))return o.rank;i[s]=!0;var l=r.min(r.map(n.outEdges(s),function(u){return a(u.w)-n.edge(u).minlen}));return(l===Number.POSITIVE_INFINITY||l===void 0||l===null)&&(l=0),o.rank=l}r.forEach(n.sources(),a)}function t(n,i){return n.node(i.w).rank-n.node(i.v).rank-n.edge(i).minlen}return cy}var hy,gO;function bN(){if(gO)return hy;gO=1;var r=Lt(),e=Wr().Graph,t=bc().slack;hy=n;function n(o){var l=new e({directed:!1}),u=o.nodes()[0],c=o.nodeCount();l.setNode(u,{});for(var h,d;i(l,o)<c;)h=a(l,o),d=l.hasNode(h.v)?t(o,h):-t(o,h),s(l,o,d);return l}function i(o,l){function u(c){r.forEach(l.nodeEdges(c),function(h){var d=h.v,f=c===d?h.w:d;!o.hasNode(f)&&!t(l,h)&&(o.setNode(f,{}),o.setEdge(c,f,{}),u(f))})}return r.forEach(o.nodes(),u),o.nodeCount()}function a(o,l){return r.minBy(l.edges(),function(u){if(o.hasNode(u.v)!==o.hasNode(u.w))return t(l,u)})}function s(o,l,u){r.forEach(o.nodes(),function(c){l.node(c).rank+=u})}return hy}var dy,pO;function LW(){if(pO)return dy;pO=1;var r=Lt(),e=bN(),t=bc().slack,n=bc().longestPath,i=Wr().alg.preorder,a=Wr().alg.postorder,s=er().simplify;dy=o,o.initLowLimValues=h,o.initCutValues=l,o.calcCutValue=c,o.leaveEdge=f,o.enterEdge=g,o.exchangeEdges=v;function o(w){w=s(w),n(w);var S=e(w);h(S),l(S,w);for(var _,O;_=f(S);)O=g(S,w,_),v(S,w,_,O)}function l(w,S){var _=a(w,w.nodes());_=_.slice(0,_.length-1),r.forEach(_,function(O){u(w,S,O)})}function u(w,S,_){var O=w.node(_),T=O.parent;w.edge(_,T).cutvalue=c(w,S,_)}function c(w,S,_){var O=w.node(_),T=O.parent,k=!0,P=S.edge(_,T),C=0;return P||(k=!1,P=S.edge(T,_)),C=P.weight,r.forEach(S.nodeEdges(_),function(N){var L=N.v===_,F=L?N.w:N.v;if(F!==T){var G=L===k,V=S.edge(N).weight;if(C+=G?V:-V,y(w,_,F)){var U=w.edge(_,F).cutvalue;C+=G?-U:U}}}),C}function h(w,S){arguments.length<2&&(S=w.nodes()[0]),d(w,{},1,S)}function d(w,S,_,O,T){var k=_,P=w.node(O);return S[O]=!0,r.forEach(w.neighbors(O),function(C){r.has(S,C)||(_=d(w,S,_,C,O))}),P.low=k,P.lim=_++,T?P.parent=T:delete P.parent,_}function f(w){return r.find(w.edges(),function(S){return w.edge(S).cutvalue<0})}function g(w,S,_){var O=_.v,T=_.w;S.hasEdge(O,T)||(O=_.w,T=_.v);var k=w.node(O),P=w.node(T),C=k,N=!1;k.lim>P.lim&&(C=P,N=!0);var L=r.filter(S.edges(),function(F){return N===m(w,w.node(F.v),C)&&N!==m(w,w.node(F.w),C)});return r.minBy(L,function(F){return t(S,F)})}function v(w,S,_,O){var T=_.v,k=_.w;w.removeEdge(T,k),w.setEdge(O.v,O.w,{}),h(w),l(w,S),p(w,S)}function p(w,S){var _=r.find(w.nodes(),function(T){return!S.node(T).parent}),O=i(w,_);O=O.slice(1),r.forEach(O,function(T){var k=w.node(T).parent,P=S.edge(T,k),C=!1;P||(P=S.edge(k,T),C=!0),S.node(T).rank=S.node(k).rank+(C?P.minlen:-P.minlen)})}function y(w,S,_){return w.hasEdge(S,_)}function m(w,S,_){return _.low<=S.lim&&S.lim<=_.lim}return dy}var fy,vO;function IW(){if(vO)return fy;vO=1;var r=bc(),e=r.longestPath,t=bN(),n=LW();fy=i;function i(l){switch(l.graph().ranker){case"network-simplex":o(l);break;case"tight-tree":s(l);break;case"longest-path":a(l);break;default:o(l)}}var a=e;function s(l){e(l),t(l)}function o(l){n(l)}return fy}var gy,yO;function DW(){if(yO)return gy;yO=1;var r=Lt();gy=e;function e(i){var a=n(i);r.forEach(i.graph().dummyChains,function(s){for(var o=i.node(s),l=o.edgeObj,u=t(i,a,l.v,l.w),c=u.path,h=u.lca,d=0,f=c[d],g=!0;s!==l.w;){if(o=i.node(s),g){for(;(f=c[d])!==h&&i.node(f).maxRank<o.rank;)d++;f===h&&(g=!1)}if(!g){for(;d<c.length-1&&i.node(f=c[d+1]).minRank<=o.rank;)d++;f=c[d]}i.setParent(s,f),s=i.successors(s)[0]}})}function t(i,a,s,o){var l=[],u=[],c=Math.min(a[s].low,a[o].low),h=Math.max(a[s].lim,a[o].lim),d,f;d=s;do d=i.parent(d),l.push(d);while(d&&(a[d].low>c||h>a[d].lim));for(f=d,d=o;(d=i.parent(d))!==f;)u.push(d);return{path:l.concat(u.reverse()),lca:f}}function n(i){var a={},s=0;function o(l){var u=s;r.forEach(i.children(l),o),a[l]={low:u,lim:s++}}return r.forEach(i.children(),o),a}return gy}var py,mO;function FW(){if(mO)return py;mO=1;var r=Lt(),e=er();py={run:t,cleanup:s};function t(o){var l=e.addDummyNode(o,"root",{},"_root"),u=i(o),c=r.max(r.values(u))-1,h=2*c+1;o.graph().nestingRoot=l,r.forEach(o.edges(),function(f){o.edge(f).minlen*=h});var d=a(o)+1;r.forEach(o.children(),function(f){n(o,l,h,d,c,u,f)}),o.graph().nodeRankFactor=h}function n(o,l,u,c,h,d,f){var g=o.children(f);if(!g.length){f!==l&&o.setEdge(l,f,{weight:0,minlen:u});return}var v=e.addBorderNode(o,"_bt"),p=e.addBorderNode(o,"_bb"),y=o.node(f);o.setParent(v,f),y.borderTop=v,o.setParent(p,f),y.borderBottom=p,r.forEach(g,function(m){n(o,l,u,c,h,d,m);var w=o.node(m),S=w.borderTop?w.borderTop:m,_=w.borderBottom?w.borderBottom:m,O=w.borderTop?c:2*c,T=S!==_?1:h-d[f]+1;o.setEdge(v,S,{weight:O,minlen:T,nestingEdge:!0}),o.setEdge(_,p,{weight:O,minlen:T,nestingEdge:!0})}),o.parent(f)||o.setEdge(l,v,{weight:0,minlen:h+d[f]})}function i(o){var l={};function u(c,h){var d=o.children(c);d&&d.length&&r.forEach(d,function(f){u(f,h+1)}),l[c]=h}return r.forEach(o.children(),function(c){u(c,1)}),l}function a(o){return r.reduce(o.edges(),function(l,u){return l+o.edge(u).weight},0)}function s(o){var l=o.graph();o.removeNode(l.nestingRoot),delete l.nestingRoot,r.forEach(o.edges(),function(u){var c=o.edge(u);c.nestingEdge&&o.removeEdge(u)})}return py}var vy,bO;function BW(){if(bO)return vy;bO=1;var r=Lt(),e=er();vy=t;function t(i){function a(s){var o=i.children(s),l=i.node(s);if(o.length&&r.forEach(o,a),r.has(l,"minRank")){l.borderLeft=[],l.borderRight=[];for(var u=l.minRank,c=l.maxRank+1;u<c;++u)n(i,"borderLeft","_bl",s,l,u),n(i,"borderRight","_br",s,l,u)}}r.forEach(i.children(),a)}function n(i,a,s,o,l,u){var c={width:0,height:0,rank:u,borderType:a},h=l[a][u-1],d=e.addDummyNode(i,"border",c,s);l[a][u]=d,i.setParent(d,o),h&&i.setEdge(h,d,{weight:1})}return vy}var yy,wO;function zW(){if(wO)return yy;wO=1;var r=Lt();yy={adjust:e,undo:t};function e(u){var c=u.graph().rankdir.toLowerCase();(c==="lr"||c==="rl")&&n(u)}function t(u){var c=u.graph().rankdir.toLowerCase();(c==="bt"||c==="rl")&&a(u),(c==="lr"||c==="rl")&&(o(u),n(u))}function n(u){r.forEach(u.nodes(),function(c){i(u.node(c))}),r.forEach(u.edges(),function(c){i(u.edge(c))})}function i(u){var c=u.width;u.width=u.height,u.height=c}function a(u){r.forEach(u.nodes(),function(c){s(u.node(c))}),r.forEach(u.edges(),function(c){var h=u.edge(c);r.forEach(h.points,s),r.has(h,"y")&&s(h)})}function s(u){u.y=-u.y}function o(u){r.forEach(u.nodes(),function(c){l(u.node(c))}),r.forEach(u.edges(),function(c){var h=u.edge(c);r.forEach(h.points,l),r.has(h,"x")&&l(h)})}function l(u){var c=u.x;u.x=u.y,u.y=c}return yy}var my,xO;function jW(){if(xO)return my;xO=1;var r=Lt();my=e;function e(t){var n={},i=r.filter(t.nodes(),function(u){return!t.children(u).length}),a=r.max(r.map(i,function(u){return t.node(u).rank})),s=r.map(r.range(a+1),function(){return[]});function o(u){if(!r.has(n,u)){n[u]=!0;var c=t.node(u);s[c.rank].push(u),r.forEach(t.successors(u),o)}}var l=r.sortBy(i,function(u){return t.node(u).rank});return r.forEach(l,o),s}return my}var by,EO;function qW(){if(EO)return by;EO=1;var r=Lt();by=e;function e(n,i){for(var a=0,s=1;s<i.length;++s)a+=t(n,i[s-1],i[s]);return a}function t(n,i,a){for(var s=r.zipObject(a,r.map(a,function(d,f){return f})),o=r.flatten(r.map(i,function(d){return r.sortBy(r.map(n.outEdges(d),function(f){return{pos:s[f.w],weight:n.edge(f).weight}}),"pos")}),!0),l=1;l<a.length;)l<<=1;var u=2*l-1;l-=1;var c=r.map(new Array(u),function(){return 0}),h=0;return r.forEach(o.forEach(function(d){var f=d.pos+l;c[f]+=d.weight;for(var g=0;f>0;)f%2&&(g+=c[f+1]),f=f-1>>1,c[f]+=d.weight;h+=d.weight*g})),h}return by}var wy,SO;function $W(){if(SO)return wy;SO=1;var r=Lt();wy=e;function e(t,n){return r.map(n,function(i){var a=t.inEdges(i);if(a.length){var s=r.reduce(a,function(o,l){var u=t.edge(l),c=t.node(l.v);return{sum:o.sum+u.weight*c.order,weight:o.weight+u.weight}},{sum:0,weight:0});return{v:i,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:i}})}return wy}var xy,_O;function GW(){if(_O)return xy;_O=1;var r=Lt();xy=e;function e(i,a){var s={};r.forEach(i,function(l,u){var c=s[l.v]={indegree:0,in:[],out:[],vs:[l.v],i:u};r.isUndefined(l.barycenter)||(c.barycenter=l.barycenter,c.weight=l.weight)}),r.forEach(a.edges(),function(l){var u=s[l.v],c=s[l.w];!r.isUndefined(u)&&!r.isUndefined(c)&&(c.indegree++,u.out.push(s[l.w]))});var o=r.filter(s,function(l){return!l.indegree});return t(o)}function t(i){var a=[];function s(u){return function(c){c.merged||(r.isUndefined(c.barycenter)||r.isUndefined(u.barycenter)||c.barycenter>=u.barycenter)&&n(u,c)}}function o(u){return function(c){c.in.push(u),--c.indegree===0&&i.push(c)}}for(;i.length;){var l=i.pop();a.push(l),r.forEach(l.in.reverse(),s(l)),r.forEach(l.out,o(l))}return r.map(r.filter(a,function(u){return!u.merged}),function(u){return r.pick(u,["vs","i","barycenter","weight"])})}function n(i,a){var s=0,o=0;i.weight&&(s+=i.barycenter*i.weight,o+=i.weight),a.weight&&(s+=a.barycenter*a.weight,o+=a.weight),i.vs=a.vs.concat(i.vs),i.barycenter=s/o,i.weight=o,i.i=Math.min(a.i,i.i),a.merged=!0}return xy}var Ey,MO;function WW(){if(MO)return Ey;MO=1;var r=Lt(),e=er();Ey=t;function t(a,s){var o=e.partition(a,function(v){return r.has(v,"barycenter")}),l=o.lhs,u=r.sortBy(o.rhs,function(v){return-v.i}),c=[],h=0,d=0,f=0;l.sort(i(!!s)),f=n(c,u,f),r.forEach(l,function(v){f+=v.vs.length,c.push(v.vs),h+=v.barycenter*v.weight,d+=v.weight,f=n(c,u,f)});var g={vs:r.flatten(c,!0)};return d&&(g.barycenter=h/d,g.weight=d),g}function n(a,s,o){for(var l;s.length&&(l=r.last(s)).i<=o;)s.pop(),a.push(l.vs),o++;return o}function i(a){return function(s,o){return s.barycenter<o.barycenter?-1:s.barycenter>o.barycenter?1:a?o.i-s.i:s.i-o.i}}return Ey}var Sy,OO;function VW(){if(OO)return Sy;OO=1;var r=Lt(),e=$W(),t=GW(),n=WW();Sy=i;function i(o,l,u,c){var h=o.children(l),d=o.node(l),f=d?d.borderLeft:void 0,g=d?d.borderRight:void 0,v={};f&&(h=r.filter(h,function(_){return _!==f&&_!==g}));var p=e(o,h);r.forEach(p,function(_){if(o.children(_.v).length){var O=i(o,_.v,u,c);v[_.v]=O,r.has(O,"barycenter")&&s(_,O)}});var y=t(p,u);a(y,v);var m=n(y,c);if(f&&(m.vs=r.flatten([f,m.vs,g],!0),o.predecessors(f).length)){var w=o.node(o.predecessors(f)[0]),S=o.node(o.predecessors(g)[0]);r.has(m,"barycenter")||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+w.order+S.order)/(m.weight+2),m.weight+=2}return m}function a(o,l){r.forEach(o,function(u){u.vs=r.flatten(u.vs.map(function(c){return l[c]?l[c].vs:c}),!0)})}function s(o,l){r.isUndefined(o.barycenter)?(o.barycenter=l.barycenter,o.weight=l.weight):(o.barycenter=(o.barycenter*o.weight+l.barycenter*l.weight)/(o.weight+l.weight),o.weight+=l.weight)}return Sy}var _y,kO;function UW(){if(kO)return _y;kO=1;var r=Lt(),e=Wr().Graph;_y=t;function t(i,a,s){var o=n(i),l=new e({compound:!0}).setGraph({root:o}).setDefaultNodeLabel(function(u){return i.node(u)});return r.forEach(i.nodes(),function(u){var c=i.node(u),h=i.parent(u);(c.rank===a||c.minRank<=a&&a<=c.maxRank)&&(l.setNode(u),l.setParent(u,h||o),r.forEach(i[s](u),function(d){var f=d.v===u?d.w:d.v,g=l.edge(f,u),v=r.isUndefined(g)?0:g.weight;l.setEdge(f,u,{weight:i.edge(d).weight+v})}),r.has(c,"minRank")&&l.setNode(u,{borderLeft:c.borderLeft[a],borderRight:c.borderRight[a]}))}),l}function n(i){for(var a;i.hasNode(a=r.uniqueId("_root")););return a}return _y}var My,TO;function HW(){if(TO)return My;TO=1;var r=Lt();My=e;function e(t,n,i){var a={},s;r.forEach(i,function(o){for(var l=t.parent(o),u,c;l;){if(u=t.parent(l),u?(c=a[u],a[u]=l):(c=s,s=l),c&&c!==l){n.setEdge(c,l);return}l=u}})}return My}var Oy,AO;function YW(){if(AO)return Oy;AO=1;var r=Lt(),e=jW(),t=qW(),n=VW(),i=UW(),a=HW(),s=Wr().Graph,o=er();Oy=l;function l(d){var f=o.maxRank(d),g=u(d,r.range(1,f+1),"inEdges"),v=u(d,r.range(f-1,-1,-1),"outEdges"),p=e(d);h(d,p);for(var y=Number.POSITIVE_INFINITY,m,w=0,S=0;S<4;++w,++S){c(w%2?g:v,w%4>=2),p=o.buildLayerMatrix(d);var _=t(d,p);_<y&&(S=0,m=r.cloneDeep(p),y=_)}h(d,m)}function u(d,f,g){return r.map(f,function(v){return i(d,v,g)})}function c(d,f){var g=new s;r.forEach(d,function(v){var p=v.graph().root,y=n(v,p,g,f);r.forEach(y.vs,function(m,w){v.node(m).order=w}),a(v,g,y.vs)})}function h(d,f){r.forEach(f,function(g){r.forEach(g,function(v,p){d.node(v).order=p})})}return Oy}var ky,PO;function XW(){if(PO)return ky;PO=1;var r=Lt(),e=Wr().Graph,t=er();ky={positionX:g,findType1Conflicts:n,findType2Conflicts:i,addConflict:s,hasConflict:o,verticalAlignment:l,horizontalCompaction:u,alignCoordinates:d,findSmallestWidthAlignment:h,balance:f};function n(y,m){var w={};function S(_,O){var T=0,k=0,P=_.length,C=r.last(O);return r.forEach(O,function(N,L){var F=a(y,N),G=F?y.node(F).order:P;(F||N===C)&&(r.forEach(O.slice(k,L+1),function(V){r.forEach(y.predecessors(V),function(U){var $=y.node(U),j=$.order;(j<T||G<j)&&!($.dummy&&y.node(V).dummy)&&s(w,U,V)})}),k=L+1,T=G)}),O}return r.reduce(m,S),w}function i(y,m){var w={};function S(O,T,k,P,C){var N;r.forEach(r.range(T,k),function(L){N=O[L],y.node(N).dummy&&r.forEach(y.predecessors(N),function(F){var G=y.node(F);G.dummy&&(G.order<P||G.order>C)&&s(w,F,N)})})}function _(O,T){var k=-1,P,C=0;return r.forEach(T,function(N,L){if(y.node(N).dummy==="border"){var F=y.predecessors(N);F.length&&(P=y.node(F[0]).order,S(T,C,L,k,P),C=L,k=P)}S(T,C,T.length,P,O.length)}),T}return r.reduce(m,_),w}function a(y,m){if(y.node(m).dummy)return r.find(y.predecessors(m),function(w){return y.node(w).dummy})}function s(y,m,w){if(m>w){var S=m;m=w,w=S}var _=y[m];_||(y[m]=_={}),_[w]=!0}function o(y,m,w){if(m>w){var S=m;m=w,w=S}return r.has(y[m],w)}function l(y,m,w,S){var _={},O={},T={};return r.forEach(m,function(k){r.forEach(k,function(P,C){_[P]=P,O[P]=P,T[P]=C})}),r.forEach(m,function(k){var P=-1;r.forEach(k,function(C){var N=S(C);if(N.length){N=r.sortBy(N,function(U){return T[U]});for(var L=(N.length-1)/2,F=Math.floor(L),G=Math.ceil(L);F<=G;++F){var V=N[F];O[C]===C&&P<T[V]&&!o(w,C,V)&&(O[V]=C,O[C]=_[C]=_[V],P=T[V])}}})}),{root:_,align:O}}function u(y,m,w,S,_){var O={},T=c(y,m,w,_),k=_?"borderLeft":"borderRight";function P(L,F){for(var G=T.nodes(),V=G.pop(),U={};V;)U[V]?L(V):(U[V]=!0,G.push(V),G=G.concat(F(V))),V=G.pop()}function C(L){O[L]=T.inEdges(L).reduce(function(F,G){return Math.max(F,O[G.v]+T.edge(G))},0)}function N(L){var F=T.outEdges(L).reduce(function(V,U){return Math.min(V,O[U.w]-T.edge(U))},Number.POSITIVE_INFINITY),G=y.node(L);F!==Number.POSITIVE_INFINITY&&G.borderType!==k&&(O[L]=Math.max(O[L],F))}return P(C,T.predecessors.bind(T)),P(N,T.successors.bind(T)),r.forEach(S,function(L){O[L]=O[w[L]]}),O}function c(y,m,w,S){var _=new e,O=y.graph(),T=v(O.nodesep,O.edgesep,S);return r.forEach(m,function(k){var P;r.forEach(k,function(C){var N=w[C];if(_.setNode(N),P){var L=w[P],F=_.edge(L,N);_.setEdge(L,N,Math.max(T(y,C,P),F||0))}P=C})}),_}function h(y,m){return r.minBy(r.values(m),function(w){var S=Number.NEGATIVE_INFINITY,_=Number.POSITIVE_INFINITY;return r.forIn(w,function(O,T){var k=p(y,T)/2;S=Math.max(O+k,S),_=Math.min(O-k,_)}),S-_})}function d(y,m){var w=r.values(m),S=r.min(w),_=r.max(w);r.forEach(["u","d"],function(O){r.forEach(["l","r"],function(T){var k=O+T,P=y[k],C;if(P!==m){var N=r.values(P);C=T==="l"?S-r.min(N):_-r.max(N),C&&(y[k]=r.mapValues(P,function(L){return L+C}))}})})}function f(y,m){return r.mapValues(y.ul,function(w,S){if(m)return y[m.toLowerCase()][S];var _=r.sortBy(r.map(y,S));return(_[1]+_[2])/2})}function g(y){var m=t.buildLayerMatrix(y),w=r.merge(n(y,m),i(y,m)),S={},_;r.forEach(["u","d"],function(T){_=T==="u"?m:r.values(m).reverse(),r.forEach(["l","r"],function(k){k==="r"&&(_=r.map(_,function(L){return r.values(L).reverse()}));var P=(T==="u"?y.predecessors:y.successors).bind(y),C=l(y,_,w,P),N=u(y,_,C.root,C.align,k==="r");k==="r"&&(N=r.mapValues(N,function(L){return-L})),S[T+k]=N})});var O=h(y,S);return d(S,O),f(S,y.graph().align)}function v(y,m,w){return function(S,_,O){var T=S.node(_),k=S.node(O),P=0,C;if(P+=T.width/2,r.has(T,"labelpos"))switch(T.labelpos.toLowerCase()){case"l":C=-T.width/2;break;case"r":C=T.width/2;break}if(C&&(P+=w?C:-C),C=0,P+=(T.dummy?m:y)/2,P+=(k.dummy?m:y)/2,P+=k.width/2,r.has(k,"labelpos"))switch(k.labelpos.toLowerCase()){case"l":C=k.width/2;break;case"r":C=-k.width/2;break}return C&&(P+=w?C:-C),C=0,P}}function p(y,m){return y.node(m).width}return ky}var Ty,CO;function KW(){if(CO)return Ty;CO=1;var r=Lt(),e=er(),t=XW().positionX;Ty=n;function n(a){a=e.asNonCompoundGraph(a),i(a),r.forEach(t(a),function(s,o){a.node(o).x=s})}function i(a){var s=e.buildLayerMatrix(a),o=a.graph().ranksep,l=0;r.forEach(s,function(u){var c=r.max(r.map(u,function(h){return a.node(h).height}));r.forEach(u,function(h){a.node(h).y=l+c/2}),l+=c+o})}return Ty}var Ay,NO;function ZW(){if(NO)return Ay;NO=1;var r=Lt(),e=NW(),t=RW(),n=IW(),i=er().normalizeRanks,a=DW(),s=er().removeEmptyRanks,o=FW(),l=BW(),u=zW(),c=YW(),h=KW(),d=er(),f=Wr().Graph;Ay=g;function g(K,W){var ee=W&&W.debugTiming?d.time:d.notime;ee("layout",function(){var he=ee("  buildLayoutGraph",function(){return P(K)});ee("  runLayout",function(){v(he,ee)}),ee("  updateInputGraph",function(){p(K,he)})})}function v(K,W){W("    makeSpaceForEdgeLabels",function(){C(K)}),W("    removeSelfEdges",function(){Z(K)}),W("    acyclic",function(){e.run(K)}),W("    nestingGraph.run",function(){o.run(K)}),W("    rank",function(){n(d.asNonCompoundGraph(K))}),W("    injectEdgeLabelProxies",function(){N(K)}),W("    removeEmptyRanks",function(){s(K)}),W("    nestingGraph.cleanup",function(){o.cleanup(K)}),W("    normalizeRanks",function(){i(K)}),W("    assignRankMinMax",function(){L(K)}),W("    removeEdgeLabelProxies",function(){F(K)}),W("    normalize.run",function(){t.run(K)}),W("    parentDummyChains",function(){a(K)}),W("    addBorderSegments",function(){l(K)}),W("    order",function(){c(K)}),W("    insertSelfEdges",function(){ne(K)}),W("    adjustCoordinateSystem",function(){u.adjust(K)}),W("    position",function(){h(K)}),W("    positionSelfEdges",function(){oe(K)}),W("    removeBorderNodes",function(){j(K)}),W("    normalize.undo",function(){t.undo(K)}),W("    fixupEdgeLabelCoords",function(){U(K)}),W("    undoCoordinateSystem",function(){u.undo(K)}),W("    translateGraph",function(){G(K)}),W("    assignNodeIntersects",function(){V(K)}),W("    reversePoints",function(){$(K)}),W("    acyclic.undo",function(){e.undo(K)})}function p(K,W){r.forEach(K.nodes(),function(ee){var he=K.node(ee),Se=W.node(ee);he&&(he.x=Se.x,he.y=Se.y,W.children(ee).length&&(he.width=Se.width,he.height=Se.height))}),r.forEach(K.edges(),function(ee){var he=K.edge(ee),Se=W.edge(ee);he.points=Se.points,r.has(Se,"x")&&(he.x=Se.x,he.y=Se.y)}),K.graph().width=W.graph().width,K.graph().height=W.graph().height}var y=["nodesep","edgesep","ranksep","marginx","marginy"],m={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},w=["acyclicer","ranker","rankdir","align"],S=["width","height"],_={width:0,height:0},O=["minlen","weight","width","height","labeloffset"],T={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},k=["labelpos"];function P(K){var W=new f({multigraph:!0,compound:!0}),ee=Ce(K.graph());return W.setGraph(r.merge({},m,le(ee,y),r.pick(ee,w))),r.forEach(K.nodes(),function(he){var Se=Ce(K.node(he));W.setNode(he,r.defaults(le(Se,S),_)),W.setParent(he,K.parent(he))}),r.forEach(K.edges(),function(he){var Se=Ce(K.edge(he));W.setEdge(he,r.merge({},T,le(Se,O),r.pick(Se,k)))}),W}function C(K){var W=K.graph();W.ranksep/=2,r.forEach(K.edges(),function(ee){var he=K.edge(ee);he.minlen*=2,he.labelpos.toLowerCase()!=="c"&&(W.rankdir==="TB"||W.rankdir==="BT"?he.width+=he.labeloffset:he.height+=he.labeloffset)})}function N(K){r.forEach(K.edges(),function(W){var ee=K.edge(W);if(ee.width&&ee.height){var he=K.node(W.v),Se=K.node(W.w),Ne={rank:(Se.rank-he.rank)/2+he.rank,e:W};d.addDummyNode(K,"edge-proxy",Ne,"_ep")}})}function L(K){var W=0;r.forEach(K.nodes(),function(ee){var he=K.node(ee);he.borderTop&&(he.minRank=K.node(he.borderTop).rank,he.maxRank=K.node(he.borderBottom).rank,W=r.max(W,he.maxRank))}),K.graph().maxRank=W}function F(K){r.forEach(K.nodes(),function(W){var ee=K.node(W);ee.dummy==="edge-proxy"&&(K.edge(ee.e).labelRank=ee.rank,K.removeNode(W))})}function G(K){var W=Number.POSITIVE_INFINITY,ee=0,he=Number.POSITIVE_INFINITY,Se=0,Ne=K.graph(),Ue=Ne.marginx||0,Tt=Ne.marginy||0;function fn(At){var Kt=At.x,Ze=At.y,yr=At.width,et=At.height;W=Math.min(W,Kt-yr/2),ee=Math.max(ee,Kt+yr/2),he=Math.min(he,Ze-et/2),Se=Math.max(Se,Ze+et/2)}r.forEach(K.nodes(),function(At){fn(K.node(At))}),r.forEach(K.edges(),function(At){var Kt=K.edge(At);r.has(Kt,"x")&&fn(Kt)}),W-=Ue,he-=Tt,r.forEach(K.nodes(),function(At){var Kt=K.node(At);Kt.x-=W,Kt.y-=he}),r.forEach(K.edges(),function(At){var Kt=K.edge(At);r.forEach(Kt.points,function(Ze){Ze.x-=W,Ze.y-=he}),r.has(Kt,"x")&&(Kt.x-=W),r.has(Kt,"y")&&(Kt.y-=he)}),Ne.width=ee-W+Ue,Ne.height=Se-he+Tt}function V(K){r.forEach(K.edges(),function(W){var ee=K.edge(W),he=K.node(W.v),Se=K.node(W.w),Ne,Ue;ee.points?(Ne=ee.points[0],Ue=ee.points[ee.points.length-1]):(ee.points=[],Ne=Se,Ue=he),ee.points.unshift(d.intersectRect(he,Ne)),ee.points.push(d.intersectRect(Se,Ue))})}function U(K){r.forEach(K.edges(),function(W){var ee=K.edge(W);if(r.has(ee,"x"))switch((ee.labelpos==="l"||ee.labelpos==="r")&&(ee.width-=ee.labeloffset),ee.labelpos){case"l":ee.x-=ee.width/2+ee.labeloffset;break;case"r":ee.x+=ee.width/2+ee.labeloffset;break}})}function $(K){r.forEach(K.edges(),function(W){var ee=K.edge(W);ee.reversed&&ee.points.reverse()})}function j(K){r.forEach(K.nodes(),function(W){if(K.children(W).length){var ee=K.node(W),he=K.node(ee.borderTop),Se=K.node(ee.borderBottom),Ne=K.node(r.last(ee.borderLeft)),Ue=K.node(r.last(ee.borderRight));ee.width=Math.abs(Ue.x-Ne.x),ee.height=Math.abs(Se.y-he.y),ee.x=Ne.x+ee.width/2,ee.y=he.y+ee.height/2}}),r.forEach(K.nodes(),function(W){K.node(W).dummy==="border"&&K.removeNode(W)})}function Z(K){r.forEach(K.edges(),function(W){if(W.v===W.w){var ee=K.node(W.v);ee.selfEdges||(ee.selfEdges=[]),ee.selfEdges.push({e:W,label:K.edge(W)}),K.removeEdge(W)}})}function ne(K){var W=d.buildLayerMatrix(K);r.forEach(W,function(ee){var he=0;r.forEach(ee,function(Se,Ne){var Ue=K.node(Se);Ue.order=Ne+he,r.forEach(Ue.selfEdges,function(Tt){d.addDummyNode(K,"selfedge",{width:Tt.label.width,height:Tt.label.height,rank:Ue.rank,order:Ne+ ++he,e:Tt.e,label:Tt.label},"_se")}),delete Ue.selfEdges})})}function oe(K){r.forEach(K.nodes(),function(W){var ee=K.node(W);if(ee.dummy==="selfedge"){var he=K.node(ee.e.v),Se=he.x+he.width/2,Ne=he.y,Ue=ee.x-Se,Tt=he.height/2;K.setEdge(ee.e,ee.label),K.removeNode(W),ee.label.points=[{x:Se+2*Ue/3,y:Ne-Tt},{x:Se+5*Ue/6,y:Ne-Tt},{x:Se+Ue,y:Ne},{x:Se+5*Ue/6,y:Ne+Tt},{x:Se+2*Ue/3,y:Ne+Tt}],ee.label.x=ee.x,ee.label.y=ee.y}})}function le(K,W){return r.mapValues(r.pick(K,W),Number)}function Ce(K){var W={};return r.forEach(K,function(ee,he){W[he.toLowerCase()]=ee}),W}return Ay}var Py,RO;function JW(){if(RO)return Py;RO=1;var r=Lt(),e=er(),t=Wr().Graph;Py={debugOrdering:n};function n(i){var a=e.buildLayerMatrix(i),s=new t({compound:!0,multigraph:!0}).setGraph({});return r.forEach(i.nodes(),function(o){s.setNode(o,{label:o}),s.setParent(o,"layer"+i.node(o).rank)}),r.forEach(i.edges(),function(o){s.setEdge(o.v,o.w,{},o.name)}),r.forEach(a,function(o,l){var u="layer"+l;s.setNode(u,{rank:"same"}),r.reduce(o,function(c,h){return s.setEdge(c,h,{style:"invis"}),h})}),s}return Py}var Cy,LO;function QW(){return LO||(LO=1,Cy="0.8.5"),Cy}var Ny,IO;function eV(){return IO||(IO=1,Ny={graphlib:Wr(),layout:ZW(),debug:JW(),util:{time:er().time,notime:er().notime},version:QW()}),Ny}var wN=eV();const tV=nl(wN);class Th{constructor(e){this.id="dagre",this.options={},Object.assign(this.options,Th.defaultOptions,e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,e,Object.assign(Object.assign({},this.options),t))})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,e,Object.assign(Object.assign({},this.options),t))})}genericDagreLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const{nodeSize:i}=n,a=new wN.graphlib.Graph;a.setGraph(n),a.setDefaultEdgeLabel(()=>({}));const s=t.getAllNodes(),o=t.getAllEdges();[...s,...o].some(({id:u})=>_e(u))&&console.error("Dagre layout only support string id, it will convert number to string."),t.getAllNodes().forEach(u=>{const{id:c}=u,h=Object.assign({},u.data);if(i!==void 0){const[d,f]=yl(Te(i)?i(u):i);Object.assign(h,{width:d,height:f})}a.setNode(c.toString(),h)}),t.getAllEdges().forEach(({id:u,source:c,target:h})=>{a.setEdge(c.toString(),h.toString(),{id:u})}),tV.layout(a);const l={nodes:[],edges:[]};return a.nodes().forEach(u=>{const c=a.node(u);l.nodes.push({id:u,data:c}),e&&t.mergeNodeData(u,c)}),a.edges().forEach(u=>{const c=a.edge(u),{id:h}=c,d=$t(c,["id"]),{v:f,w:g}=u;l.edges.push({id:h,source:f,target:g,data:d}),e&&t.mergeEdgeData(h,d)}),l})}}Th.defaultOptions={};class _b{constructor(e){this.id=e.id||0,this.rx=e.rx,this.ry=e.ry,this.fx=0,this.fy=0,this.mass=e.mass,this.degree=e.degree,this.g=e.g||0}distanceTo(e){const t=this.rx-e.rx,n=this.ry-e.ry;return Math.hypot(t,n)}setPos(e,t){this.rx=e,this.ry=t}resetForce(){this.fx=0,this.fy=0}addForce(e){const t=e.rx-this.rx,n=e.ry-this.ry;let i=Math.hypot(t,n);i=i<1e-4?1e-4:i;const a=this.g*(this.degree+1)*(e.degree+1)/i;this.fx+=a*t/i,this.fy+=a*n/i}in(e){return e.contains(this.rx,this.ry)}add(e){const t=this.mass+e.mass,n=(this.rx*this.mass+e.rx*e.mass)/t,i=(this.ry*this.mass+e.ry*e.mass)/t,a=this.degree+e.degree,s={rx:n,ry:i,mass:t,degree:a};return new _b(s)}}class Os{constructor(e){this.xmid=e.xmid,this.ymid=e.ymid,this.length=e.length,this.massCenter=e.massCenter||[0,0],this.mass=e.mass||1}getLength(){return this.length}contains(e,t){const n=this.length/2;return e<=this.xmid+n&&e>=this.xmid-n&&t<=this.ymid+n&&t>=this.ymid-n}NW(){const e=this.xmid-this.length/4,t=this.ymid+this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new Os(i)}NE(){const e=this.xmid+this.length/4,t=this.ymid+this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new Os(i)}SW(){const e=this.xmid-this.length/4,t=this.ymid-this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new Os(i)}SE(){const e=this.xmid+this.length/4,t=this.ymid-this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new Os(i)}}class ks{constructor(e){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,e!=null&&(this.quad=e)}insert(e){if(this.body==null){this.body=e;return}this._isExternal()?(this.quad&&(this.NW=new ks(this.quad.NW()),this.NE=new ks(this.quad.NE()),this.SW=new ks(this.quad.SW()),this.SE=new ks(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e))}_putBody(e){this.quad&&(e.in(this.quad.NW())&&this.NW?this.NW.insert(e):e.in(this.quad.NE())&&this.NE?this.NE.insert(e):e.in(this.quad.SW())&&this.SW?this.SW.insert(e):e.in(this.quad.SE())&&this.SE&&this.SE.insert(e))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(e){if(!(this.body==null||e===this.body))if(this._isExternal())e.addForce(this.body);else{const t=this.quad?this.quad.getLength():0,n=this.body.distanceTo(e);t/n<this.theta?e.addForce(this.body):(this.NW&&this.NW.updateForce(e),this.NE&&this.NE.updateForce(e),this.SW&&this.SW.updateForce(e),this.SE&&this.SE.updateForce(e))}}}const nV={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1};class rV{constructor(e={}){this.options=e,this.id="forceAtlas2",this.options=Object.assign(Object.assign({},nV),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericForceAtlas2Layout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericForceAtlas2Layout(!0,e,t)})}genericForceAtlas2Layout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=t.getAllEdges(),a=t.getAllNodes(),s=this.formatOptions(n,a.length),{width:o,height:l,prune:u,maxIteration:c,nodeSize:h,center:d}=s;if(!(a!=null&&a.length)||a.length===1)return rs(t,e,d);const f=a.map(y=>cr(y,[o,l])),g=i.filter(y=>{const{source:m,target:w}=y;return m!==w}),v=new dn({nodes:f,edges:g}),p=this.getSizes(v,h);if(this.run(v,t,c,p,e,s),u){for(let m=0;m<g.length;m+=1){const{source:w,target:S}=g[m],_=v.getDegree(w),O=v.getDegree(w);if(_<=1){const T=v.getNode(S);v.mergeNodeData(w,{x:T.data.x,y:T.data.y})}else if(O<=1){const T=v.getNode(w);v.mergeNodeData(S,{x:T.data.x,y:T.data.y})}}const y=Object.assign(Object.assign({},s),{prune:!1,barnesHut:!1});this.run(v,t,100,p,e,y)}return{nodes:f,edges:i}})}getSizes(e,t){const n=e.getAllNodes(),i={};for(let a=0;a<n.length;a+=1){const s=n[a];i[s.id]=rb(t,void 0)(s)}return i}formatOptions(e={},t){const n=Object.assign(Object.assign({},this.options),e),{center:i,width:a,height:s,barnesHut:o,prune:l,maxIteration:u,kr:c,kg:h}=n;return n.width=!a&&typeof window<"u"?window.innerWidth:a,n.height=!s&&typeof window<"u"?window.innerHeight:s,n.center=i||[n.width/2,n.height/2],o===void 0&&t>250&&(n.barnesHut=!0),l===void 0&&t>100&&(n.prune=!0),u===0&&!l?(n.maxIteration=250,t<=200&&t>100?n.maxIteration=1e3:t>200&&(n.maxIteration=1200)):u===0&&l&&(n.maxIteration=100,t<=200&&t>100?n.maxIteration=500:t>200&&(n.maxIteration=950)),c||(n.kr=50,t>100&&t<=500?n.kr=20:t>500&&(n.kr=1)),h||(n.kg=20,t>100&&t<=500?n.kg=10:t>500&&(n.kg=1)),n}run(e,t,n,i,a,s){const{kr:o,barnesHut:l,onTick:u}=s,c=e.getAllNodes();let h=0,d=n;const f={},g={},v={};for(let p=0;p<c.length;p+=1){const{data:y,id:m}=c[p];if(f[m]=[0,0],l){const w={id:p,rx:y.x,ry:y.y,mass:1,g:o,degree:e.getDegree(m)};v[m]=new _b(w)}}for(;d>0;)h=this.oneStep(e,{iter:d,preventOverlapIters:50,krPrime:100,sg:h,forces:f,preForces:g,bodies:v,sizes:i},s),d--,u==null||u({nodes:c,edges:t.getAllEdges()});return e}oneStep(e,t,n){const{iter:i,preventOverlapIters:a,krPrime:s,sg:o,preForces:l,bodies:u,sizes:c}=t;let{forces:h}=t;const{preventOverlap:d,barnesHut:f}=n,g=e.getAllNodes();for(let v=0;v<g.length;v+=1){const{id:p}=g[v];l[p]=[...h[p]],h[p]=[0,0]}return h=this.getAttrForces(e,i,a,c,h,n),f&&(d&&i>a||!d)?h=this.getOptRepGraForces(e,h,u,n):h=this.getRepGraForces(e,i,a,h,s,c,n),this.updatePos(e,h,l,o,n)}getAttrForces(e,t,n,i,a,s){const{preventOverlap:o,dissuadeHubs:l,mode:u,prune:c}=s,h=e.getAllEdges();for(let d=0;d<h.length;d+=1){const{source:f,target:g}=h[d],v=e.getNode(f),p=e.getNode(g),y=e.getDegree(f),m=e.getDegree(g);if(c&&(y<=1||m<=1))continue;const w=[p.data.x-v.data.x,p.data.y-v.data.y];let S=Math.hypot(w[0],w[1]);S=S<1e-4?1e-4:S,w[0]=w[0]/S,w[1]=w[1]/S,o&&t<n&&(S=S-i[f]-i[g]);let _=S,O=_;u==="linlog"&&(_=Math.log(1+S),O=_),l&&(_=S/y,O=S/m),o&&t<n&&S<=0?(_=0,O=0):o&&t<n&&S>0&&(_=S,O=S),a[f][0]+=_*w[0],a[g][0]-=O*w[0],a[f][1]+=_*w[1],a[g][1]-=O*w[1]}return a}getOptRepGraForces(e,t,n,i){const{kg:a,center:s,prune:o}=i,l=e.getAllNodes(),u=l.length;let c=9e10,h=-9e10,d=9e10,f=-9e10;for(let m=0;m<u;m+=1){const{id:w,data:S}=l[m];o&&e.getDegree(w)<=1||(n[w].setPos(S.x,S.y),S.x>=h&&(h=S.x),S.x<=c&&(c=S.x),S.y>=f&&(f=S.y),S.y<=d&&(d=S.y))}const g=Math.max(h-c,f-d),v={xmid:(h+c)/2,ymid:(f+d)/2,length:g,massCenter:s,mass:u},p=new Os(v),y=new ks(p);for(let m=0;m<u;m+=1){const{id:w}=l[m];o&&e.getDegree(w)<=1||n[w].in(p)&&y.insert(n[w])}for(let m=0;m<u;m+=1){const{id:w,data:S}=l[m],_=e.getDegree(w);if(o&&_<=1)continue;n[w].resetForce(),y.updateForce(n[w]),t[w][0]-=n[w].fx,t[w][1]-=n[w].fy;const O=[S.x-s[0],S.y-s[1]];let T=Math.hypot(O[0],O[1]);T=T<1e-4?1e-4:T,O[0]=O[0]/T,O[1]=O[1]/T;const k=a*(_+1);t[w][0]-=k*O[0],t[w][1]-=k*O[1]}return t}getRepGraForces(e,t,n,i,a,s,o){const{preventOverlap:l,kr:u,kg:c,center:h,prune:d}=o,f=e.getAllNodes(),g=f.length;for(let v=0;v<g;v+=1){const p=f[v],y=e.getDegree(p.id);for(let _=v+1;_<g;_+=1){const O=f[_],T=e.getDegree(O.id);if(d&&(y<=1||T<=1))continue;const k=[O.data.x-p.data.x,O.data.y-p.data.y];let P=Math.hypot(k[0],k[1]);P=P<1e-4?1e-4:P,k[0]=k[0]/P,k[1]=k[1]/P,l&&t<n&&(P=P-s[p.id]-s[O.id]);let C=u*(y+1)*(T+1)/P;l&&t<n&&P<0?C=a*(y+1)*(T+1):l&&t<n&&P===0?C=0:l&&t<n&&P>0&&(C=u*(y+1)*(T+1)/P),i[p.id][0]-=C*k[0],i[O.id][0]+=C*k[0],i[p.id][1]-=C*k[1],i[O.id][1]+=C*k[1]}const m=[p.data.x-h[0],p.data.y-h[1]],w=Math.hypot(m[0],m[1]);m[0]=m[0]/w,m[1]=m[1]/w;const S=c*(y+1);i[p.id][0]-=S*m[0],i[p.id][1]-=S*m[1]}return i}updatePos(e,t,n,i,a){const{ks:s,tao:o,prune:l,ksmax:u}=a,c=e.getAllNodes(),h=c.length,d=[],f=[];let g=0,v=0,p=i;for(let m=0;m<h;m+=1){const{id:w}=c[m],S=e.getDegree(w);if(l&&S<=1)continue;const _=[t[w][0]-n[w][0],t[w][1]-n[w][1]],O=Math.hypot(_[0],_[1]),T=[t[w][0]+n[w][0],t[w][1]+n[w][1]],k=Math.hypot(T[0],T[1]);d[m]=O,f[m]=k/2,g+=(S+1)*d[m],v+=(S+1)*f[m]}const y=p;p=o*v/g,y!==0&&(p=p>1.5*y?1.5*y:p);for(let m=0;m<h;m+=1){const{id:w,data:S}=c[m],_=e.getDegree(w);if(l&&_<=1||_e(S.fx)&&_e(S.fy))continue;let O=s*p/(1+p*Math.sqrt(d[m])),T=Math.hypot(t[w][0],t[w][1]);T=T<1e-4?1e-4:T;const k=u/T;O=O>k?k:O;const P=O*t[w][0],C=O*t[w][1];e.mergeNodeData(w,{x:S.x+P,y:S.y+C})}return p}}const iV={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},aV=800;class sV{constructor(e={}){this.options=e,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=Object.assign(Object.assign({},iV),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericFruchtermanLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericFruchtermanLayout(!0,e,t)})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1}tick(e=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let n=0;n<e;n++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);const t={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&t.nodes.forEach(n=>this.lastGraph.mergeNodeData(n.id,{x:n.data.x,y:n.data.y,z:this.options.dimensions===3?n.data.z:void 0})),t}genericFruchtermanLayout(e,t,n){return Ye(this,void 0,void 0,function*(){if(this.running)return;const i=this.formatOptions(n),{dimensions:a,width:s,height:o,center:l,clustering:u,nodeClusterBy:c,maxIteration:h,onTick:d}=i,f=t.getAllNodes(),g=t.getAllEdges();if(!(f!=null&&f.length)){const w={nodes:[],edges:g};return this.lastResult=w,w}if(f.length===1){e&&t.mergeNodeData(f[0].id,{x:l[0],y:l[1],z:a===3?l[2]:void 0});const w={nodes:[Object.assign(Object.assign({},f[0]),{data:Object.assign(Object.assign({},f[0].data),{x:l[0],y:l[1],z:a===3?l[2]:void 0})})],edges:g};return this.lastResult=w,w}const v=f.map(w=>cr(w,[s,o])),p=new dn({nodes:v,edges:g}),y={};if(u&&v.forEach(w=>{const S=w.data[c];y[S]||(y[S]={name:S,cx:0,cy:0,count:0})}),this.lastLayoutNodes=v,this.lastLayoutEdges=g,this.lastAssign=e,this.lastGraph=p,this.lastOptions=i,this.lastClusterMap=y,typeof window>"u")return;let m=0;return new Promise(w=>{this.timeInterval=window.setInterval(()=>{if(!this.running){w({nodes:v,edges:g});return}this.runOneStep(p,y,i),e&&v.forEach(({id:S,data:_})=>t.mergeNodeData(S,{x:_.x,y:_.y,z:a===3?_.z:void 0})),d==null||d({nodes:v,edges:g}),m++,m>=h&&(window.clearInterval(this.timeInterval),w({nodes:v,edges:g}))},0),this.running=!0})})}formatOptions(e={}){const t=Object.assign(Object.assign({},this.options),e),{clustering:n,nodeClusterBy:i}=t,{center:a,width:s,height:o}=t;return t.width=!s&&typeof window<"u"?window.innerWidth:s,t.height=!o&&typeof window<"u"?window.innerHeight:o,t.center=a||[t.width/2,t.height/2],t.clustering=n&&!!i,t}runOneStep(e,t,n){const{dimensions:i,height:a,width:s,gravity:o,center:l,speed:u,clustering:c,nodeClusterBy:h,clusterGravity:d}=n,f=a*s,g=Math.sqrt(f)/10,v=e.getAllNodes(),p=f/(v.length+1),y=Math.sqrt(p),m={};if(this.applyCalculate(e,m,y,p),c){for(const S in t)t[S].cx=0,t[S].cy=0,t[S].count=0;v.forEach(S=>{const{data:_}=S,O=t[_[h]];_e(_.x)&&(O.cx+=_.x),_e(_.y)&&(O.cy+=_.y),O.count++});for(const S in t)t[S].cx/=t[S].count,t[S].cy/=t[S].count;const w=d||o;v.forEach((S,_)=>{const{id:O,data:T}=S;if(!_e(T.x)||!_e(T.y))return;const k=t[T[h]],P=Math.sqrt((T.x-k.cx)*(T.x-k.cx)+(T.y-k.cy)*(T.y-k.cy)),C=y*w;m[O].x-=C*(T.x-k.cx)/P,m[O].y-=C*(T.y-k.cy)/P})}v.forEach((w,S)=>{const{id:_,data:O}=w;if(!_e(O.x)||!_e(O.y))return;const T=.01*y*o;m[_].x-=T*(O.x-l[0]),m[_].y-=T*(O.y-l[1]),i===3&&(m[_].z-=T*(O.z-l[2]))}),v.forEach((w,S)=>{const{id:_,data:O}=w;if(_e(O.fx)&&_e(O.fy)){O.x=O.fx,O.y=O.fy,i===3&&(O.z=O.fz);return}if(!_e(O.x)||!_e(O.y))return;const T=Math.sqrt(m[_].x*m[_].x+m[_].y*m[_].y+(i===3?m[_].z*m[_].z:0));if(T>0){const k=Math.min(g*(u/aV),T);e.mergeNodeData(_,{x:O.x+m[_].x/T*k,y:O.y+m[_].y/T*k,z:i===3?O.z+m[_].z/T*k:void 0})}})}applyCalculate(e,t,n,i){this.calRepulsive(e,t,i),this.calAttractive(e,t,n)}calRepulsive(e,t,n){const i=e.getAllNodes();i.forEach(({data:a,id:s},o)=>{t[s]={x:0,y:0,z:0},i.forEach(({data:l,id:u},c)=>{if(o<=c||!_e(a.x)||!_e(l.x)||!_e(a.y)||!_e(l.y))return;let h=a.x-l.x,d=a.y-l.y,f=this.options.dimensions===3?a.z-l.z:0,g=h*h+d*d+f*f;g===0&&(g=1,h=.01,d=.01,f=.01);const v=n/g,p=h*v,y=d*v,m=f*v;t[s].x+=p,t[s].y+=y,t[u].x-=p,t[u].y-=y,this.options.dimensions===3&&(t[s].z+=m,t[u].z-=m)})})}calAttractive(e,t,n){e.getAllEdges().forEach(a=>{const{source:s,target:o}=a;if(!s||!o||s===o)return;const{data:l}=e.getNode(s),{data:u}=e.getNode(o);if(!_e(u.x)||!_e(l.x)||!_e(u.y)||!_e(l.y))return;const c=u.x-l.x,h=u.y-l.y,d=this.options.dimensions===3?u.z-l.z:0,f=Math.sqrt(c*c+h*h+d*d)/n,g=c*f,v=h*f,p=d*f;t[s].x+=g,t[s].y+=v,t[o].x-=g,t[o].y-=v,this.options.dimensions===3&&(t[s].z+=p,t[o].z-=p)})}}const oV={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300};class lV{constructor(e={}){this.options=e,this.id="grid",this.options=Object.assign(Object.assign({},oV),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericGridLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericGridLayout(!0,e,t)})}genericGridLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{begin:a=[0,0],condense:s,preventOverlapPadding:o,preventOverlap:l,rows:u,cols:c,nodeSpacing:h,nodeSize:d,width:f,height:g,position:v}=i;let{sortBy:p}=i;const y=t.getAllNodes(),m=t.getAllEdges(),w=y==null?void 0:y.length;if(!w||w===1)return rs(t,e,a);const S=y.map(V=>cr(V));p!=="id"&&(!rt(p)||S[0].data[p]===void 0)&&(p="degree"),p==="degree"?S.sort((V,U)=>t.getDegree(U.id,"both")-t.getDegree(V.id,"both")):p==="id"?S.sort((V,U)=>_e(U.id)&&_e(V.id)?U.id-V.id:`${V.id}`.localeCompare(`${U.id}`)):S.sort((V,U)=>U.data[p]-V.data[p]);const _=!f&&typeof window<"u"?window.innerWidth:f,O=!g&&typeof window<"u"?window.innerHeight:g,T=w,k={rows:u,cols:c};if(u!=null&&c!=null)k.rows=u,k.cols=c;else if(u!=null&&c==null)k.rows=u,k.cols=Math.ceil(T/k.rows);else if(u==null&&c!=null)k.cols=c,k.rows=Math.ceil(T/k.cols);else{const V=Math.sqrt(T*O/_);k.rows=Math.round(V),k.cols=Math.round(_/O*V)}if(k.rows=Math.max(k.rows,1),k.cols=Math.max(k.cols,1),k.cols*k.rows>T){const V=bu(k),U=wu(k);(V-1)*U>=T?bu(k,V-1):(U-1)*V>=T&&wu(k,U-1)}else for(;k.cols*k.rows<T;){const V=bu(k),U=wu(k);(U+1)*V>=T?wu(k,U+1):bu(k,V+1)}let P=s?0:_/k.cols,C=s?0:O/k.rows;if(l||h){const V=ja(10,h),U=nb(30,d,!1);S.forEach($=>{(!$.data.x||!$.data.y)&&($.data.x=0,$.data.y=0);const j=t.getNode($.id),[Z,ne]=yl(U(j)||30),oe=V!==void 0?V($):o,le=Z+oe,Ce=ne+oe;P=Math.max(P,le),C=Math.max(C,Ce)})}const N={},L={row:0,col:0},F={};for(let V=0;V<S.length;V++){const U=S[V];let $;if(v&&($=v(t.getNode(U.id))),$&&($.row!==void 0||$.col!==void 0)){const j={row:$.row,col:$.col};if(j.col===void 0)for(j.col=0;Qm(N,j);)j.col++;else if(j.row===void 0)for(j.row=0;Qm(N,j);)j.row++;F[U.id]=j,xN(N,j)}uV(U,a,P,C,F,k,L,N)}const G={nodes:S,edges:m};return e&&S.forEach(V=>{t.mergeNodeData(V.id,{x:V.data.x,y:V.data.y})}),G})}}const bu=(r,e)=>{let t;const n=r.rows||5,i=r.cols||5;return e==null?t=Math.min(n,i):Math.min(n,i)===r.rows?r.rows=e:r.cols=e,t},wu=(r,e)=>{let t;const n=r.rows||5,i=r.cols||5;return e==null?t=Math.max(n,i):Math.max(n,i)===r.rows?r.rows=e:r.cols=e,t},Qm=(r,e)=>r[`c-${e.row}-${e.col}`]||!1,xN=(r,e)=>r[`c-${e.row}-${e.col}`]=!0,DO=(r,e)=>{const t=r.cols||5;e.col++,e.col>=t&&(e.col=0,e.row++)},uV=(r,e,t,n,i,a,s,o)=>{let l,u;const c=i[r.id];if(c)l=c.col*t+t/2+e[0],u=c.row*n+n/2+e[1];else{for(;Qm(o,s);)DO(a,s);l=s.col*t+t/2+e[0],u=s.row*n+n/2+e[1],xN(o,s),DO(a,s)}r.data.x=l,r.data.y=u},cV=(r,e,t)=>{try{const n=ta.mul(ta.pow(e,2),-.5),i=n.mean("row"),a=n.mean("column"),s=n.mean();n.add(s).subRowVector(i).subColumnVector(a);const o=new gC(n),l=ta.sqrt(o.diagonalMatrix).diagonal();return o.leftSingularVectors.toJSON().map(u=>ta.mul([u],[l]).toJSON()[0].splice(0,r))}catch{const i=[];for(let a=0;a<e.length;a++){const s=Math.random()*t,o=Math.random()*t;i.push([s,o])}return i}},hV=800,dV={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},fV=(r,e)=>{const t=Object.assign(Object.assign({},dV),e),{positions:n,iterations:i,width:a,k:s,speed:o=100,strictRadial:l,focusIdx:u,radii:c=[],nodeSizeFunc:h}=t,d=r.getAllNodes(),f=[],g=a/10;for(let v=0;v<i;v++)n.forEach((p,y)=>{f[y]={x:0,y:0}}),gV(d,n,f,s,c,h),pV(n,f,o,l,u,g,a,c);return n},gV=(r,e,t,n,i,a)=>{e.forEach((s,o)=>{t[o]={x:0,y:0},e.forEach((l,u)=>{if(o===u||i[o]!==i[u])return;let c=s.x-l.x,h=s.y-l.y,d=Math.sqrt(c*c+h*h);if(d===0){d=1;const f=o>u?1:-1;c=.01*f,h=.01*f}if(d<a(r[o])/2+a(r[u])/2){const f=n*n/d;t[o].x+=c/d*f,t[o].y+=h/d*f}})})},pV=(r,e,t,n,i,a,s,o)=>{const l=a||s/10;return n&&e.forEach((u,c)=>{const h=r[c].x-r[i].x,d=r[c].y-r[i].y,f=Math.sqrt(h*h+d*d);let g=d/f,v=-h/f;const p=Math.sqrt(u.x*u.x+u.y*u.y);let y=Math.acos((g*u.x+v*u.y)/p);y>Math.PI/2&&(y-=Math.PI/2,g*=-1,v*=-1);const m=Math.cos(y)*p;u.x=g*m,u.y=v*m}),r.forEach((u,c)=>{if(c===i)return;const h=Math.sqrt(e[c].x*e[c].x+e[c].y*e[c].y);if(h>0&&c!==i){const d=Math.min(l*(t/hV),h);if(u.x+=e[c].x/h*d,u.y+=e[c].y/h*d,n){let f=u.x-r[i].x,g=u.y-r[i].y;const v=Math.sqrt(f*f+g*g);f=f/v*o[c],g=g/v*o[c],u.x=r[i].x+f,u.y=r[i].y+g}}}),r},vV={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10};class yV{constructor(e={}){this.options=e,this.id="radial",this.options=Object.assign(Object.assign({},vV),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericRadialLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericRadialLayout(!0,e,t)})}genericRadialLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{width:a,height:s,center:o,focusNode:l,unitRadius:u,nodeSize:c,nodeSpacing:h,strictRadial:d,preventOverlap:f,maxPreventOverlapIteration:g,sortBy:v,linkDistance:p=50,sortStrength:y=10,maxIteration:m=1e3}=i,w=t.getAllNodes(),S=t.getAllEdges(),_=!a&&typeof window<"u"?window.innerWidth:a,O=!s&&typeof window<"u"?window.innerHeight:s,T=o||[_/2,O/2];if(!(w!=null&&w.length)||w.length===1)return rs(t,e,T);let k=w[0];if(rt(l)){for(let he=0;he<w.length;he++)if(w[he].id===l){k=w[he];break}}else k=l||w[0];const P=wV(w,k.id),C=uC({nodes:w,edges:S}),N=lC(C),L=EV(N,P);xV(N,P,L+1);const F=N[P];let G=_-T[0]>T[0]?T[0]:_-T[0],V=O-T[1]>T[1]?T[1]:O-T[1];G===0&&(G=_/2),V===0&&(V=O/2);const U=Math.min(G,V),$=Math.max(...F),j=[],Z=u||U/$;F.forEach((he,Se)=>{j[Se]=he*Z});const ne=mV(w,N,p,j,Z,v,y),oe=bV(ne),le=cV(p,ne,p);let Ce=le.map(([he,Se])=>({x:(isNaN(he)?Math.random()*p:he)-le[P][0],y:(isNaN(Se)?Math.random()*p:Se)-le[P][1]}));this.run(m,Ce,oe,ne,j,P);let K;if(f){K=rb(c,h);const he={nodes:w,nodeSizeFunc:K,positions:Ce,radii:j,height:O,width:_,strictRadial:!!d,focusIdx:P,iterations:g||200,k:Ce.length/4.5};Ce=fV(t,he)}const W=[];return Ce.forEach((he,Se)=>{const Ne=cr(w[Se]);Ne.data.x=he.x+T[0],Ne.data.y=he.y+T[1],W.push(Ne)}),e&&W.forEach(he=>t.mergeNodeData(he.id,{x:he.data.x,y:he.data.y})),{nodes:W,edges:S}})}run(e,t,n,i,a,s){for(let o=0;o<=e;o++){const l=o/e;this.oneIteration(l,t,a,i,n,s)}}oneIteration(e,t,n,i,a,s){const o=1-e;t.forEach((l,u)=>{const c=nE(l,{x:0,y:0}),h=c===0?0:1/c;if(u===s)return;let d=0,f=0,g=0;t.forEach((p,y)=>{if(u===y)return;const m=nE(l,p),w=m===0?0:1/m,S=i[y][u];g+=a[u][y],d+=a[u][y]*(p.x+S*(l.x-p.x)*w),f+=a[u][y]*(p.y+S*(l.y-p.y)*w)});const v=n[u]===0?0:1/n[u];g*=o,g+=e*v*v,d*=o,d+=e*v*l.x*h,l.x=d/g,f*=o,f+=e*v*l.y*h,l.y=f/g})}}const mV=(r,e,t,n,i,a,s)=>{if(!r)return[];const o=[];if(e){const l={};e.forEach((u,c)=>{const h=[];u.forEach((d,f)=>{var g,v;if(c===f)h.push(0);else if(n[c]===n[f])if(a==="data")h.push(d*(Math.abs(c-f)*s)/(n[c]/i));else if(a){let p,y;if(l[r[c].id])p=l[r[c].id];else{const m=(a==="id"?r[c].id:(g=r[c].data)===null||g===void 0?void 0:g[a])||0;rt(m)?p=m.charCodeAt(0):p=m,l[r[c].id]=p}if(l[r[f].id])y=l[r[f].id];else{const m=(a==="id"?r[f].id:(v=r[f].data)===null||v===void 0?void 0:v[a])||0;rt(m)?y=m.charCodeAt(0):y=m,l[r[f].id]=y}h.push(d*(Math.abs(p-y)*s)/(n[c]/i))}else h.push(d*t/(n[c]/i));else{const p=(t+i)/2;h.push(d*p)}}),o.push(h)})}return o},bV=r=>{const e=r.length,t=r[0].length,n=[];for(let i=0;i<e;i++){const a=[];for(let s=0;s<t;s++)r[i][s]!==0?a.push(1/(r[i][s]*r[i][s])):a.push(0);n.push(a)}return n},wV=(r,e)=>{let t=-1;return r.forEach((n,i)=>{n.id===e&&(t=i)}),Math.max(t,0)},xV=(r,e,t)=>{const n=r.length;for(let i=0;i<n;i++)if(r[e][i]===1/0){r[e][i]=t,r[i][e]=t;for(let a=0;a<n;a++)r[i][a]!==1/0&&r[e][a]===1/0&&(r[e][a]=t+r[i][a],r[a][e]=t+r[i][a])}for(let i=0;i<n;i++)if(i!==e){for(let a=0;a<n;a++)if(r[i][a]===1/0){let s=Math.abs(r[e][i]-r[e][a]);s=s===0?1:s,r[i][a]=s}}},EV=(r,e)=>{let t=0;for(let n=0;n<r[e].length;n++)r[e][n]!==1/0&&(t=r[e][n]>t?r[e][n]:t);return t},SV={center:[0,0],width:300,height:300};class _V{constructor(e={}){this.options=e,this.id="random",this.options=Object.assign(Object.assign({},SV),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericRandomLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericRandomLayout(!0,e,t)})}genericRandomLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{center:a,width:s,height:o}=i,l=t.getAllNodes(),u=.9,c=!s&&typeof window<"u"?window.innerWidth:s,h=!o&&typeof window<"u"?window.innerHeight:o,d=a||[c/2,h/2],f=[];return l&&l.forEach(v=>{f.push({id:v.id,data:{x:(Math.random()-.5)*u*c+d[0],y:(Math.random()-.5)*u*h+d[1]}})}),e&&f.forEach(v=>t.mergeNodeData(v.id,{x:v.data.x,y:v.data.y})),{nodes:f,edges:t.getAllEdges()}})}}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const EN=Symbol("Comlink.proxy"),MV=Symbol("Comlink.endpoint"),SN=Symbol("Comlink.releaseProxy"),Ry=Symbol("Comlink.finalizer"),Fu=Symbol("Comlink.thrown"),_N=r=>typeof r=="object"&&r!==null||typeof r=="function",OV={canHandle:r=>_N(r)&&r[EN],serialize(r){const{port1:e,port2:t}=new MessageChannel;return ON(r,e),[t,[t]]},deserialize(r){return r.start(),TN(r)}},kV={canHandle:r=>_N(r)&&Fu in r,serialize({value:r}){let e;return r instanceof Error?e={isError:!0,value:{message:r.message,name:r.name,stack:r.stack}}:e={isError:!1,value:r},[e,[]]},deserialize(r){throw r.isError?Object.assign(new Error(r.value.message),r.value):r.value}},MN=new Map([["proxy",OV],["throw",kV]]);function TV(r,e){for(const t of r)if(e===t||t==="*"||t instanceof RegExp&&t.test(e))return!0;return!1}function ON(r,e=globalThis,t=["*"]){e.addEventListener("message",function n(i){if(!i||!i.data)return;if(!TV(t,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}const{id:a,type:s,path:o}=Object.assign({path:[]},i.data),l=(i.data.argumentList||[]).map(Pa);let u;try{const c=o.slice(0,-1).reduce((d,f)=>d[f],r),h=o.reduce((d,f)=>d[f],r);switch(s){case"GET":u=h;break;case"SET":c[o.slice(-1)[0]]=Pa(i.data.value),u=!0;break;case"APPLY":u=h.apply(c,l);break;case"CONSTRUCT":{const d=new h(...l);u=LV(d)}break;case"ENDPOINT":{const{port1:d,port2:f}=new MessageChannel;ON(r,f),u=RV(d,[d])}break;case"RELEASE":u=void 0;break;default:return}}catch(c){u={value:c,[Fu]:0}}Promise.resolve(u).catch(c=>({value:c,[Fu]:0})).then(c=>{const[h,d]=Ec(c);e.postMessage(Object.assign(Object.assign({},h),{id:a}),d),s==="RELEASE"&&(e.removeEventListener("message",n),kN(e),Ry in r&&typeof r[Ry]=="function"&&r[Ry]())}).catch(c=>{const[h,d]=Ec({value:new TypeError("Unserializable return value"),[Fu]:0});e.postMessage(Object.assign(Object.assign({},h),{id:a}),d)})}),e.start&&e.start()}function AV(r){return r.constructor.name==="MessagePort"}function kN(r){AV(r)&&r.close()}function TN(r,e){const t=new Map;return r.addEventListener("message",function(i){const{data:a}=i;if(!a||!a.id)return;const s=t.get(a.id);if(s)try{s(a)}finally{t.delete(a.id)}}),e1(r,t,[],e)}function xu(r){if(r)throw new Error("Proxy has been released and is not useable")}function AN(r){return Ss(r,new Map,{type:"RELEASE"}).then(()=>{kN(r)})}const wc=new WeakMap,xc="FinalizationRegistry"in globalThis&&new FinalizationRegistry(r=>{const e=(wc.get(r)||0)-1;wc.set(r,e),e===0&&AN(r)});function PV(r,e){const t=(wc.get(e)||0)+1;wc.set(e,t),xc&&xc.register(r,e,r)}function CV(r){xc&&xc.unregister(r)}function e1(r,e,t=[],n=function(){}){let i=!1;const a=new Proxy(n,{get(s,o){if(xu(i),o===SN)return()=>{CV(a),AN(r),e.clear(),i=!0};if(o==="then"){if(t.length===0)return{then:()=>a};const l=Ss(r,e,{type:"GET",path:t.map(u=>u.toString())}).then(Pa);return l.then.bind(l)}return e1(r,e,[...t,o])},set(s,o,l){xu(i);const[u,c]=Ec(l);return Ss(r,e,{type:"SET",path:[...t,o].map(h=>h.toString()),value:u},c).then(Pa)},apply(s,o,l){xu(i);const u=t[t.length-1];if(u===MV)return Ss(r,e,{type:"ENDPOINT"}).then(Pa);if(u==="bind")return e1(r,e,t.slice(0,-1));const[c,h]=FO(l);return Ss(r,e,{type:"APPLY",path:t.map(d=>d.toString()),argumentList:c},h).then(Pa)},construct(s,o){xu(i);const[l,u]=FO(o);return Ss(r,e,{type:"CONSTRUCT",path:t.map(c=>c.toString()),argumentList:l},u).then(Pa)}});return PV(a,r),a}function NV(r){return Array.prototype.concat.apply([],r)}function FO(r){const e=r.map(Ec);return[e.map(t=>t[0]),NV(e.map(t=>t[1]))]}const PN=new WeakMap;function RV(r,e){return PN.set(r,e),r}function LV(r){return Object.assign(r,{[EN]:!0})}function Ec(r){for(const[e,t]of MN)if(t.canHandle(r)){const[n,i]=t.serialize(r);return[{type:"HANDLER",name:e,value:n},i]}return[{type:"RAW",value:r},PN.get(r)||[]]}function Pa(r){switch(r.type){case"HANDLER":return MN.get(r.name).deserialize(r.value);case"RAW":return r.value}}function Ss(r,e,t,n){return new Promise(i=>{const a=IV();e.set(a,i),r.start&&r.start(),r.postMessage(Object.assign({id:a},t),n)})}function IV(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}class DV extends Qc{constructor(e,t,n){super(),this.graph=e,this.layout=t,this.options=n,this.spawnWorker()}spawnWorker(){this.proxy=TN(new Worker(new URL("/assets/worker-CY73Iqy_.js",import.meta.url),{type:"module"})),this.running&&(this.running=!1,this.execute())}execute(){var e;return Ye(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;const t=this.layout.options,{onTick:n}=t,i=$t(t,["onTick"]),a={};Object.keys(i).forEach(u=>{Te(i[u])||(a[u]=i[u])});const s={layout:{id:this.layout.id,options:a,iterations:(e=this.options)===null||e===void 0?void 0:e.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},o=new Float32Array([0]),[l]=yield this.proxy.calculateLayout(s,[o]);return l})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[SN]()}isRunning(){return this.running}}var FV=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Ah extends eh{constructor(){super(...arguments),this.id="fishbone"}getRoot(){const e=this.context.model.getRootsData();if(!(ai(e)||e.length>2))return e[0]}formatSize(e){const t=typeof e=="function"?e:()=>e;return n=>dr(t(n))}doLayout(e,t){const{hGap:n,getRibSep:i,vGap:a,nodeSize:s,height:o}=t,{model:l}=this.context,u=this.formatSize(s);let c=u(e)[0]+i(e);const h=(w,S=0)=>{var _;return S+=n*((w.children||[]).length+1),(_=w.children)===null||_===void 0||_.forEach(O=>{var T;(T=l.getNodeLikeDatum(O).children)===null||T===void 0||T.forEach(P=>{const C=l.getNodeLikeDatum(P);S=h(C,S)})}),S},d=w=>{if(w.depth===1)return c;const S=l.getParentData(w.id,"tree");if(vs(w)){const _=l.getParentData(S.id,"tree"),O=v(w)-v(_);return d(S)+O*n/a}else{const _=(S.children||[]).indexOf(w.id),O=l.getNodeData((S.children||[]).slice(_));return f(S)-O.reduce((T,k)=>T+h(k),0)-u(S)[0]/2}},f=hm(w=>{if(Ly(w))return u(w)[0]/2;const S=l.getParentData(w.id,"tree");if(vs(w))return d(w)+h(w)+u(w)[0]/2;{const _=v(w)-v(S),O=n/a;return d(w)+_*O}},w=>w.id),g=w=>v(l.getParentData(w,"tree")),v=hm(w=>{if(Ly(w))return o/2;if(vs(w)){const S=l.getParentData(w.id,"tree"),_=S.children.indexOf(w.id);if(_===0)return g(S.id)+a;const O=l.getNodeLikeDatum(S.children[_-1]);if(ai(O.children))return v(O)+a;const T=l.getDescendantsData(O.id);return Math.max(...T.map(k=>vs(k)?g(k.id):v(k)))+a}else{if(ai(w.children))return g(w.id)+a;const S=l.getNodeLikeDatum(w.children.slice(-1)[0]);if(ai(S.children))return v(S)+a;const _=l.getDescendantsData(w.id).slice(-1)[0];return(vs(_)?g(_.id):v(_))+a}},w=>w.id);let p=0;const y={nodes:[],edges:[]},m=w=>{var S;(S=w.children)===null||S===void 0||S.forEach(P=>m(l.getNodeLikeDatum(P)));const _=v(w),O=f(w);if(y.nodes.push({id:w.id,x:O,y:_}),Ly(w))return;const T=l.getRelatedEdgesData(w.id,"in")[0],k=[d(w),vs(w)?_:g(w.id)];y.edges.push({id:J(T),controlPoints:[k],relatedNodeId:w.id}),p=Math.max(p,O+i(w)),w.depth===1&&(c=p)};return m(e),y}placeAlterative(e,t){const n=(t.children||[]).filter((o,l)=>l%2!==0);if(n.length===0)return e;const{model:i}=this.context,a=e.nodes.find(o=>o.id===t.id).y,s=o=>{const l=i.getAncestorsData(o,"tree");if(ai(l))return!1;const u=l.length===1?o:l[l.length-2].id;return n.includes(u)};e.nodes.forEach(o=>{s(o.id)&&(o.y=2*a-o.y)}),e.edges.forEach(o=>{s(o.relatedNodeId)&&(o.controlPoints=o.controlPoints.map(l=>[l[0],2*a-l[1]]))})}rightToLeft(e,t){return e.nodes.forEach(n=>n.x=t.width-n.x),e.edges.forEach(n=>{n.controlPoints=n.controlPoints.map(i=>[t.width-i[0],i[1]])}),e}execute(e,t){return FV(this,void 0,void 0,function*(){const n=Object.assign(Object.assign(Object.assign({},Ah.defaultOptions),this.options),t),{direction:i,nodeSize:a}=n,s=this.getRoot();if(!s)return e;const o=this.formatSize(a);n.vGap||(n.vGap=Math.max(...(e.nodes||[]).map(d=>o(d)[1]))),n.hGap||(n.hGap=Math.max(...(e.nodes||[]).map(d=>o(d)[0])));let l=this.doLayout(s,n);this.placeAlterative(l,s),i==="RL"&&(l=this.rightToLeft(l,n));const{model:u}=this.context,c=[],h=[];return l.nodes.forEach(d=>{const{id:f,x:g,y:v}=d,p=u.getNodeLikeDatum(f);c.push(BO(p,{x:g,y:v}))}),l.edges.forEach(d=>{const{id:f,controlPoints:g}=d,v=u.getEdgeDatum(f);h.push(BO(v,{controlPoints:g}))}),{nodes:c,edges:h}})}}Ah.defaultOptions={direction:"RL",getRibSep:()=>60};const BO=(r,e)=>Object.assign(Object.assign({},r),{style:Object.assign(Object.assign({},r.style||{}),e)}),Ly=r=>r.depth===0,vs=r=>(r.depth||(r.depth=0))%2===0;var BV=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Ph extends eh{constructor(){super(...arguments),this.id="snake"}formatSize(e,t){const n=typeof t=="function"?t:()=>t;return e.reduce((i,a)=>{const[s,o]=dr(n(a))||[0,0];return[Math.max(i[0],s),Math.max(i[1],o)]},[0,0])}validate(e){const{nodes:t=[],edges:n=[]}=e,i={},a={},s={};t.forEach(d=>{i[d.id]=0,a[d.id]=0,s[d.id]=[]}),n.forEach(d=>{i[d.target]++,a[d.source]++,s[d.source].push(d.target)});const o=new Set,l=d=>{o.has(d)||(o.add(d),s[d].forEach(l))};if(l(t[0].id),o.size!==t.length)return!1;const u=t.filter(d=>i[d.id]===0),c=t.filter(d=>a[d.id]===0);return!(u.length!==1||c.length!==1||t.filter(d=>i[d.id]===1&&a[d.id]===1).length!==t.length-2)}execute(e,t){return BV(this,void 0,void 0,function*(){var n;if(!this.validate(e))return e;const{nodeSize:i,padding:a,sortBy:s,cols:o,colGap:l,rowGap:u,clockwise:c,width:h,height:d}=Object.assign({},Ph.defaultOptions,this.options,t),[f,g,v,p]=pi(a),y=this.formatSize(e.nodes||[],i),m=Math.ceil((e.nodes||[]).length/o);let w=l||(h-p-g-o*y[0])/(o-1),S=u||(d-f-v-m*y[1])/(m-1);return(S===1/0||S<0)&&(S=0),(w===1/0||w<0)&&(w=0),{nodes:((s?(n=e.nodes)===null||n===void 0?void 0:n.sort(s):zV(e))||[]).map((T,k)=>{const P=Math.floor(k/o),C=k%o,N=c?P%2===0?C:o-1-C:P%2===0?o-1-C:C,L=p+N*(y[0]+w)+y[0]/2,F=f+P*(y[1]+S)+y[1]/2;return{id:T.id,style:{x:L,y:F}}})}})}}Ph.defaultOptions={padding:0,cols:5,clockwise:!0};function zV(r){const{nodes:e=[],edges:t=[]}=r,n={},i={};e.forEach(o=>{n[o.id]=0,i[o.id]=[]}),t.forEach(o=>{n[o.target]++,i[o.source].push(o.target)});const a=[],s=[];for(e.forEach(o=>{n[o.id]===0&&a.push(o.id)});a.length>0;){const o=a.shift(),l=e.find(u=>u.id===o);s.push(l),i[o].forEach(u=>{n[u]--,n[u]===0&&a.push(u)})}return s}const jV=["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],qV=["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],$V=["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],GV=["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],WV=["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"];class Tn extends q1{}function Js(r,e=!0,t){const n=document.createElement("div");return n.setAttribute("class",`g6-${r}`),Object.assign(n.style,{position:"absolute",display:"block"}),e&&Object.assign(n.style,{position:"unset",gridArea:"1 / 1 / 2 / 2",inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),t&&Object.assign(n.style,t),n}function t1(r,e="div",t={},n="",i=document.body){const a=document.getElementById(r);a&&a.remove();const s=document.createElement(e);return s.innerHTML=n,s.id=r,Object.assign(s.style,t),i.appendChild(s),s}var VV=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Ch extends Tn{constructor(e,t){super(e,Object.assign({},Ch.defaultOptions,t)),this.$element=Js("background"),this.context.canvas.getContainer().prepend(this.$element),this.update(t)}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return VV(this,void 0,void 0,function*(){t.update.call(this,e),Object.assign(this.$element.style,S1(this.options,["key","type"]))})}destroy(){super.destroy(),this.$element.remove()}}Ch.defaultOptions={transition:"background 0.5s",backgroundSize:"cover",zIndex:"-1"};function Mb(r,e,t,n,i,a){const s=r,o=e,l=t-s,u=n-o;let c=i-s,h=a-o,d=c*l+h*u,f=0;d<=0?f=0:(c=l-c,h=u-h,d=c*l+h*u,d<=0?f=0:f=d*d/(l*l+u*u));const g=c*c+h*h-f;return g<0?0:g}function ra(r,e,t,n){return(r-t)*(r-t)+(e-n)*(e-n)}function zO(r,e,t,n,i){return ra(r,e,t,n)<i*i}function UV(r){if(!Number.isFinite(r))return t=>t;if(r===0)return Math.round;const e=Math.pow(10,r);return t=>Math.round(t*e)/e}function CN(r){const e=Math.min(r.x1,r.x2),t=Math.max(r.x1,r.x2),n=Math.min(r.y1,r.y2),i=Math.max(r.y1,r.y2);return{x:e,y:n,x2:t,y2:i,width:t-e,height:i-n}}class vn{constructor(e,t,n,i){this.x1=e,this.y1=t,this.x2=n,this.y2=i}equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2}draw(e){e.moveTo(this.x1,this.y1),e.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(e){return new vn(e.x1,e.y1,e.x2,e.y2)}cuts(e,t){if(this.y1===this.y2||t<this.y1&&t<=this.y2||t>this.y1&&t>=this.y2||e>this.x1&&e>=this.x2)return!1;if(e<this.x1&&e<=this.x2)return!0;const n=this.x1+(t-this.y1)*(this.x2-this.x1)/(this.y2-this.y1);return e<=n}distSquare(e,t){return Mb(this.x1,this.y1,this.x2,this.y2,e,t)}ptClose(e,t,n){if(this.x1<this.x2){if(e<this.x1-n||e>this.x2+n)return!1}else if(e<this.x2-n||e>this.x1+n)return!1;if(this.y1<this.y2){if(t<this.y1-n||t>this.y2+n)return!1}else if(t<this.y2-n||t>this.y1+n)return!1;return!0}}var jt;(function(r){r[r.POINT=1]="POINT",r[r.PARALLEL=2]="PARALLEL",r[r.COINCIDENT=3]="COINCIDENT",r[r.NONE=4]="NONE"})(jt||(jt={}));class Iy{constructor(e,t=0,n=0){this.state=e,this.x=t,this.y=n}}function Eu(r,e){const t=(e.x2-e.x1)*(r.y1-e.y1)-(e.y2-e.y1)*(r.x1-e.x1),n=(r.x2-r.x1)*(r.y1-e.y1)-(r.y2-r.y1)*(r.x1-e.x1),i=(e.y2-e.y1)*(r.x2-r.x1)-(e.x2-e.x1)*(r.y2-r.y1);if(i){const a=t/i,s=n/i;return 0<=a&&a<=1&&0<=s&&s<=1?new Iy(jt.POINT,r.x1+a*(r.x2-r.x1),r.y1+a*(r.y2-r.y1)):new Iy(jt.NONE)}return new Iy(t===0||n===0?jt.COINCIDENT:jt.PARALLEL)}function NN(r,e){const t=(e.x2-e.x1)*(r.y1-e.y1)-(e.y2-e.y1)*(r.x1-e.x1),n=(r.x2-r.x1)*(r.y1-e.y1)-(r.y2-r.y1)*(r.x1-e.x1),i=(e.y2-e.y1)*(r.x2-r.x1)-(e.x2-e.x1)*(r.y2-r.y1);if(i){const a=t/i,s=n/i;if(0<=a&&a<=1&&0<=s&&s<=1)return a}return Number.POSITIVE_INFINITY}function HV(r,e){function t(i,a,s,o){let l=NN(e,new vn(i,a,s,o));return l=Math.abs(l-.5),l>=0&&l<=1?1:0}let n=t(r.x,r.y,r.x2,r.y);return n+=t(r.x,r.y,r.x,r.y2),n>1||(n+=t(r.x,r.y2,r.x2,r.y2),n>1)?!0:(n+=t(r.x2,r.y,r.x2,r.y2),n>0)}var qt;(function(r){r[r.LEFT=0]="LEFT",r[r.TOP=1]="TOP",r[r.RIGHT=2]="RIGHT",r[r.BOTTOM=3]="BOTTOM"})(qt||(qt={}));function Bu(r,e,t){const n=new Set;return r.width<=0?(n.add(qt.LEFT),n.add(qt.RIGHT)):e<r.x?n.add(qt.LEFT):e>r.x+r.width&&n.add(qt.RIGHT),r.height<=0?(n.add(qt.TOP),n.add(qt.BOTTOM)):t<r.y?n.add(qt.TOP):t>r.y+r.height&&n.add(qt.BOTTOM),n}function RN(r,e){let t=e.x1,n=e.y1;const i=e.x2,a=e.y2,s=Array.from(Bu(r,i,a));if(s.length===0)return!0;let o=Bu(r,t,n);for(;o.size!==0;){for(const l of s)if(o.has(l))return!1;if(o.has(qt.RIGHT)||o.has(qt.LEFT)){let l=r.x;o.has(qt.RIGHT)&&(l+=r.width),n=n+(l-t)*(a-n)/(i-t),t=l}else{let l=r.y;o.has(qt.BOTTOM)&&(l+=r.height),t=t+(l-n)*(i-t)/(a-n),n=l}o=Bu(r,t,n)}return!0}function YV(r,e){let t=Number.POSITIVE_INFINITY,n=0;function i(a,s,o,l){let u=NN(e,new vn(a,s,o,l));u=Math.abs(u-.5),u>=0&&u<=1&&(n++,u<t&&(t=u))}return i(r.x,r.y,r.x2,r.y),i(r.x,r.y,r.x,r.y2),n>1||(i(r.x,r.y2,r.x2,r.y2),n>1)?t:(i(r.x2,r.y,r.x2,r.y2),n===0?-1:t)}function XV(r,e){let t=0;const n=Eu(r,new vn(e.x,e.y,e.x2,e.y));t+=n.state===jt.POINT?1:0;const i=Eu(r,new vn(e.x,e.y,e.x,e.y2));t+=i.state===jt.POINT?1:0;const a=Eu(r,new vn(e.x,e.y2,e.x2,e.y2));t+=a.state===jt.POINT?1:0;const s=Eu(r,new vn(e.x2,e.y,e.x2,e.y2));return t+=s.state===jt.POINT?1:0,{top:n,left:i,bottom:a,right:s,count:t}}class Cn{constructor(e,t,n,i){this.x=e,this.y=t,this.width=n,this.height=i}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(e){return new Cn(e.x,e.y,e.width,e.height)}equals(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}clone(){return new Cn(this.x,this.y,this.width,this.height)}add(e){const t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),i=Math.max(this.x2,e.x+e.width),a=Math.max(this.y2,e.y+e.height);this.x=t,this.y=n,this.width=i-t,this.height=a-n}addPoint(e){const t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),i=Math.max(this.x2,e.x),a=Math.max(this.y2,e.y);this.x=t,this.y=n,this.width=i-t,this.height=a-n}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(e){e.rect(this.x,this.y,this.width,this.height)}containsPt(e,t){return e>=this.x&&e<=this.x2&&t>=this.y&&t<=this.y2}get area(){return this.width*this.height}intersects(e){return this.area<=0||e.width<=0||e.height<=0?!1:e.x+e.width>this.x&&e.y+e.height>this.y&&e.x<this.x2&&e.y<this.y2}distSquare(e,t){if(this.containsPt(e,t))return 0;const n=Bu(this,e,t);return n.has(qt.TOP)?n.has(qt.LEFT)?ra(e,t,this.x,this.y):n.has(qt.RIGHT)?ra(e,t,this.x2,this.y):(this.y-t)*(this.y-t):n.has(qt.BOTTOM)?n.has(qt.LEFT)?ra(e,t,this.x,this.y2):n.has(qt.RIGHT)?ra(e,t,this.x2,this.y2):(t-this.y2)*(t-this.y2):n.has(qt.LEFT)?(this.x-e)*(this.x-e):n.has(qt.RIGHT)?(e-this.x2)*(e-this.x2):0}}function KV(r){if(r.length===0)return null;const e=r[0],t=new Cn(e.x,e.y,0,0);for(const n of r)t.addPoint(n);return t}class Sc{constructor(e,t,n){this.cx=e,this.cy=t,this.radius=n}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return this.radius*2}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return this.radius*2}static from(e){return new Sc(e.cx,e.cy,e.radius)}containsPt(e,t){return ra(this.cx,this.cy,e,t)<this.radius*this.radius}distSquare(e,t){const n=ra(this.cx,this.cy,e,t);if(n<this.radius*this.radius)return 0;const i=Math.sqrt(n)-this.radius;return i*i}draw(e){e.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,Math.PI*2)}}class qa{constructor(e,t=0,n=0,i=0,a=0,s=10,o=10,l=new Float32Array(Math.max(0,s*o)).fill(0)){this.pixelGroup=e,this.i=t,this.j=n,this.pixelX=i,this.pixelY=a,this.width=s,this.height=o,this.area=l}createSub(e,t){return new qa(this.pixelGroup,e.x,e.y,t.x,t.y,e.width,e.height)}static fromPixelRegion(e,t){return new qa(t,0,0,e.x,e.y,Math.ceil(e.width/t),Math.ceil(e.height/t))}copy(e,t){return new qa(this.pixelGroup,this.scaleX(t.x),this.scaleY(t.y),t.x,t.y,e.width,e.height,e.area)}boundX(e){return e<this.i?this.i:e>=this.width?this.width-1:e}boundY(e){return e<this.j?this.j:e>=this.height?this.height-1:e}scaleX(e){return this.boundX(Math.floor((e-this.pixelX)/this.pixelGroup))}scaleY(e){return this.boundY(Math.floor((e-this.pixelY)/this.pixelGroup))}scale(e){const t=this.scaleX(e.x),n=this.scaleY(e.y),i=this.boundX(Math.ceil((e.x+e.width-this.pixelX)/this.pixelGroup)),a=this.boundY(Math.ceil((e.y+e.height-this.pixelY)/this.pixelGroup)),s=i-t,o=a-n;return new Cn(t,n,s,o)}invertScaleX(e){return Math.round(e*this.pixelGroup+this.pixelX)}invertScaleY(e){return Math.round(e*this.pixelGroup+this.pixelY)}addPadding(e,t){const n=Math.ceil(t/this.pixelGroup),i=this.boundX(e.x-n),a=this.boundY(e.y-n),s=this.boundX(e.x2+n),o=this.boundY(e.y2+n),l=s-i,u=o-a;return new Cn(i,a,l,u)}get(e,t){return e<0||t<0||e>=this.width||t>=this.height?Number.NaN:this.area[e+t*this.width]}inc(e,t,n){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]+=n)}set(e,t,n){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]=n)}incArea(e,t){if(e.width<=0||e.height<=0||t===0)return;const n=this.width,i=e.width,a=Math.max(0,e.i),s=Math.max(0,e.j),o=Math.min(e.i+e.width,n),l=Math.min(e.j+e.height,this.height);if(!(l<=0||o<=0||a>=n||l>=this.height))for(let u=s;u<l;u++){const c=(u-e.j)*i,h=u*n;for(let d=a;d<o;d++){const f=e.area[d-e.i+c];f!==0&&(this.area[d+h]+=t*f)}}}fill(e){this.area.fill(e)}fillArea(e,t){const n=e.x+e.y*this.width;for(let i=0;i<e.height;i++){const a=n+i*this.width;this.area.fill(t,a,a+e.width)}}fillHorizontalLine(e,t,n,i){const a=e+t*this.width;this.area.fill(i,a,a+n)}fillVerticalLine(e,t,n,i){const a=e+t*this.width;for(let s=0;s<n;s++)this.area[a+s*this.width]=i}clear(){this.area.fill(0)}toString(){let e="";for(let t=0;t<this.height;t++){const n=t*this.width;for(let i=0;i<this.width;i++){const a=this.area[n+i];e+=a.toFixed(1).padStart(6),e+=" "}e+=`
`}return e}draw(e,t=!0){if(this.width<=0||this.height<=0)return;e.save(),t&&e.translate(this.pixelX,this.pixelY);const n=this.area.reduce((s,o)=>Math.min(s,o),Number.POSITIVE_INFINITY),i=this.area.reduce((s,o)=>Math.max(s,o),Number.NEGATIVE_INFINITY),a=s=>(s-n)/(i-n);e.scale(this.pixelGroup,this.pixelGroup);for(let s=0;s<this.width;s++)for(let o=0;o<this.height;o++){const l=this.area[s+o*this.width];e.fillStyle=`rgba(0, 0, 0, ${a(l)})`,e.fillRect(s,o,1,1)}e.restore()}drawThreshold(e,t,n=!0){if(!(this.width<=0||this.height<=0)){e.save(),n&&e.translate(this.pixelX,this.pixelY),e.scale(this.pixelGroup,this.pixelGroup);for(let i=0;i<this.width;i++)for(let a=0;a<this.height;a++){const s=this.area[i+a*this.width];e.fillStyle=s>t?"black":"white",e.fillRect(i,a,1,1)}e.restore()}}}function LN(r,e){const t=n=>({x:n.x-e,y:n.y-e,width:n.width+2*e,height:n.height+2*e});return Array.isArray(r)?r.map(t):t(r)}function jO(r,e,t){return IN(Object.assign(CN(r),{distSquare:(n,i)=>Mb(r.x1,r.y1,r.x2,r.y2,n,i)}),e,t)}function IN(r,e,t){const n=LN(r,t),i=e.scale(n),a=e.createSub(i,n);return ZV(a,e,t,(s,o)=>r.distSquare(s,o)),a}function ZV(r,e,t,n){const i=t*t;for(let a=0;a<r.height;a++)for(let s=0;s<r.width;s++){const o=e.invertScaleX(r.i+s),l=e.invertScaleY(r.j+a),u=n(o,l);if(u===0){r.set(s,a,i);continue}if(u<i){const c=t-Math.sqrt(u);r.set(s,a,c*c)}}return r}function JV(r,e,t){const n=e.scale(r),i=e.addPadding(n,t),a=e.createSub(i,{x:r.x-t,y:r.y-t}),s=n.x-i.x,o=n.y-i.y,l=i.x2-n.x2,u=i.y2-n.y2,c=i.width-s-l,h=i.height-o-u,d=t*t;a.fillArea({x:s,y:o,width:c+1,height:h+1},d);const f=[0],g=Math.max(o,s,l,u);{const m=e.invertScaleX(n.x+n.width/2);for(let w=1;w<g;w++){const S=e.invertScaleY(n.y-w),_=r.distSquare(m,S);if(_<d){const O=t-Math.sqrt(_);f.push(O*O)}else break}}const v=[],p=Math.max(s,l),y=Math.max(o,l);for(let m=1;m<p;m++){const w=e.invertScaleX(n.x-m),S=[];for(let _=1;_<y;_++){const O=e.invertScaleY(n.y-_),T=r.distSquare(w,O);if(T<d){const k=t-Math.sqrt(T);S.push(k*k)}else S.push(0)}v.push(S)}for(let m=1;m<Math.min(o,f.length);m++){const w=f[m];a.fillHorizontalLine(s,o-m,c+1,w)}for(let m=1;m<Math.min(u,f.length);m++){const w=f[m];a.fillHorizontalLine(s,o+h+m,c+1,w)}for(let m=1;m<Math.min(s,f.length);m++){const w=f[m];a.fillVerticalLine(s-m,o,h+1,w)}for(let m=1;m<Math.min(u,f.length);m++){const w=f[m];a.fillVerticalLine(s+c+m,o,h+1,w)}for(let m=1;m<s;m++){const w=v[m-1],S=s-m;for(let _=1;_<o;_++)a.set(S,o-_,w[_-1]);for(let _=1;_<u;_++)a.set(S,o+h+_,w[_-1])}for(let m=1;m<l;m++){const w=v[m-1],S=s+c+m;for(let _=1;_<o;_++)a.set(S,o-_,w[_-1]);for(let _=1;_<u;_++)a.set(S,o+h+_,w[_-1])}return a}function _t(r,e){return{x:r,y:e}}function QV(r,e,t,n){if(r.length===0)return[];const i=i7(r);return i.map((a,s)=>{const o=i.slice(0,s);return e7(e,a,o,t,n)}).flat()}function e7(r,e,t,n,i){const a=_t(e.cx,e.cy),s=r7(a,t,r);if(s==null)return[];const o=new vn(a.x,a.y,s.cx,s.cy),l=t7(o,r,n,i);return n7(l,r)}function t7(r,e,t,n){const i=[],a=[];a.push(r);let s=!0;for(let o=0;o<t&&s;o++)for(s=!1;!s&&a.length>0;){const l=a.pop(),u=DN(e,l),c=u?XV(l,u):null;if(!u||!c||c.count!==2){s||i.push(l);continue}let h=n,d=_u(u,h,c,!0),f=$i(d,a)||$i(d,i),g=Su(d,e);for(;!f&&g&&h>=1;)h/=1.5,d=_u(u,h,c,!0),f=$i(d,a)||$i(d,i),g=Su(d,e);if(d&&!f&&!g&&(a.push(new vn(l.x1,l.y1,d.x,d.y)),a.push(new vn(d.x,d.y,l.x2,l.y2)),s=!0),s)continue;h=n,d=_u(u,h,c,!1);let v=$i(d,a)||$i(d,i);for(g=Su(d,e);!v&&g&&h>=1;)h/=1.5,d=_u(u,h,c,!1),v=$i(d,a)||$i(d,i),g=Su(d,e);d&&!v&&(a.push(new vn(l.x1,l.y1,d.x,d.y)),a.push(new vn(d.x,d.y,l.x2,l.y2)),s=!0),s||i.push(l)}for(;a.length>0;)i.push(a.pop());return i}function n7(r,e){const t=[];for(;r.length>0;){const n=r.pop();if(r.length===0){t.push(n);break}const i=r.pop(),a=new vn(n.x1,n.y1,i.x2,i.y2);DN(e,a)?(t.push(n),r.push(i)):r.push(a)}return t}function r7(r,e,t){let n=Number.POSITIVE_INFINITY;return e.reduce((i,a)=>{const s=ra(r.x,r.y,a.cx,a.cy);if(s>n)return i;const o=new vn(r.x,r.y,a.cx,a.cy),l=a7(t,o);return s*(l+1)*(l+1)<n&&(i=a,n=s*(l+1)*(l+1)),i},null)}function i7(r){if(r.length<2)return r;let e=0,t=0;return r.forEach(n=>{e+=n.cx,t+=n.cy}),e/=r.length,t/=r.length,r.map(n=>{const i=e-n.cx,a=t-n.cy,s=i*i+a*a;return[n,s]}).sort((n,i)=>n[1]-i[1]).map(n=>n[0])}function Su(r,e){return e.some(t=>t.containsPt(r.x,r.y))}function $i(r,e){return e.some(t=>!!(zO(t.x1,t.y1,r.x,r.y,.001)||zO(t.x2,t.y2,r.x,r.y,.001)))}function DN(r,e){let t=Number.POSITIVE_INFINITY,n=null;for(const i of r){if(!RN(i,e))continue;const a=YV(i,e);a>=0&&a<t&&(n=i,t=a)}return n}function a7(r,e){return r.reduce((t,n)=>RN(n,e)&&HV(n,e)?t+1:t,0)}function _u(r,e,t,n){const i=t.top,a=t.left,s=t.bottom,o=t.right;if(n){if(a.state===jt.POINT){if(i.state===jt.POINT)return _t(r.x-e,r.y-e);if(s.state===jt.POINT)return _t(r.x-e,r.y2+e);const d=r.width*r.height;return r.width*((a.y-r.y+(o.y-r.y))*.5)<d*.5?a.y>o.y?_t(r.x-e,r.y-e):_t(r.x2+e,r.y-e):a.y<o.y?_t(r.x-e,r.y2+e):_t(r.x2+e,r.y2+e)}if(o.state===jt.POINT){if(i.state===jt.POINT)return _t(r.x2+e,r.y-e);if(s.state===jt.POINT)return _t(r.x2+e,r.y2+e)}const c=r.height*r.width;return r.height*((i.x-r.x+(o.x-r.x))*.5)<c*.5?i.x>s.x?_t(r.x-e,r.y-e):_t(r.x-e,r.y2+e):i.x<s.x?_t(r.x2+e,r.y-e):_t(r.x2+e,r.y2+e)}if(a.state===jt.POINT){if(i.state===jt.POINT)return _t(r.x2+e,r.y2+e);if(s.state===jt.POINT)return _t(r.x2+e,r.y-e);const c=r.height*r.width;return r.width*((a.y-r.y+(o.y-r.y))*.5)<c*.5?a.y>o.y?_t(r.x2+e,r.y2+e):_t(r.x-e,r.y2+e):a.y<o.y?_t(r.x2+e,r.y-e):_t(r.x-e,r.y-e)}if(o.state===jt.POINT){if(i.state===jt.POINT)return _t(r.x-e,r.y2+e);if(s.state===jt.POINT)return _t(r.x-e,r.y-e)}const l=r.height*r.width;return r.height*((i.x-r.x+(o.x-r.x))*.5)<l*.5?i.x>s.x?_t(r.x2+e,r.y2+e):_t(r.x2+e,r.y-e):i.x<s.x?_t(r.x-e,r.y2+e):_t(r.x-e,r.y-e)}function s7(r,e,t,n){if(!(r.closed?t<r.length:t<r.length-1))return!1;const a=r.get(e),s=r.get(t+1);for(let o=e+1;o<=t;o++){const l=r.get(o);if(Mb(a.x,a.y,s.x,s.y,l.x,l.y)>n)return!1}return!0}function o7(r=0){return e=>{if(r<0||e.length<3)return e;const t=[];let n=0;const i=r*r;for(;n<e.length;){let a=n+1;for(;s7(e,n,a,i);)a++;t.push(e.get(n)),n=a}return new Qs(t)}}function l7(r,e){switch(r){case-2:return(((-e+3)*e-3)*e+1)/6;case-1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:throw new Error("unknown error")}}function u7(r=6){function a(s,o,l){let u=0,c=0;for(let h=-2;h<=1;h++){const d=s.get(o+h),f=l7(h,l);u+=f*d.x,c+=f*d.y}return{x:u,y:c}}return s=>{if(s.length<3)return s;const o=[],l=s.closed,u=s.length+3-1+(l?0:2);o.push(a(s,2-(l?0:2),0));for(let c=2-(l?0:2);c<u;c++)for(let h=1;h<=r;h++)o.push(a(s,c,h/r));return new Qs(o)}}function c7(r=8){return e=>{let t=r,n=e.length;if(t>1)for(n=Math.floor(e.length/t);n<3&&t>1;)t-=1,n=Math.floor(e.length/t);const i=[];for(let a=0,s=0;s<n;s++,a+=t)i.push(e.get(a));return new Qs(i)}}class Qs{constructor(e=[],t=!0){this.points=e,this.closed=t}get(e){const t=e,n=this.points.length;return e<0?this.closed?this.get(e+n):this.points[0]:e>=n?this.closed?this.get(e-n):this.points[n-1]:this.points[t]}get length(){return this.points.length}toString(e=1/0){const t=this.points;if(t.length===0)return"";const n=typeof e=="function"?e:UV(e);let i="M";for(const a of t)i+=`${n(a.x)},${n(a.y)} L`;return i=i.slice(0,-1),this.closed&&(i+=" Z"),i}draw(e){const t=this.points;if(t.length!==0){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(const n of t)e.lineTo(n.x,n.y);this.closed&&e.closePath()}}sample(e){return c7(e)(this)}simplify(e){return o7(e)(this)}bSplines(e){return u7(e)(this)}apply(e){return e(this)}containsElements(e){const t=KV(this.points);return t?e.every(n=>t.containsPt(n.cx,n.cy)&&this.withinArea(n.cx,n.cy)):!1}withinArea(e,t){if(this.length===0)return!1;let n=0;const i=this.points[0],a=new vn(i.x,i.y,i.x,i.y);for(let s=1;s<this.points.length;s++){const o=this.points[s];a.x1=a.x2,a.y1=a.y2,a.x2=o.x,a.y2=o.y,a.cuts(e,t)&&n++}return a.x1=a.x2,a.y1=a.y2,a.x2=i.x,a.y2=i.y,a.cuts(e,t)&&n++,n%2===1}}class h7{constructor(e=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=e}add(e){this.set.add(`${e.x}x${e.y}`),this.arr[this.count++]=e}contains(e){return this.set.has(`${e.x}x${e.y}`)}isFirst(e){if(this.count===0)return!1;const t=this.arr[0];return t!=null&&t.x===e.x&&t.y===e.y}path(){return new Qs(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(e){return this.arr[e]}get length(){return this.count}}const ho=0,Mu=1,Ou=2,Dy=3;function d7(r,e){const t=(Math.floor(r.width)+Math.floor(r.height))*2,n=new h7(t);function i(l,u,c,h){const d=r.get(l,u);return Number.isNaN(d)?Number.NaN:d>e?c+h:c}function a(l,u){let c=ho;return c=i(l,u,c,1),c=i(l+1,u,c,2),c=i(l,u+1,c,4),c=i(l+1,u+1,c,8),Number.isNaN(c)?-1:c}let s=Mu;function o(l,u){let c=l,h=u,d=r.invertScaleX(c),f=r.invertScaleY(h);for(let g=0;g<r.width*r.height;g++){const v={x:d,y:f};if(n.contains(v)){if(n.isFirst(v))return!0}else n.add(v);const p=a(c,h);switch(p){case-1:return!0;case 0:case 3:case 2:case 7:s=Ou;break;case 12:case 14:case 4:s=Dy;break;case 6:s=s===ho?Dy:Ou;break;case 1:case 13:case 5:s=ho;break;case 9:s=s===Ou?ho:Mu;break;case 10:case 8:case 11:s=Mu;break;default:return console.warn("Marching squares invalid state: "+p),!0}switch(s){case ho:h--,f-=r.pixelGroup;break;case Mu:h++,f+=r.pixelGroup;break;case Dy:c--,d-=r.pixelGroup;break;case Ou:c++,d+=r.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+p),!0}}return!0}for(let l=0;l<r.width;l++)for(let u=0;u<r.height;u++){if(r.get(l,u)<=e)continue;const c=a(l,u);if(!(c<0||c===15)&&o(l,u))return n.path()}return null}const Nh={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function Lo(r){return r!=null&&typeof r.radius=="number"}function qO(r,e){if(Lo(r)!==Lo(e))return!1;if(Lo(r)){const n=e;return r.cx===n.cx&&r.cy===n.cy&&r.radius===n.radius}const t=e;return r.x===t.x&&r.y===t.y&&r.width===t.width&&r.height===t.height}var Dr;(function(r){r[r.MEMBERS=0]="MEMBERS",r[r.NON_MEMBERS=1]="NON_MEMBERS",r[r.EDGES=2]="EDGES"})(Dr||(Dr={}));let $O=class{constructor(e={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new Cn(0,0,0,0),this.potentialArea=new qa(1,0,0,0,0,0,0),this.o=Object.assign({},Nh,e)}pushMember(...e){if(e.length!==0){this.dirty.add(Dr.MEMBERS);for(const t of e)this.members.push({raw:t,obj:Lo(t)?Sc.from(t):Cn.from(t),area:null})}}removeMember(e){const t=this.members.findIndex(n=>qO(n.raw,e));return t<0?!1:(this.members.splice(t,1),this.dirty.add(Dr.MEMBERS),!0)}removeNonMember(e){const t=this.nonMembers.findIndex(n=>qO(n.raw,e));return t<0?!1:(this.nonMembers.splice(t,1),this.dirty.add(Dr.NON_MEMBERS),!0)}removeEdge(e){const t=this.edges.findIndex(n=>n.obj.equals(e));return t<0?!1:(this.edges.splice(t,1),this.dirty.add(Dr.NON_MEMBERS),!0)}pushNonMember(...e){if(e.length!==0){this.dirty.add(Dr.NON_MEMBERS);for(const t of e)this.nonMembers.push({raw:t,obj:Lo(t)?Sc.from(t):Cn.from(t),area:null})}}pushEdge(...e){if(e.length!==0){this.dirty.add(Dr.EDGES);for(const t of e)this.edges.push({raw:t,obj:vn.from(t),area:null})}}update(){const e=this.dirty.has(Dr.MEMBERS),t=this.dirty.has(Dr.NON_MEMBERS);let n=this.dirty.has(Dr.EDGES);this.dirty.clear();const i=this.members.map(u=>u.obj);if(this.o.virtualEdges&&(e||t)){const u=this.nonMembers.map(d=>d.obj),c=QV(i,u,this.o.maxRoutingIterations,this.o.morphBuffer),h=new Map(this.virtualEdges.map(d=>[d.obj.toString(),d.area]));this.virtualEdges=c.map(d=>{var f;return{raw:d,obj:d,area:(f=h.get(d.toString()))!==null&&f!==void 0?f:null}}),n=!0}let a=!1;if(e||n){const u=this.virtualEdges.concat(this.edges).map(f=>f.obj),c=g7(i,u),h=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,d=Cn.from(LN(c,h));d.equals(this.activeRegion)||(a=!0,this.activeRegion=d)}if(a){const u=Math.ceil(this.activeRegion.width/this.o.pixelGroup),c=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=qa.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(h=>h.area=null),this.nonMembers.forEach(h=>h.area=null),this.edges.forEach(h=>h.area=null),this.virtualEdges.forEach(h=>h.area=null)):(u!==this.potentialArea.width||c!==this.potentialArea.height)&&(this.potentialArea=qa.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}const s=new Map,o=u=>{if(u.area){const c=`${u.obj.width}x${u.obj.height}x${u.obj instanceof Cn?"R":"C"}`;s.set(c,u.area)}},l=u=>{if(u.area)return;const c=`${u.obj.width}x${u.obj.height}x${u.obj instanceof Cn?"R":"C"}`;if(s.has(c)){const d=s.get(c);u.area=this.potentialArea.copy(d,{x:u.obj.x-this.o.nodeR1,y:u.obj.y-this.o.nodeR1});return}const h=u.obj instanceof Cn?JV(u.obj,this.potentialArea,this.o.nodeR1):IN(u.obj,this.potentialArea,this.o.nodeR1);u.area=h,s.set(c,h)};this.members.forEach(o),this.nonMembers.forEach(o),this.members.forEach(l),this.nonMembers.forEach(u=>{this.activeRegion.intersects(u.obj)?l(u):u.area=null}),this.edges.forEach(u=>{u.area||(u.area=jO(u.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(u=>{u.area||(u.area=jO(u.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(e){for(const t of this.members)t.obj.draw(e)}drawNonMembers(e){for(const t of this.nonMembers)t.obj.draw(e)}drawEdges(e){for(const t of this.edges)t.obj.draw(e)}drawPotentialArea(e,t=!0){this.potentialArea.draw(e,t)}compute(){if(this.members.length===0)return new Qs([]);this.dirty.size>0&&this.update();const{o:e,potentialArea:t}=this,n=this.members.map(o=>o.area),i=this.virtualEdges.concat(this.edges).map(o=>o.area),a=this.nonMembers.filter(o=>o.area!=null).map(o=>o.area),s=this.members.map(o=>o.obj);return f7(t,n,i,a,o=>o.containsElements(s),e)}};function f7(r,e,t,n,i,a={}){const s=Object.assign({},Nh,a);let o=s.threshold,l=s.memberInfluenceFactor,u=s.edgeInfluenceFactor,c=s.nonMemberInfluenceFactor;const h=(s.nodeR0-s.nodeR1)*(s.nodeR0-s.nodeR1),d=(s.edgeR0-s.edgeR1)*(s.edgeR0-s.edgeR1);for(let f=0;f<s.maxMarchingIterations;f++){if(r.clear(),l!==0){const v=l/h;for(const p of e)r.incArea(p,v)}if(u!==0){const v=u/d;for(const p of t)r.incArea(p,v)}if(c!==0){const v=c/h;for(const p of n)r.incArea(p,v)}const g=d7(r,o);if(g&&i(g))return g;if(o*=.95,f<=s.maxMarchingIterations*.5)l*=1.2,u*=1.2;else if(c!==0&&n.length>0)c*=.8;else break}return new Qs([])}function g7(r,e){if(r.length===0)return new Cn(0,0,0,0);const t=Cn.from(r[0]);for(const n of r)t.add(n);for(const n of e)t.add(CN(n));return t}var p7=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Rh extends Tn{constructor(e,t){super(e,$n({},Rh.defaultOptions,t)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{const{style:n,bubbleSetOptions:i}=this.parseOptions();zt(this.bubbleSetOptions,i)||this.init(),this.bubbleSetOptions=Object.assign({},i);const a=Object.assign(Object.assign({},n),{d:this.getPath()});this.shape?this.shape.update(a):(this.shape=new fl({style:a}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=n=>{if(!this.shape)return;const i=J(n.data);[...this.options.members,...this.options.avoidMembers].includes(i)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(i)}))},this.getPath=n=>{const{graph:i}=this.context,a=this.options.members,s=[...this.members.keys()],o=this.options.avoidMembers,l=[...this.avoidMembers.keys()];if(!n&&zt(a,s)&&zt(o,l))return this.path;const{enter:u=[],exit:c=[]}=sa(s,a,p=>p),{enter:h=[],exit:d=[]}=sa(l,o,p=>p);n&&(c.push(n),u.push(n));const f=(p,y,m)=>{p.forEach(w=>{const S=m?this.members:this.avoidMembers,_=m?"pushMember":"pushNonMember",O=m?"removeMember":"removeNonMember";if(y){let T;i.getElementType(w)==="edge"?([T]=y7(i,w),this.bubbleSets.pushEdge(T)):([T]=v7(i,w),this.bubbleSets[_](T)),S.set(w,T)}else{const T=S.get(w);T&&(i.getElementType(w)==="edge"?this.bubbleSets.removeEdge(T):this.bubbleSets[O](T),S.delete(w))}})};f(c,!1,!0),f(u,!0,!0),f(d,!1,!1),f(h,!0,!1);const v=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=wP(v.points.map(Sn)),this.path},this.bindEvents(),this.bubbleSets=new $O(this.options)}bindEvents(){this.context.graph.on(ye.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(ye.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new $O(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){const e=this.options,{type:t,key:n,members:i,avoidMembers:a}=e,s=p7(e,["type","key","members","avoidMembers"]),o=Object.keys(s).reduce((l,u)=>(u in Nh?l.bubbleSetOptions[u]=s[u]:l.style[u]=s[u],l),{style:{},bubbleSetOptions:{}});return Object.assign({type:t,key:n,members:i,avoidMembers:a},o)}addMember(e){const t=Array.isArray(e)?e:[e];t.some(n=>this.options.avoidMembers.includes(n))&&(this.options.avoidMembers=this.options.avoidMembers.filter(n=>!t.includes(n))),this.options.members=[...new Set([...this.options.members,...t])],this.drawBubbleSets()}removeMember(e){const t=Array.isArray(e)?e:[e];this.options.members=this.options.members.filter(n=>!t.includes(n)),this.drawBubbleSets()}updateMember(e){this.options.members=Te(e)?e(this.options.members):e,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(e){const t=Array.isArray(e)?e:[e];t.some(n=>this.options.members.includes(n))&&(this.options.members=this.options.members.filter(n=>!t.includes(n))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...t])],this.drawBubbleSets()}removeAvoidMember(e){const t=Array.isArray(e)?e:[e];this.options.avoidMembers.some(n=>t.includes(n))&&(this.options.avoidMembers=this.options.avoidMembers.filter(n=>!t.includes(n)),this.drawBubbleSets())}updateAvoidMember(e){this.options.avoidMembers=Array.isArray(e)?e:[e],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(ye.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(ye.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}}Rh.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},Nh);const v7=(r,e)=>(Array.isArray(e)?e:[e]).map(n=>{const i=r.getElementRenderBounds(n);return new Cn(i.min[0],i.min[1],vi(i),yi(i))}),y7=(r,e)=>(Array.isArray(e)?e:[e]).map(n=>{const i=r.getEdgeData(n),a=r.getElementPosition(i.source),s=r.getElementPosition(i.target);return vn.from({x1:a[0],y1:a[1],x2:s[0],y2:s[1]})});function m7(r){return`
    <ul class="g6-contextmenu-ul">
      ${r.map(e=>`<li  class="g6-contextmenu-li" value="${e.value}">${e.name}</li>`).join("")}
    </ul>
  `}const b7=`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`;var GO=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Lh extends Tn{constructor(e,t){super(e,Object.assign({},Lh.defaultOptions,t)),this.targetElement=null,this.onTriggerEvent=n=>{var i;(i=n.preventDefault)===null||i===void 0||i.call(n),this.show(n)},this.onMenuItemClick=n=>{const{onClick:i,trigger:a}=this.options;if(n.target instanceof HTMLElement&&n.target.className.includes("g6-contextmenu-li")){const s=n.target.getAttribute("value");i==null||i(s,n.target,this.targetElement),this.hide()}a!=="click"&&this.hide()},this.initElement(),this.update(t)}initElement(){this.$element=Js("contextmenu",!1,{zIndex:"99"});const{className:e}=this.options;e&&this.$element.classList.add(e),this.context.canvas.getContainer().appendChild(this.$element),t1("g6-contextmenu-css","style",{},b7,document.head)}show(e){return GO(this,void 0,void 0,function*(){const{enable:t,offset:n}=this.options;if(typeof t=="function"&&!t(e)||!t){this.hide();return}const i=yield this.getDOMContent(e);i instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(i)):this.$element.innerHTML=i;const a=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${e.client.x-a.left+n[0]}px`,this.$element.style.top=`${e.client.y-a.top+n[1]}px`,this.$element.style.display="block",this.targetElement=e.target})}hide(){this.$element.style.display="none",this.targetElement=null}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(e){return GO(this,void 0,void 0,function*(){const{getContent:t,getItems:n}=this.options;return n?m7(yield n(e)):yield t(e)})}bindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;e.on(`canvas:${t}`,this.onTriggerEvent),e.on(`node:${t}`,this.onTriggerEvent),e.on(`edge:${t}`,this.onTriggerEvent),e.on(`combo:${t}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;e.off(`canvas:${t}`,this.onTriggerEvent),e.off(`node:${t}`,this.onTriggerEvent),e.off(`edge:${t}`,this.onTriggerEvent),e.off(`combo:${t}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}}Lh.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};class Ih extends Tn{constructor(e,t){super(e,Object.assign({},Ih.defaultOptions,t)),this.edgeBundles={},this.edgePoints={},this.onBundle=()=>{const{model:n,element:i}=this.context,a=n.getEdgeData();this.divideEdges(this.options.divisions);const{cycles:s,iterRate:o,divRate:l}=this.options;let{lambda:u,divisions:c,iterations:h}=this.options;for(let d=0;d<s;d++){for(let f=0;f<h;f++){const g={};a.forEach(v=>{var p;if(v.source===v.target)return;const y=J(v);g[y]=this.getEdgeForces(v,c,u);for(let m=0;m<c+1;m++)(p=this.edgePoints)[y]||(p[y]=[]),this.edgePoints[y][m]=$e(this.edgePoints[y][m],g[y][m])})}u/=2,c*=l,h*=o,this.divideEdges(c)}a.forEach(d=>{const f=J(d),g=i.getElement(f);g==null||g.update({d:K1(this.edgePoints[f])})})},this.bindEvents()}get nodeMap(){const e=this.context.model.getNodeData();return Object.fromEntries(e.map(t=>[J(t),Ya(un(t))]))}divideEdges(e){this.context.model.getEdgeData().forEach(n=>{var i;const a=J(n);(i=this.edgePoints)[a]||(i[a]=[]);const s=this.nodeMap[n.source],o=this.nodeMap[n.target];if(e===1)this.edgePoints[a].push(s),this.edgePoints[a].push(Gr($e(s,o),2)),this.edgePoints[a].push(o);else{const u=(this.edgePoints[a].length===0?bt(s,o):_7(this.edgePoints[a]))/(e+1);let c=u;const h=[s];for(let d=1;d<this.edgePoints[a].length;d++){const f=this.edgePoints[a][d-1],g=this.edgePoints[a][d];let v=bt(g,f);for(;v>c;){const p=c/v,y=$e(f,_i(ut(g,f),p));h.push(y),v-=c,c=u}c-=v}h.push(o),this.edgePoints[a]=h}})}getVectorPosition(e){const t=this.nodeMap[e.source],n=this.nodeMap[e.target],[i,a]=ut(n,t),s=bt(t,n);return{source:t,target:n,vx:i,vy:a,length:s}}measureEdgeCompatibility(e,t){const n=this.getVectorPosition(e),i=this.getVectorPosition(t),a=w7(n,i),s=x7(n,i),o=E7(n,i),l=S7(n,i);return a*s*o*l}getEdgeBundles(){const e={},t=this.options.bundleThreshold,n=this.context.model.getEdgeData();return n.forEach((i,a)=>{n.forEach((s,o)=>{var l,u;if(o<=a)return;this.measureEdgeCompatibility(i,s)>=t&&(e[l=J(i)]||(e[l]=[]),e[J(i)].push(s),e[u=J(s)]||(e[u]=[]),e[J(s)].push(i))})}),e}getSpringForce(e,t){const{pre:n,cur:i,next:a}=e;return _i(ut($e(n,a),_i(i,2)),t)}getElectrostaticForce(e,t){ai(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());const n=this.edgeBundles[J(t)];let i=[0,0];return n==null||n.forEach(a=>{const s=this.edgePoints[J(a)][e],o=this.edgePoints[J(t)][e],l=ut(s,o),u=bt(s,o);i=$e(i,_i(l,1/u))}),i}getEdgeForces(e,t,n){const i=this.nodeMap[e.source],a=this.nodeMap[e.target],s=this.options.K/(bt(i,a)*(t+1)),o=[[0,0]],l=J(e);for(let u=1;u<t;u++){const c=this.getSpringForce({pre:this.edgePoints[l][u-1],cur:this.edgePoints[l][u],next:this.edgePoints[l][u+1]||[0,0]},s),h=this.getElectrostaticForce(u,e);o.push(_i($e(c,h),n))}return o.push([0,0]),o}bindEvents(){const{graph:e}=this.context;e.on(ye.AFTER_RENDER,this.onBundle)}unbindEvents(){const{graph:e}=this.context;e.off(ye.AFTER_RENDER,this.onBundle)}destroy(){this.unbindEvents(),super.destroy()}}Ih.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};const w7=(r,e)=>Math.abs(_5([r.vx,r.vy],[e.vx,e.vy])/(r.length*e.length)),x7=(r,e)=>{const t=(r.length+e.length)/2;return 2/(t/Math.min(r.length,e.length)+Math.max(r.length,e.length)/t)},E7=(r,e)=>{const t=(r.length+e.length)/2,n=Gr($e(r.source,r.target),2),i=Gr($e(e.source,e.target),2);return t/(t+bt(n,i))},WO=(r,e)=>{if(e.source[0]===e.target[0])return[e.source[0],r[1]];if(e.source[1]===e.target[1])return[r[0],e.source[1]];const t=(e.source[1]-e.target[1])/(e.source[0]-e.target[0]),n=(t*t*e.source[0]+t*(r[1]-e.source[1])+r[0])/(t*t+1),i=t*(n-e.source[0])+e.source[1];return[n,i]},VO=(r,e)=>{const t=WO(e.source,r),n=WO(e.target,r),i=Gr($e(t,n),2),a=Gr($e(r.source,r.target),2);return bt(t,n)===0?0:Math.max(0,1-2*bt(a,i)/bt(t,n))},S7=(r,e)=>Math.min(VO(r,e),VO(e,r)),_7=r=>{let e=0;for(let t=1;t<r.length;t++)e+=bt(r[t],r[t-1]);return e},M7={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8,zIndex:-1/0},UO=.05;class Dh extends Tn{constructor(e,t){super(e,Object.assign({},Dh.defaultOptions,t)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=n=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const i=Sn(n.canvas);this.renderLens(i),this.renderFocusElements()},this.renderLens=n=>{const i=Object.assign({},M7,this.options.style);this.isLensOn||(this.lens=new gl({style:i}),this.canvas.appendChild(this.lens)),Object.assign(i,zr(n),{size:this.r*2}),this.lens.update(i)},this.getFilterData=()=>{const{filter:n}=this.options,{model:i}=this.context,a=i.getData();if(!n)return a;const{nodes:s,edges:o,combos:l}=a;return{nodes:s.filter(u=>n(J(u),"node")),edges:o.filter(u=>n(J(u),"edge")),combos:l.filter(u=>n(J(u),"combo"))}},this.getFocusElements=n=>{const{nodes:i,edges:a}=this.getFilterData(),s=i.filter(u=>bt(un(u),n)<this.r),o=s.map(u=>J(u)),l=a.filter(u=>{const{source:c,target:h}=u,d=o.includes(c),f=o.includes(h);switch(this.options.nodeType){case"both":return d&&f;case"either":return d!==f;case"source":return d&&!f;case"target":return!d&&f;default:return!1}});return{nodes:s,edges:l}},this.renderFocusElements=()=>{const{element:n,graph:i}=this.context;if(!this.isLensOn)return;const a=this.lens.getCenter(),{nodes:s,edges:o}=this.getFocusElements(a),l=new Set,u=c=>{const h=J(c);l.add(h);const d=n.getElement(h);if(!d)return;const f=this.shapes.get(h)||d.cloneNode();f.setPosition(d.getPosition()),f.id=d.id,this.shapes.has(h)?Object.entries(d.attributes).forEach(([p,y])=>{f.style[p]!==y&&(f.style[p]=y)}):(this.canvas.appendChild(f),this.shapes.set(h,f));const g=i.getElementType(h),v=this.getElementStyle(g,c);f.update(v)};s.forEach(u),o.forEach(u),this.shapes.forEach((c,h)=>{l.has(h)||(c.destroy(),this.shapes.delete(h))})},this.scaleRByWheel=n=>{var i;this.options.preventDefault&&n.preventDefault();const{clientX:a,clientY:s,deltaX:o,deltaY:l}=n,{graph:u,canvas:c}=this.context,h=u.getCanvasByClient([a,s]),d=(i=this.lens)===null||i===void 0?void 0:i.getCenter();if(!this.isLensOn||bt(h,d)>this.r)return;const{maxR:f,minR:g}=this.options,v=o+l>0?1/(1-UO):1-UO,p=Math.min(...c.getSize())/2;this.r=Math.max(g||0,Math.min(f||p,this.r*v)),this.renderLens(d),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=n=>{var i;const a=Sn(n.canvas),s=(i=this.lens)===null||i===void 0?void 0:i.getCenter();!this.isLensOn||bt(a,s)>this.r||(this.isLensDragging=!0)},this.onDrag=n=>{if(!this.isLensDragging)return;const i=Sn(n.canvas);this.renderLens(i),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(e,t){const n=e==="node"?this.options.nodeStyle:this.options.edgeStyle;return typeof n=="function"?n(t):n}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var e;const{graph:t}=this.context,{trigger:n,scaleRBy:i}=this.options,a=t.getCanvas().getLayer();["click","drag"].includes(n)&&a.addEventListener(ie.CLICK,this.onEdgeFilter),n==="pointermove"?a.addEventListener(ie.POINTER_MOVE,this.onEdgeFilter):n==="drag"&&(a.addEventListener(ie.DRAG_START,this.onDragStart),a.addEventListener(ie.DRAG,this.onDrag),a.addEventListener(ie.DRAG_END,this.onDragEnd)),i==="wheel"&&((e=this.graphDom)===null||e===void 0||e.addEventListener(ie.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var e;const{graph:t}=this.context,{trigger:n,scaleRBy:i}=this.options,a=t.getCanvas().getLayer();["click","drag"].includes(n)&&a.removeEventListener(ie.CLICK,this.onEdgeFilter),n==="pointermove"?a.removeEventListener(ie.POINTER_MOVE,this.onEdgeFilter):n==="drag"&&(a.removeEventListener(ie.DRAG_START,this.onDragStart),a.removeEventListener(ie.DRAG,this.onDrag),a.removeEventListener(ie.DRAG_END,this.onDragEnd)),i==="wheel"&&((e=this.graphDom)===null||e===void 0||e.removeEventListener(ie.WHEEL,this.scaleRByWheel))}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((e,t)=>{e.destroy(),this.shapes.delete(t)}),super.destroy()}}Dh.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};const O7={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12},HO=.05,YO=.1;class Fh extends Tn{constructor(e,t){super(e,Object.assign({},Fh.defaultOptions,t)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=n=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const i=Sn(n.canvas);this.onMagnify(i)},this.onMagnify=n=>{n.some(isNaN)||(this.renderLens(n),this.renderFocusElements())},this.renderLens=n=>{const i=Object.assign({},O7,this.options.style);this.isLensOn||(this.lens=new gl({style:i}),this.canvas.appendChild(this.lens)),Object.assign(i,zr(n),{size:this.r*2,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(i)},this.getDPercent=()=>{const{minD:n,maxD:i}=this.options;return`${Math.round((this.d-n)/(i-n)*100)}%`},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;const{graph:n}=this.context,i=this.lens.getCenter(),a=(this.d+1)*this.r,s=new Map,o=new Map;n.getNodeData().forEach(u=>{const c=un(u),h=bt(c,i);if(h>this.r)return;const d=a*h/(this.d*h+this.r),[f,g]=c,[v,p]=i,y=(f-v)/h,m=(g-p)/h,w=[v+d*y,p+d*m],S=J(u),_=this.getNodeStyle(u),O=Ga(n.getElementRenderStyle(S),Object.keys(_));s.set(S,Object.assign(Object.assign({},zr(w)),_)),o.set(S,Object.assign(Object.assign({},zr(c)),O))}),this.updateStyle(s,o)},this.getNodeStyle=n=>{const{nodeStyle:i}=this.options;return typeof i=="function"?i(n):i},this.updateStyle=(n,i)=>{const{graph:a,element:s}=this.context,{enter:o,exit:l,keep:u}=sa(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(n.keys()),d=>d),c=new Set,h=(d,f)=>{const g=s.getElement(d);g==null||g.update(f),a.getRelatedEdgesData(d).forEach(v=>{c.add(J(v))})};[...o,...u].forEach(d=>{h(d,n.get(d))}),l.forEach(d=>{h(d,this.prevOriginStyleMap.get(d)),this.prevOriginStyleMap.delete(d)}),c.forEach(d=>{const f=s.getElement(d);f==null||f.update({})}),this.prevMagnifiedStyleMap=n,i.forEach((d,f)=>{this.prevOriginStyleMap.has(f)||this.prevOriginStyleMap.set(f,d)})},this.isWheelValid=n=>{if(this.options.preventDefault&&n.preventDefault(),!this.isLensOn)return!1;const{clientX:i,clientY:a}=n,s=this.context.graph.getCanvasByClient([i,a]),o=this.lens.getCenter();return!(bt(s,o)>this.r)},this.scaleR=n=>{const{maxR:i,minR:a}=this.options,s=n?1/(1-HO):1-HO,o=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(a||0,Math.min(i||o,this.r*s))},this.scaleD=n=>{const{maxD:i,minD:a}=this.options,s=n?this.d+YO:this.d-YO;this.d=Math.max(a,Math.min(i,s))},this.scaleRByWheel=n=>{if(!this.isWheelValid(n))return;const{deltaX:i,deltaY:a}=n;this.scaleR(i+a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.scaleDByWheel=n=>{if(!this.isWheelValid(n))return;const{deltaX:i,deltaY:a}=n;this.scaleD(i+a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.isDragValid=n=>{if(this.options.preventDefault&&n.preventDefault(),!this.isLensOn)return!1;const i=Sn(n.canvas),a=this.lens.getCenter();return!(bt(i,a)>this.r)},this.isLensDragging=!1,this.onDragStart=n=>{this.isDragValid(n)&&(this.isLensDragging=!0)},this.onDrag=n=>{if(!this.isLensDragging)return;const i=Sn(n.canvas);this.onMagnify(i)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=n=>{if(!this.isLensDragging)return;const{dx:i,dy:a}=n;this.scaleR(i-a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.scaleDByDrag=n=>{if(!this.isLensDragging)return;const{dx:i,dy:a}=n;this.scaleD(i-a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var e;const{graph:t}=this.context,{trigger:n,scaleRBy:i,scaleDBy:a}=this.options,s=t.getCanvas().getLayer();if(["click","drag"].includes(n)&&s.addEventListener(ie.CLICK,this.onCreateFisheye),n==="pointermove"&&s.addEventListener(ie.POINTER_MOVE,this.onCreateFisheye),n==="drag"||i==="drag"||a==="drag"){s.addEventListener(ie.DRAG_START,this.onDragStart),s.addEventListener(ie.DRAG_END,this.onDragEnd);const o=n==="drag"?this.onDrag:i==="drag"?this.scaleRByDrag:this.scaleDByDrag;s.addEventListener(ie.DRAG,o)}if(i==="wheel"||a==="wheel"){const o=i==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(e=this.graphDom)===null||e===void 0||e.addEventListener(ie.WHEEL,o,{passive:!1})}}unbindEvents(){var e;const{graph:t}=this.context,{trigger:n,scaleRBy:i,scaleDBy:a}=this.options,s=t.getCanvas().getLayer();if(["click","drag"].includes(n)&&s.removeEventListener(ie.CLICK,this.onCreateFisheye),n==="pointermove"&&s.removeEventListener(ie.POINTER_MOVE,this.onCreateFisheye),n==="drag"||i==="drag"||a==="drag"){s.removeEventListener(ie.DRAG_START,this.onDragStart),s.removeEventListener(ie.DRAG_END,this.onDragEnd);const o=n==="drag"?this.onDrag:i==="drag"?this.scaleRByDrag:this.scaleDByDrag;s.removeEventListener(ie.DRAG,o)}if(i==="wheel"||a==="wheel"){const o=i==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(e=this.graphDom)===null||e===void 0||e.removeEventListener(ie.WHEEL,o)}}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){var e;this.unbindEvents(),this.isLensOn&&((e=this.lens)===null||e===void 0||e.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}}Fh.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class Bh extends Tn{constructor(e,t){super(e,Object.assign({},Bh.defaultOptions,t)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var n,i,a,s;const o=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(o),o?(i=(n=this.options).onEnter)===null||i===void 0||i.call(n):(s=(a=this.options).onExit)===null||s===void 0||s.call(a)},this.shortcut=new Gs(e.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:e=[],exit:t=[]}=this.options.trigger;this.shortcut.bind(e,this.request),this.shortcut.bind(t,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(i=>{document.addEventListener(i,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(t=>{document.removeEventListener(t,this.onFullscreenChange,!1)})}setGraphSize(e=!0){var t,n;let i,a;e?(i=((t=globalThis.screen)===null||t===void 0?void 0:t.width)||0,a=((n=globalThis.screen)===null||n===void 0?void 0:n.height)||0,this.graphSize=this.context.graph.getSize()):[i,a]=this.graphSize,this.context.graph.setSize(i,a),this.context.graph.render()}request(){document.fullscreenElement||!k7()||this.$el.requestFullscreen().catch(e=>{gi.warn(`Error attempting to enable full-screen: ${e.message} (${e.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}}Bh.defaultOptions={trigger:{},autoFit:!0};function k7(){return document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled")}class zh extends Tn{constructor(e,t){super(e,Object.assign({},zh.defaultOptions,t)),this.$element=Js("grid-line",!0),this.offset=[0,0],this.onTransform=i=>{if(!this.options.follow)return;const{data:{translate:a}}=i;a&&this.updateOffset(a)},this.context.canvas.getContainer().prepend(this.$element),this.updateStyle(),this.bindEvents()}update(e){super.update(e),this.updateStyle()}bindEvents(){const{graph:e}=this.context;e.on(ye.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{size:e,stroke:t,lineWidth:n,border:i,borderLineWidth:a,borderStroke:s,borderStyle:o}=this.options;Object.assign(this.$element.style,{border:i?`${a}px ${o} ${s}`:"none",backgroundImage:`linear-gradient(${t} ${n}px, transparent ${n}px), linear-gradient(90deg, ${t} ${n}px, transparent ${n}px)`,backgroundSize:`${e}px ${e}px`,backgroundRepeat:"repeat"})}updateOffset(e){this.offset=O5($e(this.offset,e),this.options.size),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}destroy(){this.context.graph.off(ye.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}}zh.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};function Ob(r){const e={Added:new Map,Updated:new Map,Removed:new Map};return r.forEach(t=>{const{type:n,value:i}=t,a=J(i);if(n==="NodeAdded"||n==="EdgeAdded"||n==="ComboAdded")e.Added.set(a,t);else if(n==="NodeUpdated"||n==="EdgeUpdated"||n==="ComboUpdated")if(e.Added.has(a))e.Added.set(a,{type:n.replace("Updated","Added"),value:i});else if(e.Updated.has(a)){const{original:s}=e.Updated.get(a);e.Updated.set(a,{type:n,value:i,original:s})}else e.Removed.has(a)||e.Updated.set(a,t);else(n==="NodeRemoved"||n==="EdgeRemoved"||n==="ComboRemoved")&&(e.Added.has(a)?e.Added.delete(a):(e.Updated.has(a)&&e.Updated.delete(a),e.Removed.set(a,t)))}),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function FN(r){const{NodeAdded:e=[],NodeUpdated:t=[],NodeRemoved:n=[],EdgeAdded:i=[],EdgeUpdated:a=[],EdgeRemoved:s=[],ComboAdded:o=[],ComboUpdated:l=[],ComboRemoved:u=[]}=Ac(r,c=>c.type);return{add:{nodes:e,edges:i,combos:o},update:{nodes:t,edges:a,combos:l},remove:{nodes:n,edges:s,combos:u}}}function BN(r,e){for(const t in r)Yt(r[t])&&!Array.isArray(r[t])&&r[t]!==null?(e[t]||(e[t]={}),BN(r[t],e[t])):e[t]===void 0&&(e[t]=Go(t))}function T7(r,e=!1,t){const n={animation:e,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:i,update:a,remove:s}=FN(Ob(r));return["nodes","edges","combos"].forEach(o=>{a[o]&&a[o].forEach(l=>{var u,c;const h=Object.assign({},l.value);let d=Object.assign({},l.original);if(t){const f=t.graph.getElementType(J(l.original)),g=f==="edge"?"stroke":"fill",v=t.element.getElementComputedStyle(f,l.original);d=Object.assign(Object.assign({},l.original),{style:Object.assign({[g]:v[g]},l.original.style)})}BN(h,d),(u=n.current.update)[o]||(u[o]=[]),n.current.update[o].push(h),(c=n.original.update)[o]||(c[o]=[]),n.original.update[o].push(d)}),i[o]&&i[o].forEach(l=>{var u,c;const h=Object.assign({},l.value);(u=n.current.add)[o]||(u[o]=[]),n.current.add[o].push(h),(c=n.original.remove)[o]||(c[o]=[]),n.original.remove[o].push(h)}),s[o]&&s[o].forEach(l=>{var u,c;const h=Object.assign({},l.value);(u=n.current.remove)[o]||(u[o]=[]),n.current.remove[o].push(h),(c=n.original.add)[o]||(c[o]=[]),n.original.add[o].push(h)})}),n}class jh extends Tn{constructor(e,t){super(e,Object.assign({},jh.defaultOptions,t)),this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=(i,a=!0)=>{var s,o,l;this.freezed=!0,(o=(s=this.options).executeCommand)===null||o===void 0||o.call(s,i);const u=a?i.original:i.current;this.context.graph.addData(u.add),this.context.graph.updateData(u.update),this.context.graph.removeData(iP(u.remove,!1)),(l=this.context.element)===null||l===void 0||l.draw({silence:!0,animation:i.animation}),this.freezed=!1},this.addCommand=i=>{var a;if(!this.freezed){if(i.type===ye.AFTER_DRAW){const{dataChanges:s=[],animation:o=!0}=i.data;if(!((a=this.context.batch)===null||a===void 0)&&a.isBatching){if(!this.batchChanges)return;this.batchChanges.push(s),this.batchAnimation&&(this.batchAnimation=o);return}this.batchChanges=[s],this.batchAnimation=o}this.undoStackPush(T7(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(Hi.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=i=>{const{initiate:a}=i.data;this.batchAnimation=!1,a?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)},this.emitter=new Qc;const{graph:n}=this.context;n.on(ye.AFTER_DRAW,this.addCommand),n.on(ye.BATCH_START,this.initBatchCommand),n.on(ye.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var e,t,n,i;const a=this.undoStack.pop();if(a){if(this.executeCommand(a),((t=(e=this.options).beforeAddCommand)===null||t===void 0?void 0:t.call(e,a,!1))===!1)return;this.redoStack.push(a),(i=(n=this.options).afterAddCommand)===null||i===void 0||i.call(n,a,!1),this.notify(Hi.UNDO,a)}return this}redo(){const e=this.redoStack.pop();return e&&(this.executeCommand(e,!1),this.undoStackPush(e),this.notify(Hi.REDO,e)),this}undoAndCancel(){const e=this.undoStack.pop();return e&&(this.executeCommand(e,!1),this.redoStack=[],this.notify(Hi.CANCEL,e)),this}undoStackPush(e){var t,n,i,a;const{stackSize:s}=this.options;s!==0&&this.undoStack.length>=s&&this.undoStack.shift(),((n=(t=this.options).beforeAddCommand)===null||n===void 0?void 0:n.call(t,e,!0))!==!1&&(this.undoStack.push(e),(a=(i=this.options).afterAddCommand)===null||a===void 0||a.call(i,e,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(Hi.CLEAR,null)}notify(e,t){this.emitter.emit(e,{cmd:t}),this.emitter.emit(Hi.CHANGE,{cmd:t})}on(e,t){this.emitter.on(e,t)}destroy(){const{graph:e}=this.context;e.off(ye.AFTER_DRAW,this.addCommand),e.off(ye.BATCH_START,this.initBatchCommand),e.off(ye.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}}jh.defaultOptions={stackSize:0};var Fy,XO;function A7(){if(XO)return Fy;XO=1;function r(t,n,i,a,s,o){const l=(o-n)*(i-t)-(a-n)*(s-t);return l>0?!0:!(l<0)}function e(t,n){const i=t[0][0],a=t[0][1],s=t[1][0],o=t[1][1],l=n[0][0],u=n[0][1],c=n[1][0],h=n[1][1];return r(i,a,l,u,c,h)!==r(s,o,l,u,c,h)&&r(i,a,s,o,l,u)!==r(i,a,s,o,c,h)}return Fy=e,Fy}var By,KO;function P7(){if(KO)return By;KO=1;function r(t,n){this._cells=[],this._cellSize=n,this._reverseCellSize=1/n;for(let i=0;i<t.length;i++){const a=t[i],s=this.coordToCellNum(a[0]),o=this.coordToCellNum(a[1]);if(this._cells[s])this._cells[s][o]?this._cells[s][o].push(a):this._cells[s][o]=[a];else{const l=[];l[o]=[a],this._cells[s]=l}}}r.prototype={cellPoints:function(t,n){return this._cells[t]!==void 0&&this._cells[t][n]!==void 0?this._cells[t][n]:[]},rangePoints:function(t){const n=this.coordToCellNum(t[0]),i=this.coordToCellNum(t[1]),a=this.coordToCellNum(t[2]),s=this.coordToCellNum(t[3]),o=[];for(let l=n;l<=a;l++)for(let u=i;u<=s;u++)for(let c=0;c<this.cellPoints(l,u).length;c++)o.push(this.cellPoints(l,u)[c]);return o},removePoint:function(t){const n=this.coordToCellNum(t[0]),i=this.coordToCellNum(t[1]),a=this._cells[n][i];let s;for(let o=0;o<a.length;o++)if(a[o][0]===t[0]&&a[o][1]===t[1]){s=o;break}return a.splice(s,1),a},trunc:Math.trunc||function(t){return t-t%1},coordToCellNum:function(t){return this.trunc(t*this._reverseCellSize)},extendBbox:function(t,n){return[t[0]-n*this._cellSize,t[1]-n*this._cellSize,t[2]+n*this._cellSize,t[3]+n*this._cellSize]}};function e(t,n){return new r(t,n)}return By=e,By}var zy,ZO;function C7(){return ZO||(ZO=1,zy={toXy:function(r,e){return e===void 0?r.slice():r.map(function(t){return new Function("pt","return [pt"+e[0]+",pt"+e[1]+"];")(t)})},fromXy:function(r,e){return e===void 0?r.slice():r.map(function(t){return new Function("pt","const o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;")(t)})}}),zy}var jy,JO;function N7(){if(JO)return jy;JO=1;function r(i,a,s){return(a[0]-i[0])*(s[1]-i[1])-(a[1]-i[1])*(s[0]-i[0])}function e(i){const a=[];for(let s=0;s<i.length;s++){for(;a.length>=2&&r(a[a.length-2],a[a.length-1],i[s])<=0;)a.pop();a.push(i[s])}return a.pop(),a}function t(i){const a=i.reverse(),s=[];for(let o=0;o<a.length;o++){for(;s.length>=2&&r(s[s.length-2],s[s.length-1],a[o])<=0;)s.pop();s.push(a[o])}return s.pop(),s}function n(i){const a=e(i),o=t(i).concat(a);return o.push(i[0]),o}return jy=n,jy}var qy,QO;function R7(){if(QO)return qy;QO=1;const r=A7(),e=P7(),t=C7(),n=N7();function i(p){const y=[p[0]];let m=p[0];for(let w=1;w<p.length;w++){const S=p[w];(m[0]!==S[0]||m[1]!==S[1])&&y.push(S),m=S}return y}function a(p){return p.sort(function(y,m){return y[0]-m[0]||y[1]-m[1]})}function s(p,y){return Math.pow(y[0]-p[0],2)+Math.pow(y[1]-p[1],2)}function o(p,y,m){const w=[y[0]-p[0],y[1]-p[1]],S=[m[0]-p[0],m[1]-p[1]],_=s(p,y),O=s(p,m);return(w[0]*S[0]+w[1]*S[1])/Math.sqrt(_*O)}function l(p,y){for(let m=0;m<y.length-1;m++){const w=[y[m],y[m+1]];if(!(p[0][0]===w[0][0]&&p[0][1]===w[0][1]||p[0][0]===w[1][0]&&p[0][1]===w[1][1])&&r(p,w))return!0}return!1}function u(p){let y=1/0,m=1/0,w=-1/0,S=-1/0;for(let _=p.length-1;_>=0;_--)p[_][0]<y&&(y=p[_][0]),p[_][1]<m&&(m=p[_][1]),p[_][0]>w&&(w=p[_][0]),p[_][1]>S&&(S=p[_][1]);return[w-y,S-m]}function c(p){return[Math.min(p[0][0],p[1][0]),Math.min(p[0][1],p[1][1]),Math.max(p[0][0],p[1][0]),Math.max(p[0][1],p[1][1])]}function h(p,y,m){let w=null,S=g,_=g,O,T;for(let k=0;k<y.length;k++)O=o(p[0],p[1],y[k]),T=o(p[1],p[0],y[k]),O>S&&T>_&&!l([p[0],y[k]],m)&&!l([p[1],y[k]],m)&&(S=O,_=T,w=y[k]);return w}function d(p,y,m,w,S){let _=!1;for(let O=0;O<p.length-1;O++){const T=[p[O],p[O+1]],k=T[0][0]+","+T[0][1]+","+T[1][0]+","+T[1][1];if(s(T[0],T[1])<y||S.has(k))continue;let P=0,C=c(T),N,L,F;do C=w.extendBbox(C,P),N=C[2]-C[0],L=C[3]-C[1],F=h(T,w.rangePoints(C),p),P++;while(F===null&&(m[0]>N||m[1]>L));N>=m[0]&&L>=m[1]&&S.add(k),F!==null&&(p.splice(O+1,0,F),w.removePoint(F),_=!0)}return _?d(p,y,m,w,S):p}function f(p,y,m){let w=y||20;const S=i(a(t.toXy(p,m)));if(S.length<4){const N=S.concat([S[0]]);return m?t.fromXy(N,m):N}const _=u(S),O=[_[0]*v,_[1]*v],T=n(S),k=S.filter(function(N){return T.indexOf(N)<0}),P=Math.ceil(1/(S.length/(_[0]*_[1]))),C=d(T,Math.pow(w,2),O,e(k,P),new Set);return m?t.fromXy(C,m):C}const g=Math.cos(90/(180/Math.PI)),v=.6;return qy=f,qy}var L7=R7();const I7=nl(L7);function D7(r,e,t){if(r.length===1)return F7(r[0],e,t);if(r.length===2)return ek(r,e,t);if(r.length===3){const[n,i,a]=W1(r);if(hP(n,i,a))return ek([n,a],e,t)}switch(t){case"smooth":return z7(r,e);case"sharp":return j7(r,e);case"rounded":default:return B7(r,e)}}const F7=(r,e,t)=>{if(t==="sharp")return[["M",r[0]-e,r[1]-e],["L",r[0]+e,r[1]-e],["L",r[0]+e,r[1]+e],["L",r[0]-e,r[1]+e],["Z"]];const n=[e,e,0,0,0];return[["M",r[0],r[1]-e],["A",...n,r[0],r[1]+e],["A",...n,r[0],r[1]-e]]},ek=(r,e,t)=>{const n=[e,e,0,0,0],i=t==="sharp"?$e(r[0],Qi(Ci(ut(r[0],r[1])),e)):r[0],a=t==="sharp"?$e(r[1],Qi(Ci(ut(r[1],r[0])),e)):r[1],s=Qi(Ci(Dc(ut(i,a),!1)),e),o=Qi(s,-1),l=$e(i,s),u=$e(a,s),c=$e(a,o),h=$e(i,o);return t==="sharp"?[["M",l[0],l[1]],["L",u[0],u[1]],["L",c[0],c[1]],["L",h[0],h[1]],["Z"]]:[["M",l[0],l[1]],["L",u[0],u[1]],["A",...n,c[0],c[1]],["L",h[0],h[1]],["A",...n,l[0],l[1]]]},B7=(r,e)=>{const t=W1(r).map((o,l)=>{const u=(l-2+r.length)%r.length,c=(l-1+r.length)%r.length,h=(l+1)%r.length,d=r[u],f=r[c],g=r[h],v=ut(d,f),p=ut(f,o),y=ut(o,g),m=(T,k)=>$1(T,k,!0)<Math.PI,w=m(v,p),S=m(p,y),_=T=>Qi(Ci(Dc(T,!1)),e),O=_(p);return[{p:Ya(w?$e(f,_(v)):$e(f,O)),concave:w&&f},{p:Ya(S?$e(o,_(y)):$e(o,O)),concave:S&&o}]}),n=[e,e,0,0,0],i=t.findIndex((o,l)=>!t[(l-1+t.length)%t.length][0].concave&&!t[(l-1+t.length)%t.length][1].concave&&!o[0].concave&&!o[0].concave&&!o[1].concave),a=t.slice(i).concat(t.slice(0,i));let s=[];return a.flatMap((o,l)=>{const u=[],c=a[t.length-1];return l===0&&u.push(["M",...c[1].p]),o[0].concave?s.push(o[0].p,o[1].p):u.push(["A",...n,...o[0].p]),o[1].concave?s.unshift(o[1].p):u.push(["L",...o[1].p]),s.length===3&&(u.pop(),u.push(["C",...s.flat()]),s=[]),u})},z7=(r,e)=>{const t=W1(r).map((n,i)=>{const a=r[(i+1)%r.length];return{p:n,v:Ci(ut(a,n))}});return t.forEach((n,i)=>{const a=i>0?i-1:r.length-1,s=t[a].v,o=Ci($e(s,Qi(n.v,$1(s,n.v,!0)<Math.PI?1:-1)));n.p=$e(n.p,Qi(o,e))}),wP(t.map(n=>n.p))},j7=(r,e)=>{const n=r.map((a,s)=>{const o=r[s===0?r.length-1:s-1],l=Wo(Qi(Ci(Dc(ut(o,a),!1)),e));return[$e(o,l),$e(a,l)]}).flat();return n.map((a,s)=>{if(s%2===0)return null;const o=[n[(s-1)%n.length],n[s%n.length]],l=[n[(s+1)%n.length],n[(s+2)%n.length]];return G1(o,l,!0)}).filter(Boolean).map((a,s)=>[s===0?"M":"L",a[0],a[1]]).concat([["Z"]])};var q7=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class qh extends Tn{constructor(e,t){super(e,Object.assign({},qh.defaultOptions,t)),this.hullMemberIds=[],this.drawHull=()=>{if(!this.shape)this.shape=new fl({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);else{const n=!zt(this.optionsCache,this.options);this.shape.update(this.getHullStyle(n))}this.optionsCache=Object.assign({},this.options)},this.updateHullPath=n=>{this.shape&&this.options.members.includes(J(n.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=(n=!1)=>{const{graph:i}=this.context,a=this.getMember();if(a.length===0)return"";const s=a.map(u=>i.getNodeData(u)),o=I7(s.map(un),this.options.concavity).slice(1).reverse(),l=o.flatMap(u=>s.filter(c=>zt(un(c),u)).map(J));return zt(l,this.hullMemberIds)&&!n?this.path:(this.hullMemberIds=l,this.path=D7(o,this.getPadding(),this.options.corner),this.path)},this.bindEvents()}bindEvents(){this.context.graph.on(ye.AFTER_RENDER,this.drawHull),this.context.graph.on(ye.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(e){const t=this.options,{members:n,padding:i,corner:a}=t,s=q7(t,["members","padding","corner"]);return Object.assign(Object.assign({},s),{d:this.getHullPath(e)})}getPadding(){const{graph:e}=this.context;return this.hullMemberIds.reduce((n,i)=>{const{halfExtents:a}=e.getElementRenderBounds(i),s=Math.max(a[0],a[1]);return Math.max(n,s)},0)+this.options.padding}addMember(e){const t=Array.isArray(e)?e:[e];this.options.members=[...new Set([...this.options.members,...t])],this.shape.update({d:this.getHullPath()})}removeMember(e){const t=Array.isArray(e)?e:[e];this.options.members=this.options.members.filter(n=>!t.includes(n)),t.some(n=>this.hullMemberIds.includes(n))&&this.shape.update({d:this.getHullPath()})}updateMember(e){this.options.members=Te(e)?e(this.options.members):e,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.context.graph.off(ye.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}}qh.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};function zN(r,e){e(r),r.children&&r.children.forEach(function(t){t&&zN(t,e)})}function Sl(r){$h(r,!0)}function jr(r){$h(r,!1)}function $h(r,e){var t=e?"visible":"hidden";zN(r,function(n){n.attr("visibility",t)})}var $7=function(r){Xe(e,r);function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=r.apply(this,Ee([],q(t),!1))||this;return i.isMutationObserved=!0,i.addEventListener(Ke.INSERTED,function(){jr(i)}),i}return e}(hn);function jN(r){var e=r.appendChild(new $7({class:"offscreen"}));return jr(e),e}function G7(r){for(var e=r;e;){if(e.className==="offscreen")return!0;e=e.parent}return!1}var kb=function(r){Xe(e,r);function e(t){t===void 0&&(t={});var n=t.style,i=$t(t,["style"]);return r.call(this,ce({style:ce({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},n)},i))||this}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=jN(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var t;(t=this._offscreen)===null||t===void 0||t.destroy()},e}(ts);function qs(r){return r*Math.PI/180}function qN(r){return Number((r*180/Math.PI).toPrecision(5))}var qn=function(){function r(e,t,n,i){e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=e,this.y=t,this.width=n,this.height=i}return Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),r.fromRect=function(e){return new r(e.x,e.y,e.width,e.height)},r.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},r.prototype.isPointIn=function(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom},r}();function Tr(r,e){return Te(r)?r.apply(void 0,Ee([],q(e),!1)):r}var Hr=function(r,e){var t=function(i){return"".concat(e,"-").concat(i)},n=Object.fromEntries(Object.entries(r).map(function(i){var a=q(i,2),s=a[0],o=a[1],l=t(o);return[s,{name:l,class:".".concat(l),id:"#".concat(l),toString:function(){return l}}]}));return Object.assign(n,{prefix:t}),n},W7=5,$N=function(r,e,t,n){t===void 0&&(t=0),n===void 0&&(n=W7),Object.entries(e).forEach(function(i){var a=q(i,2),s=a[0],o=a[1],l=r;Object.prototype.hasOwnProperty.call(e,s)&&(o?Ds(o)?(Ds(r[s])||(l[s]={}),t<n?$N(r[s],o,t+1,n):l[s]=e[s]):pr(o)?(l[s]=[],l[s]=l[s].concat(o)):l[s]=o:l[s]=o)})},yn=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n+=1)$N(r,e[n]);return r},GN=function(r){return r!==void 0&&r!=null&&!Number.isNaN(r)},ku,V7=hm(function(r,e){var t=e.fontSize,n=e.fontFamily,i=e.fontWeight,a=e.fontStyle,s=e.fontVariant;return ku||(ku=ge.offscreenCanvasCreator.getOrCreateContext(void 0)),ku.font=[a,s,i,"".concat(t,"px"),n].join(" "),ku.measureText(r).width},function(r,e){return[r,Object.values(e||WN(r)).join()].join("")},4096),WN=function(r){var e=r.style.fontFamily||"sans-serif",t=r.style.fontWeight||"normal",n=r.style.fontStyle||"normal",i=r.style.fontVariant,a=r.style.fontSize;return a=typeof a=="object"?a.value:a,{fontSize:a,fontFamily:e,fontWeight:t,fontStyle:n,fontVariant:i}};function VN(r){return r.nodeName==="text"?r:r.nodeName==="g"&&r.children.length===1&&r.children[0].nodeName==="text"?r.children[0]:null}function UN(r,e){var t=VN(r);t&&t.attr(e)}function n1(r,e,t){t===void 0&&(t="..."),UN(r,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:t})}function U7(r,e,t,n){t===void 0&&(t=2),n===void 0&&(n="top"),UN(r,{wordWrap:!0,wordWrapWidth:e,maxLines:t,textBaseline:n})}function tk(r){var e=r.canvas,t=r.touches,n=r.offsetX,i=r.offsetY;if(e){var a=e.x,s=e.y;return[a,s]}if(t){var o=t[0],l=o.clientX,u=o.clientY;return[l,u]}return n&&i?[n,i]:[0,0]}function Ii(r){return typeof r=="function"?r():rt(r)||_e(r)?new kb({style:{text:String(r)}}):r}function H7(r,e){return r.reduce(function(t,n){return(t[n[e]]=t[n[e]]||[]).push(n),t},{})}function fr(r,e,t,n,i){return n===void 0&&(n=!0),i===void 0&&(i=function(a){a.node().removeChildren()}),r?t(e):(n&&i(e),null)}function xn(r,e,t,n,i){return n===void 0&&(n=!0),i===void 0&&(i=!1),n&&r===e||i&&r===t?!0:r>e&&r<t}var Y7=function(r,e){return function(t){return r*(1-t)+e*t}};function X7(r,e){var t=e?e.length:0,n=r?Math.min(t,r.length):0;return function(i){var a=new Array(n),s=new Array(t),o=0;for(o=0;o<n;++o)a[o]=Tb(r[o],e[o]);for(;o<t;++o)s[o]=e[o];for(o=0;o<n;++o)s[o]=a[o](i);return s}}function K7(r,e){r===void 0&&(r={}),e===void 0&&(e={});var t={},n={};return Object.entries(e).forEach(function(i){var a=q(i,2),s=a[0],o=a[1];s in r?t[s]=Tb(r[s],o):n[s]=o}),function(i){return Object.entries(t).forEach(function(a){var s=q(a,2),o=s[0],l=s[1];return n[o]=l(i)}),n}}function Tb(r,e){return typeof r=="number"&&typeof e=="number"?Y7(r,e):Array.isArray(r)&&Array.isArray(e)?X7(r,e):typeof r=="object"&&typeof e=="object"?K7(r,e):function(t){return r}}function Z7(r,e,t,n){if(!n)return r.attr("__keyframe_data__",t),null;var i=n.duration,a=i===void 0?0:i,s=Tb(e,t),o=Math.ceil(+a/16),l=new Array(o).fill(0).map(function(u,c,h){return{__keyframe_data__:s(c/(h.length-1))}});return r.animate(l,ce({fill:"both"},n))}function ki(r,e){return[r[0]*e,r[1]*e]}function Oo(r,e){return[r[0]+e[0],r[1]+e[1]]}function $y(r,e){return[r[0]-e[0],r[1]-e[1]]}function Ma(r,e){return[Math.min(r[0],e[0]),Math.min(r[1],e[1])]}function Oa(r,e){return[Math.max(r[0],e[0]),Math.max(r[1],e[1])]}function Zo(r,e){return Math.sqrt(Math.pow(r[0]-e[0],2)+Math.pow(r[1]-e[1],2))}function HN(r){if(r[0]===0&&r[1]===0)return[0,0];var e=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2));return[r[0]/e,r[1]/e]}function J7(r,e){return e?[r[1],-r[0]]:[-r[1],r[0]]}function nk(r,e){return+r.toPrecision(e)}function rk(r,e){var t={},n=Array.isArray(e)?e:[e];for(var i in r)n.includes(i)||(t[i]=r[i]);return t}function Q7(r,e,t,n){var i,a=[],s=!!n,o,l,u=[1/0,1/0],c=[-1/0,-1/0],h,d,f;if(s){i=q(n,2),u=i[0],c=i[1];for(var g=0,v=r.length;g<v;g+=1){var p=r[g];u=Ma(u,p),c=Oa(c,p)}}for(var g=0,y=r.length;g<y;g+=1){var p=r[g];if(g===0)f=p;else if(g===y-1)d=p,a.push(f),a.push(d);else{var m=[g?g-1:y-1,g-1][1];o=r[m],l=r[g+1];var w=[0,0];w=$y(l,o),w=ki(w,e);var S=Zo(p,o),_=Zo(p,l),O=S+_;O!==0&&(S/=O,_/=O);var T=ki(w,-S),k=ki(w,_);d=Oo(p,T),h=Oo(p,k),h=Ma(h,Oa(l,p)),h=Oa(h,Ma(l,p)),T=$y(h,p),T=ki(T,-S/_),d=Oo(p,T),d=Ma(d,Oa(o,p)),d=Oa(d,Ma(o,p)),k=$y(p,d),k=ki(k,_/S),h=Oo(p,k),s&&(d=Oa(d,u),d=Ma(d,c),h=Oa(h,u),h=Ma(h,c)),a.push(f),a.push(d),f=h}}return a}function eU(r,e,t){t===void 0&&(t=[[0,0],[1,1]]);for(var n=!1,i=[],a=0,s=r.length;a<s;a+=2)i.push([r[a],r[a+1]]);for(var o=Q7(i,.4,n,t),l=i.length,u=[],c,h,d,a=0;a<l-1;a+=1)c=o[a*2],h=o[a*2+1],d=i[a+1],u.push(["C",c[0],c[1],h[0],h[1],d[0],d[1]]);return u}var tU=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function nU(r){return tU.includes(r)}function ik(r){var e={};for(var t in r)nU(t)&&(e[t]=r[t]);return e}function rU(r,e){if(r.length<=e)return r;for(var t=Math.floor(r.length/e),n=[],i=0;i<r.length;i+=t)n.push(r[i]);return n}function Ab(r,e,t){var n=r.getBBox(),i=n.width,a=n.height,s=e/Math.max(i,a);return r.style.transform="scale(".concat(s,")"),s}function iU(r,e){var t=new Map;return r.forEach(function(n){var i=e(n);t.has(i)||t.set(i,[]),t.get(i).push(n)}),t}function aU(r){throw new Error(r)}var sU=function(){function r(i,a,s,o,l,u,c){i===void 0&&(i=null),a===void 0&&(a=null),s===void 0&&(s=null),o===void 0&&(o=null),l===void 0&&(l=[null,null,null,null,null]),u===void 0&&(u=[]),c===void 0&&(c=[]),e.add(this),this._elements=Array.from(i),this._data=a,this._parent=s,this._document=o,this._enter=l[0],this._update=l[1],this._exit=l[2],this._merge=l[3],this._split=l[4],this._transitions=u,this._facetElements=c}r.prototype.selectAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new t(a,null,this._elements[0],this._document)},r.prototype.selectFacetAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new t(this._elements,null,this._parent,this._document,void 0,void 0,a)},r.prototype.select=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i)[0]||null:i;return new t([a],null,a,this._document)},r.prototype.append=function(i){var a=this,s=typeof i=="function"?i:function(){return a.createElement(i)},o=[];if(this._data!==null){for(var l=0;l<this._data.length;l++){var u=this._data[l],c=q(Array.isArray(u)?u:[u,null],2),h=c[0],d=c[1],f=s(h,l);f.__data__=h,d!==null&&(f.__fromElements__=d),this._parent.appendChild(f),o.push(f)}return new t(o,null,this._parent,this._document)}for(var l=0;l<this._elements.length;l++){var g=this._elements[l],h=g.__data__,f=s(h,l);g.appendChild(f),o.push(f)}return new t(o,null,o[0],this._document)},r.prototype.maybeAppend=function(i,a){var s=xd(this,e,"m",n).call(this,i[0]==="#"?i:"#".concat(i),a);return s.attr("id",i),s},r.prototype.maybeAppendByClassName=function(i,a){var s=i.toString(),o=xd(this,e,"m",n).call(this,s[0]==="."?s:".".concat(s),a);return o.attr("className",s),o},r.prototype.maybeAppendByName=function(i,a){var s=xd(this,e,"m",n).call(this,'[name="'.concat(i,'"]'),a);return s.attr("name",i),s},r.prototype.data=function(i,a,s){var o,l;a===void 0&&(a=function(C){return C}),s===void 0&&(s=function(){return null});for(var u=[],c=[],h=new Set(this._elements),d=[],f=new Set,g=new Map(this._elements.map(function(C,N){return[a(C.__data__,N),C]})),v=new Map(this._facetElements.map(function(C,N){return[a(C.__data__,N),C]})),p=iU(this._elements,function(C){return s(C.__data__)}),y=0;y<i.length;y++){var m=i[y],w=a(m,y),S=s(m,y);if(g.has(w)){var _=g.get(w);_.__data__=m,_.__facet__=!1,c.push(_),h.delete(_),g.delete(w)}else if(v.has(w)){var _=v.get(w);_.__data__=m,_.__facet__=!0,c.push(_),v.delete(w)}else if(p.has(w)){var O=p.get(w);d.push([m,O]);try{for(var T=(o=void 0,il(O)),k=T.next();!k.done;k=T.next()){var _=k.value;h.delete(_)}}catch(C){o={error:C}}finally{try{k&&!k.done&&(l=T.return)&&l.call(T)}finally{if(o)throw o.error}}p.delete(w)}else if(g.has(S)){var _=g.get(S);_.__toData__?_.__toData__.push(m):_.__toData__=[m],f.add(_),h.delete(_)}else u.push(m)}var P=[new t([],u,this._parent,this._document),new t(c,null,this._parent,this._document),new t(h,null,this._parent,this._document),new t([],d,this._parent,this._document),new t(f,null,this._parent,this._document)];return new t(this._elements,null,this._parent,this._document,P)},r.prototype.merge=function(i){var a=Ee(Ee([],q(this._elements),!1),q(i._elements),!1),s=Ee(Ee([],q(this._transitions),!1),q(i._transitions),!1);return new t(a,null,this._parent,this._document,void 0,s)},r.prototype.createElement=function(i){if(this._document)return this._document.createElement(i,{});var a=t.registry[i];return a?new a:aU("Unknown node type: ".concat(i))},r.prototype.join=function(i,a,s,o,l){i===void 0&&(i=function(g){return g}),a===void 0&&(a=function(g){return g}),s===void 0&&(s=function(g){return g.remove()}),o===void 0&&(o=function(g){return g}),l===void 0&&(l=function(g){return g.remove()});var u=i(this._enter),c=a(this._update),h=s(this._exit),d=o(this._merge),f=l(this._split);return c.merge(u).merge(h).merge(d).merge(f)},r.prototype.remove=function(){for(var i=function(o){var l=a._elements[o],u=a._transitions[o];u?u.then(function(){return l.remove()}):l.remove()},a=this,s=0;s<this._elements.length;s++)i(s);return new t([],null,this._parent,this._document,void 0,this._transitions)},r.prototype.each=function(i){for(var a=0;a<this._elements.length;a++){var s=this._elements[a],o=s.__data__;i.call(s,o,a)}return this},r.prototype.attr=function(i,a){var s=typeof a!="function"?function(){return a}:a;return this.each(function(o,l){a!==void 0&&(this[i]=s.call(this,o,l))})},r.prototype.style=function(i,a,s){s===void 0&&(s=!0);var o=typeof a!="function"||!s?function(){return a}:a;return this.each(function(l,u){a!==void 0&&(this.style[i]=o.call(this,l,u))})},r.prototype.styles=function(i,a){return i===void 0&&(i={}),a===void 0&&(a=!0),this.each(function(s,o){var l=this;Object.entries(i).forEach(function(u){var c=q(u,2),h=c[0],d=c[1],f=typeof d!="function"||!a?function(){return d}:d;d!==void 0&&l.attr(h,f.call(l,s,o))})})},r.prototype.update=function(i,a){a===void 0&&(a=!0);var s=typeof i!="function"||!a?function(){return i}:i;return this.each(function(o,l){i&&this.update&&this.update(s.call(this,o,l))})},r.prototype.maybeUpdate=function(i,a){a===void 0&&(a=!0);var s=typeof i!="function"||!a?function(){return i}:i;return this.each(function(o,l){i&&this.update&&this.update(s.call(this,o,l))})},r.prototype.transition=function(i){var a=this._transitions;return this.each(function(s,o){a[o]=i.call(this,s,o)})},r.prototype.on=function(i,a){return this.each(function(){this.addEventListener(i,a)}),this},r.prototype.call=function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return i.call.apply(i,Ee([this._parent,this],q(a),!1)),this},r.prototype.node=function(){return this._elements[0]},r.prototype.nodes=function(){return this._elements},r.prototype.transitions=function(){return this._transitions.filter(function(i){return!!i})},r.prototype.parent=function(){return this._parent};var e,t,n;return t=r,e=new WeakSet,n=function(a,s){var o=this._elements[0],l=o.querySelector(a);if(l)return new t([l],null,this._parent,this._document);var u=typeof s=="string"?this.createElement(s):s();return o.appendChild(u),new t([u],null,this._parent,this._document)},r.registry={g:hn,rect:Mn,circle:Fi,path:ur,text:kb,ellipse:ol,image:ul,line:Ua,polygon:es,polyline:Rc,html:ll},r}();function Ae(r){return new sU([r],null,r,r.ownerDocument)}function oU(r,e,t){return r.querySelector(e)?Ae(r).select(e):Ae(r).append(t)}function On(r){if(_e(r))return[r,r,r,r];if(pr(r)){var e=r.length;if(e===1)return[r[0],r[0],r[0],r[0]];if(e===2)return[r[0],r[1],r[0],r[1]];if(e===3)return[r[0],r[1],r[2],r[1]];if(e===4)return r}return[0,0,0,0]}function ak(r){var e=r.getLocalBounds(),t=e.min,n=e.max,i=q([t,n],2),a=q(i[0],2),s=a[0],o=a[1],l=q(i[1],2),u=l[0],c=l[1];return{x:s,y:o,width:u-s,height:c-o,left:s,bottom:c,top:o,right:u}}function lU(r,e){var t=q(r,2),n=t[0],i=t[1],a=q(e,2),s=a[0],o=a[1];return n!==s&&i===o}function uU(r,e){var t,n,i=e.attributes;try{for(var a=il(Object.entries(i)),s=a.next();!s.done;s=a.next()){var o=q(s.value,2),l=o[0],u=o[1];l!=="id"&&l!=="className"&&r.attr(l,u)}}catch(c){t={error:c}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}function Pb(r){return r.toString().charAt(0).toUpperCase()+r.toString().slice(1)}function cU(r){return r.toString().charAt(0).toLowerCase()+r.toString().slice(1)}function hU(r,e){return"".concat(e).concat(Pb(r))}function sk(r,e,t){var n;t===void 0&&(t=!0);var i=e||((n=r.match(/^([a-z][a-z0-9]+)/))===null||n===void 0?void 0:n[0])||"",a=r.replace(new RegExp("^(".concat(i,")")),"");return t?cU(a):a}function dU(r,e){Object.entries(e).forEach(function(t){var n=q(t,2),i=n[0],a=n[1];Ee([r],q(r.querySelectorAll(i)),!1).filter(function(s){return s.matches(i)}).forEach(function(s){if(s){var o=s;o.style.cssText+=Object.entries(a).reduce(function(l,u){return"".concat(l).concat(u.join(":"),";")},"")}})})}var Tu=function(r,e){if(!(r!=null&&r.startsWith(e)))return!1;var t=r[e.length];return t>="A"&&t<="Z"};function ze(r,e,t){t===void 0&&(t=!1);var n={};return Object.entries(r).forEach(function(i){var a=q(i,2),s=a[0],o=a[1];if(!(s==="className"||s==="class")){if(Tu(s,"show")&&Tu(sk(s,"show"),e)!==t)s===hU(e,"show")?n[s]=o:n[s.replace(new RegExp(Pb(e)),"")]=o;else if(!Tu(s,"show")&&Tu(s,e)!==t){var l=sk(s,e);l==="filter"&&typeof o=="function"||(n[l]=o)}}}),n}function _s(r,e){return Object.entries(r).reduce(function(t,n){var i=q(n,2),a=i[0],s=i[1];return a.startsWith("show")?t["show".concat(e).concat(a.slice(4))]=s:t["".concat(e).concat(Pb(a))]=s,t},{})}function Di(r,e){e===void 0&&(e=["x","y","class","className"]);var t=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],n={},i={};return Object.entries(r).forEach(function(a){var s=q(a,2),o=s[0],l=s[1];e.includes(o)||(t.indexOf(o)!==-1?i[o]=l:n[o]=l)}),[n,i]}function Hn(r,e){var t={YYYY:r.getFullYear(),MM:r.getMonth()+1,DD:r.getDate(),HH:r.getHours(),mm:r.getMinutes(),ss:r.getSeconds()},n=e;return Object.keys(t).forEach(function(i){var a=t[i];n=n.replace(i,i==="YYYY"?"".concat(a):"".concat(a).padStart(2,"0"))}),n}function fU(r,e,t){var n=r.getBBox(),i=n.width,a=n.height,s=q([e,t].map(function(u,c){var h;return u.includes("%")?parseFloat(((h=u.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||h===void 0?void 0:h[0])||"0")/100*(c===0?i:a):u}),2),o=s[0],l=s[1];return[o,l]}function YN(r,e){if(e)try{var t=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,n=e.replace(t,function(i,a,s){return"translate(".concat(fU(r,a,s),")")});r.attr("transform",n)}catch{}}function gU(r){var e;return((e=r[0])===null||e===void 0?void 0:e.map(function(t,n){return r.map(function(i){return i[n]})}))||[]}var ok=function(r,e){if(e==null){r.innerHTML="";return}r.replaceChildren?Array.isArray(e)?r.replaceChildren.apply(r,Ee([],q(e),!1)):r.replaceChildren(e):(r.innerHTML="",Array.isArray(e)?e.forEach(function(t){return r.appendChild(t)}):r.appendChild(e))};function pU(){$h(this,this.attributes.visibility!=="hidden")}var Gt=function(r){Xe(e,r);function e(t,n){n===void 0&&(n={});var i=r.call(this,yn({},{style:n},t))||this;return i.initialized=!1,i._defaultOptions=n,i}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=jN(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var t;(t=this._offscreen)===null||t===void 0||t.destroy()},e.prototype.attributeChangedCallback=function(t){t==="visibility"&&pU.call(this)},e.prototype.update=function(t,n){var i;return this.attr(yn({},this.attributes,t||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,n)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(t,n){},e.prototype.getSubShapeStyle=function(t){t.x,t.y,t.transform,t.transformOrigin,t.class,t.className,t.zIndex;var n=$t(t,["x","y","transform","transformOrigin","class","className","zIndex"]);return n},e}(R1),XN=function(r,e,t){return[["M",r-t,e],["A",t,t,0,1,0,r+t,e],["A",t,t,0,1,0,r-t,e],["Z"]]},vU=XN,yU=function(r,e,t){return[["M",r-t,e-t],["L",r+t,e-t],["L",r+t,e+t],["L",r-t,e+t],["Z"]]},mU=function(r,e,t){return[["M",r-t,e],["L",r,e-t],["L",r+t,e],["L",r,e+t],["Z"]]},bU=function(r,e,t){var n=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e+n],["L",r,e-n],["L",r+t,e+n],["Z"]]},wU=function(r,e,t){var n=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e-n],["L",r+t,e-n],["L",r,e+n],["Z"]]},xU=function(r,e,t){var n=t/2*Math.sqrt(3);return[["M",r,e-t],["L",r+n,e-t/2],["L",r+n,e+t/2],["L",r,e+t],["L",r-n,e+t/2],["L",r-n,e-t/2],["Z"]]},EU=function(r,e,t){var n=t-1.5;return[["M",r-t,e-n],["L",r+t,e+n],["L",r+t,e-n],["L",r-t,e+n],["Z"]]},KN=function(r,e,t){return[["M",r,e+t],["L",r,e-t]]},SU=function(r,e,t){return[["M",r-t,e-t],["L",r+t,e+t],["M",r+t,e-t],["L",r-t,e+t]]},_U=function(r,e,t){return[["M",r-t/2,e-t],["L",r+t/2,e-t],["M",r,e-t],["L",r,e+t],["M",r-t/2,e+t],["L",r+t/2,e+t]]},MU=function(r,e,t){return[["M",r-t,e],["L",r+t,e],["M",r,e-t],["L",r,e+t]]},OU=function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},ZN=function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},kU=ZN,TU=function(r,e,t){return[["M",r-t,e],["A",t/2,t/2,0,1,1,r,e],["A",t/2,t/2,0,1,0,r+t,e]]},AU=function(r,e,t){return[["M",r-t-1,e-2.5],["L",r,e-2.5],["L",r,e+2.5],["L",r+t+1,e+2.5]]},PU=function(r,e,t){return[["M",r-t-1,e+2.5],["L",r,e+2.5],["L",r,e-2.5],["L",r+t+1,e-2.5]]},CU=function(r,e,t){return[["M",r-(t+1),e+2.5],["L",r-t/2,e+2.5],["L",r-t/2,e-2.5],["L",r+t/2,e-2.5],["L",r+t/2,e+2.5],["L",r+t+1,e+2.5]]};function NU(r,e){return[["M",r-5,e+2.5],["L",r-5,e],["L",r,e],["L",r,e-3],["L",r,e+3],["L",r+6.5,e+3]]}var RU=function(r,e,t){return[["M",r-t,e-t],["L",r+t,e],["L",r-t,e+t],["Z"]]};function LU(r){var e="default";if(Yt(r)&&r instanceof Image)e="image";else if(Te(r))e="symbol";else if(rt(r)){var t=new RegExp("data:(image|text)");r.match(t)?e="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(r)?e="url":e="symbol"}return e}function IU(r){var e=LU(r);return["base64","url","image"].includes(e)?"image":r&&e==="symbol"?"path":null}var ht=function(r){Xe(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.render=function(t,n){var i=t.x,a=i===void 0?0:i,s=t.y,o=s===void 0?0:s,l=this.getSubShapeStyle(t),u=l.symbol,c=l.size,h=c===void 0?16:c,d=$t(l,["symbol","size"]),f=IU(u);fr(!!f,Ae(n),function(g){g.maybeAppendByClassName("marker",f).attr("className","marker ".concat(f,"-marker")).call(function(v){if(f==="image"){var p=h*2;v.styles({img:u,width:p,height:p,x:a-h,y:o-h})}else{var p=h/2,y=Te(u)?u:e.getSymbol(u);v.styles(ce({d:y==null?void 0:y(a,o,p)},d))}})})},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(t,n){e.MARKER_SYMBOL_MAP.set(t,n)},e.getSymbol=function(t){return e.MARKER_SYMBOL_MAP.get(t)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}(Gt);ht.registerSymbol("cross",SU);ht.registerSymbol("hyphen",OU);ht.registerSymbol("line",KN);ht.registerSymbol("plus",MU);ht.registerSymbol("tick",_U);ht.registerSymbol("circle",XN);ht.registerSymbol("point",vU);ht.registerSymbol("bowtie",EU);ht.registerSymbol("hexagon",xU);ht.registerSymbol("square",yU);ht.registerSymbol("diamond",mU);ht.registerSymbol("triangle",bU);ht.registerSymbol("triangle-down",wU);ht.registerSymbol("line",KN);ht.registerSymbol("dot",ZN);ht.registerSymbol("dash",kU);ht.registerSymbol("smooth",TU);ht.registerSymbol("hv",AU);ht.registerSymbol("vh",PU);ht.registerSymbol("hvh",CU);ht.registerSymbol("vhv",NU);function _c(r,...e){return e.reduce((t,n)=>i=>t(n(i)),r)}function r1(r,e){return e-r?t=>(t-r)/(e-r):t=>.5}function DU(r,e){const t=e<r?e:r,n=r>e?r:e;return i=>Math.min(Math.max(t,i),n)}function FU(r,e,t,n,i){let a=t,s=n||r.length;const o=l=>l;for(;a<s;){const l=Math.floor((a+s)/2);o(r[l])>e?s=l:a=l+1}return a}const lk=Math.sqrt(50),uk=Math.sqrt(10),ck=Math.sqrt(2);function zu(r,e,t){const n=(e-r)/Math.max(0,t),i=Math.floor(Math.log(n)/Math.LN10),a=n/10**i;return i>=0?(a>=lk?10:a>=uk?5:a>=ck?2:1)*10**i:-(10**-i)/(a>=lk?10:a>=uk?5:a>=ck?2:1)}const BU=(r,e,t=5)=>{const n=[r,e];let i=0,a=n.length-1,s=n[i],o=n[a],l;return o<s&&([s,o]=[o,s],[i,a]=[a,i]),l=zu(s,o,t),l>0?(s=Math.floor(s/l)*l,o=Math.ceil(o/l)*l,l=zu(s,o,t)):l<0&&(s=Math.ceil(s*l)/l,o=Math.floor(o*l)/l,l=zu(s,o,t)),l>0?(n[i]=Math.floor(s/l)*l,n[a]=Math.ceil(o/l)*l):l<0&&(n[i]=Math.ceil(s*l)/l,n[a]=Math.floor(o*l)/l),n};function hk(r){return!Be(r)&&!b3(r)&&!Number.isNaN(r)}var Gy={exports:{}},Wy,dk;function zU(){return dk||(dk=1,Wy={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),Wy}var Vy={exports:{}},Uy,fk;function jU(){return fk||(fk=1,Uy=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")}),Uy}var gk;function qU(){if(gk)return Vy.exports;gk=1;var r=jU(),e=Array.prototype.concat,t=Array.prototype.slice,n=Vy.exports=function(a){for(var s=[],o=0,l=a.length;o<l;o++){var u=a[o];r(u)?s=e.call(s,t.call(u)):s.push(u)}return s};return n.wrap=function(i){return function(){return i(n(arguments))}},Vy.exports}var pk;function $U(){if(pk)return Gy.exports;pk=1;var r=zU(),e=qU(),t=Object.hasOwnProperty,n=Object.create(null);for(var i in r)t.call(r,i)&&(n[r[i]]=i);var a=Gy.exports={to:{},get:{}};a.get=function(l){var u=l.substring(0,3).toLowerCase(),c,h;switch(u){case"hsl":c=a.get.hsl(l),h="hsl";break;case"hwb":c=a.get.hwb(l),h="hwb";break;default:c=a.get.rgb(l),h="rgb";break}return c?{model:h,value:c}:null},a.get.rgb=function(l){if(!l)return null;var u=/^#([a-f0-9]{3,4})$/i,c=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,h=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,d=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,f=/^(\w+)$/,g=[0,0,0,1],v,p,y;if(v=l.match(c)){for(y=v[2],v=v[1],p=0;p<3;p++){var m=p*2;g[p]=parseInt(v.slice(m,m+2),16)}y&&(g[3]=parseInt(y,16)/255)}else if(v=l.match(u)){for(v=v[1],y=v[3],p=0;p<3;p++)g[p]=parseInt(v[p]+v[p],16);y&&(g[3]=parseInt(y+y,16)/255)}else if(v=l.match(h)){for(p=0;p<3;p++)g[p]=parseInt(v[p+1],0);v[4]&&(v[5]?g[3]=parseFloat(v[4])*.01:g[3]=parseFloat(v[4]))}else if(v=l.match(d)){for(p=0;p<3;p++)g[p]=Math.round(parseFloat(v[p+1])*2.55);v[4]&&(v[5]?g[3]=parseFloat(v[4])*.01:g[3]=parseFloat(v[4]))}else return(v=l.match(f))?v[1]==="transparent"?[0,0,0,0]:t.call(r,v[1])?(g=r[v[1]],g[3]=1,g):null:null;for(p=0;p<3;p++)g[p]=s(g[p],0,255);return g[3]=s(g[3],0,1),g},a.get.hsl=function(l){if(!l)return null;var u=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,c=l.match(u);if(c){var h=parseFloat(c[4]),d=(parseFloat(c[1])%360+360)%360,f=s(parseFloat(c[2]),0,100),g=s(parseFloat(c[3]),0,100),v=s(isNaN(h)?1:h,0,1);return[d,f,g,v]}return null},a.get.hwb=function(l){if(!l)return null;var u=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,c=l.match(u);if(c){var h=parseFloat(c[4]),d=(parseFloat(c[1])%360+360)%360,f=s(parseFloat(c[2]),0,100),g=s(parseFloat(c[3]),0,100),v=s(isNaN(h)?1:h,0,1);return[d,f,g,v]}return null},a.to.hex=function(){var l=e(arguments);return"#"+o(l[0])+o(l[1])+o(l[2])+(l[3]<1?o(Math.round(l[3]*255)):"")},a.to.rgb=function(){var l=e(arguments);return l.length<4||l[3]===1?"rgb("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+")":"rgba("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+", "+l[3]+")"},a.to.rgb.percent=function(){var l=e(arguments),u=Math.round(l[0]/255*100),c=Math.round(l[1]/255*100),h=Math.round(l[2]/255*100);return l.length<4||l[3]===1?"rgb("+u+"%, "+c+"%, "+h+"%)":"rgba("+u+"%, "+c+"%, "+h+"%, "+l[3]+")"},a.to.hsl=function(){var l=e(arguments);return l.length<4||l[3]===1?"hsl("+l[0]+", "+l[1]+"%, "+l[2]+"%)":"hsla("+l[0]+", "+l[1]+"%, "+l[2]+"%, "+l[3]+")"},a.to.hwb=function(){var l=e(arguments),u="";return l.length>=4&&l[3]!==1&&(u=", "+l[3]),"hwb("+l[0]+", "+l[1]+"%, "+l[2]+"%"+u+")"},a.to.keyword=function(l){return n[l.slice(0,3)]};function s(l,u,c){return Math.min(Math.max(u,l),c)}function o(l){var u=Math.round(l).toString(16).toUpperCase();return u.length<2?"0"+u:u}return Gy.exports}var GU=$U();const WU=nl(GU);function Hy(r,e,t){let n=t;return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(e-r)*6*n:n<1/2?e:n<2/3?r+(e-r)*(2/3-n)*6:r}function VU(r){const e=r[0]/360,t=r[1]/100,n=r[2]/100,i=r[3];if(t===0)return[n*255,n*255,n*255,i];const a=n<.5?n*(1+t):n+t-n*t,s=2*n-a,o=Hy(s,a,e+1/3),l=Hy(s,a,e),u=Hy(s,a,e-1/3);return[o*255,l*255,u*255,i]}function vk(r){const e=WU.get(r);if(!e)return null;const{model:t,value:n}=e;return t==="rgb"?n:t==="hsl"?VU(n):null}const Mc=(r,e)=>t=>r*(1-t)+e*t,UU=(r,e)=>{const t=vk(r),n=vk(e);return t===null||n===null?t?()=>r:()=>e:i=>{const a=new Array(4);for(let c=0;c<4;c+=1){const h=t[c],d=n[c];a[c]=h*(1-i)+d*i}const[s,o,l,u]=a;return`rgba(${Math.round(s)}, ${Math.round(o)}, ${Math.round(l)}, ${u})`}},HU=(r,e)=>typeof r=="number"&&typeof e=="number"?Mc(r,e):typeof r=="string"&&typeof e=="string"?UU(r,e):()=>r,YU=(r,e)=>{const t=Mc(r,e);return n=>Math.round(t(n))};function yk({map:r,initKey:e},t){const n=e(t);return r.has(n)?r.get(n):t}function XU({map:r,initKey:e},t){const n=e(t);return r.has(n)?r.get(n):(r.set(n,t),t)}function KU({map:r,initKey:e},t){const n=e(t);return r.has(n)&&(t=r.get(n),r.delete(n)),t}function ZU(r){return typeof r=="object"?r.valueOf():r}class mk extends Map{constructor(e){if(super(),this.map=new Map,this.initKey=ZU,e!==null)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(yk({map:this.map,initKey:this.initKey},e))}has(e){return super.has(yk({map:this.map,initKey:this.initKey},e))}set(e,t){return super.set(XU({map:this.map,initKey:this.initKey},e),t)}delete(e){return super.delete(KU({map:this.map,initKey:this.initKey},e))}}class JN{constructor(e){this.options=$n({},this.getDefaultOptions()),this.update(e)}getOptions(){return this.options}update(e={}){this.options=$n({},this.options,e),this.rescale(e)}rescale(e){}}const Cb=Symbol("defaultUnknown");function bk(r,e,t){for(let n=0;n<e.length;n+=1)r.has(e[n])||r.set(t(e[n]),n)}function wk(r){const{value:e,from:t,to:n,mapper:i,notFoundReturn:a}=r;let s=i.get(e);if(s===void 0){if(a!==Cb)return a;s=t.push(e)-1,i.set(e,s)}return n[s%n.length]}function xk(r){return r instanceof Date?e=>`${e}`:typeof r=="object"?e=>JSON.stringify(e):e=>e}class Nb extends JN{getDefaultOptions(){return{domain:[],range:[],unknown:Cb}}constructor(e){super(e)}map(e){return this.domainIndexMap.size===0&&bk(this.domainIndexMap,this.getDomain(),this.domainKey),wk({value:this.domainKey(e),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(e){return this.rangeIndexMap.size===0&&bk(this.rangeIndexMap,this.getRange(),this.rangeKey),wk({value:this.rangeKey(e),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(e){const[t]=this.options.domain,[n]=this.options.range;if(this.domainKey=xk(t),this.rangeKey=xk(n),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!e||e.range)&&this.rangeIndexMap.clear(),(!e||e.domain||e.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new Nb(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:e,compare:t}=this.options;return this.sortedDomain=t?[...e].sort(t):e,this.sortedDomain}}function JU(r){const e=Math.min(...r);return r.map(t=>t/e)}function QU(r,e){const t=r.length,n=e-t;return n>0?[...r,...new Array(n).fill(1)]:n<0?r.slice(0,e):r}function eH(r){return Math.round(r*1e12)/1e12}function tH(r){const{domain:e,range:t,paddingOuter:n,paddingInner:i,flex:a,round:s,align:o}=r,l=e.length,u=QU(a,l),[c,h]=t,d=h-c,f=2/l*n+1-1/l*i,g=d/f,v=g*i/l,p=g-l*v,y=JU(u),m=y.reduce((L,F)=>L+F),w=p/m,S=new mk(e.map((L,F)=>{const G=y[F]*w;return[L,s?Math.floor(G):G]})),_=new mk(e.map((L,F)=>{const V=y[F]*w+v;return[L,s?Math.floor(V):V]})),O=Array.from(_.values()).reduce((L,F)=>L+F),k=(d-(O-O/l*i))*o,P=c+k;let C=s?Math.round(P):P;const N=new Array(l);for(let L=0;L<l;L+=1){N[L]=eH(C);const F=e[L];C+=_.get(F)}return{valueBandWidth:S,valueStep:_,adjustedRange:N}}function nH(r){var e;const{domain:t}=r,n=t.length;if(n===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((e=r.flex)===null||e===void 0)&&e.length))return tH(r);const{range:a,paddingOuter:s,paddingInner:o,round:l,align:u}=r;let c,h,d=a[0];const g=a[1]-d,v=s*2,p=n-o;c=g/Math.max(1,v+p),l&&(c=Math.floor(c)),d+=(g-c*(n-o))*u,h=c*(1-o),l&&(d=Math.round(d),h=Math.round(h));const y=new Array(n).fill(0).map((m,w)=>d+w*c);return{valueStep:c,valueBandWidth:h,adjustedRange:y}}class Rb extends Nb{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:Cb,flex:[]}}constructor(e){super(e)}clone(){return new Rb(this.options)}getStep(e){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:e===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(e)}getBandWidth(e){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:e===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(e)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:e,paddingInner:t}=this.options;return e>0?e:t}getPaddingOuter(){const{padding:e,paddingOuter:t}=this.options;return e>0?e:t}rescale(){super.rescale();const{align:e,domain:t,range:n,round:i,flex:a}=this.options,{adjustedRange:s,valueBandWidth:o,valueStep:l}=nH({align:e,range:n,round:i,flex:a,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:t});this.valueStep=l,this.valueBandWidth=o,this.adjustedRange=s}}const rH=(r,e,t)=>{let n,i,a=r,s=e;if(a===s&&t>0)return[a];let o=zu(a,s,t);if(o===0||!Number.isFinite(o))return[];if(o>0){a=Math.ceil(a/o),s=Math.floor(s/o),i=new Array(n=Math.ceil(s-a+1));for(let l=0;l<n;l+=1)i[l]=(a+l)*o}else{o=-o,a=Math.ceil(a*o),s=Math.floor(s*o),i=new Array(n=Math.ceil(s-a+1));for(let l=0;l<n;l+=1)i[l]=(a+l)/o}return i},iH=(r,e,t)=>{const[n,i]=r,[a,s]=e;let o,l;return n<i?(o=r1(n,i),l=t(a,s)):(o=r1(i,n),l=t(s,a)),_c(l,o)},aH=(r,e,t)=>{const n=Math.min(r.length,e.length)-1,i=new Array(n),a=new Array(n),s=r[0]>r[n],o=s?[...r].reverse():r,l=s?[...e].reverse():e;for(let u=0;u<n;u+=1)i[u]=r1(o[u],o[u+1]),a[u]=t(l[u],l[u+1]);return u=>{const c=FU(r,u,1,n)-1,h=i[c],d=a[c];return _c(d,h)(u)}},Ek=(r,e,t,n)=>(Math.min(r.length,e.length)>2?aH:iH)(r,e,n?YU:t);class sH extends JN{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:Mc,tickCount:5}}map(e){return hk(e)?this.output(e):this.options.unknown}invert(e){return hk(e)?this.input(e):this.options.unknown}nice(){if(!this.options.nice)return;const[e,t,n,...i]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(e,t,n,...i)}getTicks(){const{tickMethod:e}=this.options,[t,n,i,...a]=this.getTickMethodOptions();return e(t,n,i,...a)}getTickMethodOptions(){const{domain:e,tickCount:t}=this.options,n=e[0],i=e[e.length-1];return[n,i,t]}chooseNice(){return BU}rescale(){this.nice();const[e,t]=this.chooseTransforms();this.composeOutput(e,this.chooseClamp(e)),this.composeInput(e,t,this.chooseClamp(t))}chooseClamp(e){const{clamp:t,range:n}=this.options,i=this.options.domain.map(e),a=Math.min(i.length,n.length);return t?DU(i[0],i[a-1]):dm}composeOutput(e,t){const{domain:n,range:i,round:a,interpolate:s}=this.options,o=Ek(n.map(e),i,s,a);this.output=_c(o,t,e)}composeInput(e,t,n){const{domain:i,range:a}=this.options,s=Ek(a,i.map(e),Mc);this.input=_c(t,n,s)}}class Io extends sH{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:HU,tickMethod:rH,tickCount:5}}chooseTransforms(){return[dm,dm]}clone(){return new Io(this.options)}}var oH=function(r){Xe(e,r);function e(t){var n=this,i=t.style,a=$t(t,["style"]);return n=r.call(this,$n({},{type:"column"},ce({style:i},a)))||this,n.columnsGroup=new hn({name:"columns"}),n.appendChild(n.columnsGroup),n.render(),n}return e.prototype.render=function(){var t=this.attributes,n=t.columns,i=t.x,a=t.y;this.columnsGroup.style.transform="translate(".concat(i,", ").concat(a,")"),Ae(this.columnsGroup).selectAll(".column").data(n.flat()).join(function(s){return s.append("rect").attr("className","column").each(function(o){this.attr(o)})},function(s){return s.each(function(o){this.attr(o)})},function(s){return s.remove()})},e.prototype.update=function(t){this.attr(yn({},this.attributes,t)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(wt),lH=function(r){Xe(e,r);function e(t){var n=this,i=t.style,a=$t(t,["style"]);return n=r.call(this,$n({},{type:"lines"},ce({style:i},a)))||this,n.linesGroup=n.appendChild(new hn),n.areasGroup=n.appendChild(new hn),n.render(),n}return e.prototype.render=function(){var t=this.attributes,n=t.lines,i=t.areas,a=t.x,s=t.y;this.style.transform="translate(".concat(a,", ").concat(s,")"),n&&this.renderLines(n),i&&this.renderAreas(i)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(t){this.attr(yn({},this.attributes,t)),this.render()},e.prototype.renderLines=function(t){Ae(this.linesGroup).selectAll(".line").data(t).join(function(n){return n.append("path").attr("className","line").each(function(i){this.attr(i)})},function(n){return n.each(function(i){this.attr(i)})},function(n){return n.remove()})},e.prototype.renderAreas=function(t){Ae(this.linesGroup).selectAll(".area").data(t).join(function(n){return n.append("path").attr("className","area").each(function(i){this.attr(i)})},function(n){return n.each(function(i){this.style(i)})},function(n){return n.remove()})},e}(wt);function uH(r,e){var t,n=e.x,i=e.y,a=q(i.getOptions().range||[0,0],2),s=a[0],o=a[1];return o>s&&(t=q([s,o],2),o=t[0],s=t[1]),r.map(function(l){var u=l.map(function(c,h){return[n.map(h),Bt(i.map(c),o,s)]});return u})}function Jo(r,e){e===void 0&&(e=!1);var t=e?r.length-1:0,n=r.map(function(i,a){return Ee([a===t?"M":"L"],q(i),!1)});return e?n.reverse():n}function Oc(r,e){if(e===void 0&&(e=!1),r.length<=2)return Jo(r);for(var t=[],n=r.length,i=0;i<n;i+=1){var a=e?r[n-i-1]:r[i];zt(a,t.slice(-2))||t.push.apply(t,Ee([],q(a),!1))}var s=eU(t);return e?s.unshift(Ee(["M"],q(r[n-1]),!1)):s.unshift(Ee(["M"],q(r[0]),!1)),s}function Lb(r,e,t){var n=ca(r);return n.push(["L",e,t],["L",0,t],["Z"]),n}function cH(r,e,t,n){return r.map(function(i){return Lb(e?Oc(i):Jo(i),t,n)})}function hH(r,e,t){for(var n=[],i=r.length-1;i>=0;i-=1){var a=r[i],s=Jo(a),o=void 0;if(i===0)o=Lb(s,e,t);else{var l=r[i-1],u=Jo(l,!0);u[0][0]="L",o=Ee(Ee(Ee([],q(s),!1),q(u),!1),[["Z"]],!1)}n.push(o)}return n}function dH(r,e,t){for(var n=[],i=r.length-1;i>=0;i-=1){var a=r[i],s=Oc(a),o=void 0;if(i===0)o=Lb(s,e,t);else{var l=r[i-1],u=Oc(l,!0),c=a[0];u[0][0]="L",o=Ee(Ee(Ee([],q(s),!1),q(u),!1),[Ee(["M"],q(c),!1),["Z"]],!1)}n.push(o)}return n}function Sk(r){return r.length===0?[0,0]:[Xu(f3(r,function(e){return Xu(e)||0})),Yu(d3(r,function(e){return Yu(e)||0}))]}function _k(r){for(var e=ca(r),t=e[0].length,n=q([Array(t).fill(0),Array(t).fill(0)],2),i=n[0],a=n[1],s=0;s<e.length;s+=1)for(var o=e[s],l=0;l<t;l+=1)o[l]>=0?(o[l]+=i[l],i[l]=o[l]):(o[l]+=a[l],a[l]=o[l]);return e}var fH=function(r){Xe(e,r);function e(t){return r.call(this,t,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(e.prototype,"rawData",{get:function(){var t=this.attributes.data;if(!t||(t==null?void 0:t.length)===0)return[[]];var n=ca(t);return _e(n[0])?[n]:n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?_k(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var t=this.scales.y,n=q(t.getOptions().domain||[0,0],2),i=n[0],a=n[1];return a<0?t.map(a):t.map(i<0?0:i)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var t=this.attributes,n=t.width,i=t.height;return{width:n,height:i}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var t=this,n=this.attributes,i=n.type,a=n.isStack,s=n.smooth;if(i!=="line")throw new Error("linesStyle can only be used in line type");var o=ze(this.attributes,"area"),l=ze(this.attributes,"line"),u=this.containerShape.width,c=this.data;if(c[0].length===0)return{lines:[],areas:[]};var h=this.scales,d=h.x,f=h.y,g=uH(c,{x:d,y:f}),v=[];if(o){var p=this.baseline;a?v=s?dH(g,u,p):hH(g,u,p):v=cH(g,s,u,p)}return{lines:g.map(function(y,m){return ce({stroke:t.getColor(m),d:s?Oc(y):Jo(y)},l)}),areas:v.map(function(y,m){return ce({d:y,fill:t.getColor(m)},o)})}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var t=this,n=ze(this.attributes,"column"),i=this.attributes,a=i.isStack,s=i.type,o=i.scale;if(s!=="column")throw new Error("columnsStyle can only be used in column type");var l=this.containerShape.height,u=this.rawData;if(!u)return{columns:[]};a&&(u=_k(u));var c=this.createScales(u),h=c.x,d=c.y,f=q(Sk(u),2),g=f[0],v=f[1],p=new Io({domain:[0,v-(g>0?0:g)],range:[0,l*o]}),y=h.getBandWidth(),m=this.rawData;return{columns:u.map(function(w,S){return w.map(function(_,O){var T=y/u.length,k=function(){return{x:h.map(O)+T*S,y:_>=0?d.map(_):d.map(0),width:T,height:p.map(Math.abs(_))}},P=function(){return{x:h.map(O),y:d.map(_),width:y,height:p.map(m[S][O])}};return ce(ce({fill:t.getColor(S)},n),a?P():k())})})}},enumerable:!1,configurable:!0}),e.prototype.render=function(t,n){oU(n,".container","rect").attr("className","container").node();var i=t.type,a=t.x,s=t.y,o="spark".concat(i),l=ce({x:a,y:s},i==="line"?this.linesStyle:this.columnsStyle);Ae(n).selectAll(".spark").data([i]).join(function(u){return u.append(function(c){return c==="line"?new lH({className:o,style:l}):new oH({className:o,style:l})}).attr("className","spark ".concat(o))},function(u){return u.update(l)},function(u){return u.remove()})},e.prototype.getColor=function(t){var n=this.attributes.color;return pr(n)?n[t%n.length]:Te(n)?n.call(null,t):n},e.prototype.createScales=function(t){var n,i,a=this.attributes,s=a.type,o=a.scale,l=a.range,u=l===void 0?[]:l,c=a.spacing,h=this.containerShape,d=h.width,f=h.height,g=q(Sk(t),2),v=g[0],p=g[1],y=new Io({domain:[(n=u[0])!==null&&n!==void 0?n:v,(i=u[1])!==null&&i!==void 0?i:p],range:[f,f*(1-o)]});return s==="line"?{type:s,x:new Io({domain:[0,t[0].length-1],range:[0,d]}),y}:{type:s,x:new Rb({domain:t[0].map(function(m,w){return w}),range:[0,d],paddingInner:c,paddingOuter:c/2,align:.5}),y}},e.tag="sparkline",e}(Gt);function gH(r){return typeof r=="boolean"?!1:"enter"in r&&"update"in r&&"exit"in r}function Mk(r){if(!r)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],t=Object.fromEntries(Object.entries(r).filter(function(n){var i=q(n,1),a=i[0];return!e.includes(a)}));return Object.fromEntries(e.map(function(n){return gH(r)?r[n]===!1?[n,!1]:[n,ce(ce({},r[n]),t)]:[n,t]}))}function eo(r,e){r?r.finished.then(e):e()}function pH(r,e){r.length===0?e():Promise.all(r.map(function(t){return t==null?void 0:t.finished})).then(e)}function QN(r,e){"update"in r?r.update(e):r.attr(e)}function eR(r,e,t){if(e.length===0)return null;if(!t){var n=e.slice(-1)[0];return QN(r,{style:n}),null}return r.animate(e,t)}function vH(r,e){return!(r.nodeName!=="text"||e.nodeName!=="text"||r.attributes.text!==e.attributes.text)}function yH(r,e,t,n){if(n===void 0&&(n="destroy"),vH(r,e))return r.remove(),[null];var i=function(){n==="destroy"?r.destroy():n==="hide"&&jr(r),e.isVisible()&&Sl(e)};if(!t)return i(),[null];var a=t.duration,s=a===void 0?0:a,o=t.delay,l=o===void 0?0:o,u=Math.ceil(+s/2),c=+s/4,h=q(r.getGeometryBounds().center,2),d=h[0],f=h[1],g=q(e.getGeometryBounds().center,2),v=g[0],p=g[1],y=q([(d+v)/2-d,(f+p)/2-f],2),m=y[0],w=y[1],S=r.style.opacity,_=S===void 0?1:S,O=e.style.opacity,T=O===void 0?1:O,k=r.style.transform||"",P=e.style.transform||"",C=r.animate([{opacity:_,transform:"translate(0, 0) ".concat(k)},{opacity:0,transform:"translate(".concat(m,", ").concat(w,") ").concat(k)}],ce(ce({fill:"both"},t),{duration:l+u+c})),N=e.animate([{opacity:0,transform:"translate(".concat(-m,", ").concat(-w,") ").concat(P),offset:.01},{opacity:T,transform:"translate(0, 0) ".concat(P)}],ce(ce({fill:"both"},t),{duration:u+c,delay:l+u-c}));return eo(N,i),[C,N]}function qr(r,e,t){var n={},i={};return Object.entries(e).forEach(function(a){var s=q(a,2),o=s[0],l=s[1];if(!Le(l)){var u=r.style[o]||r.parsedStyle[o]||0;u!==l&&(n[o]=u,i[o]=l)}}),t?eR(r,[n,i],ce({fill:"both"},t)):(QN(r,i),null)}function Gh(r,e){return r.style.opacity||(r.style.opacity=1),qr(r,{opacity:0},e)}var tR={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},nR={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},rR={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},ni=Hr({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),Xi=Hr({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),mH=function(r){Xe(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.render=function(t,n){var i=t.x,a=t.y,s=t.size,o=s===void 0?10:s,l=t.radius,u=l===void 0?o/4:l,c=t.orientation,h=$t(t,["x","y","size","radius","orientation"]),d=o,f=d*2.4,g=Ae(n).maybeAppendByClassName(Xi.iconRect,"rect").styles(ce(ce({},h),{width:d,height:f,radius:u,x:i-d/2,y:a-f/2,transformOrigin:"center"})),v=i+1/3*d-d/2,p=i+2/3*d-d/2,y=a+1/4*f-f/2,m=a+3/4*f-f/2;g.maybeAppendByClassName("".concat(Xi.iconLine,"-1"),"line").styles(ce({x1:v,x2:v,y1:y,y2:m},h)),g.maybeAppendByClassName("".concat(Xi.iconLine,"-2"),"line").styles(ce({x1:p,x2:p,y1:y,y2:m},h)),c==="vertical"&&(g.node().style.transform="rotate(90)")},e}(Gt),bH=function(r){Xe(e,r);function e(t){return r.call(this,t,rR)||this}return e.prototype.renderLabel=function(t){var n=this,i=this.attributes,a=i.x,s=i.y,o=i.showLabel,l=ze(this.attributes,"label"),u=l.x,c=u===void 0?0:u,h=l.y,d=h===void 0?0:h,f=l.transform,g=l.transformOrigin,v=$t(l,["x","y","transform","transformOrigin"]),p=q(Di(v,[]),2),y=p[0],m=p[1],w=Ae(t).maybeAppendByClassName(Xi.labelGroup,"g").styles(m),S=ce(ce({},nR),y),_=S.text,O=$t(S,["text"]);fr(!!o,w,function(T){n.label=T.maybeAppendByClassName(Xi.label,"text").styles(ce(ce({},O),{x:a+c,y:s+d,transform:f,transformOrigin:g,text:"".concat(_)})),n.label.on("mousedown",function(k){k.stopPropagation()}),n.label.on("touchstart",function(k){k.stopPropagation()})})},e.prototype.renderIcon=function(t){var n=this.attributes,i=n.x,a=n.y,s=n.orientation,o=n.type,l=ce(ce({x:i,y:a,orientation:s},tR),ze(this.attributes,"icon")),u=this.attributes.iconShape,c=u===void 0?function(){return new mH({style:l})}:u,h=Ae(t).maybeAppendByClassName(Xi.iconGroup,"g");h.selectAll(Xi.icon.class).data([c]).join(function(d){return d.append(typeof c=="string"?c:function(){return c(o)}).attr("className",Xi.icon.name)},function(d){return d.update(l)},function(d){return d.remove()})},e.prototype.render=function(t,n){this.renderIcon(n),this.renderLabel(n)},e}(Gt),wH=function(r){Xe(e,r);function e(t){var n=r.call(this,t,ce(ce(ce({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(i){return i.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},_s(rR,"handle")),_s(tR,"handleIcon")),_s(nR,"handleLabel")))||this;return n.range=[0,1],n.onDragStart=function(i){return function(a){a.stopPropagation(),n.target=i,n.prevPos=n.getOrientVal(tk(a));var s=n.availableSpace,o=s.x,l=s.y,u=n.getBBox(),c=u.x,h=u.y;n.selectionStartPos=n.getRatio(n.prevPos-n.getOrientVal([o,l])-n.getOrientVal([+c,+h])),n.selectionWidth=0,document.addEventListener("pointermove",n.onDragging),document.addEventListener("pointerup",n.onDragEnd)}},n.onDragging=function(i){var a=n.attributes,s=a.slidable,o=a.brushable,l=a.type;i.stopPropagation();var u=n.getOrientVal(tk(i)),c=u-n.prevPos;if(c){var h=n.getRatio(c);switch(n.target){case"start":s&&n.setValuesOffset(h);break;case"end":s&&n.setValuesOffset(0,h);break;case"selection":s&&n.setValuesOffset(h,h);break;case"track":if(!o)return;n.selectionWidth+=h,l==="range"?n.innerSetValues([n.selectionStartPos,n.selectionStartPos+n.selectionWidth].sort(),!0):n.innerSetValues([0,n.selectionStartPos+n.selectionWidth],!0);break}n.prevPos=u}},n.onDragEnd=function(){document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointerup",n.onDragEnd),n.target="",n.updateHandlesPosition(!1)},n.onValueChange=function(i){var a=n.attributes,s=a.onChange,o=a.type,l=o==="range"?i:i[1],u=o==="range"?n.getValues():n.getValues()[1],c=new Jt("valuechange",{detail:{oldValue:l,value:u}});n.dispatchEvent(c),s==null||s(u)},n.selectionStartPos=0,n.selectionWidth=0,n.prevPos=0,n.target="",n}return Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(t){this.attributes.values=this.clampValues(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){var t=this.attributes.orientation;if(t!=="horizontal")return null;var n=ze(this.attributes,"sparkline");return ce(ce({zIndex:0},this.availableSpace),n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t=this.attributes,n=t.trackLength,i=t.trackSize,a=q(this.getOrientVal([[n,i],[i,n]]),2),s=a[0],o=a[1];return{width:s,height:o}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes;t.x,t.y;var n=t.padding,i=q(On(n),4),a=i[0],s=i[1],o=i[2],l=i[3],u=this.shape,c=u.width,h=u.height;return{x:l,y:a,width:c-(l+s),height:h-(a+o)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(t,n){t===void 0&&(t=[0,0]),n===void 0&&(n=!1),this.attributes.values=t;var i=n===!1?!1:this.attributes.animate;this.updateSelectionArea(i),this.updateHandlesPosition(i)},e.prototype.updateSelectionArea=function(t){var n=this.calcSelectionArea();this.foregroundGroup.selectAll(ni.selection.class).each(function(i,a){qr(this,n[a],t)})},e.prototype.updateHandlesPosition=function(t){this.attributes.showHandle&&(this.startHandle&&qr(this.startHandle,this.getHandleStyle("start"),t),this.endHandle&&qr(this.endHandle,this.getHandleStyle("end"),t))},e.prototype.innerSetValues=function(t,n){t===void 0&&(t=[0,0]),n===void 0&&(n=!1);var i=this.values,a=this.clampValues(t);this.attributes.values=a,this.setValues(a),n&&this.onValueChange(i)},e.prototype.renderTrack=function(t){var n=this.attributes,i=n.x,a=n.y,s=ze(this.attributes,"track");this.trackShape=Ae(t).maybeAppendByClassName(ni.track,"rect").styles(ce(ce({x:i,y:a},this.shape),s))},e.prototype.renderBrushArea=function(t){var n=this.attributes,i=n.x,a=n.y,s=n.brushable;this.brushArea=Ae(t).maybeAppendByClassName(ni.brushArea,"rect").styles(ce({x:i,y:a,fill:"transparent",cursor:s?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(t){var n=this,i=this.attributes,a=i.x,s=i.y,o=i.orientation,l=Ae(t).maybeAppendByClassName(ni.sparklineGroup,"g");fr(o==="horizontal",l,function(u){var c=ce(ce({},n.sparklineStyle),{x:a,y:s});u.maybeAppendByClassName(ni.sparkline,function(){return new fH({style:c})}).update(c)})},e.prototype.renderHandles=function(){var t=this,n,i=this.attributes,a=i.showHandle,s=i.type,o=s==="range"?["start","end"]:["end"],l=a?o:[],u=this;(n=this.foregroundGroup)===null||n===void 0||n.selectAll(ni.handle.class).data(l.map(function(c){return{type:c}}),function(c){return c.type}).join(function(c){return c.append(function(h){var d=h.type;return new bH({style:t.getHandleStyle(d)})}).each(function(h){var d=h.type;this.attr("class","".concat(ni.handle.name," ").concat(d,"-handle"));var f="".concat(d,"Handle");u[f]=this,this.addEventListener("pointerdown",u.onDragStart(d))})},function(c){return c.each(function(h){var d=h.type;this.update(u.getHandleStyle(d))})},function(c){return c.each(function(h){var d=h.type,f="".concat(d,"Handle");u[f]=void 0}).remove()})},e.prototype.renderSelection=function(t){var n=this.attributes,i=n.x,a=n.y,s=n.type,o=n.selectionType;this.foregroundGroup=Ae(t).maybeAppendByClassName(ni.foreground,"g");var l=ze(this.attributes,"selection"),u=function(h){return h.style("visibility",function(d){return d.show?"visible":"hidden"}).style("cursor",function(d){return o==="select"?"grab":o==="invert"?"crosshair":"default"}).styles(ce(ce({},l),{transform:"translate(".concat(i,", ").concat(a,")")}))},c=this;this.foregroundGroup.selectAll(ni.selection.class).data(s==="value"?[]:this.calcSelectionArea().map(function(h,d){return{style:ce({},h),index:d,show:o==="select"?d===1:d!==1}}),function(h){return h.index}).join(function(h){return h.append("rect").attr("className",ni.selection.name).call(u).each(function(d,f){var g=this;f===1?(c.selectionShape=Ae(this),this.on("pointerdown",function(v){g.attr("cursor","grabbing"),c.onDragStart("selection")(v)}),c.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),c.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),c.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){g.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){g.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){g.attr("cursor","pointer")})):this.on("pointerdown",c.onDragStart("track"))})},function(h){return h.call(u)},function(h){return h.remove()}),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(t,n){this.renderTrack(n),this.renderSparkline(n),this.renderBrushArea(n),this.renderSelection(n)},e.prototype.clampValues=function(t,n){var i;n===void 0&&(n=4);var a=q(this.range,2),s=a[0],o=a[1],l=q(this.getValues().map(function(p){return nk(p,n)}),2),u=l[0],c=l[1],h=Array.isArray(t)?t:[u,t??c],d=q((h||[u,c]).map(function(p){return nk(p,n)}),2),f=d[0],g=d[1];if(this.attributes.type==="value")return[0,Bt(g,s,o)];f>g&&(i=q([g,f],2),f=i[0],g=i[1]);var v=g-f;return v>o-s?[s,o]:f<s?u===s&&c===g?[s,g]:[s,v+s]:g>o?c===o&&u===f?[f,o]:[o-v,o]:[f,g]},e.prototype.calcSelectionArea=function(t){var n=q(this.clampValues(t),2),i=n[0],a=n[1],s=this.availableSpace,o=s.x,l=s.y,u=s.width,c=s.height;return this.getOrientVal([[{y:l,height:c,x:o,width:i*u},{y:l,height:c,x:i*u+o,width:(a-i)*u},{y:l,height:c,x:a*u,width:(1-a)*u}],[{x:o,width:u,y:l,height:i*c},{x:o,width:u,y:i*c+l,height:(a-i)*c},{x:o,width:u,y:a*c,height:(1-a)*c}]])},e.prototype.calcHandlePosition=function(t){var n=this.attributes.handleIconOffset,i=this.availableSpace,a=i.x,s=i.y,o=i.width,l=i.height,u=q(this.clampValues(),2),c=u[0],h=u[1],d=t==="start"?-n:n,f=(t==="start"?c:h)*this.getOrientVal([o,l])+d;return{x:a+this.getOrientVal([f,o/2]),y:s+this.getOrientVal([l/2,f])}},e.prototype.inferTextStyle=function(t){var n=this.attributes.orientation;return n==="horizontal"?{}:t==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:t==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(t){var n,i=this.attributes,a=i.type,s=i.orientation,o=i.formatter,l=i.autoFitLabel,u=ze(this.attributes,"handle"),c=ze(u,"label"),h=u.spacing,d=this.getHandleSize(),f=this.clampValues(),g=t==="start"?f[0]:f[1],v=o(g),p=new kb({style:ce(ce(ce({},c),this.inferTextStyle(t)),{text:v})}),y=p.getBBox(),m=y.width,w=y.height;if(p.destroy(),!l){if(a==="value")return{text:v,x:0,y:-w-h};var S=h+d+(s==="horizontal"?m/2:0);return n={text:v},n[s==="horizontal"?"x":"y"]=t==="start"?-S:S,n}var _=0,O=0,T=this.availableSpace,k=T.width,P=T.height,C=this.calcSelectionArea()[1],N=C.x,L=C.y,F=C.width,G=C.height,V=h+d;if(s==="horizontal"){var U=V+m/2;if(t==="start"){var $=N-V-m;_=$>0?-U:U}else{var j=k-N-F-V>m;_=j?U:-U}}else{var Z=V,ne=w+V;t==="start"?O=L-d>w?-ne:Z:O=P-(L+G)-d>w?ne:-Z}return{x:_,y:O,text:v}},e.prototype.getHandleLabelStyle=function(t){var n=ze(this.attributes,"handleLabel");return ce(ce(ce({},n),this.calcHandleText(t)),this.inferTextStyle(t))},e.prototype.getHandleIconStyle=function(){var t=this.attributes.handleIconShape,n=ze(this.attributes,"handleIcon"),i=this.getOrientVal(["ew-resize","ns-resize"]),a=this.getHandleSize();return ce({cursor:i,shape:t,size:a},n)},e.prototype.getHandleStyle=function(t){var n=this.attributes,i=n.x,a=n.y,s=n.showLabel,o=n.showLabelOnInteraction,l=n.orientation,u=this.calcHandlePosition(t),c=u.x,h=u.y,d=this.calcHandleText(t),f=s;return!s&&o&&(this.target?f=!0:f=!1),ce(ce(ce({},_s(this.getHandleIconStyle(),"icon")),_s(ce(ce({},this.getHandleLabelStyle(t)),d),"label")),{transform:"translate(".concat(c+i,", ").concat(h+a,")"),orientation:l,showLabel:f,type:t,zIndex:3})},e.prototype.getHandleSize=function(){var t=this.attributes,n=t.handleIconSize,i=t.width,a=t.height;return n||Math.floor((this.getOrientVal([+a,+i])+4)/2.4)},e.prototype.getOrientVal=function(t){var n=q(t,2),i=n[0],a=n[1],s=this.attributes.orientation;return s==="horizontal"?i:a},e.prototype.setValuesOffset=function(t,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var a=this.attributes.type,s=q(this.getValues(),2),o=s[0],l=s[1],u=a==="range"?t:0,c=[o+u,l+n].sort();i?this.setValues(c):this.innerSetValues(c,!0)},e.prototype.getRatio=function(t){var n=this.availableSpace,i=n.width,a=n.height;return t/this.getOrientVal([i,a])},e.prototype.dispatchCustomEvent=function(t,n,i){var a=this;t.on(n,function(s){s.stopPropagation(),a.dispatchEvent(new Jt(i,{detail:s}))})},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var t=this.brushArea;this.dispatchCustomEvent(t,"click","trackClick"),this.dispatchCustomEvent(t,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(t,"pointerleave","trackMouseleave"),t.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(t){var n=this.attributes.scrollable;if(n){var i=t.deltaX,a=t.deltaY,s=a||i,o=this.getRatio(s);this.setValuesOffset(o,o,!0)}},e.tag="slider",e}(Gt),Ib={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new ur({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]};$n({},Ib,{style:{type:"arc"}});$n({},Ib,{style:{}});var lt=Hr({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis"),$s=Hr({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function iR(r){return r.reduce(function(e,t,n){return e.push(Ee([n===0?"M":"L"],q(t),!1)),e},[])}function xH(r,e,t){var n=e.connect,i=n===void 0?"line":n,a=e.center;if(i==="line")return iR(r);if(!a)return[];var s=Zo(r[0],a),o=t?0:1;return r.reduce(function(l,u,c){return c===0?l.push(Ee(["M"],q(u),!1)):l.push(Ee(["A",s,s,0,0,o],q(u),!1)),l},[])}function i1(r,e,t){return e.type==="surround"?xH(r,e,t):iR(r)}function EH(r,e,t){var n=t.type,i=t.connect,a=t.center,s=t.closed,o=s?[["Z"]]:[],l=q([i1(r,t),i1(e.slice().reverse(),t,!0)],2),u=l[0],c=l[1],h=q([r[0],e.slice(-1)[0]],2),d=h[0],f=h[1],g=function(m,w){return[u,m,c,w,o].flat()};if(i==="line"||n==="surround")return g([Ee(["L"],q(f),!1)],[Ee(["L"],q(d),!1)]);if(!a)throw new Error("Arc grid need to specified center");var v=q([Zo(f,a),Zo(d,a)],2),p=v[0],y=v[1];return g([Ee(["A",p,p,0,0,1],q(f),!1),Ee(["L"],q(f),!1)],[Ee(["A",y,y,0,0,0],q(d),!1),Ee(["L"],q(d),!1)])}function SH(r,e,t,n){var i=t.animate,a=t.isBillboard,s=e.map(function(o,l){return{id:o.id||"grid-line-".concat(l),d:i1(o.points,t)}});return r.selectAll($s.line.class).data(s,function(o){return o.id}).join(function(o){return o.append("path").each(function(l,u){var c=Tr(ik(ce({d:l.d},n)),[l,u,s]);this.attr(ce({class:$s.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:a},c))})},function(o){return o.transition(function(l,u){var c=Tr(ik(ce({d:l.d},n)),[l,u,s]);return qr(this,c,i.update)})},function(o){return o.transition(function(){var l=this,u=Gh(this,i.exit);return eo(u,function(){return l.remove()}),u})}).transitions()}function _H(r,e,t){var n=t.animate,i=t.connect,a=t.areaFill;if(e.length<2||!a||!i)return[];for(var s=Array.isArray(a)?a:[a,"transparent"],o=function(g){return s[g%s.length]},l=[],u=0;u<e.length-1;u++){var c=q([e[u].points,e[u+1].points],2),h=c[0],d=c[1],f=EH(h,d,t);l.push({d:f,fill:o(u)})}return r.selectAll($s.region.class).data(l,function(g,v){return v}).join(function(g){return g.append("path").each(function(v,p){var y=Tr(v,[v,p,l]);this.attr(y)}).attr("className",$s.region.name)},function(g){return g.transition(function(v,p){var y=Tr(v,[v,p,l]);return qr(this,y,n.update)})},function(g){return g.transition(function(){var v=this,p=Gh(this,n.exit);return eo(p,function(){return v.remove()}),p})}).transitions()}function MH(r){var e=r.data,t=e===void 0?[]:e,n=r.closed;return n?t.map(function(i){var a=i.points,s=q(a,1),o=s[0];return ce(ce({},i),{points:Ee(Ee([],q(a),!1),[o],!1)})}):t}var OH=function(r){Xe(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.render=function(t,n){t.type,t.center,t.areaFill,t.closed;var i=$t(t,["type","center","areaFill","closed"]),a=MH(t),s=Ae(n).maybeAppendByClassName($s.lineGroup,"g"),o=Ae(n).maybeAppendByClassName($s.regionGroup,"g"),l=SH(s,a,t,i),u=_H(o,a,t);return Ee(Ee([],q(l),!1),q(u),!1)},e}(Gt);function aR(r,e){return Object.fromEntries(Object.entries(r).map(function(t){var n=q(t,2),i=n[0],a=n[1];return[i,Tr(a,e)]}))}function Db(r,e){return e&&Te(e)?r.filter(e):r}function sR(r,e){var t=e.startAngle,n=e.endAngle;return(n-t)*r+t}function Wh(r,e){if(e.type==="linear"){var t=q(e.startPos,2),n=t[0],i=t[1],a=q(e.endPos,2),s=a[0],o=a[1],l=q([s-n,o-i],2),u=l[0],c=l[1];return HN([u,c])}var h=qs(sR(r,e));return[-Math.sin(h),Math.cos(h)]}function Fb(r,e,t){var n=Wh(r,t);return J7(n,e!=="positive")}function _l(r,e){return Fb(r,e.labelDirection,e)}function kH(r,e){var t=q(e.startPos,2),n=t[0],i=t[1],a=q(e.endPos,2),s=a[0],o=a[1],l=q([s-n,o-i],2),u=l[0],c=l[1];return[n+u*r,i+c*r]}function TH(r,e){var t=e.radius,n=q(e.center,2),i=n[0],a=n[1],s=qs(sR(r,e));return[i+t*Math.cos(s),a+t*Math.sin(s)]}function Vh(r,e){return e.type==="linear"?kH(r,e):TH(r,e)}function oR(r){return Wh(0,r)[1]===0}function lR(r){return Wh(0,r)[0]===0}function uR(r,e){return e-r===360}function Ok(r,e,t,n,i){var a=e-r,s=q([i,i],2),o=s[0],l=s[1],u=q([qs(r),qs(e)],2),c=u[0],h=u[1],d=function(P){return[t+i*Math.cos(P),n+i*Math.sin(P)]},f=q(d(c),2),g=f[0],v=f[1],p=q(d(h),2),y=p[0],m=p[1];if(uR(r,e)){var w=(h+c)/2,S=q(d(w),2),_=S[0],O=S[1];return[["M",g,v],["A",o,l,0,1,0,_,O],["A",o,l,0,1,0,y,m]]}var T=a>180?1:0,k=r>e?0:1;return"M".concat(g,",").concat(v,",A").concat(o,",").concat(l,",0,").concat(T,",").concat(k,",").concat(y,",").concat(m)}function AH(r){var e=r.attributes,t=e.startAngle,n=e.endAngle,i=e.center,a=e.radius;return Ee(Ee([t,n],q(i),!1),[a],!1)}function PH(r,e,t,n){var i=e.startAngle,a=e.endAngle,s=e.center,o=e.radius;return r.selectAll(lt.line.class).data([{d:Ok.apply(void 0,Ee(Ee([i,a],q(s),!1),[o],!1))}],function(l,u){return u}).join(function(l){return l.append("path").attr("className",lt.line.name).styles(e).styles({d:function(u){return u.d}})},function(l){return l.transition(function(){var u=this,c=Z7(this,AH(this),Ee(Ee([i,a],q(s),!1),[o],!1),n.update);if(c){var h=function(){var d=Bn(u.attributes,"__keyframe_data__");u.style.d=Ok.apply(void 0,Ee([],q(d),!1))};c.onframe=h,c.onfinish=h}return c}).styles(e)},function(l){return l.remove()}).styles(t).transitions()}function CH(r,e){e.truncRange,e.truncShape,e.lineExtension}function NH(r,e,t){t===void 0&&(t=[0,0]);var n=q([r,e,t],3),i=q(n[0],2),a=i[0],s=i[1],o=q(n[1],2),l=o[0],u=o[1],c=q(n[2],2),h=c[0],d=c[1],f=q([l-a,u-s],2),g=f[0],v=f[1],p=Math.sqrt(Math.pow(g,2)+Math.pow(v,2)),y=q([-h/p,d/p],2),m=y[0],w=y[1];return[m*g,m*v,w*g,w*v]}function kk(r){var e=q(r,2),t=q(e[0],2),n=t[0],i=t[1],a=q(e[1],2),s=a[0],o=a[1];return{x1:n,y1:i,x2:s,y2:o}}function RH(r,e,t,n){var i=e.showTrunc,a=e.startPos,s=e.endPos,o=e.truncRange,l=e.lineExtension,u=q([a,s],2),c=q(u[0],2),h=c[0],d=c[1],f=q(u[1],2),g=f[0],v=f[1],p=q(l?NH(a,s,l):new Array(4).fill(0),4),y=p[0],m=p[1],w=p[2],S=p[3],_=function(j){return r.selectAll(lt.line.class).data(j,function(Z,ne){return ne}).join(function(Z){return Z.append("line").attr("className",function(ne){return"".concat(lt.line.name," ").concat(ne.className)}).styles(t).transition(function(ne){return qr(this,kk(ne.line),!1)})},function(Z){return Z.styles(t).transition(function(ne){var oe=ne.line;return qr(this,kk(oe),n.update)})},function(Z){return Z.remove()}).transitions()};if(!i||!o)return _([{line:[[h+y,d+m],[g+w,v+S]],className:lt.line.name}]);var O=q(o,2),T=O[0],k=O[1],P=g-h,C=v-d,N=q([h+P*T,d+C*T],2),L=N[0],F=N[1],G=q([h+P*k,d+C*k],2),V=G[0],U=G[1],$=_([{line:[[h+y,d+m],[L,F]],className:lt.lineFirst.name},{line:[[V,U],[g+w,v+S]],className:lt.lineSecond.name}]);return CH(r,e),$}function LH(r,e,t,n){var i=t.showArrow,a=t.showTrunc,s=t.lineArrow,o=t.lineArrowOffset,l=t.lineArrowSize,u;if(e==="arc"?u=r.select(lt.line.class):a?u=r.select(lt.lineSecond.class):u=r.select(lt.line.class),!i||!s||t.type==="arc"&&uR(t.startAngle,t.endAngle)){var c=u.node();c&&(c.style.markerEnd=void 0);return}var h=Ii(s);h.attr(n),Ab(h,l),u.style("markerEnd",h).style("markerEndOffset",-o)}function IH(r,e,t){var n=e.type,i,a=ze(e,"line");return n==="linear"?i=RH(r,e,rk(a,"arrow"),t):i=PH(r,e,rk(a,"arrow"),t),LH(r,n,e,a),i}function DH(r,e){return Fb(r,e.gridDirection,e)}function cR(r){var e=r.type,t=r.gridCenter;return e==="linear"?t:t||r.center}function FH(r,e){var t=e.gridLength;return r.map(function(n,i){var a=n.value,s=q(Vh(a,e),2),o=s[0],l=s[1],u=q(ki(DH(a,e),t),2),c=u[0],h=u[1];return{id:i,points:[[o,l],[o+c,l+h]]}})}function BH(r,e){var t=e.gridControlAngles,n=cR(e);if(!n)throw new Error("grid center is not provide");if(r.length<2)throw new Error("Invalid grid data");if(!t||t.length===0)throw new Error("Invalid gridControlAngles");var i=q(n,2),a=i[0],s=i[1];return r.map(function(o,l){var u=o.value,c=q(Vh(u,e),2),h=c[0],d=c[1],f=q([h-a,d-s],2),g=f[0],v=f[1],p=[];return t.forEach(function(y){var m=qs(y),w=q([Math.cos(m),Math.sin(m)],2),S=w[0],_=w[1],O=g*S-v*_+a,T=g*_+v*S+s;p.push([O,T])}),{points:p,id:l}})}function zH(r,e,t,n){var i=ze(t,"grid"),a=i.type,s=i.areaFill,o=cR(t),l=Db(e,t.gridFilter),u=a==="segment"?FH(l,t):BH(l,t),c=ce(ce({},i),{center:o,areaFill:Te(s)?l.map(function(h,d){return Tr(s,[h,d,l])}):s,animate:n,data:u});return r.selectAll(lt.grid.class).data([1]).join(function(h){return h.append(function(){return new OH({style:c})}).attr("className",lt.grid.name)},function(h){return h.transition(function(){return this.update(c)})},function(h){return h.remove()}).transitions()}var a1=function(){function r(e,t,n,i){this.set(e,t,n,i)}return Object.defineProperty(r.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),r.prototype.rotatedPoints=function(e,t,n){var i=this,a=i.x1,s=i.y1,o=i.x2,l=i.y2,u=Math.cos(e),c=Math.sin(e),h=t-t*u+n*c,d=n-t*c-n*u,f=[[u*a-c*l+h,c*a+u*l+d],[u*o-c*l+h,c*o+u*l+d],[u*a-c*s+h,c*a+u*s+d],[u*o-c*s+h,c*o+u*s+d]];return f},r.prototype.set=function(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},r.prototype.defined=function(e){return this[e]!==Number.MAX_VALUE&&this[e]!==-Number.MAX_VALUE},r}();function s1(r,e){var t=r.getEulerAngles()||0;r.setEulerAngles(0);var n=r.getBounds(),i=q(n.min,2),a=i[0],s=i[1],o=q(n.max,2),l=o[0],u=o[1],c=r.getBBox(),h=c.width,d=c.height,f=d,g=0,v=0,p=a,y=s,m=VN(r);if(m){f-=1.5;var w=m.style.textAlign,S=m.style.textBaseline;w==="center"?p=(a+l)/2:(w==="right"||w==="end")&&(p=l),S==="middle"?y=(s+u)/2:S==="bottom"&&(y=u)}var _=q(On(e),4),O=_[0],T=O===void 0?0:O,k=_[1],P=k===void 0?0:k,C=_[2],N=C===void 0?T:C,L=_[3],F=L===void 0?P:L,G=new a1((g+=a)-F,(v+=s)-T,g+h+P,v+f+N);return r.setEulerAngles(t),G.rotatedPoints(qs(t),p,y)}function ko(r,e){return e[0]<=Math.max(r[0][0],r[1][0])&&e[0]<=Math.min(r[0][0],r[1][0])&&e[1]<=Math.max(r[0][1],r[1][1])&&e[1]<=Math.min(r[0][1],r[1][1])}function To(r,e,t){var n=(e[1]-r[1])*(t[0]-e[0])-(e[0]-r[0])*(t[1]-e[1]);return n===0?0:n<0?2:1}function jH(r,e){var t=To(r[0],r[1],e[0]),n=To(r[0],r[1],e[1]),i=To(e[0],e[1],r[0]),a=To(e[0],e[1],r[1]);return!!(t!==n&&i!==a||t===0&&ko(r,e[0])||n===0&&ko(r,e[1])||i===0&&ko(e,r[0])||a===0&&ko(e,r[1]))}function qH(r,e){var t=r.length;if(t<3)return!1;var n=[e,[9999,e[1]]],i=0,a=0;do{var s=[r[a],r[(a+1)%t]];if(jH(s,n)){if(To(s[0],e,s[1])===0)return ko(s,e);i++}a=(a+1)%t}while(a!==0);return!!(i&1)}function $H(r,e){return e.every(function(t){return qH(r,t)})}function GH(r,e,t){var n=r.x1,i=r.x2,a=r.y1,s=r.y2,o=[[n,a],[i,a],[i,s],[n,s]],l=s1(e,t);return $H(o,l)}function WH(r,e){var t=q(r,4),n=t[0],i=t[1],a=t[2],s=t[3],o=q(e,4),l=o[0],u=o[1],c=o[2],h=o[3],d=a-n,f=s-i,g=c-l,v=h-u,p=d*v-g*f;if(p===0)return!1;var y=p>0,m=n-l,w=i-u,S=d*w-f*m;if(S<0===y)return!1;var _=g*w-v*m;return!(_<0===y||S>p===y||_>p===y)}function VH(r,e){var t=[[r[0],r[1],r[2],r[3]],[r[2],r[3],r[4],r[5]],[r[4],r[5],r[6],r[7]],[r[6],r[7],r[0],r[1]]];return t.some(function(n){return WH(e,n)})}function UH(r,e,t){var n,i,a=s1(r,t).flat(1),s=s1(e,t).flat(1),o=[[a[0],a[1],a[2],a[3]],[a[0],a[1],a[4],a[5]],[a[4],a[5],a[6],a[7]],[a[2],a[3],a[6],a[7]]];try{for(var l=il(o),u=l.next();!u.done;u=l.next()){var c=u.value;if(VH(s,c))return!0}}catch(h){n={error:h}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}return!1}function HH(r,e){var t=r.type,n=r.labelDirection,i=r.crossSize;if(!i)return!1;if(t==="arc"){var a=r.center,s=r.radius,o=q(a,2),l=o[0],u=o[1],c=n==="negative"?0:i,h=-s-c,d=s+c,f=q(On(e),4),g=f[0],v=f[1],p=f[2],y=f[3];return new a1(l+h-y,u+h-g,l+d+v,u+d+p)}var m=q(r.startPos,2),w=m[0],S=m[1],_=q(r.endPos,2),O=_[0],T=_[1],k=q(lR(r)?[-e,0,e,0]:[0,e,0,-e],4),P=k[0],C=k[1],N=k[2],L=k[3],F=_l(0,r),G=ki(F,i),V=new a1(w,S,O,T);return V.x1+=L,V.y1+=P,V.x2+=C+G[0],V.y2+=N+G[1],V}function Uh(r,e,t){var n,i,a=e.crossPadding,s=new Set,o=null,l=HH(e,a),u=function(g){return l?GH(l,g):!0},c=function(g,v){return!g||!g.firstChild?!0:!UH(g.firstChild,v.firstChild,On(t))};try{for(var h=il(r),d=h.next();!d.done;d=h.next()){var f=d.value;u(f)?!o||c(o,f)?o=f:(s.add(o),s.add(f)):s.add(f)}}catch(g){n={error:g}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}return Array.from(s)}function Yy(r,e){return e===void 0&&(e={}),Le(r)?0:typeof r=="number"?r:Math.floor(V7(r,e))}function YH(r,e,t,n){if(!(r.length<=1)){var i=e.suffix,a=i===void 0?"...":i,s=e.minLength,o=e.maxLength,l=o===void 0?1/0:o,u=e.step,c=u===void 0?" ":u,h=e.margin,d=h===void 0?[0,0,0,0]:h,f=WN(n.getTextShape(r[0])),g=Yy(c,f),v=s?Yy(s,f):g,p=Yy(l,f);(Le(p)||p===1/0)&&(p=Math.max.apply(null,r.map(function(O){return O.getBBox().width})));var y=r.slice(),m=q(d,4);m[0],m[1],m[2],m[3];for(var w=function(O){if(y.forEach(function(T){n.ellipsis(n.getTextShape(T),O,a)}),y=Uh(r,t,d),y.length<1)return{value:void 0}},S=p;S>v+g;S-=g){var _=w(S);if(typeof _=="object")return _.value}}}var XH={parity:function(r,e){var t=e.seq,n=t===void 0?2:t;return r.filter(function(i,a){return a%n?(jr(i),!1):!0})}},KH=function(r){return r.filter(GN)};function ZH(r,e,t,n){var i=r.length,a=e.keepHeader,s=e.keepTail;if(!(i<=1||i===2&&a&&s)){var o=XH.parity,l=function(w){return w.forEach(n.show),w},u=2,c=r.slice(),h=r.slice(),d=Math.min.apply(Math,Ee([1],q(r.map(function(w){return w.getBBox().width})),!1));if(t.type==="linear"&&(oR(t)||lR(t))){var f=ak(r[0]).left,g=ak(r[i-1]).right,v=Math.abs(g-f)||1;u=Math.max(Math.floor(i*d/v),u)}var p,y;for(a&&(p=c.splice(0,1)[0]),s&&(y=c.splice(-1,1)[0],c.reverse()),l(c);u<r.length&&Uh(KH(y?Ee(Ee([y],q(h),!1),[p],!1):Ee([p],q(h),!1)),t,e==null?void 0:e.margin).length;){if(y&&!p&&u%2===0){var m=c.splice(0,1);m.forEach(n.hide)}else if(y&&p){var m=c.splice(0,1);m.forEach(n.hide)}h=o(l(c),{seq:u}),u++}}}function JH(r,e,t,n){var i,a,s=e.optionalAngles,o=s===void 0?[0,45,90]:s,l=e.margin,u=e.recoverWhenFailed,c=u===void 0?!0:u,h=r.map(function(y){return y.getLocalEulerAngles()}),d=function(){return Uh(r,t,l).length<1},f=function(y){return r.forEach(function(m,w){var S=Array.isArray(y)?y[w]:y;n.rotate(m,+S)})};try{for(var g=il(o),v=g.next();!v.done;v=g.next()){var p=v.value;if(f(p),d())return}}catch(y){i={error:y}}finally{try{v&&!v.done&&(a=g.return)&&a.call(g)}finally{if(i)throw i.error}}c&&f(h)}function QH(r){var e=r.type,t=r.labelDirection;return e==="linear"&&oR(r)?t==="negative"?"bottom":"top":"middle"}function eY(r,e,t,n){var i=e.wordWrapWidth,a=i===void 0?50:i,s=e.maxLines,o=s===void 0?3:s,l=e.recoverWhenFailed,u=l===void 0?!0:l,c=e.margin,h=c===void 0?[0,0,0,0]:c,d=r.map(function(m){return m.attr("maxLines")||1}),f=Math.min.apply(Math,Ee([],q(d),!1)),g=function(){return Uh(r,t,h).length<1},v=QH(t),p=function(m){return r.forEach(function(w,S){var _=Array.isArray(m)?m[S]:m;n.wrap(w,a,_,v)})};if(!(f>o)){for(var y=f;y<=o;y++)if(p(y),g())return;u&&p(d)}}var tY=new Map([["hide",ZH],["rotate",JH],["ellipsis",YH],["wrap",eY]]);function nY(r,e,t){return e.labelOverlap.length<1?!1:t==="hide"?!G7(r[0]):t==="rotate"?!r.some(function(n){var i;return!!(!((i=n.attr("transform"))===null||i===void 0)&&i.includes("rotate"))}):t==="ellipsis"||t==="wrap"?r.filter(function(n){return n.querySelector("text")}).length>1:!0}function rY(r,e,t){var n=e.labelOverlap,i=n===void 0?[]:n;i.length&&i.forEach(function(a){var s=a.type,o=tY.get(s);nY(r,e,s)&&(o==null||o(r,a,e,t))})}function iY(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=function(n){return n==="positive"?-1:1};return r.reduce(function(n,i){return n*t(i)},1)}function Tk(r){for(var e=r;e<0;)e+=360;return Math.round(e%360)}function o1(r,e){var t=q(r,2),n=t[0],i=t[1],a=q(e,2),s=a[0],o=a[1],l=q([n*s+i*o,n*o-i*s],2),u=l[0],c=l[1];return Math.atan2(c,u)}function aY(r){var e=(r+360)%180;return xn(e,-90,90)||(e+=180),e}function sY(r,e,t){var n,i=t.labelAlign,a=(n=e.style.transform)===null||n===void 0?void 0:n.includes("rotate");if(a)return e.getLocalEulerAngles();var s=0,o=_l(r.value,t),l=Wh(r.value,t);return i==="horizontal"?0:(i==="perpendicular"?s=o1([1,0],o):s=o1([l[0]<0?-1:1,0],l),aY(qN(s)))}function hR(r,e,t){var n=t.type,i=t.labelAlign,a=_l(r,t),s=Tk(e),o=Tk(qN(o1([1,0],a))),l="center",u="middle";return n==="linear"?[90,270].includes(o)&&s===0?(l="center",u=a[1]===1?"top":"bottom"):!(o%180)&&[90,270].includes(s)?l="center":o===0?(xn(s,0,90,!1,!0)||xn(s,0,90)||xn(s,270,360))&&(l="start"):o===90?xn(s,0,90,!1,!0)?l="start":(xn(s,90,180)||xn(s,270,360))&&(l="end"):o===270?xn(s,0,90,!1,!0)?l="end":(xn(s,90,180)||xn(s,270,360))&&(l="start"):o===180&&(s===90?l="start":(xn(s,0,90)||xn(s,270,360))&&(l="end")):i==="parallel"?xn(o,0,180,!0)?u="top":u="bottom":i==="horizontal"?xn(o,90,270,!1)?l="end":(xn(o,270,360,!1)||xn(o,0,90))&&(l="start"):i==="perpendicular"&&(xn(o,90,270)?l="end":l="start"),{textAlign:l,textBaseline:u}}function oY(r,e,t){e.setLocalEulerAngles(r);var n=e.__data__.value,i=hR(n,r,t),a=e.querySelector(lt.labelItem.class);a&&dR(a,i)}function Ak(r,e,t){var n=t.showTick,i=t.tickLength,a=t.tickDirection,s=t.labelDirection,o=t.labelSpacing,l=e.indexOf(r),u=Tr(o,[r,l,e]),c=q([_l(r.value,t),iY(s,a)],2),h=c[0],d=c[1],f=d===1?Tr(n?i:0,[r,l,e]):0,g=q(Oo(ki(h,u+f),Vh(r.value,t)),2),v=g[0],p=g[1];return{x:v,y:p}}function lY(r,e,t,n){var i=n.labelFormatter,a=Te(i)?function(){return Ii(Tr(i,[r,e,t,_l(r.value,n)]))}:function(){return Ii(r.label||"")};return a}function dR(r,e){r.nodeName==="text"&&r.attr(e)}function Pk(r){rY(this.node().childNodes,r,{hide:jr,show:Sl,rotate:function(e,t){oY(+t,e,r)},ellipsis:function(e,t,n){e&&n1(e,t||1/0,n)},wrap:function(e,t,n){e&&U7(e,t,n)},getTextShape:function(e){return e.querySelector("text")}})}function Ck(r,e,t,n,i){var a=t.indexOf(e),s=Ae(r).append(lY(e,a,t,i)).attr("className",lt.labelItem.name).node(),o=q(Di(aR(n,[e,a,t])),2),l=o[0],u=o[1],c=u.transform,h=$t(u,["transform"]);YN(s,c);var d=sY(e,s,i);return s.getLocalEulerAngles()||s.setLocalEulerAngles(d),dR(s,ce(ce({},hR(e.value,d,i)),l)),r.attr(h),s}function uY(r,e,t,n){var i=Db(e,t.labelFilter),a=ze(t,"label");return r.selectAll(lt.label.class).data(i,function(s,o){return o}).join(function(s){return s.append("g").attr("className",lt.label.name).transition(function(o){Ck(this,o,e,a,t);var l=Ak(o,e,t),u=l.x,c=l.y;return this.style.transform="translate(".concat(u,", ").concat(c,")"),null}).call(function(){Pk.call(r,t)})},function(s){return s.transition(function(o){var l=this.querySelector(lt.labelItem.class),u=Ck(this,o,e,a,t),c=yH(l,u,n.update),h=Ak(o,e,t),d=h.x,f=h.y,g=qr(this,{transform:"translate(".concat(d,", ").concat(f,")")},n.update);return Ee(Ee([],q(c),!1),[g],!1)}).call(function(o){var l=Bn(o,"_transitions").flat().filter(GN);pH(l,function(){Pk.call(r,t)})})},function(s){return s.transition(function(){var o=this,l=Gh(this.childNodes[0],n.exit);return eo(l,function(){return Ae(o).remove()}),l})}).transitions()}function fR(r,e){return Fb(r,e.tickDirection,e)}function cY(r,e){var t=q(r,2),n=t[0],i=t[1];return[[0,0],[n*e,i*e]]}function hY(r,e,t,n,i){var a=i.tickLength,s=q(cY(n,Tr(a,[r,e,t])),2),o=q(s[0],2),l=o[0],u=o[1],c=q(s[1],2),h=c[0],d=c[1];return{x1:l,x2:h,y1:u,y2:d}}function dY(r,e,t,n,i){var a=i.tickFormatter,s=fR(e.value,i),o="line";return Te(a)&&(o=function(){return Tr(a,[e,t,n,s])}),r.append(o).attr("className",lt.tickItem.name)}function fY(r,e,t,n,i,a,s){var o=fR(r.value,a),l=hY(r,e,t,o,a),u=l.x1,c=l.x2,h=l.y1,d=l.y2,f=q(Di(aR(s,[r,e,t,o])),2),g=f[0],v=f[1];n.node().nodeName==="line"&&n.styles(ce({x1:u,x2:c,y1:h,y2:d},g)),i.attr(v),n.styles(g)}function Nk(r,e,t,n,i,a){var s=dY(Ae(this),r,e,t,n);fY(r,e,t,s,this,n,i);var o=q(Vh(r.value,n),2),l=o[0],u=o[1];return qr(this,{transform:"translate(".concat(l,", ").concat(u,")")},a)}function gY(r,e,t,n){var i=Db(e,t.tickFilter),a=ze(t,"tick");return r.selectAll(lt.tick.class).data(i,function(s){return s.id||s.label}).join(function(s){return s.append("g").attr("className",lt.tick.name).transition(function(o,l){return Nk.call(this,o,l,i,t,a,!1)})},function(s){return s.transition(function(o,l){return this.removeChildren(),Nk.call(this,o,l,i,t,a,n.update)})},function(s){return s.transition(function(){var o=this,l=Gh(this.childNodes[0],n.exit);return eo(l,function(){return o.remove()}),l})}).transitions()}var Rk=Hr({text:"text"},"title");function Hh(r){return/\S+-\S+/g.test(r)?r.split("-").map(function(e){return e[0]}):r.length>2?[r[0]]:r.split("")}function pY(r,e){var t=r.attributes,n=t.position,i=t.spacing,a=t.inset,s=t.text,o=r.getBBox(),l=e.getBBox(),u=Hh(n),c=q(On(s?i:0),4),h=c[0],d=c[1],f=c[2],g=c[3],v=q(On(a),4),p=v[0],y=v[1],m=v[2],w=v[3],S=q([g+d,h+f],2),_=S[0],O=S[1],T=q([w+y,p+m],2),k=T[0],P=T[1];if(u[0]==="l")return new qn(o.x,o.y,l.width+o.width+_+k,Math.max(l.height+P,o.height));if(u[0]==="t")return new qn(o.x,o.y,Math.max(l.width+k,o.width),l.height+o.height+O+P);var C=q([e.attributes.width||l.width,e.attributes.height||l.height],2),N=C[0],L=C[1];return new qn(l.x,l.y,N+o.width+_+k,L+o.height+O+P)}function vY(r,e){var t=Object.entries(e).reduce(function(n,i){var a=q(i,2),s=a[0],o=a[1],l=r.node().attr(s);return l||(n[s]=o),n},{});r.styles(t)}function yY(r){var e,t,n,i,a=r,s=a.width,o=a.height,l=a.position,u=q([+s/2,+o/2],2),c=u[0],h=u[1],d=q([+c,+h,"center","middle"],4),f=d[0],g=d[1],v=d[2],p=d[3],y=Hh(l);return y.includes("l")&&(e=q([0,"start"],2),f=e[0],v=e[1]),y.includes("r")&&(t=q([+s,"end"],2),f=t[0],v=t[1]),y.includes("t")&&(n=q([0,"top"],2),g=n[0],p=n[1]),y.includes("b")&&(i=q([+o,"bottom"],2),g=i[0],p=i[1]),{x:f,y:g,textAlign:v,textBaseline:p}}var mY=function(r){Xe(e,r);function e(t){return r.call(this,t,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return e.prototype.getAvailableSpace=function(){var t=this,n=this.attributes,i=n.width,a=n.height,s=n.position,o=n.spacing,l=n.inset,u=t.querySelector(Rk.text.class);if(!u)return new qn(0,0,+i,+a);var c=u.getBBox(),h=c.width,d=c.height,f=q(On(o),4),g=f[0],v=f[1],p=f[2],y=f[3],m=q([0,0,+i,+a],4),w=m[0],S=m[1],_=m[2],O=m[3],T=Hh(s);if(T.includes("i"))return new qn(w,S,_,O);T.forEach(function(U,$){var j,Z,ne,oe;U==="t"&&(j=q($===0?[d+p,+a-d-p]:[0,+a],2),S=j[0],O=j[1]),U==="r"&&(Z=q([+i-h-y],1),_=Z[0]),U==="b"&&(ne=q([+a-d-g],1),O=ne[0]),U==="l"&&(oe=q($===0?[h+v,+i-h-v]:[0,+i],2),w=oe[0],_=oe[1])});var k=q(On(l),4),P=k[0],C=k[1],N=k[2],L=k[3],F=q([L+C,P+N],2),G=F[0],V=F[1];return new qn(w+L,S+P,_-G,O-V)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new qn(0,0,0,0)},e.prototype.render=function(t,n){var i=this;t.width,t.height,t.position,t.spacing;var a=$t(t,["width","height","position","spacing"]),s=q(Di(a),1),o=s[0],l=yY(t),u=l.x,c=l.y,h=l.textAlign,d=l.textBaseline;fr(!!a.text,Ae(n),function(f){i.title=f.maybeAppendByClassName(Rk.text,"text").styles(o).call(vY,{x:u,y:c,textAlign:h,textBaseline:d}).node()})},e}(Gt);function bY(r,e,t){var n=t.titlePosition,i=n===void 0?"lb":n,a=t.titleSpacing,s=Hh(i),o=r.node().getLocalBounds(),l=q(o.min,2),u=l[0],c=l[1],h=q(o.halfExtents,2),d=h[0],f=h[1],g=q(e.node().getLocalBounds().halfExtents,2),v=g[0],p=g[1],y=q([u+d,c+f],2),m=y[0],w=y[1],S=q(On(a),4),_=S[0],O=S[1],T=S[2],k=S[3];if(["start","end"].includes(i)&&t.type==="linear"){var P=t.startPos,C=t.endPos,N=q(i==="start"?[P,C]:[C,P],2),L=N[0],F=N[1],G=HN([-F[0]+L[0],-F[1]+L[1]]),V=q(ki(G,_),2),U=V[0],$=V[1];return{x:L[0]+U,y:L[1]+$}}return s.includes("t")&&(w-=f+p+_),s.includes("r")&&(m+=d+v+O),s.includes("l")&&(m-=d+v+k),s.includes("b")&&(w+=f+p+T),{x:m,y:w}}function wY(r,e,t){var n=r.getGeometryBounds().halfExtents,i=n[1]*2;if(e==="vertical"){if(t==="left")return"rotate(-90) translate(0, ".concat(i/2,")");if(t==="right")return"rotate(-90) translate(0, -".concat(i/2,")")}return""}function Lk(r,e,t,n,i){var a=ze(n,"title"),s=q(Di(a),2),o=s[0],l=s[1],u=l.transform,c=l.transformOrigin,h=$t(l,["transform","transformOrigin"]);e.styles(h);var d=u||wY(r.node(),o.direction,o.position);r.styles(ce(ce({},o),{transformOrigin:c})),YN(r.node(),d);var f=bY(Ae(t._offscreen||t.querySelector(lt.mainGroup.class)),e,n),g=f.x,v=f.y,p=qr(e.node(),{transform:"translate(".concat(g,", ").concat(v,")")},i);return p}function xY(r,e,t,n){var i=t.titleText;return r.selectAll(lt.title.class).data([{title:i}].filter(function(a){return!!a.title}),function(a,s){return a.title}).join(function(a){return a.append(function(){return Ii(i)}).attr("className",lt.title.name).transition(function(){return Lk(Ae(this),r,e,t,n.enter)})},function(a){return a.transition(function(){return Lk(Ae(this),r,e,t,n.update)})},function(a){return a.remove()}).transitions()}function Ik(r,e,t,n){var i=r.showLine,a=r.showTick,s=r.showLabel,o=e.maybeAppendByClassName(lt.lineGroup,"g"),l=fr(i,o,function(f){return IH(f,r,n)})||[],u=e.maybeAppendByClassName(lt.tickGroup,"g"),c=fr(a,u,function(f){return gY(f,t,r,n)})||[],h=e.maybeAppendByClassName(lt.labelGroup,"g"),d=fr(s,h,function(f){return uY(f,t,r,n)})||[];return Ee(Ee(Ee([],q(l),!1),q(c),!1),q(d),!1).filter(function(f){return!!f})}var EY=function(r){Xe(e,r);function e(t){return r.call(this,t,Ib)||this}return e.prototype.render=function(t,n,i){var a=this,s=t.titleText,o=t.data,l=t.animate,u=t.showTitle,c=t.showGrid,h=t.dataThreshold,d=t.truncRange,f=rU(o,h).filter(function(_){var O=_.value;return!(d&&O>d[0]&&O<d[1])}),g=Mk(i===void 0?l:i),v=Ae(n).maybeAppendByClassName(lt.gridGroup,"g"),p=fr(c,v,function(_){return zH(_,f,t,g)})||[],y=Ae(n).maybeAppendByClassName(lt.mainGroup,"g");s&&(!this.initialized&&g.enter||this.initialized&&g.update)&&Ik(t,Ae(this.offscreenGroup),f,Mk(!1));var m=Ik(t,Ae(y.node()),f,g),w=Ae(n).maybeAppendByClassName(lt.titleGroup,"g"),S=fr(u,w,function(_){return xY(_,a,t,g)})||[];return Ee(Ee(Ee([],q(p),!1),q(m),!1),q(S),!1).flat().filter(function(_){return!!_})},e}(Gt),_r=Hr({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),SY=function(r){Xe(e,r);function e(t){var n=r.call(this,t,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:RU(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(i,a){return"".concat(i,"/").concat(a)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return n.playState="idle",n.contentGroup=n.appendChild(new hn({class:_r.contentGroup.name})),n.playWindow=n.contentGroup.appendChild(new hn({class:_r.playWindow.name})),n.innerCurrPage=n.defaultPage,n}return Object.defineProperty(e.prototype,"defaultPage",{get:function(){var t=this.attributes.defaultPage;return Bt(t,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var t=this.pageViews,n=q(gU(t.map(function(h){var d=h.getBBox(),f=d.width,g=d.height;return[f,g]})).map(function(h){return Math.max.apply(Math,Ee([],q(h),!1))}),2),i=n[0],a=n[1],s=this.attributes,o=s.pageWidth,l=o===void 0?i:o,u=s.pageHeight,c=u===void 0?a:u;return{pageWidth:l,pageHeight:c}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t=r.prototype.getBBox.call(this),n=t.x,i=t.y,a=this.controllerShape,s=this.pageShape,o=s.pageWidth,l=s.pageHeight;return new qn(n,i,o+a.width,l)},e.prototype.goTo=function(t){var n=this,i=this.attributes.animate,a=this,s=a.currPage,o=a.playState,l=a.playWindow,u=a.pageViews;if(o!=="idle"||t<0||u.length<=0||t>=u.length)return null;u[s].setLocalPosition(0,0),this.prepareFollowingPage(t);var c=q(this.getFollowingPageDiff(t),2),h=c[0],d=c[1];this.playState="running";var f=eR(l,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-h,", ").concat(-d,")")}],i);return eo(f,function(){n.innerCurrPage=t,n.playState="idle",n.setVisiblePages([t]),n.updatePageInfo()}),f},e.prototype.prev=function(){var t=this.attributes.loop,n=this.pageViews.length,i=this.currPage;if(!t&&i<=0)return null;var a=t?(i-1+n)%n:Bt(i-1,0,n);return this.goTo(a)},e.prototype.next=function(){var t=this.attributes.loop,n=this.pageViews.length,i=this.currPage;if(!t&&i>=n-1)return null;var a=t?(i+1)%n:Bt(i+1,0,n);return this.goTo(a)},e.prototype.renderClipPath=function(t){var n=this.pageShape,i=n.pageWidth,a=n.pageHeight;if(!i||!a){this.contentGroup.style.clipPath=void 0;return}this.clipPath=t.maybeAppendByClassName(_r.clipPath,"rect").styles({width:i,height:a}),this.contentGroup.attr("clipPath",this.clipPath.node())},e.prototype.setVisiblePages=function(t){this.playWindow.children.forEach(function(n,i){t.includes(i)?Sl(n):jr(n)})},e.prototype.adjustControllerLayout=function(){var t=this,n=t.prevBtnGroup,i=t.nextBtnGroup,a=t.pageInfoGroup,s=this.attributes,o=s.orientation,l=s.controllerPadding,u=a.getBBox(),c=u.width;u.height;var h=q(o==="horizontal"?[-180,0]:[-90,90],2),d=h[0],f=h[1];n.setLocalEulerAngles(d),i.setLocalEulerAngles(f);var g=n.getBBox(),v=g.width,p=g.height,y=i.getBBox(),m=y.width,w=y.height,S=Math.max(v,c,m),_=o==="horizontal"?{offset:[[0,0],[v/2+l,0],[v+c+l*2,0]],textAlign:"start"}:{offset:[[S/2,-p-l],[S/2,0],[S/2,w+l]],textAlign:"center"},O=q(_.offset,3),T=q(O[0],2),k=T[0],P=T[1],C=q(O[1],2),N=C[0],L=C[1],F=q(O[2],2),G=F[0],V=F[1],U=_.textAlign,$=a.querySelector("text");$&&($.style.textAlign=U),n.setLocalPosition(k,P),a.setLocalPosition(N,L),i.setLocalPosition(G,V)},e.prototype.updatePageInfo=function(){var t,n=this,i=n.currPage,a=n.pageViews,s=n.attributes.formatter;a.length<2||((t=this.pageInfoGroup.querySelector(_r.pageInfo.class))===null||t===void 0||t.attr("text",s(i+1,a.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(t){var n=this.currPage;if(n===t)return[0,0];var i=this.attributes.orientation,a=this.pageShape,s=a.pageWidth,o=a.pageHeight,l=t<n?-1:1;return i==="horizontal"?[l*s,0]:[0,l*o]},e.prototype.prepareFollowingPage=function(t){var n=this,i=n.currPage,a=n.pageViews;if(this.setVisiblePages([t,i]),t!==i){var s=q(this.getFollowingPageDiff(t),2),o=s[0],l=s[1];a[t].setLocalPosition(o,l)}},e.prototype.renderController=function(t){var n=this,i=this.attributes.controllerSpacing,a=this.pageShape,s=a.pageWidth,o=a.pageHeight,l=this.pageViews.length>=2,u=t.maybeAppendByClassName(_r.controller,"g");if($h(u.node(),l),!!l){var c=ze(this.attributes,"button"),h=ze(this.attributes,"pageNum"),d=q(Di(c),2),f=d[0],g=d[1],v=f.size,p=$t(f,["size"]),y=!u.select(_r.prevBtnGroup.class).node(),m=u.maybeAppendByClassName(_r.prevBtnGroup,"g").styles(g);this.prevBtnGroup=m.node();var w=m.maybeAppendByClassName(_r.prevBtn,"path"),S=u.maybeAppendByClassName(_r.nextBtnGroup,"g").styles(g);this.nextBtnGroup=S.node();var _=S.maybeAppendByClassName(_r.nextBtn,"path");[w,_].forEach(function(T){T.styles(ce(ce({},p),{transformOrigin:"center"})),Ab(T.node(),v)});var O=u.maybeAppendByClassName(_r.pageInfoGroup,"g");this.pageInfoGroup=O.node(),O.maybeAppendByClassName(_r.pageInfo,"text").styles(h),this.updatePageInfo(),u.node().setLocalPosition(s+i,o/2),y&&(this.prevBtnGroup.addEventListener("click",function(){n.prev()}),this.nextBtnGroup.addEventListener("click",function(){n.next()}))}},e.prototype.render=function(t,n){var i=t.x,a=i===void 0?0:i,s=t.y,o=s===void 0?0:s;this.attr("transform","translate(".concat(a,", ").concat(o,")"));var l=Ae(n);this.renderClipPath(l),this.renderController(l),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var t=this,n=rl(function(){return t.render(t.attributes,t)},50);this.playWindow.addEventListener(Ke.INSERTED,n),this.playWindow.addEventListener(Ke.REMOVED,n)},e}(Gt);function _Y(r,e,t){var n=1.4,i=n*t;return[["M",r-t,e-i],["L",r+t,e-i],["L",r+t,e+i],["L",r-t,e+i],["Z"]]}var gR=1.4,pR=.4;function MY(r,e,t){var n=t,i=n*gR,a=n/2,s=n/6,o=r+i*pR;return[["M",r,e],["L",o,e+a],["L",r+i,e+a],["L",r+i,e-a],["L",o,e-a],["Z"],["M",o,e+s],["L",r+i-2,e+s],["M",o,e-s],["L",r+i-2,e-s]]}function OY(r,e,t){var n=t,i=n*gR,a=n/2,s=n/6,o=e+i*pR;return[["M",r,e],["L",r-a,o],["L",r-a,e+i],["L",r+a,e+i],["L",r+a,o],["Z"],["M",r-s,o],["L",r-s,e+i-2],["M",r+s,o],["L",r+s,e+i-2]]}ht.registerSymbol("hiddenHandle",_Y);ht.registerSymbol("verticalHandle",MY);ht.registerSymbol("horizontalHandle",OY);function l1(r,e,t){return r===void 0&&(r="horizontal"),r==="horizontal"?e:t}var ar=Hr({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item");function kY(r){var e=r.querySelector(ar.marker.class);return e?e.style:{}}var TY=function(r){Xe(e,r);function e(t){return r.call(this,t,{span:[1,1],marker:function(){return new Fi({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return Object.defineProperty(e.prototype,"showValue",{get:function(){var t=this.attributes.valueText;return t?typeof t=="string"||typeof t=="number"?t!=="":typeof t=="function"?!0:t.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var t=this.labelGroup,n=this.valueGroup,i=this.attributes.markerSize,a=t.node().getBBox(),s=a.width,o=a.height,l=n.node().getBBox(),u=l.width,c=l.height;return{markerWidth:i,labelWidth:s,valueWidth:u,height:Math.max(i,o,c)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var t=this.attributes.span;if(!t)return[1,1];var n=q(On(t),2),i=n[0],a=n[1],s=this.showValue?a:0,o=i+s;return[i/o,s/o]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t,n=this.attributes,i=n.markerSize,a=n.width,s=this.actualSpace,o=s.markerWidth,l=s.height,u=this.actualSpace,c=u.labelWidth,h=u.valueWidth,d=q(this.spacing,2),f=d[0],g=d[1];if(a){var v=a-i-f-g,p=q(this.span,2),y=p[0],m=p[1];t=q([y*v,m*v],2),c=t[0],h=t[1]}var w=o+c+h+f+g;return{width:w,height:l,markerWidth:o,labelWidth:c,valueWidth:h}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var t=this.attributes.spacing;if(!t)return[0,0];var n=q(On(t),2),i=n[0],a=n[1];return this.showValue?[i,a]:[i,0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var t=this.shape,n=t.markerWidth,i=t.labelWidth,a=t.valueWidth,s=t.width,o=t.height,l=q(this.spacing,2),u=l[0],c=l[1];return{height:o,width:s,markerWidth:n,labelWidth:i,valueWidth:a,position:[n/2,n+u,n+i+u+c]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var t=kY(this.markerGroup.node()),n=this.attributes,i=n.markerSize,a=n.markerStrokeWidth,s=a===void 0?t.strokeWidth:a,o=n.markerLineWidth,l=o===void 0?t.lineWidth:o,u=n.markerStroke,c=u===void 0?t.stroke:u,h=+(s||l||(c?1:0))*Math.sqrt(2),d=this.markerGroup.node().getBBox(),f=d.width,g=d.height;return(1-h/Math.max(f,g))*i},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(t){var n=this,i=this.attributes.marker,a=ze(this.attributes,"marker");this.markerGroup=t.maybeAppendByClassName(ar.markerGroup,"g").style("zIndex",0),fr(!!i,this.markerGroup,function(){var s,o=n.markerGroup.node(),l=(s=o.childNodes)===null||s===void 0?void 0:s[0],u=typeof i=="string"?new ht({style:{symbol:i},className:ar.marker.name}):i();l?u.nodeName===l.nodeName?l instanceof ht?l.update(ce(ce({},a),{symbol:i})):(uU(l,u),Ae(l).styles(a)):(l.remove(),Ae(u).attr("className",ar.marker.name).styles(a),o.appendChild(u)):(u instanceof ht||Ae(u).attr("className",ar.marker.name).styles(a),o.appendChild(u)),n.markerGroup.node().scale(1/n.markerGroup.node().getScale()[0]);var c=Ab(n.markerGroup.node(),n.scaleSize);n.markerGroup.node().style._transform="scale(".concat(c,")")})},e.prototype.renderLabel=function(t){var n=ze(this.attributes,"label"),i=n.text,a=$t(n,["text"]);this.labelGroup=t.maybeAppendByClassName(ar.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(ar.label,function(){return Ii(i)}).styles(a)},e.prototype.renderValue=function(t){var n=this,i=ze(this.attributes,"value"),a=i.text,s=$t(i,["text"]);this.valueGroup=t.maybeAppendByClassName(ar.valueGroup,"g").style("zIndex",0),fr(this.showValue,this.valueGroup,function(){n.valueGroup.maybeAppendByClassName(ar.value,function(){return Ii(a)}).styles(s)})},e.prototype.renderBackground=function(t){var n=this.shape,i=n.width,a=n.height,s=ze(this.attributes,"background");this.background=t.maybeAppendByClassName(ar.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(ar.background,"rect").styles(ce({width:i,height:a},s))},e.prototype.adjustLayout=function(){var t=this.layout,n=t.labelWidth,i=t.valueWidth,a=t.height,s=q(t.position,3),o=s[0],l=s[1],u=s[2],c=a/2;this.markerGroup.styles({transform:"translate(".concat(o,", ").concat(c,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(l,", ").concat(c,")")}),n1(this.labelGroup.select(ar.label.class).node(),Math.ceil(n)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(u,", ").concat(c,")")}),n1(this.valueGroup.select(ar.value.class).node(),Math.ceil(i)))},e.prototype.render=function(t,n){var i=Ae(n),a=t.x,s=a===void 0?0:a,o=t.y,l=o===void 0?0:o;i.styles({transform:"translate(".concat(s,", ").concat(l,")")}),this.renderMarker(i),this.renderLabel(i),this.renderValue(i),this.renderBackground(i),this.adjustLayout()},e}(Gt),ka=Hr({page:"item-page",navigator:"navigator",item:"item"},"items"),Dk=function(r,e,t){return t===void 0&&(t=!0),r?e(r):t},AY=function(r){Xe(e,r);function e(t){var n=r.call(this,t,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:wd,mouseenter:wd,mouseleave:wd})||this;return n.navigatorShape=[0,0],n}return Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var t=this.attributes,n=t.gridRow,i=t.gridCol,a=t.data;if(!n&&!i)throw new Error("gridRow and gridCol can not be set null at the same time");return n&&i?[n,i]:n?[n,a.length]:[a.length,i]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var t=this.attributes,n=t.data,i=t.layout,a=ze(this.attributes,"item"),s=n.map(function(o,l){var u=o.id,c=u===void 0?l:u,h=o.label,d=o.value;return{id:"".concat(c),index:l,style:ce({layout:i,labelText:h,valueText:d},Object.fromEntries(Object.entries(a).map(function(f){var g=q(f,2),v=g[0],p=g[1];return[v,Tr(p,[o,l,n])]})))}});return s},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var t=this,n=this.attributes,i=n.orientation,a=n.width,s=n.rowPadding,o=n.colPadding,l=q(this.navigatorShape,1),u=l[0],c=q(this.grid,2),h=c[0],d=c[1],f=d*h,g=0;return this.pageViews.children.map(function(v,p){var y,m,w=Math.floor(p/f),S=p%f,_=t.ifHorizontal(d,h),O=[Math.floor(S/_),S%_];i==="vertical"&&O.reverse();var T=q(O,2),k=T[0],P=T[1],C=(a-u-(d-1)*o)/d,N=v.getBBox().height,L=q([0,0],2),F=L[0],G=L[1];return i==="horizontal"?(y=q([g,k*(N+s)],2),F=y[0],G=y[1],g=P===d-1?0:g+C+o):(m=q([P*(C+o),g],2),F=m[0],G=m[1],g=k===h-1?0:g+N+s),{page:w,index:p,row:k,col:P,pageIndex:S,width:C,height:N,x:F,y:G}})},e.prototype.getFlexLayout=function(){var t=this.attributes,n=t.width,i=t.height,a=t.rowPadding,s=t.colPadding,o=q(this.navigatorShape,1),l=o[0],u=q(this.grid,2),c=u[0],h=u[1],d=q([n-l,i],2),f=d[0],g=d[1],v=q([0,0,0,0,0,0,0,0],8),p=v[0],y=v[1],m=v[2],w=v[3],S=v[4],_=v[5],O=v[6],T=v[7];return this.pageViews.children.map(function(k,P){var C,N,L,F,G=k.getBBox(),V=G.width,U=G.height,$=O===0?0:s,j=O+$+V;if(j<=f&&Dk(S,function(ne){return ne<h}))return C=q([O+$,T,j],3),p=C[0],y=C[1],O=C[2],{width:V,height:U,x:p,y,page:m,index:P,pageIndex:w++,row:_,col:S++};N=q([_+1,0,0,T+U+a],4),_=N[0],S=N[1],O=N[2],T=N[3];var Z=T+U;return Z<=g&&Dk(_,function(ne){return ne<c})?(L=q([O,T,V],3),p=L[0],y=L[1],O=L[2],{width:V,height:U,x:p,y,page:m,index:P,pageIndex:w++,row:_,col:S++}):(F=q([0,0,V,0,m+1,0,0,0],8),p=F[0],y=F[1],O=F[2],T=F[3],m=F[4],w=F[5],_=F[6],S=F[7],{width:V,height:U,x:p,y,page:m,index:P,pageIndex:w++,row:_,col:S++})})},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var t=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,n=t.call(this);return n.slice(-1)[0].page>0?(this.navigatorShape=[55,0],t.call(this)):n},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,n){var i=this.attributes.orientation;return l1(i,t,n)},e.prototype.flattenPage=function(t){t.querySelectorAll(ka.item.class).forEach(function(n){t.appendChild(n)}),t.querySelectorAll(ka.page.class).forEach(function(n){var i=t.removeChild(n);i.destroy()})},e.prototype.renderItems=function(t){var n=this.attributes,i=n.click,a=n.mouseenter,s=n.mouseleave;this.flattenPage(t);var o=this.dispatchCustomEvent.bind(this);Ae(t).selectAll(ka.item.class).data(this.renderData,function(l){return l.id}).join(function(l){return l.append(function(u){var c=u.style;return new TY({style:c})}).attr("className",ka.item.name).on("click",function(){i==null||i(this),o("itemClick",{item:this})}).on("pointerenter",function(){a==null||a(this),o("itemMouseenter",{item:this})}).on("pointerleave",function(){s==null||s(this),o("itemMouseleave",{item:this})})},function(l){return l.each(function(u){var c=u.style;this.update(c)})},function(l){return l.remove()})},e.prototype.relayoutNavigator=function(){var t,n=this.attributes,i=n.layout,a=n.width,s=((t=this.pageViews.children[0])===null||t===void 0?void 0:t.getBBox().height)||0,o=q(this.navigatorShape,2),l=o[0],u=o[1];this.navigator.update(i==="grid"?{pageWidth:a-l,pageHeight:s-u}:{})},e.prototype.adjustLayout=function(){var t=this,n=Object.entries(H7(this.itemsLayout,"page")).map(function(a){var s=q(a,2),o=s[0],l=s[1];return{page:o,layouts:l}}),i=Ee([],q(this.navigator.getContainer().children),!1);n.forEach(function(a){var s=a.layouts,o=t.pageViews.appendChild(new hn({className:ka.page.name}));s.forEach(function(l){var u=l.x,c=l.y,h=l.index,d=l.width,f=l.height,g=i[h];o.appendChild(g),Bo(g,"__layout__",l),g.update({x:u,y:c,width:d,height:f})})}),this.relayoutNavigator()},e.prototype.renderNavigator=function(t){var n=this.attributes.orientation,i=ze(this.attributes,"nav"),a=yn({orientation:n},i),s=this;return t.selectAll(ka.navigator.class).data(["nav"]).join(function(o){return o.append(function(){return new SY({style:a})}).attr("className",ka.navigator.name).each(function(){s.navigator=this})},function(o){return o.each(function(){this.update(a)})},function(o){return o.remove()}),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(t,n){var i=this.attributes.data;if(!(!i||i.length===0)){var a=this.renderNavigator(Ae(n));this.renderItems(a.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(t,n){var i=new Jt(t,{detail:n});this.dispatchEvent(i)},e}(Gt),fo=Hr({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),vR={showLabel:!0,formatter:function(r){return r.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0};(function(r){Xe(e,r);function e(t){return r.call(this,t,vR)||this}return e.prototype.render=function(t,n){var i=Ae(n).maybeAppendByClassName(fo.markerGroup,"g");this.renderMarker(i);var a=Ae(n).maybeAppendByClassName(fo.labelGroup,"g");this.renderLabel(a)},e.prototype.renderMarker=function(t){var n=this,i=this.attributes,a=i.orientation,s=i.markerSymbol,o=s===void 0?l1(a,"horizontalHandle","verticalHandle"):s;fr(!!o,t,function(l){var u=ze(n.attributes,"marker"),c=ce({symbol:o},u);n.marker=l.maybeAppendByClassName(fo.marker,function(){return new ht({style:c})}).update(c)})},e.prototype.renderLabel=function(t){var n=this,i=this.attributes,a=i.showLabel,s=i.orientation,o=i.spacing,l=o===void 0?0:o,u=i.formatter;fr(a,t,function(c){var h,d=ze(n.attributes,"label"),f=d.text,g=$t(d,["text"]),v=((h=c.select(fo.marker.class))===null||h===void 0?void 0:h.node().getBBox())||{},p=v.width,y=p===void 0?0:p,m=v.height,w=m===void 0?0:m,S=q(l1(s,[0,w+l,"center","top"],[y+l,0,"start","middle"]),4),_=S[0],O=S[1],T=S[2],k=S[3];c.maybeAppendByClassName(fo.label,"text").styles(ce(ce({},g),{x:_,y:O,text:u(f).toString(),textAlign:T,textBaseline:k}))})},e})(Gt);var yR={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},PY=yn({},yR,{});yn({},yR,_s(vR,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"});var go=Hr({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend"),CY=function(r){Xe(e,r);function e(t){return r.call(this,t,PY)||this}return e.prototype.renderTitle=function(t,n,i){var a=this.attributes,s=a.showTitle,o=a.titleText,l=ze(this.attributes,"title"),u=q(Di(l),2),c=u[0],h=u[1];this.titleGroup=t.maybeAppendByClassName(go.titleGroup,"g").styles(h);var d=ce(ce({width:n,height:i},c),{text:s?o:""});this.title=this.titleGroup.maybeAppendByClassName(go.title,function(){return new mY({style:d})}).update(d)},e.prototype.renderItems=function(t,n){var i=n.x,a=n.y,s=n.width,o=n.height,l=ze(this.attributes,"title",!0),u=q(Di(l),2),c=u[0],h=u[1],d=ce(ce({},c),{width:s,height:o,x:0,y:0});this.itemsGroup=t.maybeAppendByClassName(go.itemsGroup,"g").styles(ce(ce({},h),{transform:"translate(".concat(i,", ").concat(a,")")}));var f=this;this.itemsGroup.selectAll(go.items.class).data(["items"]).join(function(g){return g.append(function(){return new AY({style:d})}).attr("className",go.items.name).each(function(){f.items=Ae(this)})},function(g){return g.update(d)},function(g){return g.remove()})},e.prototype.adjustLayout=function(){var t=this.attributes.showTitle;if(t){var n=this.title.node().getAvailableSpace(),i=n.x,a=n.y;this.itemsGroup.node().style.transform="translate(".concat(i,", ").concat(a,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,n=t.showTitle,i=t.width,a=t.height;return n?this.title.node().getAvailableSpace():new qn(0,0,i,a)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t,n,i=(t=this.title)===null||t===void 0?void 0:t.node(),a=(n=this.items)===null||n===void 0?void 0:n.node();return!i||!a?r.prototype.getBBox.call(this):pY(i,a)},e.prototype.render=function(t,n){var i=this.attributes,a=i.width,s=i.height,o=i.x,l=o===void 0?0:o,u=i.y,c=u===void 0?0:u,h=Ae(n);n.style.transform="translate(".concat(l,", ").concat(c,")"),this.renderTitle(h,a,s),this.renderItems(h,this.availableSpace),this.adjustLayout()},e}(Gt),NY={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(r){return r.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},Xy=Hr({background:"background",labelGroup:"label-group",label:"label"},"indicator"),RY=function(r){Xe(e,r);function e(t){var n=r.call(this,t,NY)||this;return n.point=[0,0],n.group=n.appendChild(new hn({})),n.isMutationObserved=!0,n}return e.prototype.renderBackground=function(){if(this.label){var t=this.attributes,n=t.position,i=t.padding,a=q(On(i),4),s=a[0],o=a[1],l=a[2],u=a[3],c=this.label.node().getLocalBounds(),h=c.min,d=c.max,f=new qn(h[0]-u,h[1]-s,d[0]+o-h[0]+u,d[1]+l-h[1]+s),g=this.getPath(n,f),v=ze(this.attributes,"background");this.background=Ae(this.group).maybeAppendByClassName(Xy.background,"path").styles(ce(ce({},v),{d:g})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var t=this.attributes,n=t.formatter,i=t.labelText,a=ze(this.attributes,"label"),s=q(Di(a),2),o=s[0],l=s[1];o.text;var u=$t(o,["text"]);if(this.label=Ae(this.group).maybeAppendByClassName(Xy.labelGroup,"g").styles(l),!!i){var c=this.label.maybeAppendByClassName(Xy.label,function(){return Ii(n(i))}).style("text",n(i).toString());c.selectAll("text").styles(u)}},e.prototype.adjustLayout=function(){var t=q(this.point,2),n=t[0],i=t[1],a=this.attributes,s=a.x,o=a.y;this.group.attr("transform","translate(".concat(s-n,", ").concat(o-i,")"))},e.prototype.getPath=function(t,n){var i=this.attributes.radius,a=n.x,s=n.y,o=n.width,l=n.height,u=[["M",a+i,s],["L",a+o-i,s],["A",i,i,0,0,1,a+o,s+i],["L",a+o,s+l-i],["A",i,i,0,0,1,a+o-i,s+l],["L",a+i,s+l],["A",i,i,0,0,1,a,s+l-i],["L",a,s+i],["A",i,i,0,0,1,a+i,s],["Z"]],c={top:4,right:6,bottom:0,left:2},h=c[t],d=this.createCorner([u[h].slice(-2),u[h+1].slice(-2)]);return u.splice.apply(u,Ee([h+1,1],q(d),!1)),u[0][0]="M",u},e.prototype.createCorner=function(t,n){n===void 0&&(n=10);var i=.8,a=lU.apply(void 0,Ee([],q(t),!1)),s=q(t,2),o=q(s[0],2),l=o[0],u=o[1],c=q(s[1],2),h=c[0],d=c[1],f=q(a?[h-l,[l,h]]:[d-u,[u,d]],2),g=f[0],v=q(f[1],2),p=v[0],y=v[1],m=g/2,w=g/Math.abs(g),S=n*w,_=S/2,O=S*Math.sqrt(3)/2*i,T=q([p,p+m-_,p+m,p+m+_,y],5),k=T[0],P=T[1],C=T[2],N=T[3],L=T[4];return a?(this.point=[C,u-O],[["L",k,u],["L",P,u],["L",C,u-O],["L",N,u],["L",L,u]]):(this.point=[l+O,C],[["L",l,k],["L",l,P],["L",l+O,C],["L",l,N],["L",l,L]])},e.prototype.applyVisibility=function(){var t=this.attributes.visibility;t==="hidden"?jr(this):Sl(this)},e.prototype.bindEvents=function(){this.label.on(Ke.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}(Gt);function u1(r){return r===void 0&&(r=""),{CONTAINER:"".concat(r,"tooltip"),TITLE:"".concat(r,"tooltip-title"),LIST:"".concat(r,"tooltip-list"),LIST_ITEM:"".concat(r,"tooltip-list-item"),NAME:"".concat(r,"tooltip-list-item-name"),MARKER:"".concat(r,"tooltip-list-item-marker"),NAME_LABEL:"".concat(r,"tooltip-list-item-name-label"),VALUE:"".concat(r,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(r,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(r,"tooltip-crosshair-y")}}var Fk={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function LY(r){var e;r===void 0&&(r="");var t=u1(r);return e={},e[".".concat(t.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},e[".".concat(t.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},e[".".concat(t.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},e[".".concat(t.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},e[".".concat(t.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},e[".".concat(t.NAME)]={display:"flex","align-items":"center","max-width":"216px"},e[".".concat(t.NAME_LABEL)]=ce({flex:1},Fk),e[".".concat(t.VALUE)]=ce({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},Fk),e[".".concat(t.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e[".".concat(t.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e}var IY=function(r){Xe(e,r);function e(t){var n=this,i,a,s=(a=(i=t.style)===null||i===void 0?void 0:i.template)===null||a===void 0?void 0:a.prefixCls,o=u1(s);return n=r.call(this,t,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(o.CONTAINER,'"></div>'),title:'<div class="'.concat(o.TITLE,'"></div>'),item:'<li class="'.concat(o.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(o.NAME,`">
          <span class="`).concat(o.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(o.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(o.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:LY(s)})||this,n.timestamp=-1,n.prevCustomContentKey=n.attributes.contentKey,n.initShape(),n.render(n.attributes,n),n}return Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){var t=this.element.offsetWidth,n=this.element.offsetHeight;return{width:t,height:n}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var t=this.attributes,n=t.data,i=t.template;return n.map(function(a,s){var o=a.name,l=o===void 0?"":o,u=a.color,c=u===void 0?"black":u,h=a.index,d=$t(a,["name","color","index"]),f=ce({name:l,color:c,index:h??s},d);return vm(p3(i.item,f))})},enumerable:!1,configurable:!0}),e.prototype.render=function(t,n){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var t;(t=this.element)===null||t===void 0||t.remove(),r.prototype.destroy.call(this)},e.prototype.show=function(t,n){var i=this;if(t!==void 0&&n!==void 0){var a=this.element.style.visibility==="hidden",s=function(){i.attributes.x=t??i.attributes.x,i.attributes.y=n??i.attributes.y,i.updatePosition()};a?this.closeTransition(s):s()}this.element.style.visibility="visible"},e.prototype.hide=function(t,n){t===void 0&&(t=0),n===void 0&&(n=0);var i=this.attributes.enterable;i&&this.isCursorEntered(t,n)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var t=this.attributes.template;this.element=vm(t.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var t=this.attributes.content;t&&(typeof t=="string"?this.element.innerHTML=t:ok(this.element,t))}},e.prototype.renderHTMLTooltipElement=function(){var t,n,i=this.attributes,a=i.template,s=i.title,o=i.enterable,l=i.style,u=i.content,c=u1(a.prefixCls),h=this.element;if(this.element.style.pointerEvents=o?"auto":"none",u)this.renderCustomContent();else{s?(h.innerHTML=a.title,h.getElementsByClassName(c.TITLE)[0].innerHTML=s):(n=(t=h.getElementsByClassName(c.TITLE))===null||t===void 0?void 0:t[0])===null||n===void 0||n.remove();var d=this.HTMLTooltipItemsElements,f=document.createElement("ul");f.className=c.LIST,ok(f,d);var g=this.element.querySelector(".".concat(c.LIST));g?g.replaceWith(f):h.appendChild(f)}dU(h,l)},e.prototype.getRelativeOffsetFromCursor=function(t){var n=this.attributes,i=n.position,a=n.offset,s=t||i,o=s.split("-"),l={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},u=this.elementSize,c=u.width,h=u.height,d=[-c/2,-h/2];return o.forEach(function(f){var g=q(d,2),v=g[0],p=g[1],y=q(l[f],2),m=y[0],w=y[1];d=[v+(c/2+a[0])*m,p+(h/2+a[1])*w]}),d},e.prototype.setOffsetPosition=function(t){var n=q(t,2),i=n[0],a=n[1],s=this.attributes,o=s.x,l=o===void 0?0:o,u=s.y,c=u===void 0?0:u,h=s.container,d=h.x,f=h.y;this.element.style.left="".concat(+l+d+i,"px"),this.element.style.top="".concat(+c+f+a,"px")},e.prototype.updatePosition=function(){var t=this.attributes.showDelay,n=t===void 0?60:t,i=Date.now();this.timestamp>0&&i-this.timestamp<n||(this.timestamp=i,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(t){var n=q(t,2),i=n[0],a=n[1],s=this.attributes,o=s.x,l=s.y,u=s.bounding,c=s.position;if(!u)return[i,a];var h=this.element,d=h.offsetWidth,f=h.offsetHeight,g=q([+o+i,+l+a],2),v=g[0],p=g[1],y={left:"right",right:"left",top:"bottom",bottom:"top"},m=u.x,w=u.y,S=u.width,_=u.height,O={left:v<m,right:v+d>m+S,top:p<w,bottom:p+f>w+_},T=[];c.split("-").forEach(function(P){O[P]?T.push(y[P]):T.push(P)});var k=T.join("-");return this.getRelativeOffsetFromCursor(k)},e.prototype.isCursorEntered=function(t,n){if(this.element){var i=this.element.getBoundingClientRect(),a=i.x,s=i.y,o=i.width,l=i.height;return new qn(a,s,o,l).isPointIn(t,n)}return!1},e.prototype.closeTransition=function(t){var n=this,i=this.element.style.transition;this.element.style.transition="none",t(),setTimeout(function(){n.element.style.transition=i},10)},e.tag="tooltip",e}(Gt),DY=function(r){Xe(e,r);function e(t){var n=r.call(this,yn({},e.defaultOptions,t))||this;return n.hoverColor="#f5f5f5",n.selectedColor="#e6f7ff",n.background=n.appendChild(new Mn({})),n.label=n.background.appendChild(new hn({})),n}return Object.defineProperty(e.prototype,"padding",{get:function(){return On(this.style.padding)},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(){var t=this.style,n=t.label,i=t.value,a=ze(this.attributes,"label");Ae(this.label).maybeAppend(".label",function(){return Ii(n)}).attr("className","label").styles(a),this.label.attr("__data__",i)},e.prototype.renderBackground=function(){var t=this.label.getBBox(),n=q(this.padding,4),i=n[0],a=n[1],s=n[2],o=n[3],l=t.width,u=t.height,c=l+o+a,h=u+i+s,d=ze(this.attributes,"background"),f=this.style,g=f.width,v=g===void 0?0:g,p=f.height,y=p===void 0?0:p,m=f.selected;this.background.attr(ce(ce({},d),{width:Math.max(c,v),height:Math.max(h,y),fill:m?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(o,", ").concat((h-u)/2,")")})},e.prototype.render=function(){this.renderLabel(),this.renderBackground()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("pointerenter",function(){t.style.selected||t.background.attr("fill",t.hoverColor)}),this.addEventListener("pointerleave",function(){t.style.selected||t.background.attr("fill",t.style.backgroundFill)});var n=this;this.addEventListener("click",function(){var i=t.style,a=i.label,s=i.value,o=i.onClick;o==null||o(s,{label:a,value:s},n)})},e.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},e}(Gt),FY=function(r){Xe(e,r);function e(t){var n,i,a=r.call(this,yn({},e.defaultOptions,t))||this;a.currentValue=(n=e.defaultOptions.style)===null||n===void 0?void 0:n.defaultValue,a.isPointerInSelect=!1,a.select=a.appendChild(new Mn({className:"select",style:{cursor:"pointer",width:0,height:0}})),a.dropdown=a.appendChild(new Mn({className:"dropdown"}));var s=a.style.defaultValue;return s&&(!((i=a.style.options)===null||i===void 0)&&i.some(function(o){return o.value===s}))&&(a.currentValue=s),a}return e.prototype.setValue=function(t){this.currentValue=t,this.render()},e.prototype.getValue=function(){return this.currentValue},Object.defineProperty(e.prototype,"dropdownPadding",{get:function(){return On(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),e.prototype.renderSelect=function(){var t=this,n,i=this.style,a=i.x,s=i.y,o=i.width,l=i.height,u=i.bordered,c=i.showDropdownIcon,h=ze(this.attributes,"select"),d=ze(this.attributes,"placeholder");this.select.attr(ce(ce({x:a,y:s,width:o,height:l},h),{fill:"#fff",strokeWidth:u?1:0}));var f=this.dropdownPadding,g=10;c&&Ae(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(a+o-g-f[1]-f[3],", ").concat(s+l/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var v=(n=this.style.options)===null||n===void 0?void 0:n.find(function(w){return w.value===t.currentValue}),p=ce({x:a+f[3]},d);Ae(this.select).selectAll(".placeholder").data(v?[]:[1]).join(function(w){return w.append("text").attr("className","placeholder").styles(p).style("y",function(){var S=this.getBBox();return s+(l-S.height)/2})},function(w){return w.styles(p)},function(w){return w.remove()});var y=ze(this.attributes,"optionLabel"),m=ce({x:a+f[3]},y);Ae(this.select).selectAll(".value").data(v?[v]:[]).join(function(w){return w.append(function(S){return Ii(S.label)}).attr("className","value").styles(m).style("y",function(){var S=this.getBBox();return s+(l-S.height)/2})},function(w){return w.styles(m)},function(w){return w.remove()})},e.prototype.renderDropdown=function(){var t=this,n,i,a=this.style,s=a.x,o=a.y,l=a.width,u=a.height,c=a.options,h=a.onSelect,d=a.open,f=ze(this.attributes,"dropdown"),g=ze(this.attributes,"option"),v=this.dropdownPadding;Ae(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(c,function(m){return m.value}).join(function(m){return m.append(function(w){return new DY({className:"dropdown-item",style:ce(ce(ce({},w),g),{width:l-v[1]-v[3],selected:w.value===t.currentValue,onClick:function(S,_,O){t.setValue(S),h==null||h(S,_,O),t.dispatchEvent(new Jt("change",{detail:{value:S,option:_,item:O}})),jr(t.dropdown)}})})}).each(function(w,S){var _,O=(_=this.parentNode)===null||_===void 0?void 0:_.children,T=O.reduce(function(k,P,C){return C<S&&(k+=P.getBBox().height),k},0);this.attr("transform","translate(".concat(v[3],", ").concat(v[0]+T,")"))})},function(m){return m.update(function(w){return{selected:w.value===t.currentValue}})},function(m){return m.remove()});var p=(i=(n=this.dropdown.getElementsByClassName("dropdown-container"))===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.getBBox(),y=f.spacing;this.dropdown.attr(ce({transform:"translate(".concat(s,", ").concat(o+u+y,")"),width:p.width+v[1]+v[3],height:p.height+v[0]+v[2]},f)),!d&&jr(this.dropdown)},e.prototype.render=function(){this.renderSelect(),this.renderDropdown()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("click",function(n){n.stopPropagation()}),this.select.addEventListener("click",function(){t.dropdown.style.visibility==="visible"?jr(t.dropdown):Sl(t.dropdown)}),this.addEventListener("pointerenter",function(){t.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){t.isPointerInSelect=!1}),document==null||document.addEventListener("click",function(){t.isPointerInSelect||jr(t.dropdown)})},e.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},e}(Gt),Yr=function(r){Xe(e,r);function e(t){var n=r.call(this,yn({},{style:{backgroundOpacity:e.backgroundOpacities.default}},e.defaultOptions,t))||this;return n.showBackground=!0,n.background=n.appendChild(new Mn({})),n.icon=n.appendChild(new hn({})),n}return Object.defineProperty(e.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return On(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){var t=this.attributes.size,n=q(this.padding,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.max(t-Math.max(o+a,i+s),this.lineWidth*2+1)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.attributes,n=t.x,i=t.y,a=t.size,s=a/2,o=ze(this.attributes,"background");this.background.attr(ce({x:n-s,y:i-s,width:a,height:a},o))},e.prototype.showIndicator=function(){if(this.label){var t=this.attributes.size,n=this.background.getBBox(),i=n.x,a=n.y;this.indicator.update({x:i+t/2,y:a-5,labelText:this.label,visibility:"visible"})}},e.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},e.prototype.connectedCallback=function(){var t;r.prototype.connectedCallback.call(this);var n=this.attributes.size,i=this.background.getBBox(),a=i.x,s=i.y,o=(t=this.ownerDocument)===null||t===void 0?void 0:t.defaultView;o&&(this.indicator=o.appendChild(new RY({style:{x:a+n/2,y:s-n/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},e.prototype.disconnectedCallback=function(){this.indicator.destroy()},e.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},e.prototype.bindEvents=function(){var t=this,n=this.attributes.onClick;if(this.addEventListener("click",function(){n==null||n(t)}),this.showBackground){var i=function(){return t.background.attr({opacity:e.backgroundOpacities.default})},a=function(){return t.background.attr({opacity:e.backgroundOpacities.hover})},s=function(){return t.background.attr({opacity:e.backgroundOpacities.active})};this.addEventListener("pointerenter",function(){a(),t.showIndicator()}),this.addEventListener("pointerleave",function(){i(),t.hideIndicator()}),this.addEventListener("pointerdown",function(){s()}),this.addEventListener("pointerup",function(){i()})}},e.tag="IconBase",e.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},e.backgroundOpacities={default:0,hover:.8,active:1},e}(Gt),Qo=function(r,e){return e===void 0&&(e="#565758"),new ur({style:{fill:e,d:"M ".concat(r,",").concat(r," L -").concat(r,",0 L ").concat(r,",-").concat(r," Z"),transformOrigin:"center"}})},BY=function(r){Xe(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.arcPath=function(t,n,i){var a=q([i,i],2),s=a[0],o=a[1],l=function(v){return[t+i*Math.cos(v),n+i*Math.sin(v)]},u=q(l(-5/4*Math.PI),2),c=u[0],h=u[1],d=q(l(1/4*Math.PI),2),f=d[0],g=d[1];return"M".concat(c,",").concat(h,",A").concat(s,",").concat(o,",0,1,1,").concat(f,",").concat(g)},Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this.iconSize,o=this.lineWidth,l=o+.5;Ae(this.icon).maybeAppend(".reset","path").styles({stroke:a,lineWidth:o,d:this.arcPath(n,i,s/2-o),markerStart:Qo(l,a)})},e}(Yr),zY=function(r){Xe(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this.iconSize,o=s/2,l=s/2/Math.pow(3,.5),u=[[n,i],[n,i-l],[n-o,i],[n,i+l],[n,i],[n+o,i-l],[n+o,i+l],[n,i]];Ae(this.icon).maybeAppend(".backward","polygon").styles({points:u,fill:a})},e}(Yr),jY=function(r){Xe(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this.iconSize,o=s/2,l=s/2/Math.pow(3,.5),u=[[n,i],[n,i-l],[n+o,i],[n,i+l],[n,i],[n-o,i-l],[n-o,i+l],[n,i]];Ae(this.icon).maybeAppend(".forward","polygon").styles({points:u,fill:a})},e}(Yr),qY=function(r){Xe(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this.iconSize,o=s/3*Math.pow(3,.5)*.8,l=[[n+o,i],[n-o/2,i-s/2*.8],[n-o/2,i+s/2*.8],[n+o,i]];Ae(this.icon).maybeAppend(".play","polygon").styles({points:l,fill:a})},e}(Yr),$Y=function(r){Xe(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this.iconSize,o=s/3,l=[[n-o,i-s/2],[n-o,i+s/2],[n-o/2,i+s/2],[n-o/2,i-s/2],[n-o,i-s/2],[n+o/2,i-s/2],[n+o/2,i+s/2],[n+o,i+s/2],[n+o,i-s/2]];Ae(this.icon).maybeAppend(".pause","polygon").styles({points:l,fill:a})},e}(Yr),GY=function(r){Xe(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this,o=s.iconSize,l=s.lineWidth,u=l;Ae(this.icon).maybeAppend(".left-line","line").styles({x1:n-o/2,y1:i-o/2,x2:n-o/2,y2:i+o/2,stroke:a,lineWidth:l}),Ae(this.icon).maybeAppend(".right-line","line").styles({x1:n+o/2,y1:i-o/2,x2:n+o/2,y2:i+o/2,stroke:a,lineWidth:l}),Ae(this.icon).maybeAppend(".left-arrow","line").styles({x1:n,y1:i,x2:n-o/2+u*2,y2:i,stroke:a,lineWidth:l,markerEnd:Qo(l*2,a)}),Ae(this.icon).maybeAppend(".right-arrow","line").styles({x1:n,y1:i,x2:n+o/2-u*2,y2:i,stroke:a,lineWidth:l,markerEnd:Qo(l*2,a)})},e}(Yr),WY=function(r){Xe(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this,o=s.iconSize,l=s.lineWidth;Ae(this.icon).maybeAppend(".line","line").styles({x1:n,y1:i-o/2,x2:n,y2:i+o/2,stroke:a,lineWidth:l});var u=l;Ae(this.icon).maybeAppend(".left-arrow","line").styles({x1:n-o/2-u*2,y1:i,x2:n-u*2,y2:i,stroke:a,lineWidth:l,markerEnd:Qo(l*2,a)}),Ae(this.icon).maybeAppend(".right-arrow","line").styles({x1:n+o/2+u*2,y1:i,x2:n+u*2,y2:i,stroke:a,lineWidth:l,markerEnd:Qo(l*2,a)})},e}(Yr),mR=function(r){return[[-r/2,-r/2],[-r/2,r/2],[r/2,r/2]]},VY=function(r){Xe(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this,o=s.iconSize,l=s.lineWidth,u=l,c=(o-u*2-l)/4,h=(o-u*2-l)/2,d=q([n-o/2+u,i+o/2-u*2],2),f=d[0],g=d[1];Ae(this.icon).maybeAppend(".coordinate","polyline").styles({points:mR(o).map(function(v){var p=q(v,2),y=p[0],m=p[1];return[y+n,m+i]}),stroke:a,lineWidth:l}),Ae(this.icon).maybeAppend(".line","polyline").styles({points:[[f,g],[f+c,g-h],[f+c*2,g],[f+c*4,g-h*2]],stroke:a,lineWidth:l})},e}(Yr),UY=function(r){Xe(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.data,n=this.attributes,i=n.x,a=n.y,s=n.color,o=this,l=o.iconSize,u=o.lineWidth,c=u,h=(l-c)/t.length,d=(l-c*2)/4,f=q([i-l/2+c*2,a+l/2-c],2),g=f[0],v=f[1];Ae(this.icon).maybeAppend(".coordinate","polyline").styles({points:mR(l).map(function(p){var y=q(p,2),m=y[0],w=y[1];return[m+i,w+a]}),stroke:s,lineWidth:u}),Ae(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(p,y){return{value:p,index:y}})).join(function(p){return p.append("line").attr("className","column").style("x1",function(y){var m=y.index;return g+h*m}).style("y1",v).style("x2",function(y){var m=y.index;return g+h*m}).style("y2",function(y){var m=y.value;return v-d*m}).styles({y1:v,stroke:s,lineWidth:u})})},e}(Yr),HY=function(r){Xe(e,r);function e(t){var n=r.call(this,yn({},{style:{color:"#d8d9d9"}},t))||this;return n.showBackground=!1,n}return e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this,o=s.iconSize,l=s.lineWidth;Ae(this.icon).maybeAppend(".split","line").styles({x1:n,y1:i-o/2,x2:n,y2:i+o/2,stroke:a,lineWidth:l})},e}(Yr),c1=function(r){Xe(e,r);function e(){var t=r.apply(this,Ee([],q(arguments),!1))||this;return t.showBackground=!1,t}return Object.defineProperty(e.prototype,"padding",{get:function(){return On(0)},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.iconSize,n=this.attributes,i=n.x,a=n.y,s=n.speed,o=s===void 0?1:s,l=S1(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),u=Bt(t,20,1/0),c=20,h=ce(ce({},l),{x:i-u/2,y:a-c/2,width:u,height:c,defaultValue:o,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:t/5,placeholderFontSize:t/2,optionPadding:0,optionLabelFontSize:t/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});Ae(this.icon).maybeAppend(".speed",function(){return new FY({style:h})}).attr("className","speed").each(function(){this.update(h)})},e.tag="SpeedSelect",e}(Yr),Bb=function(r){Xe(e,r);function e(t){var n=r.call(this,t)||this;return n.icon=n.appendChild(new hn({})),n.currentType=n.attributes.type,n}return e.prototype.getType=function(){return this.currentType},e.prototype.render=function(){var t=this,n=this.attributes;n.onChange;var i=$t(n,["onChange"]);Ae(this.icon).selectAll(".icon").data([this.currentType]).join(function(a){return a.append(function(s){var o,l=(o=t.toggles.find(function(u){var c=q(u,1),h=c[0];return h===s}))===null||o===void 0?void 0:o[1];if(!l)throw new Error("Invalid type: ".concat(s));return new l({})}).attr("className","icon").styles(i,!1).update({})},function(a){return a.styles({restStyles:i}).update({})},function(a){return a.remove()})},e.prototype.bindEvents=function(){var t=this,n=this.attributes.onChange;this.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation();var a=(t.toggles.findIndex(function(o){var l=q(o,1),u=l[0];return u===t.currentType})+1)%t.toggles.length,s=t.toggles[a][0];n==null||n(t.currentType),t.currentType=s,t.render()})},e.tag="ToggleIcon",e}(Gt),h1=function(r){Xe(e,r);function e(t){var n=r.call(this,yn({},{style:{type:"play"}},t))||this;return n.toggles=[["play",qY],["pause",$Y]],n}return e}(Bb),d1=function(r){Xe(e,r);function e(t){var n=r.call(this,yn({},{style:{type:"range"}},t))||this;return n.toggles=[["range",GY],["value",WY]],n}return e}(Bb),f1=function(r){Xe(e,r);function e(t){var n=r.call(this,yn({},{style:{type:"column"}},t))||this;return n.toggles=[["line",VY],["column",UY]],n}return e}(Bb),YY={reset:BY,speed:c1,backward:zY,playPause:h1,forward:jY,selectionType:d1,chartType:f1,split:HY},XY=function(r){Xe(e,r);function e(t){var n=r.call(this,yn({},e.defaultOptions,t))||this;return n.background=n.appendChild(new Mn({})),n.functions=n.appendChild(new hn({})),n}return Object.defineProperty(e.prototype,"padding",{get:function(){return On(this.attributes.padding)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.style,n=t.x,i=t.y,a=t.width,s=t.height,o=ze(this.attributes,"background");this.background.attr(ce({x:n,y:i,width:a,height:s},o))},e.prototype.renderFunctions=function(){var t=this,n,i=this.attributes,a=i.functions,s=i.iconSize,o=i.iconSpacing,l=i.x,u=i.y,c=i.width,h=i.height,d=i.align,f=q(this.padding,4),g=f[1],v=f[3],p=a.reduce(function(w,S){return w.length&&S.length?w.concat.apply(w,Ee(["split"],q(S),!1)):w.concat.apply(w,Ee([],q(S),!1))},[]),y=p.length*(s+o)-o,m={left:v+s/2,center:(c-y)/2+s/2,right:c-y-v-g+s/2}[d]||0;(n=this.speedSelect)===null||n===void 0||n.destroy(),this.functions.removeChildren(),p.forEach(function(w,S){var _,O=YY[w],T={x:l+S*(s+o)+m,y:u+h/2,size:s};if(O===c1?(T.speed=t.attributes.speed,T.onSelect=function(P){return t.handleFunctionChange(w,{value:P})}):[h1,d1,f1].includes(O)?(T.onChange=function(P){return t.handleFunctionChange(w,{value:P})},O===h1&&(T.type=t.attributes.state==="play"?"pause":"play"),O===d1&&(T.type=t.attributes.selectionType==="range"?"value":"range"),O===f1&&(T.type=t.attributes.chartType==="line"?"column":"line")):T.onClick=function(){return t.handleFunctionChange(w,{value:w})},O===c1){var k=(_=t.ownerDocument)===null||_===void 0?void 0:_.defaultView;k&&(t.speedSelect=new O({style:ce(ce({},T),{zIndex:100})}),k.appendChild(t.speedSelect))}else t.functions.appendChild(new O({style:T}))})},e.prototype.disconnectedCallback=function(){var t;r.prototype.disconnectedCallback.call(this),(t=this.speedSelect)===null||t===void 0||t.destroy()},e.prototype.render=function(){this.renderBackground(),this.renderFunctions()},e.prototype.handleFunctionChange=function(t,n){var i=this.attributes.onChange;i==null||i(t,n)},e.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},e}(Gt),KY=function(r){Xe(e,r);function e(t){var n=r.call(this,yn({},e.defaultOptions,t))||this;return n.bindEvents(),n}return e.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseenter",function(){t.attr("lineWidth",Math.ceil(+(t.style.r||0)/2))}),this.addEventListener("mouseleave",function(){t.attr("lineWidth",0)})},e.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},e}(Fi),ZY=function(r){Xe(e,r);function e(t){return r.call(this,yn({},e.defaultOptions,t))||this}return e.prototype.renderBackground=function(){var t=this.attributes,n=t.x,i=t.y,a=t.width,s=t.height,o=ze(this.attributes,"background");Ae(this).maybeAppend("background","rect").attr("className","background").styles(ce({x:n-a/2,y:i-s/2,width:a,height:s},o))},e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.iconSize,s=ze(this.attributes,"icon"),o=1,l=a/2;Ae(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles(ce({x1:n-o,y1:i-l,x2:n-o,y2:i+l},s)),Ae(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles(ce({x1:n+o,y1:i-l,x2:n+o,y2:i+l},s))},e.prototype.renderBorder=function(){var t=this.attributes,n=t.x,i=t.y,a=t.width,s=t.height,o=t.type,l=ze(this.attributes,"border"),u=o==="start"?+a/2:-a/2;Ae(this).maybeAppend("border","line").attr("className","border").styles(ce({x1:u+n,y1:i-s/2,x2:u+n,y2:i+s/2},l))},e.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},e.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},e}(Gt);function JY(r,e){return typeof r=="number"?bR(r):QY(r,e)}function QY(r,e){var t=new Date(r);switch(e){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(t.getHours())&&t.getMinutes()===0?Hn(t,`HH:mm
YYYY-MM-DD`):Hn(t,"HH:mm");case"half-day":return t.getHours()<12?`AM
`.concat(Hn(t,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(t.getDate())?Hn(t,`DD
YYYY-MM`):Hn(t,"DD");case"week":return t.getDate()<=7?Hn(t,`DD
YYYY-MM`):Hn(t,"DD");case"month":return[0,6].includes(t.getMonth())?Hn(t,`MM
YYYY`):Hn(t,"MM");case"season":return[0].includes(t.getMonth())?Hn(t,`MM
YYYY`):Hn(t,"MM");case"year":return Hn(t,"YYYY");default:return Hn(t,"YYYY-MM-DD HH:mm")}}function bR(r){var e=String(Math.floor(r/3600)).padStart(2,"0"),t=String(Math.floor(r%3600/60)).padStart(2,"0"),n=String(Math.floor(r%60)).padStart(2,"0");return r<3600?"".concat(t,":").concat(n):"".concat(e,":").concat(t,":").concat(n)}var eX=function(r){Xe(e,r);function e(t){var n=r.call(this,yn({},e.defaultOptions,t))||this;n.axis=n.appendChild(new EY({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),n.timeline=n.appendChild(new wH({style:{onChange:function(h){n.handleSliderChange(h)}}})),n.controller=n.appendChild(new XY({})),n.states={},n.handleSliderChange=function(h){var d=function(){var f=n.states.values;return Array.isArray(f)?Ee([],q(f),!1):f}();n.setBySliderValues(h),n.dispatchOnChange(d)};var i=n.attributes,a=i.selectionType,s=i.chartType,o=i.speed,l=i.state,u=i.playMode,c=i.values;return n.states={chartType:s,playMode:u,selectionType:a,speed:o,state:l},n.setByTimebarValues(c),n}return Object.defineProperty(e.prototype,"data",{get:function(){var t=this.attributes.data,n=function(i,a){return i.time<a.time?-1:i.time>a.time?1:0};return t.sort(n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){var t=this.attributes,n=t.x,i=t.y,a=t.width,s=t.height,o=t.type,l=t.controllerHeight,u=Bt(+s-l,0,+s),c=new qn(n,i+ +s-l,+a,l),h,d=0;o==="chart"?(d=35,h=new qn(n,i+u-d,+a,d)):h=new qn;var f=o==="time"?10:u,g=new qn(n,i+(o==="time"?u:u-f),+a,f-d);return{axisBBox:h,controllerBBox:c,timelineBBox:g}},enumerable:!1,configurable:!0}),e.prototype.setBySliderValues=function(t){var n,i,a=this.data,s=q(Array.isArray(t)?t:[0,t],2),o=s[0],l=s[1],u=a.length,c=a[Math.floor(o*u)],h=a[Math.ceil(l*u)-(Array.isArray(t)?0:1)];this.states.values=[(n=c==null?void 0:c.time)!==null&&n!==void 0?n:a[0].time,(i=h==null?void 0:h.time)!==null&&i!==void 0?i:1/0]},e.prototype.setByTimebarValues=function(t){var n,i,a,s=this.data,o=q(Array.isArray(t)?t:[void 0,t],2),l=o[0],u=o[1],c=s.find(function(d){var f=d.time;return f===l}),h=s.find(function(d){var f=d.time;return f===u});this.states.values=[(n=c==null?void 0:c.time)!==null&&n!==void 0?n:(i=s[0])===null||i===void 0?void 0:i.time,(a=h==null?void 0:h.time)!==null&&a!==void 0?a:1/0]},e.prototype.setByIndex=function(t){var n,i,a,s,o=this.data,l=q(t,2),u=l[0],c=l[1];this.states.values=[(i=(n=o[u])===null||n===void 0?void 0:n.time)!==null&&i!==void 0?i:o[0].time,(s=(a=this.data[c])===null||a===void 0?void 0:a.time)!==null&&s!==void 0?s:1/0]},Object.defineProperty(e.prototype,"sliderValues",{get:function(){var t=this.states,n=t.values,i=t.selectionType,a=q(Array.isArray(n)?n:[void 0,n],2),s=a[0],o=a[1],l=this.data,u=l.length,c=i==="value",h=function(){var f=l.findIndex(function(g){var v=g.time;return v===s});return c?0:f>-1?f/u:0},d=function(){if(o===1/0)return 1;var f=l.findIndex(function(g){var v=g.time;return v===o});return f>-1?f/u:c?.5:1};return[h(),d()]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this.states,n=t.values,i=t.selectionType,a=q(Array.isArray(n)?n:[this.data[0].time,n],2),s=a[0],o=a[1];return i==="value"?o:[s,o]},enumerable:!1,configurable:!0}),e.prototype.getDatumByRatio=function(t){var n=this.data,i=n.length,a=Math.floor(t*(i-1));return n[a]},Object.defineProperty(e.prototype,"chartHandleIconShape",{get:function(){var t=this.states.selectionType,n=this.space.timelineBBox.height;return t==="range"?function(i){return new ZY({style:{type:i,height:n,iconSize:n/6}})}:function(){return new Ua({style:{x1:0,y1:-n/2,x2:0,y2:n/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),e.prototype.getChartStyle=function(t){var n=this,i=t.x,a=t.y,s=t.width,o=t.height,l=this.states,u=l.selectionType,c=l.chartType,h=this.data,d=this.attributes,f=d.type,g=d.labelFormatter,v=ze(this.attributes,"chart");v.type;var p=$t(v,["type"]),y=u==="range";if(f==="time")return ce({handleIconShape:function(){return new KY({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:y?-15:0,autoFitLabel:y,handleSpacing:y?-15:0,trackFill:"#edeeef",trackLength:s,trackOpacity:.5,trackRadius:o/2,trackSize:o/2,type:u,values:this.sliderValues,formatter:function(S){if(g)return g(S);var _=n.getDatumByRatio(S).time;return typeof _=="number"?bR(_):Hn(_,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},p);var m=u==="range"?5:0,w=h.map(function(S){var _=S.value;return _});return ce({handleIconOffset:m,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:w,sparklineType:c,sparklineScale:.8,trackLength:s,trackSize:o,type:u,values:this.sliderValues,transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},p)},e.prototype.renderChart=function(t){t===void 0&&(t=this.space.timelineBBox),this.timeline.update(this.getChartStyle(t))},e.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},e.prototype.getAxisStyle=function(t){var n=this.data,i=this.attributes,a=i.interval,s=i.labelFormatter,o=ze(this.attributes,"axis"),l=t.x,u=t.y,c=t.width,h=Ee(Ee([],q(n),!1),[{time:0}],!1).map(function(f,g,v){var p=f.time;return{label:"".concat(p),value:g/(v.length-1),time:p}}),d=ce({startPos:[l,u],endPos:[l+c,u],data:h,labelFilter:function(f,g){return g<h.length-1},labelFormatter:function(f){var g=f.time;return s?s(g):JY(g,a)}},o);return d},e.prototype.renderAxis=function(t){t===void 0&&(t=this.space.axisBBox);var n=this.attributes.type;n==="chart"&&this.axis.update(this.getAxisStyle(t))},e.prototype.renderController=function(t){t===void 0&&(t=this.space.controllerBBox);var n=this.attributes.type,i=this.states,a=i.state,s=i.speed,o=i.selectionType,l=i.chartType,u=ze(this.attributes,"controller"),c=this,h=ce(ce(ce({},t),{iconSize:20,speed:s,state:a,selectionType:o,chartType:l,onChange:function(d,f){var g=f.value;switch(d){case"reset":c.internalReset();break;case"speed":c.handleSpeedChange(g);break;case"backward":c.internalBackward();break;case"playPause":g==="play"?c.internalPlay():c.internalPause();break;case"forward":c.internalForward();break;case"selectionType":c.handleSelectionTypeChange(g);break;case"chartType":c.handleChartTypeChange(g);break}}}),u);n==="time"&&(h.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(h)},e.prototype.dispatchOnChange=function(t){var n=this.data,i=this.attributes.onChange,a=this.states,s=a.values,o=a.selectionType,l=q(s,2),u=l[0],c=l[1],h=c===1/0?n.at(-1).time:c,d=o==="range"?[u,h]:h,f=function(g,v){return Array.isArray(g)?Array.isArray(v)?g[0]===v[0]&&(g[1]===v[1]||g[1]===1/0||v[1]===1/0):!1:Array.isArray(v)?!1:g===v};(!t||!f(t,d))&&(i==null||i(o==="range"?[u,h]:h))},e.prototype.internalReset=function(t){var n,i,a=this.states.selectionType;this.internalPause(),this.setBySliderValues(a==="range"?[0,1]:[0,0]),this.renderController(),this.updateSelection(),t||((i=(n=this.attributes)===null||n===void 0?void 0:n.onReset)===null||i===void 0||i.call(n),this.dispatchOnChange())},e.prototype.reset=function(){this.internalReset()},e.prototype.moveSelection=function(t,n){var i=this.data,a=i.length,s=this.states,o=s.values,l=s.selectionType,u=s.playMode,c=q(o,2),h=c[0],d=c[1],f=i.findIndex(function(w){var S=w.time;return S===h}),g=i.findIndex(function(w){var S=w.time;return S===d});g===-1&&(g=a);var v=t==="backward"?-1:1,p;l==="range"?u==="acc"?(p=[f,g+v],v===-1&&f===g&&(p=[f,a])):p=[f+v,g+v]:p=[f,g+v];var y=function(w){var S=q(w.sort(function(k,P){return k-P}),2),_=S[0],O=S[1],T=function(k){return Bt(k,0,a)};return O>a?l==="value"?[0,0]:u==="acc"?[T(_),T(_)]:[0,T(O-_)]:_<0?u==="acc"?[0,T(O)]:[T(_+a-O),a]:[T(_),T(O)]},m=y(p);return this.setByIndex(m),this.updateSelection(),m},e.prototype.internalBackward=function(t){var n,i,a=this.moveSelection("backward",t);return t||((i=(n=this.attributes)===null||n===void 0?void 0:n.onBackward)===null||i===void 0||i.call(n),this.dispatchOnChange()),a},e.prototype.backward=function(){this.internalBackward()},e.prototype.internalPlay=function(t){var n=this,i,a,s=this.data,o=this.attributes.loop,l=this.states.speed,u=l===void 0?1:l;this.playInterval=window.setInterval(function(){var c=n.internalForward();c[1]===s.length&&!o&&(n.internalPause(),n.renderController())},1e3/u),this.states.state="play",!t&&((a=(i=this.attributes)===null||i===void 0?void 0:i.onPlay)===null||a===void 0||a.call(i))},e.prototype.play=function(){this.internalPlay()},e.prototype.internalPause=function(t){var n,i;clearInterval(this.playInterval),this.states.state="pause",!t&&((i=(n=this.attributes)===null||n===void 0?void 0:n.onPause)===null||i===void 0||i.call(n))},e.prototype.pause=function(){this.internalPause()},e.prototype.internalForward=function(t){var n,i,a=this.moveSelection("forward",t);return t||((i=(n=this.attributes)===null||n===void 0?void 0:n.onForward)===null||i===void 0||i.call(n),this.dispatchOnChange()),a},e.prototype.forward=function(){this.internalForward()},e.prototype.handleSpeedChange=function(t){var n,i;this.states.speed=t;var a=this.states.state;a==="play"&&(this.internalPause(!0),this.internalPlay(!0)),(i=(n=this.attributes)===null||n===void 0?void 0:n.onSpeedChange)===null||i===void 0||i.call(n,t)},e.prototype.handleSelectionTypeChange=function(t){var n,i;this.states.selectionType=t,this.renderChart(),(i=(n=this.attributes)===null||n===void 0?void 0:n.onSelectionTypeChange)===null||i===void 0||i.call(n,t)},e.prototype.handleChartTypeChange=function(t){var n,i;this.states.chartType=t,this.renderChart(),(i=(n=this.attributes)===null||n===void 0?void 0:n.onChartTypeChange)===null||i===void 0||i.call(n,t)},e.prototype.render=function(){var t=this.space,n=t.axisBBox,i=t.controllerBBox,a=t.timelineBBox;this.renderController(i),this.renderAxis(n),this.renderChart(a),this.states.state==="play"&&this.internalPlay()},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.internalPause(!0)},e.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},e}(Gt);function zb(r){const{width:e,height:t,renderer:n}=r,i=tX(r),a=new Nm({width:e,height:t,container:i,renderer:n||new Vo});return[i,a]}function tX(r){var e;const{container:t,className:n,graphCanvas:i}=r;if(t)return typeof t=="string"?document.getElementById(t):t;const a=Js(n,!1),{width:s,height:o,containerStyle:l}=r,[u,c]=nX(r);return Object.assign(a.style,Object.assign({position:"absolute",left:u+"px",top:c+"px",width:s+"px",height:o+"px"},l)),(e=i.getContainer())===null||e===void 0||e.appendChild(a),a}function nX(r){const{width:e,height:t,placement:n,graphCanvas:i}=r,[a,s]=i.getSize(),[o,l]=uP(n);return[o*(a-e),l*(s-t)]}var rX=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Yh extends Tn{constructor(e,t){super(e,Object.assign({},Yh.defaultOptions,t)),this.typePrefix="__data__",this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{const{graph:n}=this.context;n.on(ye.AFTER_DRAW,this.createElement)},this.changeState=(n,i)=>{const{graph:a}=this.context,{typePrefix:s}=this,o=Bn(n,[s,"id"]),l=Bn(n,[s,"style","labelText"]),[u]=o.split("__"),c=this.fieldMap[u].get(l)||[];a.setElementState(Object.fromEntries(c==null?void 0:c.map(h=>[h,i])))},this.click=n=>{if(this.options.trigger==="hover")return;const i=Bn(n,[this.typePrefix,"id"]);this.selectedItems.includes(i)?(this.selectedItems=this.selectedItems.filter(a=>a!==i),this.changeState(n,[])):(this.selectedItems.push(i),this.changeState(n,"selected"))},this.mouseleave=n=>{this.options.trigger!=="click"&&(this.selectedItems=[],this.changeState(n,[]))},this.mouseenter=n=>{if(this.options.trigger==="click")return;const i=Bn(n,[this.typePrefix,"id"]);this.selectedItems.includes(i)?this.selectedItems=this.selectedItems.filter(a=>a!==i):(this.selectedItems.push(i),this.changeState(n,"active"))},this.setFieldMap=(n,i,a)=>{if(!n)return;const s=this.fieldMap[a];if(s)if(!s.has(n))s.set(n,[i]);else{const o=s.get(n);o&&(o.push(i),s.set(n,o))}},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(n,i)=>{if(!n)return[];const{model:a,element:s}=this.context,{nodes:o,edges:l,combos:u}=a.getData(),c={},h=p=>Te(n)?n(p):n,d={node:"circle",edge:"line",combo:"rect"},f={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},g=(p,y)=>s==null?void 0:s.getElementComputedStyle(p,y),v=(p,y)=>{p.forEach(m=>{const{id:w}=m,S=Bn(m,["data",h(m)]),_=(s==null?void 0:s.getElementType(y,m))||"circle",O=g(y,m),T=(y==="edge"?O==null?void 0:O.stroke:O==null?void 0:O.fill)||"#1783ff";w&&S&&S.replace(/\s+/g,"")&&(this.setFieldMap(S,w,y),c[S]||(c[S]={id:`${y}__${w}`,label:S,marker:f[_]||d[y],elementType:y,lineWidth:1,stroke:T,fill:T}))})};switch(i){case"node":v(o,"node");break;case"edge":v(l,"edge");break;case"combo":v(u,"combo");break;default:return[]}return Object.values(c)},this.createElement=()=>{if(this.draw){this.updateElement();return}const n=this.options,{width:i,height:a,nodeField:s,edgeField:o,comboField:l,trigger:u,position:c,container:h,containerStyle:d,className:f}=n,g=rX(n,["width","height","nodeField","edgeField","comboField","trigger","position","container","containerStyle","className"]),v=this.getMarkerData(s,"node"),p=this.getMarkerData(o,"edge"),y=this.getMarkerData(l,"combo"),m=[...v,...y,...p],w=Object.assign({width:i,height:a,data:m,itemMarkerLineWidth:({lineWidth:O})=>O,itemMarker:({marker:O})=>O,itemMarkerStroke:({stroke:O})=>O,itemMarkerFill:({fill:O})=>O,gridCol:v.length},g,this.getEvents()),S=new CY({className:"legend",style:w});this.category=S,this.upsertCanvas().appendChild(S),this.draw=!0},this.bindEvents()}update(e){super.update(e),this.clear(),this.createElement()}clear(){var e,t;(e=this.canvas)===null||e===void 0||e.destroy(),(t=this.container)===null||t===void 0||t.remove(),this.canvas=void 0,this.container=void 0,this.draw=!1}updateElement(){this.category&&this.category.update({itemMarkerOpacity:({id:e})=>!this.selectedItems.length||this.selectedItems.includes(e)?1:.5,itemLabelOpacity:({id:e})=>!this.selectedItems.length||this.selectedItems.includes(e)?1:.5})}upsertCanvas(){if(this.canvas)return this.canvas;const e=this.context.canvas,[t,n]=e.getSize(),{width:i=t,height:a=n,position:s,container:o,containerStyle:l,className:u}=this.options,[c,h]=zb({width:i,height:a,graphCanvas:e,container:o,containerStyle:l,placement:s,className:"legend"});return this.container=c,u&&c.classList.add(u),this.canvas=h,this.canvas}destroy(){this.clear(),this.context.graph.off(ye.AFTER_DRAW,this.createElement),super.destroy()}}Yh.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16,width:240,height:160};class Xh extends Tn{constructor(e,t){super(e,Object.assign({},Xh.defaultOptions,t)),this.onDraw=n=>{var i;!((i=n==null?void 0:n.data)===null||i===void 0)&&i.render||this.onRender()},this.shapes=new Map,this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=n=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(n.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=n=>{if(!this.mask||!this.isMaskDragging)return;const{size:[i,a]}=this.options,{movementX:s,movementY:o}=n,{left:l,top:u,width:c,height:h}=this.mask.style,[,,d,f]=this.maskBBox;let g=parseInt(l)+s,v=parseInt(u)+o,p=parseInt(c),y=parseInt(h);g<0&&(g=0),v<0&&(v=0),g+p>i&&(g=Wi(i-p,0)),v+y>a&&(v=Wi(a-y,0)),p<d&&(s>0?(g=Wi(g-s,0),p=Gi(p+s,i)):s<0&&(p=Gi(p-s,i))),y<f&&(o>0?(v=Wi(v-o,0),y=Gi(y+o,a)):o<0&&(y=Gi(y-o,a))),Object.assign(this.mask.style,{left:g+"px",top:v+"px",width:p+"px",height:y+"px"});const m=parseInt(l)-g,w=parseInt(u)-v;if(m===0&&w===0)return;const S=this.context.canvas.getCamera().getZoom(),_=this.canvas.getCamera().getZoom(),O=S/_;this.context.graph.translateBy([m*O,w*O],!1)},this.onMaskDragEnd=n=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(n.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=UT(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}),this.setOnRender(),this.bindEvents()}update(e){this.unbindEvents(),super.update(e),"delay"in e&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=rl(()=>{this.renderMinimap(),this.renderMask()},this.options.delay,!0)}bindEvents(){const{graph:e}=this.context;e.on(ye.AFTER_DRAW,this.onDraw),e.on(ye.AFTER_RENDER,this.onRender),e.on(ye.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:e}=this.context;e.off(ye.AFTER_DRAW,this.onDraw),e.off(ye.AFTER_RENDER,this.onRender),e.off(ye.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){const e=this.getElements(),t=this.initCanvas();this.setShapes(t,e)}getElements(){const{filter:e}=this.options,{model:t}=this.context,n=t.getData();if(!e)return n;const{nodes:i,edges:a,combos:s}=n;return{nodes:i.filter(o=>e(J(o),"node")),edges:a.filter(o=>e(J(o),"edge")),combos:s.filter(o=>e(J(o),"combo"))}}setShapes(e,t){const{nodes:n,edges:i,combos:a}=t,{shape:s}=this.options,{element:o}=this.context;if(s==="key"){const u=new Set,c=h=>{const d=J(h);u.add(d);const f=o.getElement(d);if(!f)return;const g=f.getShape("key"),v=this.shapes.get(d)||g.cloneNode();v.setPosition(g.getPosition()),f.style.zIndex&&(v.style.zIndex=f.style.zIndex),v.id=f.id,this.shapes.has(d)?Object.entries(g.attributes).forEach(([p,y])=>{v.style[p]!==y&&(v.style[p]=y)}):(e.appendChild(v),this.shapes.set(d,v))};i.forEach(c),a.forEach(c),n.forEach(c),this.shapes.forEach((h,d)=>{u.has(d)||(e.removeChild(h),this.shapes.delete(d))});return}const l=(u,c)=>{const d=o.getElement(u).getPosition();return c.setPosition(d),c};e.removeChildren(),i.forEach(u=>e.appendChild(s(J(u),"edge"))),a.forEach(u=>{e.appendChild(l(J(u),s(J(u),"combo")))}),n.forEach(u=>{e.appendChild(l(J(u),s(J(u),"node")))})}initCanvas(){const{renderer:e,size:[t,n]}=this.options;if(this.canvas){const{width:i,height:a}=this.canvas.getConfig();(t!==i||n!==a)&&this.canvas.resize(t,n),e&&this.canvas.setRenderer(e)}else{const{className:i,position:a,container:s,containerStyle:o}=this.options,[l,u]=zb({renderer:e,width:t,height:n,placement:a,className:"minimap",container:s,containerStyle:o,graphCanvas:this.context.canvas});i&&l.classList.add(i),this.container=l,this.canvas=u}return this.setCamera(),this.canvas}createLandmark(e,t,n){const i=`${e.join(",")}-${t.join(",")}-${n}`;if(this.landmarkMap.has(i))return this.landmarkMap.get(i);const s=this.canvas.getCamera().createLandmark(i,{position:e,focalPoint:t,zoom:n});return this.landmarkMap.set(i,s),s}setCamera(){var e;const{canvas:t}=this.context,n=(e=this.canvas)===null||e===void 0?void 0:e.getCamera();if(!n)return;const{size:[i,a],padding:s}=this.options,[o,l,u,c]=pi(s),{min:h,max:d,center:f}=t.getBounds("elements"),g=d[0]-h[0],v=d[1]-h[1],p=i-c-l,y=a-o-u,m=p/g,w=y/v,S=Math.min(m,w),_=this.createLandmark(f,f,S);n.gotoLandmark(_,0)}get maskBBox(){const{canvas:e}=this.context,t=e.getSize(),n=e.getCanvasByViewport([0,0]),i=e.getCanvasByViewport(t),a=this.canvas.canvas2Viewport(zr(n)),s=this.canvas.canvas2Viewport(zr(i)),o=s.x-a.x,l=s.y-a.y;return[a.x,a.y,o,l]}calculateMaskBBox(){const{size:[e,t]}=this.options;let[n,i,a,s]=this.maskBBox;return n<0&&(a=Gi(a+n,e),n=0),i<0&&(s=Gi(s+i,t),i=0),n+a>e&&(a=Wi(e-n,0)),i+s>t&&(s=Wi(t-i,0)),[Gi(n,e),Gi(i,t),Wi(a,0),Wi(s,0)]}renderMask(){const{maskStyle:e}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart)),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},e),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;const[e,t,n,i]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:t+"px",left:e+"px",width:n+"px",height:i+"px"})}destroy(){var e;this.unbindEvents(),this.canvas.destroy(),(e=this.mask)===null||e===void 0||e.remove(),super.destroy()}}Xh.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};const Gi=(r,e)=>Math.min(r,e),Wi=(r,e)=>Math.max(r,e);var Ky=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};const Zy={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class Kh extends Tn{constructor(e,t){super(e,Object.assign({},Kh.defaultOptions,t)),this.initSnapline=()=>{const n=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=n.appendChild(new Ua({style:Object.assign(Object.assign({},Zy),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=n.appendChild(new Ua({style:Object.assign(Object.assign({},Zy),this.options.verticalLineStyle)})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(n,i,a)=>Ky(this,void 0,void 0,function*(){const{verticalX:s,horizontalY:o}=a,{tolerance:l}=this.options,{min:[u,c],max:[h,d],center:[f,g]}=i;let v=0,p=0;s!==null&&(Pn(h,s)<l&&(v=s-h),Pn(u,s)<l&&(v=s-u),Pn(f,s)<l&&(v=s-f),v!==0&&(this.isVerticalSticking=!0)),o!==null&&(Pn(d,o)<l&&(p=o-d),Pn(c,o)<l&&(p=o-c),Pn(g,o)<l&&(p=o-g),p!==0&&(this.isHorizontalSticking=!0)),(v!==0||p!==0)&&(yield this.context.graph.translateElementBy({[n]:[v,p]},!1))}),this.enableSnap=n=>{const{target:i}=n,a=.5;if(this.isHorizontalSticking||this.isVerticalSticking){const[s,o]=this.getDelta(n);if(this.isHorizontalSticking&&this.isVerticalSticking&&Math.abs(s)<=a&&Math.abs(o)<=a)return this.context.graph.translateElementBy({[i.id]:[-s,-o]},!1),!1;if(this.isHorizontalSticking&&Math.abs(o)<=a)return this.context.graph.translateElementBy({[i.id]:[0,-o]},!1),!1;if(this.isVerticalSticking&&Math.abs(s)<=a)return this.context.graph.translateElementBy({[i.id]:[-s,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick},this.calcSnaplineMetadata=(n,i)=>{const{tolerance:a,shape:s}=this.options,{min:[o,l],max:[u,c],center:[h,d]}=i;let f=null,g=null,v=null,p=null,y=null,m=null;return this.getNodes().some(w=>{if(zt(n.id,w.id))return!1;const S=Bk(w,s).getRenderBounds(),{min:[_,O],max:[T,k],center:[P,C]}=S;return f===null&&(Pn(P,h)<a?f=P:Pn(_,o)<a||Pn(_,u)<a?f=_:(Pn(T,u)<a||Pn(T,o)<a)&&(f=T),f!==null&&(g=Math.min(O,l),v=Math.max(k,c))),p===null&&(Pn(C,d)<a?p=C:Pn(O,l)<a||Pn(O,c)<a?p=O:(Pn(k,c)<a||Pn(k,l)<a)&&(p=k),p!==null&&(y=Math.min(_,o),m=Math.max(T,u))),f!==null&&p!==null}),{verticalX:f,verticalMinY:g,verticalMaxY:v,horizontalY:p,horizontalMinX:y,horizontalMaxX:m}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=n=>Ky(this,void 0,void 0,function*(){const{target:i}=n;if(this.options.autoSnap&&!this.enableSnap(n))return;const a=Bk(i,this.options.shape).getRenderBounds(),s=this.calcSnaplineMetadata(i,a);this.hideSnapline(),(s.verticalX!==null||s.horizontalY!==null)&&this.updateSnapline(s),this.options.autoSnap&&(yield this.autoSnapToLine(i.id,a,s))}),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}getNodes(){var e;const{filter:t}=this.options,i=(((e=this.context.element)===null||e===void 0?void 0:e.getNodes())||[]).filter(a=>{var s;return Bz(a)&&((s=this.context.viewport)===null||s===void 0?void 0:s.isInViewport(a.getRenderBounds()))});return t?i.filter(a=>t(a)):i}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(e){const{lineWidth:t}=this.options[`${e}LineStyle`];return+(t||Zy.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(e){const{verticalX:t,verticalMinY:n,verticalMaxY:i,horizontalY:a,horizontalMinX:s,horizontalMaxX:o}=e,[l,u]=this.context.canvas.getSize(),{offset:c}=this.options;a!==null?Object.assign(this.horizontalLine.style,{x1:c===1/0?0:s-c,y1:a,x2:c===1/0?l:o+c,y2:a,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",t!==null?Object.assign(this.verticalLine.style,{x1:t,y1:c===1/0?0:n-c,x2:t,y2:c===1/0?u:i+c,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(e){const t=this.context.graph.getZoom();return Gr([e.dx,e.dy],t)}bindEvents(){return Ky(this,void 0,void 0,function*(){const{graph:e}=this.context;e.on(kr.DRAG_START,this.onDragStart),e.on(kr.DRAG,this.onDrag),e.on(kr.DRAG_END,this.onDragEnd)})}unbindEvents(){const{graph:e}=this.context;e.off(kr.DRAG_START,this.onDragStart),e.off(kr.DRAG,this.onDrag),e.off(kr.DRAG_END,this.onDragEnd)}destroyElements(){var e,t;(e=this.horizontalLine)===null||e===void 0||e.destroy(),(t=this.verticalLine)===null||t===void 0||t.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}}Kh.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};const Pn=(r,e)=>Math.abs(r-e),Bk=(r,e)=>typeof e=="function"?e(r):r.getShape(e);var iX=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},aX=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const sX=["timestamp","time","date","datetime"];class Zh extends Tn{get padding(){return pi(this.options.padding)}constructor(e,t){super(e,Object.assign({},Zh.defaultOptions,t)),this.backup(),this.upsertTimebar()}play(){var e;(e=this.timebar)===null||e===void 0||e.play()}pause(){var e;(e=this.timebar)===null||e===void 0||e.pause()}forward(){var e;(e=this.timebar)===null||e===void 0||e.forward()}backward(){var e;(e=this.timebar)===null||e===void 0||e.backward()}reset(){var e;(e=this.timebar)===null||e===void 0||e.reset()}update(e){super.update(e),this.backup(),this.upsertTimebar()}backup(){this.originalData=zk(this.context.graph.getData())}upsertTimebar(){const{canvas:e}=this.context,t=this.options,{onChange:n,timebarType:i,data:a,x:s,y:o,width:l,height:u,mode:c}=t,h=aX(t,["onChange","timebarType","data","x","y","width","height","mode"]),d=e.getSize(),[f]=this.padding;this.upsertCanvas().ready.then(()=>{var g;const v=Object.assign(Object.assign({x:d[0]/2-l/2,y:f,onChange:p=>{const y=(pr(p)?p:[p,p]).map(m=>m3(m)?m.getTime():m);this.options.mode==="modify"?this.filterElements(y):this.hiddenElements(y),n==null||n(y)}},h),{data:a.map(p=>_e(p)?{time:p,value:0}:p),width:l,height:u,type:i});this.timebar?this.timebar.update(v):(this.timebar=new eX({style:v}),(g=this.canvas)===null||g===void 0||g.appendChild(this.timebar))})}upsertCanvas(){if(this.canvas)return this.canvas;const{className:e,height:t,position:n}=this.options,i=this.context.canvas,[a]=i.getSize(),[s,,o]=this.padding,[l,u]=zb({width:a,height:t+s+o,graphCanvas:i,className:"timebar",placement:n});return this.container=l,e&&l.classList.add(e),this.canvas=u,this.canvas}filterElements(e){return iX(this,void 0,void 0,function*(){var t;if(!this.originalData)return;const{elementTypes:n,getTime:i}=this.options,{graph:a,element:s}=this.context,o=zk(this.originalData);n.forEach(u=>{const c=`${u}s`;o[c]=(this.originalData[c]||[]).filter(h=>{const d=i(h);return!!jk(d,e)})});const l=[...o.nodes,...o.combos].map(u=>J(u));o.edges=o.edges.filter(u=>{const c=u.source,h=u.target;return l.includes(c)&&l.includes(h)}),a.setData(o),yield(t=s.draw({animation:!1,silence:!0}))===null||t===void 0?void 0:t.finished})}hiddenElements(e){const{graph:t}=this.context,{elementTypes:n,getTime:i}=this.options,a=[],s=[];n.forEach(o=>{var l;const u=`${o}s`;(((l=this.originalData)===null||l===void 0?void 0:l[u])||[]).forEach(h=>{const d=J(h),f=i(h);jk(f,e)?s.push(d):a.push(d)})}),t.hideElement(a,!1),t.showElement(s,!1)}destroy(){var e,t,n;const{graph:i}=this.context;this.originalData&&i.setData(Object.assign({},this.originalData)),(e=this.timebar)===null||e===void 0||e.destroy(),(t=this.canvas)===null||t===void 0||t.destroy(),(n=this.container)===null||n===void 0||n.remove(),this.originalData=void 0,this.container=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}}Zh.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:r=>oX(r,sX,void 0),loop:!1};const zk=r=>{const{nodes:e=[],edges:t=[],combos:n=[]}=r;return{nodes:[...e],edges:[...t],combos:[...n]}},jk=(r,e)=>{if(_e(e))return r===e;const[t,n]=e;return r>=t&&r<=n},oX=(r,e,t)=>{var n;for(let i=0;i<e.length;i++){const a=e[i],s=(n=r.data)===null||n===void 0?void 0:n[a];if(s)return s}return t};function lX(r){const e={top:"unset",right:"unset",bottom:"unset",left:"unset"};return r.split("-").forEach(n=>{e[n]="8px"}),e.flexDirection=r.startsWith("top")||r.startsWith("bottom")?"row":"column",e}const uX=`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`,cX=`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`;var qk=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Jh extends Tn{constructor(e,t){super(e,Object.assign({},Jh.defaultOptions,t)),this.$element=Js("toolbar",!1),this.onToolbarItemClick=i=>{const{onClick:a}=this.options;if(i.target instanceof Element&&i.target.className.includes("g6-toolbar-item")){const s=i.target.getAttribute("value");a==null||a(s,i.target)}};const n=this.context.canvas.getContainer();this.$element.style.display="flex",n.appendChild(this.$element),t1("g6-toolbar-css","style",{},uX,document.head),t1("g6-toolbar-svgicon","div",{display:"none"},cX),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(t)}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return qk(this,void 0,void 0,function*(){t.update.call(this,e);const{className:n,position:i,style:a}=this.options;this.$element.className=`g6-toolbar ${n||""}`,Object.assign(this.$element.style,a,lX(i)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return qk(this,void 0,void 0,function*(){return(yield this.options.getItems()).map(t=>`
          <div class="g6-toolbar-item" value="${t.value}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${t.id}"></use>
            </svg>
          </div>`).join("")})}}Jh.defaultOptions={position:"top-left"};var $k=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Qh extends Tn{constructor(e,t){super(e,Object.assign({},Qh.defaultOptions,t)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=(n,i)=>{const{enable:a}=this.options;return typeof a=="function"?a(n,i):a},this.onClick=n=>{const{target:{id:i}}=n;this.currentTarget===i?this.hide(n):this.show(n)},this.onPointerMove=n=>{const{target:i}=n;!this.currentTarget||i.id===this.currentTarget||this.show(n)},this.onPointerLeave=n=>{this.hide(n)},this.onCanvasMove=n=>{this.hide(n)},this.onPointerEnter=n=>{this.show(n)},this.showById=n=>$k(this,void 0,void 0,function*(){const i={target:{id:n}};yield this.show(i)}),this.getElementData=(n,i)=>{const{model:a}=this.context;switch(i){case"node":return a.getNodeData([n]);case"edge":return a.getEdgeData([n]);case"combo":return a.getComboData([n]);default:return[]}},this.show=n=>$k(this,void 0,void 0,function*(){var i,a;const{client:s,target:{id:o}}=n;if(Xc(n.target))return;const l=this.context.graph.getElementType(o),{getContent:u,title:c}=this.options,h=this.getElementData(o,l);if(!this.tooltipElement||!this.isEnable(n,h))return;let d={};if(u){if(d.content=yield u(n,h),!d.content)return}else{const v=this.context.graph.getElementRenderStyle(o),p=l==="node"?v.fill:v.stroke;d={title:c||l,data:h.map(y=>({name:"ID",value:y.id||`${y.source} -> ${y.target}`,color:p}))}}this.currentTarget=o;let f,g;if(s)f=s.x,g=s.y;else{const v=Bn(h,"0.style",{x:0,y:0});f=v.x,g=v.y}(a=(i=this.options).onOpenChange)===null||a===void 0||a.call(i,!0),this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:f,y:g,style:{".tooltip":{visibility:"visible"}}}),d))}),this.hide=n=>{var i,a,s,o,l;if(!n){(a=(i=this.options).onOpenChange)===null||a===void 0||a.call(i,!1),(s=this.tooltipElement)===null||s===void 0||s.hide(),this.currentTarget=null;return}if(!this.tooltipElement||!this.currentTarget)return;const{client:{x:u,y:c}}=n;(l=(o=this.options).onOpenChange)===null||l===void 0||l.call(o,!1),this.tooltipElement.hide(u,c),this.currentTarget=null},this.initTooltip=()=>{var n;const i=new IY({className:"tooltip",style:this.tooltipStyleProps});return(n=this.container)===null||n===void 0||n.appendChild(i.HTMLTooltipElement),i},this.render(),this.bindEvents()}getEvents(){return this.options.trigger==="click"?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(e){var t;this.unbindEvents(),super.update(e),this.tooltipElement&&((t=this.container)===null||t===void 0||t.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:e}=this.context,t=e.getContainer();t&&(this.container=t,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:e}=this.context,t=this.getEvents();Object.keys(t).forEach(n=>{e.off(n,t[n])})}bindEvents(){const{graph:e}=this.context,t=this.getEvents();Object.keys(t).forEach(n=>{e.on(n,t[n])})}get tooltipStyleProps(){const{canvas:e}=this.context,{center:t}=e.getBounds(),n=e.getContainer(),{top:i,left:a}=n.getBoundingClientRect(),{style:s,position:o,enterable:l,container:u={x:-a,y:-i},title:c,offset:h}=this.options,[d,f]=t,[g,v]=e.getSize();return{x:d,y:f,container:u,title:c,bounding:{x:0,y:0,width:g,height:v},position:o,enterable:l,offset:h,style:s}}destroy(){var e;this.unbindEvents(),this.tooltipElement&&((e=this.container)===null||e===void 0||e.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}}Qh.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};var wR=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};let ys;function xR(r,e){return ys||(ys=document.createElement("canvas")),ys.width=r,ys.height=e,ys.getContext("2d").clearRect(0,0,r,e),ys}function hX(r,e,t,n){return wR(this,void 0,void 0,function*(){const i=xR(r,e),a=i.getContext("2d"),{rotate:s,opacity:o,textFill:l,textFontSize:u,textFontFamily:c,textFontVariant:h,textFontWeight:d,textAlign:f,textBaseline:g}=n;return a.textAlign=f,a.textBaseline=g,a.translate(r/2,e/2),a.font=`${u}px ${c} ${h} ${d}`,s&&a.rotate(s),o&&(a.globalAlpha=o),l&&(a.fillStyle=l,a.fillText(`${t}`,0,0)),i.toDataURL()})}function dX(r,e,t,n){return wR(this,void 0,void 0,function*(){const i=xR(r,e),a=i.getContext("2d"),{rotate:s,opacity:o}=n;s&&a.rotate(s),o&&(a.globalAlpha=o);const l=new Image;return l.crossOrigin="anonymous",l.src=t,new Promise(u=>{l.onload=function(){const c=r>l.width?(r-l.width)/2:0,h=e>l.height?(e-l.height)/2:0;a.drawImage(l,0,0,l.width,l.height,c,h,r-c*2,e-h*2),u(i.toDataURL())}})})}var fX=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},gX=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class ed extends Tn{constructor(e,t){super(e,Object.assign({},ed.defaultOptions,t)),this.$element=Js("watermark"),this.context.canvas.getContainer().appendChild(this.$element),this.update(t)}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return fX(this,void 0,void 0,function*(){t.update.call(this,e);const n=this.options,{width:i,height:a,text:s,imageURL:o}=n,l=gX(n,["width","height","text","imageURL"]);Object.keys(l).forEach(c=>{c.startsWith("background")&&(this.$element.style[c]=e[c])});const u=o?yield dX(i,a,o,l):yield hX(i,a,s,l);this.$element.style.backgroundImage=`url(${u})`})}destroy(){super.destroy(),this.$element.remove()}}ed.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};const pX=["#7E92B5","#F4664A","#FFBE3A"],vX={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},yX={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function ER(r){const{bgColor:e,textColor:t,nodeColor:n,nodeColorDisabled:i,nodeStroke:a,nodeHaloStrokeOpacityActive:s=.15,nodeHaloStrokeOpacitySelected:o=.25,nodeOpacityDisabled:l=.06,nodeIconOpacityInactive:u=.85,nodeOpacityInactive:c=.25,nodeBadgePalette:h=pX,nodePaletteOptions:d=vX,edgeColor:f,edgeColorDisabled:g,edgePaletteOptions:v=yX,comboColor:p,comboColorDisabled:y,comboStroke:m,comboStrokeDisabled:w,edgeColorInactive:S}=r;return{background:e,node:{palette:d,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:h,fill:n,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:t,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:n,portLineWidth:1,portStroke:a,portStrokeOpacity:.65,size:32,stroke:a,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:o,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:a},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:s},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:a,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:c,donutOpacity:c,fillOpacity:c,iconOpacity:u,labelFill:t,labelFillOpacity:c,strokeOpacity:c},disabled:{badgeBackgroundOpacity:.25,donutOpacity:l,fill:i,fillOpacity:l,iconFill:i,iconOpacity:.25,labelFill:t,labelFillOpacity:.25,strokeOpacity:l}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:v,style:{badgeBackgroundFill:f,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:f,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:S,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:g,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:p,halo:!1,haloLineWidth:12,haloStroke:m,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:m},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:y,fillOpacity:.25,labelOpacity:.25,stroke:w,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const mX={type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},bX={bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:mX,nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"},wX=ER(bX),xX={bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"},EX=ER(xX);class xa extends q1{beforeDraw(e,t){return e}afterLayout(e,t){}}class SX extends xa{beforeDraw(e){const{model:t}=this.context,n=e.add.combos,i=a=>{const s=[];return a.forEach((o,l)=>{const c=t.getAncestorsData(l,"combo").map(h=>J(h)).reverse();s.push([l,o,c.length])}),new Map(s.sort(([,,o],[,,l])=>l-o).map(([o,l])=>[o,l]))};return e.add.combos=i(n),e.update.combos=i(e.update.combos),e}}function hr(r,e,t,n,i){const a=J(n),s=`${t}s`,o=i?n:r.add[s].get(a)||r.update[s].get(a)||r.remove[s].get(a)||n;Object.entries(r).forEach(([l,u])=>{e===l?u[s].set(a,o):u[s].delete(a)})}function ju(r,e){return Object.keys(r).every(t=>r[t]===e[t])}class _X extends xa{beforeDraw(e,t){if(t.stage==="visibility"||!this.context.model.model.hasTreeStructure(ct))return e;const{model:n}=this.context,{add:i,update:a}=e,s=[...e.update.combos.entries(),...e.add.combos.entries()];for(;s.length;){const[o,l]=s.pop();if(Jn(l)){const u=n.getDescendantsData(o),c=u.map(J),{internal:h,external:d}=qm(c,f=>n.getRelatedEdgesData(f));u.forEach(f=>{const g=J(f),v=s.findIndex(([y])=>y===g);v!==-1&&s.splice(v,1);const p=n.getElementType(g);hr(e,"remove",p,f)}),h.forEach(f=>hr(e,"remove","edge",f)),d.forEach(f=>{var g;const v=J(f);((g=this.context.element)===null||g===void 0?void 0:g.getElement(v))?a.edges.set(v,f):i.edges.set(v,f)})}else{const u=n.getChildrenData(o),c=u.map(J),{edges:h}=qm(c,d=>n.getRelatedEdgesData(d));[...u,...h].forEach(d=>{var f;const g=J(d),v=n.getElementType(g);((f=this.context.element)===null||f===void 0?void 0:f.getElement(g))?hr(e,"update",v,d):hr(e,"add",v,d),v==="combo"&&s.push([g,d])})}}return e}}const Gk=(r,e,t,n)=>{const i=`${t}s`,a=J(n);!r.add[i].has(a)&&!r.update[i].has(a)&&r[e][i].set(J(n),n)};class MX extends xa{getElement(e){return this.context.element.getElement(e)}handleExpand(e,t){if(Gk(t,"add","node",e),Jn(e))return;const n=J(e);Gk(t,"add","node",e),this.context.model.getRelatedEdgesData(n,"out").forEach(s=>{hr(t,"add","edge",s)}),this.context.model.getChildrenData(n).forEach(s=>{this.handleExpand(s,t)})}beforeDraw(e){const{graph:t,model:n}=this.context;if(!n.model.hasTreeStructure(lr))return e;const{add:{nodes:i,edges:a},update:{nodes:s}}=e,o=new Map,l=new Map;i.forEach((c,h)=>{Jn(c)&&o.set(h,c)}),a.forEach(c=>{if(t.getElementType(c.source)!=="node")return;const h=t.getNodeData(c.source);Jn(h)&&o.set(c.source,h)}),s.forEach((c,h)=>{const d=this.getElement(h);if(!d)return;const f=d.attributes.collapsed;Jn(c)?f||o.set(h,c):f&&l.set(h,c)});const u=new Set;return o.forEach((c,h)=>{n.getDescendantsData(h).forEach(f=>{const g=J(f);if(u.has(g))return;hr(e,"remove","node",f),n.getRelatedEdgesData(g).forEach(p=>{hr(e,"remove","edge",p)}),u.add(g)})}),l.forEach((c,h)=>{if(n.getAncestorsData(h,lr).some(Jn)){hr(e,"remove","node",c);return}this.handleExpand(c,e)}),e}}function OX(r,e,t,n=!1){const i=Rm[r][e];!n&&i?i!==t&&gi.warn(`The extension ${e} of ${r} has been registered before.`):Object.assign(Rm[r],{[e]:t})}/*!
 * @antv/g-plugin-dragndrop
 * @description A G plugin for Drag n Drop implemented with PointerEvents
 * @version 2.0.32
 * @date 1/23/2025, 8:33:12 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var SR=function(){function r(e){de(this,r),this.dragndropPluginOptions=e}return fe(r,[{key:"apply",value:function(t){var n=this,i=t.renderingService,a=t.renderingContext,s=a.root.ownerDocument,o=s.defaultView,l=function(c){var h=c.target,d=h===s,f=d&&n.dragndropPluginOptions.isDocumentDraggable?s:h.closest&&h.closest("[draggable=true]");if(f){var g=!1,v=c.timeStamp,p=[c.clientX,c.clientY],y=null,m=[c.clientX,c.clientY],w=function(){var _=ha(_n().mark(function O(T){var k,P,C,N,L,F;return _n().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(g){V.next=8;break}if(k=T.timeStamp-v,P=Xn([T.clientX,T.clientY],p),!(k<=n.dragndropPluginOptions.dragstartTimeThreshold||P<=n.dragndropPluginOptions.dragstartDistanceThreshold)){V.next=5;break}return V.abrupt("return");case 5:T.type="dragstart",f.dispatchEvent(T),g=!0;case 8:if(T.type="drag",T.dx=T.clientX-m[0],T.dy=T.clientY-m[1],f.dispatchEvent(T),m=[T.clientX,T.clientY],d){V.next=21;break}return C=n.dragndropPluginOptions.overlap==="pointer"?[T.canvasX,T.canvasY]:h.getBounds().center,V.next=17,s.elementsFromPoint(C[0],C[1]);case 17:N=V.sent,L=N[N.indexOf(h)+1],F=(L==null?void 0:L.closest("[droppable=true]"))||(n.dragndropPluginOptions.isDocumentDroppable?s:null),y!==F&&(y&&(T.type="dragleave",T.target=y,y.dispatchEvent(T)),F&&(T.type="dragenter",T.target=F,F.dispatchEvent(T)),y=F,y&&(T.type="dragover",T.target=y,y.dispatchEvent(T)));case 21:case"end":return V.stop()}},O)}));return function(T){return _.apply(this,arguments)}}();o.addEventListener("pointermove",w);var S=function(O){if(g){O.detail={preventClick:!0};var T=O.clone();y&&(T.type="drop",T.target=y,y.dispatchEvent(T)),T.type="dragend",f.dispatchEvent(T),g=!1}o.removeEventListener("pointermove",w)};h.addEventListener("pointerup",S,{once:!0}),h.addEventListener("pointerupoutside",S,{once:!0})}};i.hooks.init.tap(r.tag,function(){o.addEventListener("pointerdown",l)}),i.hooks.destroy.tap(r.tag,function(){o.removeEventListener("pointerdown",l)})}}])}();SR.tag="Dragndrop";var kX=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return de(this,e),t=We(this,e),t.name="dragndrop",t.options=n,t}return Ve(e,r),fe(e,[{key:"init",value:function(){this.addRenderingPlugin(new SR(Ge({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(n){Object.assign(this.plugins[0].dragndropPluginOptions,n)}}])}(ga),Wk=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},Vk=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const Uk=["main"],Hk=["background","main","label","transient"];function TX(r){return r.main}class Yk{getConfig(){return this.config}getLayer(e="main"){return this.extends.layers[e]||TX(this.getLayers())}getLayers(){return this.extends.layers}getRenderer(e){return this.extends.renderers[e]}getCamera(e="main"){return this.getLayer(e).getCamera()}getRoot(e="main"){return this.getLayer(e).getRoot()}getContextService(e="main"){return this.getLayer(e).getContextService()}setCursor(e){this.config.cursor=e,this.getLayer().setCursor(e)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}constructor(e){this.config={enableMultiLayer:!0},Object.assign(this.config,e);const t=this.config,{renderer:n,background:i,cursor:a,enableMultiLayer:s}=t,o=Vk(t,["renderer","background","cursor","enableMultiLayer"]),l=s?Hk:Uk,u=Xk(n,l),c=Object.fromEntries(l.map(h=>{const d=new Nm(Object.assign(Object.assign({},o),{supportsMutipleCanvasesInOneContainer:s,renderer:u[h],background:s?h==="background"?i:void 0:i}));return[h,d]}));Kk(c),this.extends={config:this.config,renderer:n,renderers:u,layers:c}}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,e])=>e.ready))}resize(e,t){Object.assign(this.extends.config,{width:e,height:t}),Object.values(this.getLayers()).forEach(n=>{const i=n.getCamera(),a=i.getPosition(),s=i.getFocalPoint();n.resize(e,t),i.setPosition(a),i.setFocalPoint(s)})}getBounds(e){return cl(Object.values(this.getLayers()).map(t=>e?t.getRoot().childNodes.find(i=>i.classList.includes(e)):t.getRoot()).filter(t=>(t==null?void 0:t.childNodes.length)>0).map(t=>t.getBounds()))}getContainer(){const e=this.extends.config.container;return typeof e=="string"?document.getElementById(e):e}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(e,t){var n;const i=((n=e.style)===null||n===void 0?void 0:n.$layer)||"main";return this.getLayer(i).appendChild(e,t)}setRenderer(e){if(e===this.extends.renderer)return;const t=Xk(e,this.config.enableMultiLayer?Hk:Uk);this.extends.renderers=t,Object.entries(t).forEach(([n,i])=>this.getLayer(n).setRenderer(i)),Kk(this.getLayers())}getCanvasByViewport(e){return Sn(this.getLayer().viewport2Canvas(zr(e)))}getViewportByCanvas(e){return Sn(this.getLayer().canvas2Viewport(zr(e)))}getViewportByClient(e){return Sn(this.getLayer().client2Viewport(zr(e)))}getClientByViewport(e){return Sn(this.getLayer().viewport2Client(zr(e)))}getClientByCanvas(e){return this.getClientByViewport(this.getViewportByCanvas(e))}getCanvasByClient(e){const t=this.getLayer(),n=t.client2Viewport(zr(e));return Sn(t.viewport2Canvas(n))}toDataURL(){return Wk(this,arguments,void 0,function*(e={}){const t=globalThis.devicePixelRatio||1,{mode:n="viewport"}=e,i=Vk(e,["mode"]);let[a,s,o,l]=[0,0,0,0];if(n==="viewport")[o,l]=this.getSize();else if(n==="overall"){const y=this.getBounds(),m=pa(y);[a,s]=y.min,[o,l]=m}const u=vm('<div id="virtual-image"></div>'),c=new Nm({width:o,height:l,renderer:new Vo,devicePixelRatio:t,container:u,background:this.extends.config.background});yield c.ready,c.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),c.appendChild(this.getRoot().cloneNode(!0));const h=this.getLayer("label").getRoot().cloneNode(!0),d=c.viewport2Canvas({x:0,y:0}),f=this.getCanvasByViewport([0,0]);h.translate([f[0]-d.x,f[1]-d.y]),h.scale(1/this.getCamera().getZoom()),c.appendChild(h),c.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const g=this.getCamera(),v=c.getCamera();if(n==="viewport")v.setZoom(g.getZoom()),v.setPosition(g.getPosition()),v.setFocalPoint(g.getFocalPoint());else if(n==="overall"){const[y,m,w]=v.getPosition(),[S,_,O]=v.getFocalPoint();v.setPosition([y+a,m+s,w]),v.setFocalPoint([S+a,_+s,O])}const p=c.getContextService();return new Promise(y=>{c.addEventListener(or.RERENDER,()=>Wk(this,void 0,void 0,function*(){yield new Promise(w=>setTimeout(w,300));const m=yield p.toDataURL(i);y(m)}))})})}destroy(){Object.values(this.getLayers()).forEach(e=>{e.getCamera().cancelLandmarkAnimation(),e.destroy()})}}function Xk(r,e){return Object.fromEntries(e.map(t=>{const n=(r==null?void 0:r(t))||new Vo;return n instanceof Vo&&n.setConfig({enableDirtyRectangleRendering:!1}),t==="main"?n.registerPlugin(new kX({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):n.unregisterPlugin(n.getPlugin("dom-interaction")),[t,n]}))}function Kk(r){Object.entries(r).forEach(([e,t])=>{const n=t.getContextService().getDomElement();n!=null&&n.style&&(n.style.gridArea="1 / 1 / 2 / 2",n.style.outline="none",n.tabIndex=1,e!=="main"&&(n.style.pointerEvents="none")),n!=null&&n.parentElement&&(n.parentElement.style.display="grid")})}const ms=r=>r?parseInt(r):0;function AX(r){const e=getComputedStyle(r),t=r.clientWidth||ms(e.width),n=r.clientHeight||ms(e.height),i=ms(e.paddingLeft)+ms(e.paddingRight),a=ms(e.paddingTop)+ms(e.paddingBottom);return[t-i,n-a]}function Zk(r){if(!r)return[0,0];let e=640,t=480;const[n,i]=AX(r);e=n||e,t=i||t;const a=1,s=1;return[Math.max(_e(e)?e:a,a),Math.max(_e(t)?t:s,s)]}class td{constructor(e){this.type=e}}class Qt extends td{constructor(e,t){super(e),this.data=t}}class Or extends td{constructor(e,t,n,i){super(e),this.animationType=t,this.animation=n,this.data=i}}class bs extends td{constructor(e,t,n){super(e),this.elementType=t,this.data=n}}class Au extends td{constructor(e,t){super(e),this.data=t}}function ln(r,e){r.emit(e.type,e)}function PX(r){if(!r)return null;if(r instanceof IA)return{type:"canvas",element:r};let e=r;for(;e;){if(pl(e))return{type:"node",element:e};if($P(e))return{type:"edge",element:e};if(Z1(e))return{type:"combo",element:e};e=e.parentElement}return null}function Jk(r){var e;return((e=r==null?void 0:r.style)===null||e===void 0?void 0:e.zIndex)||0}const Do="cachedStyle",jb=r=>`__${r}__`;function CX(r,e){const t=Array.isArray(e)?e:[e];Bn(r,Do)||Bo(r,Do,{}),t.forEach(n=>{Bo(Bn(r,Do),jb(n),r.attributes[n])})}function Qk(r,e){return Bn(r,[Do,jb(e)])}function NX(r,e){return jb(e)in(Bn(r,Do)||{})}class RX{constructor(e){this.tasks=[],this.animations=new Set,this.context=e}getTasks(){const e=[...this.tasks];return this.tasks=[],e}add(e,t){this.tasks.push([e,t])}animate(e,t,n){var i,a,s;(i=t==null?void 0:t.before)===null||i===void 0||i.call(t);const o=this.getTasks().map(([u,c])=>{var h,d,f;const{element:g,elementType:v,stage:p}=u,y=jB(this.context.options,v,p,e);(h=c==null?void 0:c.before)===null||h===void 0||h.call(c);const m=y.length?$B(g,this.inferStyle(u,n),y):null;return m?((d=c==null?void 0:c.beforeAnimate)===null||d===void 0||d.call(c,m),m.finished.then(()=>{var w,S;(w=c==null?void 0:c.afterAnimate)===null||w===void 0||w.call(c,m),(S=c==null?void 0:c.after)===null||S===void 0||S.call(c),this.animations.delete(m)})):(f=c==null?void 0:c.after)===null||f===void 0||f.call(c),m}).filter(Boolean);o.forEach(u=>this.animations.add(u));const l=F1(o);return l?((a=t==null?void 0:t.beforeAnimate)===null||a===void 0||a.call(t,l),l.finished.then(()=>{var u,c;(u=t==null?void 0:t.afterAnimate)===null||u===void 0||u.call(t,l),(c=t==null?void 0:t.after)===null||c===void 0||c.call(t),this.release()})):(s=t==null?void 0:t.after)===null||s===void 0||s.call(t),l}inferStyle(e,t){var n,i;const{element:a,elementType:s,stage:o,originalStyle:l,updatedStyle:u={}}=e;e.modifiedStyle||(e.modifiedStyle=Object.assign(Object.assign({},l),u));const{modifiedStyle:c}=e,h={},d={};if(o==="enter")Object.assign(h,{opacity:0});else if(o==="exit")Object.assign(d,{opacity:0});else if(o==="show")Object.assign(h,{opacity:0}),Object.assign(d,{opacity:(n=Qk(a,"opacity"))!==null&&n!==void 0?n:Go("opacity")});else if(o==="hide")Object.assign(h,{opacity:(i=Qk(a,"opacity"))!==null&&i!==void 0?i:Go("opacity")}),Object.assign(d,{opacity:0});else if(o==="collapse"){const{collapse:f}=t||{},{target:g,descendants:v,position:p}=f;if(s==="node"){if(v.includes(a.id)){const[y,m,w]=p;Object.assign(d,{x:y,y:m,z:w})}}else if(s==="combo"){if(a.id===g||v.includes(a.id)){const[y,m]=p;Object.assign(d,{x:y,y:m,childrenNode:l.childrenNode})}}else s==="edge"&&Object.assign(d,{sourceNode:c.sourceNode,targetNode:c.targetNode})}else if(o==="expand"){const{expand:f}=t||{},{target:g,descendants:v,position:p}=f;if(s==="node"){if(a.id===g||v.includes(a.id)){const[y,m,w]=p;Object.assign(h,{x:y,y:m,z:w})}}else if(s==="combo"){if(a.id===g||v.includes(a.id)){const[y,m,w]=p;Object.assign(h,{x:y,y:m,z:w,childrenNode:c.childrenNode})}}else s==="edge"&&Object.assign(h,{sourceNode:c.sourceNode,targetNode:c.targetNode})}return[Object.keys(h).length>0?Object.assign({},l,h):l,Object.keys(d).length>0?Object.assign({},c,d):c]}stop(){this.animations.forEach(e=>e.cancel())}clear(){this.tasks=[]}release(){var e,t;const{canvas:n}=this.context,i=(t=(e=n.document)===null||e===void 0?void 0:e.timeline)===null||t===void 0?void 0:t.animationsWithPromises;i&&(n.document.timeline.animationsWithPromises=i.filter(a=>a.playState!=="finished"))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class LX{constructor(e){this.batchCount=0,this.context=e}emit(e){const{graph:t}=this.context;t.emit(e.type,e)}startBatch(e=!0){this.batchCount++,this.batchCount===1&&this.emit(new Qt(ye.BATCH_START,{initiate:e}))}endBatch(){this.batchCount--,this.batchCount===0&&this.emit(new Qt(ye.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class IX extends j1{constructor(e){super(e),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=t=>{const{target:n}=t,i=PX(n);if(!i)return;const{graph:a,canvas:s}=this.context,{type:o,element:l}=i;if("destroyed"in l&&(Xc(l)||l.destroyed))return;const{type:u,detail:c,button:h}=t,d=Object.assign(Object.assign({},t),{target:l,targetType:o,originalTarget:n});u===ie.POINTER_MOVE&&(this.currentTarget!==l&&(this.currentTarget&&a.emit(`${this.currentTargetType}:${ie.POINTER_LEAVE}`,Object.assign(Object.assign({},d),{type:ie.POINTER_LEAVE,target:this.currentTarget,targetType:this.currentTargetType})),l&&(Object.assign(d,{type:ie.POINTER_ENTER}),a.emit(`${o}:${ie.POINTER_ENTER}`,d))),this.currentTarget=l,this.currentTargetType=o),u===ie.CLICK&&h===2||(a.emit(`${o}:${u}`,d),a.emit(u,d)),u===ie.CLICK&&c===2&&(Object.assign(d,{type:ie.DBLCLICK}),a.emit(`${o}:${ie.DBLCLICK}`,d),a.emit(ie.DBLCLICK,d)),u===ie.POINTER_DOWN&&h===2&&(Object.assign(d,{type:ie.CONTEXT_MENU,preventDefault:()=>{var f;(f=s.getContainer())===null||f===void 0||f.addEventListener(ie.CONTEXT_MENU,g=>g.preventDefault(),{once:!0})}}),a.emit(`${o}:${ie.CONTEXT_MENU}`,d),a.emit(ie.CONTEXT_MENU,d))},this.forwardContainerEvents=t=>{this.context.graph.emit(t.type,t)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(e){this.setExtensions(e)}forwardEvents(){const e=this.context.canvas.getContainer();e&&[Ms.KEY_DOWN,Ms.KEY_UP].forEach(n=>{e.addEventListener(n,this.forwardContainerEvents)});const t=this.context.canvas.document;t&&[ie.CLICK,ie.DBLCLICK,ie.POINTER_OVER,ie.POINTER_LEAVE,ie.POINTER_ENTER,ie.POINTER_MOVE,ie.POINTER_OUT,ie.POINTER_DOWN,ie.POINTER_UP,ie.CONTEXT_MENU,ie.DRAG_START,ie.DRAG,ie.DRAG_END,ie.DRAG_ENTER,ie.DRAG_OVER,ie.DRAG_LEAVE,ie.DROP,ie.WHEEL].forEach(n=>{t.addEventListener(n,this.forwardCanvasEvents)})}destroy(){const e=this.context.canvas.getContainer();e&&[Ms.KEY_DOWN,Ms.KEY_UP].forEach(t=>{e.removeEventListener(t,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}var el=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function Vi(r,e){const{data:t,style:n}=r,i=el(r,["data","style"]),{data:a,style:s}=e,o=el(e,["data","style"]),l=Object.assign(Object.assign({},i),o);return(t||a)&&Object.assign(l,{data:Object.assign(Object.assign({},t),a)}),(n||s)&&Object.assign(l,{style:Object.assign(Object.assign({},n),s)}),l}function Jy(r){const{data:e,style:t}=r,i=el(r,["data","style"]);return e&&(i.data=Object.assign({},e)),t&&(i.style=Object.assign({},t)),i}function ws(r={},e={}){const{states:t=[],data:n={},style:i={},children:a=[]}=r,s=el(r,["states","data","style","children"]),{states:o=[],data:l={},style:u={},children:c=[]}=e,h=el(e,["states","data","style","children"]),d=(g,v)=>g.length!==v.length?!1:g.every((p,y)=>p===v[y]),f=(g,v)=>{const p=Object.keys(g),y=Object.keys(v);return p.length!==y.length?!1:p.every(m=>g[m]===v[m])};return!(!f(s,h)||!d(a,c)||!d(t,o)||!f(n,l)||!f(i,u))}var DX=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function Qy(r){const{id:e=J(r),style:t,data:n}=r,i=DX(r,["id","style","data"]),a=Object.assign(Object.assign({},r),{style:Object.assign({},t),data:Object.assign({},n)});return YB(r)?Object.assign({id:e,data:a},i):{id:e,data:a}}function gn(r){return r.data}function FX(r){if(r.hasTreeStructure(lr))return;r.attachTreeStructure(lr);const e=r.getAllEdges();for(const t of e){const{source:n,target:i}=t;r.setParent(i,n,lr)}}class BX{constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new dn}pushChange(e){if(this.isTraceless)return;const{type:t}=e;if(t===Mt.NodeUpdated||t===Mt.EdgeUpdated||t===Mt.ComboUpdated){const{value:n,original:i}=e;this.changes.push({value:Jy(n),original:Jy(i),type:t})}else this.changes.push({value:Jy(e.value),type:t})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(e){this.batchCount++,this.model.batch(e),this.batchCount--}isBatching(){return this.batchCount>0}silence(e){this.isTraceless=!0,e(),this.isTraceless=!1}isCombo(e){return this.comboIds.has(e)||this.latestRemovedComboIds.has(e)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(e){return this.model.getAllNodes().reduce((t,n)=>{const i=gn(n);return this.isCombo(J(i))||(e===void 0||e.includes(J(i)))&&t.push(i),t},[])}getEdgeDatum(e){return gn(this.model.getEdge(e))}getEdgeData(e){return this.model.getAllEdges().reduce((t,n)=>{const i=gn(n);return(e===void 0||e.includes(J(i)))&&t.push(i),t},[])}getComboData(e){return this.model.getAllNodes().reduce((t,n)=>{const i=gn(n);return this.isCombo(J(i))&&(e===void 0||e.includes(J(i)))&&t.push(i),t},[])}getRootsData(e=lr){return this.model.getRoots(e).map(gn)}getAncestorsData(e,t){const{model:n}=this;return!n.hasNode(e)||!n.hasTreeStructure(t)?[]:n.getAncestors(e,t).map(gn)}getDescendantsData(e){const t=this.getElementDataById(e),n=[];return za(t,i=>{i!==t&&n.push(i)},i=>this.getChildrenData(J(i)),"TB"),n}getParentData(e,t){const{model:n}=this;if(!t){gi.warn("The hierarchy structure key is not specified");return}if(!n.hasNode(e)||!n.hasTreeStructure(t))return;const i=n.getParent(e,t);return i?gn(i):void 0}getChildrenData(e){const t=this.getElementType(e)==="node"?lr:ct,{model:n}=this;return!n.hasNode(e)||!n.hasTreeStructure(t)?[]:n.getChildren(e,t).map(gn)}getElementsDataByType(e){return e==="node"?this.getNodeData():e==="edge"?this.getEdgeData():e==="combo"?this.getComboData():[]}getElementDataById(e){return this.getElementType(e)==="edge"?this.getEdgeDatum(e):this.getNodeLikeDatum(e)}getNodeLikeDatum(e){const t=this.model.getNode(e);return gn(t)}getNodeLikeData(e){return this.model.getAllNodes().reduce((t,n)=>{const i=gn(n);return e?e.includes(J(i))&&t.push(i):t.push(i),t},[])}getElementDataByState(e,t){return this.getElementsDataByType(e).filter(i=>{var a;return(a=i.states)===null||a===void 0?void 0:a.includes(t)})}getElementState(e){var t;return((t=this.getElementDataById(e))===null||t===void 0?void 0:t.states)||[]}hasNode(e){return this.model.hasNode(e)&&!this.isCombo(e)}hasEdge(e){return this.model.hasEdge(e)}hasCombo(e){return this.model.hasNode(e)&&this.isCombo(e)}getRelatedEdgesData(e,t="both"){return this.model.getRelatedEdges(e,t).map(gn)}getNeighborNodesData(e){return this.model.getNeighbors(e).map(gn)}setData(e){const{nodes:t=[],edges:n=[],combos:i=[]}=e,{nodes:a,edges:s,combos:o}=this.getData(),l=sa(a,t,h=>J(h),ws),u=sa(s,n,h=>J(h),ws),c=sa(o,i,h=>J(h),ws);this.batch(()=>{const h={nodes:l.enter,edges:u.enter,combos:c.enter};this.addData(h),this.computeZIndex(h,"add",!0);const d={nodes:l.update,edges:u.update,combos:c.update};this.updateData(d),this.computeZIndex(d,"update",!0);const f={nodes:l.exit.map(J),edges:u.exit.map(J),combos:c.exit.map(J)};this.removeData(f)})}addData(e){const{nodes:t,edges:n,combos:i}=e;this.batch(()=>{this.addComboData(i),this.addNodeData(t),this.addEdgeData(n)}),this.computeZIndex(e,"add")}addNodeData(e=[]){e.length&&(this.model.addNodes(e.map(t=>(this.pushChange({value:t,type:Mt.NodeAdded}),Qy(t)))),this.updateNodeLikeHierarchy(e),this.computeZIndex({nodes:e},"add"))}addEdgeData(e=[]){e.length&&(this.model.addEdges(e.map(t=>(this.pushChange({value:t,type:Mt.EdgeAdded}),Qy(t)))),this.computeZIndex({edges:e},"add"))}addComboData(e=[]){if(!e.length)return;const{model:t}=this;t.hasTreeStructure(ct)||t.attachTreeStructure(ct),t.addNodes(e.map(n=>(this.comboIds.add(J(n)),this.pushChange({value:n,type:Mt.ComboAdded}),Qy(n)))),this.updateNodeLikeHierarchy(e),this.computeZIndex({combos:e},"add")}addChildrenData(e,t){const n=this.getNodeLikeDatum(e),i=t.map(J);this.addNodeData(t),this.updateNodeData([{id:e,children:[...n.children||[],...i]}]),this.addEdgeData(i.map(a=>({source:e,target:a})))}computeZIndex(e,t,n=!1){!n&&this.isBatching()||this.batch(()=>{const{nodes:i=[],edges:a=[],combos:s=[]}=e;s.forEach(o=>{var l,u,c;const h=J(o);if(t==="add"&&_e((l=o.style)===null||l===void 0?void 0:l.zIndex)||t==="update"&&!("combo"in o))return;const d=this.getParentData(h,ct),f=d?((c=(u=d.style)===null||u===void 0?void 0:u.zIndex)!==null&&c!==void 0?c:0)+1:0;this.preventUpdateNodeLikeHierarchy(()=>{this.updateComboData([{id:h,style:{zIndex:f}}])})}),i.forEach(o=>{var l,u,c;const h=J(o);if(t==="add"&&_e((l=o.style)===null||l===void 0?void 0:l.zIndex)||t==="update"&&!("combo"in o)&&!("children"in o))return;let d=0;const f=this.getParentData(h,ct);if(f)d=(((u=f.style)===null||u===void 0?void 0:u.zIndex)||0)+1;else{const g=this.getParentData(h,lr);g&&(d=((c=g==null?void 0:g.style)===null||c===void 0?void 0:c.zIndex)||0)}this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:h,style:{zIndex:d}}])})}),a.forEach(o=>{var l,u,c,h,d;if(_e((l=o.style)===null||l===void 0?void 0:l.zIndex))return;let{id:f,source:g,target:v}=o;if(!f)f=J(o);else{const m=this.getEdgeDatum(f);g=m.source,v=m.target}if(!g||!v)return;const p=((c=(u=this.getNodeLikeDatum(g))===null||u===void 0?void 0:u.style)===null||c===void 0?void 0:c.zIndex)||0,y=((d=(h=this.getNodeLikeDatum(v))===null||h===void 0?void 0:h.style)===null||d===void 0?void 0:d.zIndex)||0;this.updateEdgeData([{id:J(o),style:{zIndex:Math.max(p,y)-1}}])})})}getFrontZIndex(e){var t;const n=this.getElementType(e),i=this.getElementDataById(e),a=this.getData();if(Object.assign(a,{[`${n}s`]:a[`${n}s`].filter(s=>J(s)!==e)}),n==="combo"&&!Jn(i)){const s=new Set(this.getAncestorsData(e,ct).map(J));a.nodes=a.nodes.filter(o=>!s.has(J(o))),a.combos=a.combos.filter(o=>!s.has(J(o))),a.edges=a.edges.filter(({source:o,target:l})=>!s.has(o)&&!s.has(l))}return Math.max(((t=i.style)===null||t===void 0?void 0:t.zIndex)||0,0,...Object.values(a).flat().map(s=>{var o;return(((o=s==null?void 0:s.style)===null||o===void 0?void 0:o.zIndex)||0)+1}))}updateNodeLikeHierarchy(e){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:t}=this;e.forEach(n=>{const i=J(n),a=ou(n);a!==void 0&&(t.hasTreeStructure(ct)||t.attachTreeStructure(ct),a===null&&this.refreshComboData(i),this.setParent(i,ou(n),ct));const s=n.children||[];if(s.length){t.hasTreeStructure(lr)||t.attachTreeStructure(lr);const o=s.filter(l=>t.hasNode(l));o.forEach(l=>this.setParent(l,i,lr)),o.length!==s.length&&this.updateNodeData([{id:i,children:o}])}})}preventUpdateNodeLikeHierarchy(e){this.enableUpdateNodeLikeHierarchy=!1,e(),this.enableUpdateNodeLikeHierarchy=!0}updateData(e){const{nodes:t,edges:n,combos:i}=e;this.batch(()=>{this.updateNodeData(t),this.updateComboData(i),this.updateEdgeData(n)}),this.computeZIndex(e,"update")}updateNodeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{const n=[];e.forEach(i=>{const a=J(i),s=gn(t.getNode(a));if(ws(s,i))return;const o=Vi(s,i);this.pushChange({value:o,original:s,type:Mt.NodeUpdated}),t.mergeNodeData(a,o),n.push(o)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({nodes:e},"update")}refreshData(){const{nodes:e,edges:t,combos:n}=this.getData();e.forEach(i=>{this.pushChange({value:i,original:i,type:Mt.NodeUpdated})}),t.forEach(i=>{this.pushChange({value:i,original:i,type:Mt.EdgeUpdated})}),n.forEach(i=>{this.pushChange({value:i,original:i,type:Mt.ComboUpdated})})}syncNodeLikeDatum(e){const{model:t}=this,n=J(e);if(!t.hasNode(n))return;const i=gn(t.getNode(n)),a=Vi(i,e);t.mergeNodeData(n,a)}syncEdgeDatum(e){const{model:t}=this,n=J(e);if(!t.hasEdge(n))return;const i=gn(t.getEdge(n)),a=Vi(i,e);t.mergeEdgeData(n,a)}updateEdgeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{e.forEach(n=>{const i=J(n),a=gn(t.getEdge(i));if(ws(a,n))return;n.source&&a.source!==n.source&&t.updateEdgeSource(i,n.source),n.target&&a.target!==n.target&&t.updateEdgeTarget(i,n.target);const s=Vi(a,n);this.pushChange({value:s,original:a,type:Mt.EdgeUpdated}),t.mergeEdgeData(i,s)})}),this.computeZIndex({edges:e},"update")}updateComboData(e=[]){if(!e.length)return;const{model:t}=this;t.batch(()=>{const n=[];e.forEach(i=>{const a=J(i),s=gn(t.getNode(a));if(ws(s,i))return;const o=Vi(s,i);this.pushChange({value:o,original:s,type:Mt.ComboUpdated}),t.mergeNodeData(a,o),n.push(o)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({combos:e},"update")}setParent(e,t,n,i=!0){if(e===t)return;const a=this.getNodeLikeDatum(e),s=ou(a);if(s!==t&&n===ct){const o={id:e,combo:t};this.isCombo(e)?this.syncNodeLikeDatum(o):this.syncNodeLikeDatum(o)}this.model.setParent(e,t,n),i&&n===ct&&u3([s,t]).forEach(o=>{o!==void 0&&this.refreshComboData(o)})}refreshComboData(e){const t=this.getComboData([e])[0],n=this.getAncestorsData(e,ct);t&&this.pushChange({value:t,original:t,type:Mt.ComboUpdated}),n.forEach(i=>{this.pushChange({value:i,original:i,type:Mt.ComboUpdated})})}getElementPosition(e){const t=this.getElementDataById(e);return un(t)}translateNodeLikeBy(e,t){this.isCombo(e)?this.translateComboBy(e,t):this.translateNodeBy(e,t)}translateNodeLikeTo(e,t){this.isCombo(e)?this.translateComboTo(e,t):this.translateNodeTo(e,t)}translateNodeBy(e,t){const n=this.getElementPosition(e),i=$e(n,[...t,0].slice(0,3));this.translateNodeTo(e,i)}translateNodeTo(e,t){const[n=0,i=0,a=0]=t;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:e,style:{x:n,y:i,z:a}}])})}translateComboBy(e,t){const[n=0,i=0,a=0]=t;if([n,i,a].some(isNaN)||[n,i,a].every(l=>l===0))return;const s=this.getComboData([e])[0];if(!s)return;const o=new Set;za(s,l=>{const u=J(l);if(o.has(u))return;o.add(u);const[c,h,d]=un(l),f=Vi(l,{style:{x:c+n,y:h+i,z:d+a}});this.pushChange({value:f,original:l,type:this.isCombo(u)?Mt.ComboUpdated:Mt.NodeUpdated}),this.model.mergeNodeData(u,f)},l=>this.getChildrenData(J(l)),"BT")}translateComboTo(e,t){var n;if(t.some(isNaN))return;const[i=0,a=0,s=0]=t,o=(n=this.getComboData([e]))===null||n===void 0?void 0:n[0];if(!o)return;const[l,u,c]=un(o),h=i-l,d=a-u,f=s-c;za(o,g=>{const v=J(g),[p,y,m]=un(g),w=Vi(g,{style:{x:p+h,y:y+d,z:m+f}});this.pushChange({value:w,original:g,type:this.isCombo(v)?Mt.ComboUpdated:Mt.NodeUpdated}),this.model.mergeNodeData(v,w)},g=>this.getChildrenData(J(g)),"BT")}removeData(e){const{nodes:t,edges:n,combos:i}=e;this.batch(()=>{this.removeEdgeData(n),this.removeNodeData(t),this.removeComboData(i),this.latestRemovedComboIds=new Set(i)})}removeNodeData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(J)),this.pushChange({value:this.getNodeData([t])[0],type:Mt.NodeRemoved}),this.removeNodeLikeHierarchy(t)}),this.model.removeNodes(e)})}removeEdgeData(e=[]){e.length&&(e.forEach(t=>this.pushChange({value:this.getEdgeData([t])[0],type:Mt.EdgeRemoved})),this.model.removeEdges(e))}removeComboData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.pushChange({value:this.getComboData([t])[0],type:Mt.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)}),this.model.removeNodes(e)})}removeNodeLikeHierarchy(e){if(this.model.hasTreeStructure(ct)){const t=ou(this.getNodeLikeDatum(e));this.setParent(e,void 0,ct,!1),this.model.getChildren(e,ct).forEach(n=>{const i=gn(n),a=J(i);this.setParent(J(i),t,ct,!1);const s=Vi(i,{id:J(i),combo:t});this.pushChange({value:s,original:i,type:this.isCombo(a)?Mt.ComboUpdated:Mt.NodeUpdated}),this.model.mergeNodeData(J(i),s)}),Le(t)||this.refreshComboData(t)}}getElementType(e){if(this.model.hasNode(e))return this.isCombo(e)?"combo":"node";if(this.model.hasEdge(e))return"edge";throw new Error(Ai(`Unknown element type of id: ${e}`))}destroy(){const{model:e}=this,t=e.getAllNodes(),n=e.getAllEdges();e.removeEdges(n.map(i=>i.id)),e.removeNodes(t.map(i=>i.id)),this.context={}}}var po=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class zX{constructor(e){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=e}init(){this.initContainer()}initContainer(){if(!this.container||this.container.destroyed){const{canvas:e}=this.context;this.container=e.appendChild(new hn({className:"elements"}))}}emit(e,t){t.silence||ln(this.context.graph,e)}forEachElementData(e){Xa.forEach(t=>{const n=this.context.model.getElementsDataByType(t);e(t,n)})}getElementType(e,t){var n;const{options:i,graph:a}=this.context,s=((n=i[e])===null||n===void 0?void 0:n.type)||t.type;return s?typeof s=="string"?s:s.call(a,t):e==="edge"?"line":"circle"}getTheme(e){return HA(this.context.options)[e]||{}}getThemeStyle(e){return this.getTheme(e).style||{}}getThemeStateStyle(e,t){const{state:n={}}=this.getTheme(e);return Object.assign({},...t.map(i=>n[i]||{}))}computePaletteStyle(){const{options:e}=this.context;this.paletteStyle={},this.forEachElementData((t,n)=>{var i,a;const s=Object.assign({},nx((i=this.getTheme(t))===null||i===void 0?void 0:i.palette),nx((a=e[t])===null||a===void 0?void 0:a.palette));s!=null&&s.field&&Object.assign(this.paletteStyle,G5(n,s))})}getPaletteStyle(e,t){const n=this.paletteStyle[t];return n?e==="edge"?{stroke:n}:{fill:n}:{}}computeElementDefaultStyle(e,t){var n;const{options:i}=this.context,a=((n=i[e])===null||n===void 0?void 0:n.style)||{};"transform"in a&&Array.isArray(a.transform)&&(a.transform=[...a.transform]),this.defaultStyle[J(t.datum)]=tx(a,t)}computeElementsDefaultStyle(e){const{graph:t}=this.context;this.forEachElementData((n,i)=>{const a=i.length;for(let s=0;s<a;s++){const o=i[s];(e===void 0||e.includes(J(o)))&&this.computeElementDefaultStyle(n,{datum:o,graph:t})}})}getDefaultStyle(e){return this.defaultStyle[e]||{}}getElementState(e){try{const{model:t}=this.context;return t.getElementState(e)}catch{return[]}}getElementStateStyle(e,t,n){var i,a;const{options:s}=this.context,o=((a=(i=s[e])===null||i===void 0?void 0:i.state)===null||a===void 0?void 0:a[t])||{};return tx(o,n)}computeElementStatesStyle(e,t,n){this.stateStyle[J(n.datum)]=Object.assign({},...t.map(i=>this.getElementStateStyle(e,i,n)))}computeElementsStatesStyle(e){const{graph:t}=this.context;this.forEachElementData((n,i)=>{const a=i.length;for(let s=0;s<a;s++){const o=i[s];if(e===void 0||e.includes(J(o))){const l=this.getElementState(J(o));this.computeElementStatesStyle(n,l,{datum:o,graph:t})}}})}getStateStyle(e){return this.stateStyle[e]||{}}computeStyle(e,t){e&&["translate","zIndex"].includes(e)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(t),this.computeElementsStatesStyle(t))}getElement(e){return this.elementMap[e]}getNodes(){return this.context.model.getNodeData().map(({id:e})=>this.elementMap[e])}getEdges(){return this.context.model.getEdgeData().map(e=>this.elementMap[J(e)])}getCombos(){return this.context.model.getComboData().map(({id:e})=>this.elementMap[e])}getElementComputedStyle(e,t){const n=J(t),i=this.getThemeStyle(e),a=this.getPaletteStyle(e,n),s=t.style||{},o=this.getDefaultStyle(n),l=this.getThemeStateStyle(e,this.getElementState(n)),u=this.getStateStyle(n),c=Object.assign({},i,a,s,o,l,u);if(e==="combo"){const h=this.context.model.getChildrenData(n),f=!!c.collapsed?[]:h.map(J).filter(g=>this.getElement(g));Object.assign(c,{childrenNode:f,childrenData:h})}return c}getDrawData(e){this.init();const t=this.computeChangesAndDrawData(e);if(!t)return null;const{type:n="draw",stage:i=n}=e;return this.markDestroyElement(t.drawData),this.computeStyle(i),{type:n,stage:i,data:t}}draw(e={animation:!0}){const t=this.getDrawData(e);if(!t)return;const{data:{drawData:{add:n,update:i,remove:a}}}=t;return this.destroyElements(a,e),this.createElements(n,e),this.updateElements(i,e),this.setAnimationTask(e,t)}preLayoutDraw(){return po(this,arguments,void 0,function*(e={animation:!0}){var t,n;const i=this.getDrawData(e);if(!i)return;const{data:{drawData:a}}=i;yield(n=(t=this.context.layout)===null||t===void 0?void 0:t.preLayout)===null||n===void 0?void 0:n.call(t,a);const{add:s,update:o,remove:l}=a;return this.destroyElements(l,e),this.createElements(s,e),this.updateElements(o,e),this.setAnimationTask(e,i)})}setAnimationTask(e,t){const{animation:n,silence:i}=e,{data:{dataChanges:a,drawData:s},stage:o,type:l}=t;return this.context.animation.animate(n,i?{}:{before:()=>this.emit(new Qt(ye.BEFORE_DRAW,{dataChanges:a,animation:n,stage:o,render:l==="render"}),e),beforeAnimate:u=>this.emit(new Or(ye.BEFORE_ANIMATE,Yn.DRAW,u,s),e),afterAnimate:u=>this.emit(new Or(ye.AFTER_ANIMATE,Yn.DRAW,u,s),e),after:()=>this.emit(new Qt(ye.AFTER_DRAW,{dataChanges:a,animation:n,stage:o,render:l==="render",firstRender:this.context.graph.rendered===!1}),e)})}computeChangesAndDrawData(e){const{model:t}=this.context,n=t.getChanges(),i=Ob(n);if(i.length===0)return null;const{NodeAdded:a=[],NodeUpdated:s=[],NodeRemoved:o=[],EdgeAdded:l=[],EdgeUpdated:u=[],EdgeRemoved:c=[],ComboAdded:h=[],ComboUpdated:d=[],ComboRemoved:f=[]}=Ac(i,y=>y.type),g=y=>new Map(y.map(m=>{const w=m.value;return[J(w),w]})),v={add:{nodes:g(a),edges:g(l),combos:g(h)},update:{nodes:g(s),edges:g(u),combos:g(d)},remove:{nodes:g(o),edges:g(c),combos:g(f)}},p=this.transformData(v,e);return t.clearChanges(),{dataChanges:n,drawData:p}}transformData(e,t){const n=this.context.transform.getTransformInstance();return Object.values(n).reduce((i,a)=>a.beforeDraw(i,t),e)}createElement(e,t,n){var i;const a=J(t);if(this.getElement(a))return;const o=this.getElementType(e,t),l=this.getElementComputedStyle(e,t),u=Ri(e,o);if(!u)return gi.warn(`The element ${o} of ${e} is not registered.`);this.emit(new bs(ye.BEFORE_ELEMENT_CREATE,e,t),n);const c=this.container.appendChild(new u({id:a,context:this.context,style:l}));this.shapeTypeMap[a]=o,this.elementMap[a]=c;const{stage:h="enter"}=n;(i=this.context.animation)===null||i===void 0||i.add({element:c,elementType:e,stage:h,originalStyle:Object.assign({},c.attributes),updatedStyle:l},{after:()=>{var d;this.emit(new bs(ye.AFTER_ELEMENT_CREATE,e,t),n),(d=c.onCreate)===null||d===void 0||d.call(c)}})}createElements(e,t){const{nodes:n,edges:i,combos:a}=e;[["node",n],["combo",a],["edge",i]].forEach(([o,l])=>{l.forEach(u=>this.createElement(o,u,t))})}getUpdateStageStyle(e,t,n){const{stage:i="update"}=n;if(i==="translate")if(e==="node"||e==="combo"){const{style:{x:a=0,y:s=0,z:o=0}={}}=t;return{x:a,y:s,z:o}}else return{};return this.getElementComputedStyle(e,t)}updateElement(e,t,n){var i;const a=J(t),{stage:s="update"}=n,o=this.getElement(a);if(!o)return()=>null;this.emit(new bs(ye.BEFORE_ELEMENT_UPDATE,e,t),n);const l=this.getElementType(e,t),u=this.getUpdateStageStyle(e,t,n);this.shapeTypeMap[a]!==l&&(o.destroy(),delete this.shapeTypeMap[a],delete this.elementMap[a],this.createElement(e,t,{animation:!1,silence:!0}));const c=s!=="visibility"?s:u.visibility==="hidden"?"hide":"show";c==="hide"&&delete u.visibility,(i=this.context.animation)===null||i===void 0||i.add({element:o,elementType:e,stage:c,originalStyle:Object.assign({},o.attributes),updatedStyle:u},{before:()=>{const h=this.elementMap[a];s!=="collapse"&&Gm(h,u),s==="visibility"&&(NX(h,"opacity")||CX(h,"opacity"),this.visibilityCache.set(h,c==="show"?"visible":"hidden"),c==="show"&&Ha(h,"visible"))},after:()=>{var h;const d=this.elementMap[a];s==="collapse"&&Gm(d,u),c==="hide"&&Ha(d,this.visibilityCache.get(d)),this.emit(new bs(ye.AFTER_ELEMENT_UPDATE,e,t),n),(h=d.onUpdate)===null||h===void 0||h.call(d)}})}updateElements(e,t){const{nodes:n,edges:i,combos:a}=e;[["node",n],["combo",a],["edge",i]].forEach(([o,l])=>{l.forEach(u=>this.updateElement(o,u,t))})}markDestroyElement(e){Object.values(e.remove).forEach(t=>{t.forEach(n=>{const i=J(n),a=this.getElement(i);a&&qz(a)})})}destroyElement(e,t,n){var i;const{stage:a="exit"}=n,s=J(t),o=this.elementMap[s];if(!o)return()=>null;this.emit(new bs(ye.BEFORE_ELEMENT_DESTROY,e,t),n),(i=this.context.animation)===null||i===void 0||i.add({element:o,elementType:e,stage:a,originalStyle:Object.assign({},o.attributes),updatedStyle:{}},{after:()=>{var l;this.clearElement(s),o.destroy(),(l=o.onDestroy)===null||l===void 0||l.call(o),this.emit(new bs(ye.AFTER_ELEMENT_DESTROY,e,t),n)}})}destroyElements(e,t){const{nodes:n,edges:i,combos:a}=e;[["combo",a],["edge",i],["node",n]].forEach(([o,l])=>{l.forEach(u=>this.destroyElement(o,u,t))})}clearElement(e){delete this.paletteStyle[e],delete this.defaultStyle[e],delete this.stateStyle[e],delete this.elementMap[e],delete this.shapeTypeMap[e]}alignLayoutResultToElement(e,t){var n,i;const a=(n=e.nodes)===null||n===void 0?void 0:n.find(s=>J(s)===t);if(a){const s=un(this.context.model.getNodeLikeDatum(t)),o=un(a),l=ut(s,o);(i=e.nodes)===null||i===void 0||i.forEach(u=>{var c,h,d;!((c=u.style)===null||c===void 0)&&c.x&&(u.style.x+=l[0]),!((h=u.style)===null||h===void 0)&&h.y&&(u.style.y+=l[1]),!((d=u.style)===null||d===void 0)&&d.z&&(u.style.z+=l[2]||0)})}}collapseNode(e,t){return po(this,void 0,void 0,function*(){var n;const{animation:i,align:a}=t,{model:s,layout:o}=this.context,l=this.computeChangesAndDrawData({stage:"collapse",animation:i});if(!l)return;this.markDestroyElement(l.drawData);const u=yield o.simulate();a&&this.alignLayoutResultToElement(u,e),s.updateData(u);const c=this.computeChangesAndDrawData({stage:"collapse",animation:i});if(!c)return;const{drawData:h}=c,{add:d,remove:f,update:g}=h;this.markDestroyElement(h);const v={animation:i,stage:"collapse",data:h};this.destroyElements(f,v),this.createElements(d,v),this.updateElements(g,v),yield(n=this.context.animation.animate(i,{beforeAnimate:p=>this.emit(new Or(ye.BEFORE_ANIMATE,Yn.COLLAPSE,p,h),v),afterAnimate:p=>this.emit(new Or(ye.AFTER_ANIMATE,Yn.COLLAPSE,p,h),v)},{collapse:{target:e,descendants:Array.from(f.nodes).map(([,p])=>J(p)),position:un(g.nodes.get(e))}}))===null||n===void 0?void 0:n.finished})}expandNode(e,t){return po(this,void 0,void 0,function*(){var n;const{model:i,layout:a}=this.context,{animation:s,align:o}=t,l=un(i.getNodeData([e])[0]),u=this.computeChangesAndDrawData({stage:"expand",animation:s});if(!u)return;const{drawData:{add:c}}=u;this.createElements(c,{animation:!1,stage:"expand",target:e}),this.context.animation.clear();const h=yield a.simulate();o&&this.alignLayoutResultToElement(h,e),i.updateData(h),this.computeStyle("expand");const d=this.computeChangesAndDrawData({stage:"collapse",animation:s});if(!d)return;const{drawData:f}=d,{update:g}=f,v={animation:s,stage:"expand",data:f};c.edges.forEach(p=>g.edges.set(J(p),p)),c.nodes.forEach(p=>g.nodes.set(J(p),p)),this.updateElements(g,v),yield(n=this.context.animation.animate(s,{beforeAnimate:p=>this.emit(new Or(ye.BEFORE_ANIMATE,Yn.EXPAND,p,f),v),afterAnimate:p=>this.emit(new Or(ye.AFTER_ANIMATE,Yn.EXPAND,p,f),v)},{expand:{target:e,descendants:Array.from(c.nodes).map(([,p])=>J(p)),position:l}}))===null||n===void 0?void 0:n.finished})}collapseCombo(e,t){return po(this,void 0,void 0,function*(){var n;const{model:i,element:a}=this.context;if(i.getAncestorsData(e,ct).some(v=>Jn(v)))return;const s=a.getElement(e),o=s.getComboPosition(Object.assign(Object.assign({},s.attributes),{collapsed:!0})),l=this.computeChangesAndDrawData({stage:"collapse",animation:t});if(!l)return;const{dataChanges:u,drawData:c}=l;this.markDestroyElement(c);const{update:h,remove:d}=c,f={animation:t,stage:"collapse",data:c};this.destroyElements(d,f),this.updateElements(h,f);const g=v=>Array.from(v).map(([,p])=>J(p));yield(n=this.context.animation.animate(t,{before:()=>this.emit(new Qt(ye.BEFORE_DRAW,{dataChanges:u,animation:t}),f),beforeAnimate:v=>this.emit(new Or(ye.BEFORE_ANIMATE,Yn.COLLAPSE,v,c),f),afterAnimate:v=>this.emit(new Or(ye.AFTER_ANIMATE,Yn.COLLAPSE,v,c),f),after:()=>this.emit(new Qt(ye.AFTER_DRAW,{dataChanges:u,animation:t}),f)},{collapse:{target:e,descendants:[...g(d.nodes),...g(d.combos)],position:o}}))===null||n===void 0?void 0:n.finished})}expandCombo(e,t){return po(this,void 0,void 0,function*(){var n;const{model:i}=this.context,a=un(i.getComboData([e])[0]);this.computeStyle("expand");const s=this.computeChangesAndDrawData({stage:"expand",animation:t});if(!s)return;const{dataChanges:o,drawData:l}=s,{add:u,update:c}=l,h={animation:t,stage:"expand",data:l,target:e};this.createElements(u,h),this.updateElements(c,h);const d=f=>Array.from(f).map(([,g])=>J(g));yield(n=this.context.animation.animate(t,{before:()=>this.emit(new Qt(ye.BEFORE_DRAW,{dataChanges:o,animation:t}),h),beforeAnimate:f=>this.emit(new Or(ye.BEFORE_ANIMATE,Yn.EXPAND,f,l),h),afterAnimate:f=>this.emit(new Or(ye.AFTER_ANIMATE,Yn.EXPAND,f,l),h),after:()=>this.emit(new Qt(ye.AFTER_DRAW,{dataChanges:o,animation:t}),h)},{expand:{target:e,descendants:[...d(u.nodes),...d(u.combos)],position:a}}))===null||n===void 0?void 0:n.finished})}clear(){this.container.destroy(),this.initContainer(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={}}destroy(){this.clear(),this.container.destroy(),this.context={}}}var xs=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},jX=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class qX{get presetOptions(){return{animation:!!YA(this.context.options,!0)}}get options(){const{options:e}=this.context;return e.layout}constructor(e){this.instances=[],this.context=e}getLayoutInstance(){return this.instances}preLayout(e){return xs(this,void 0,void 0,function*(){var t,n,i,a;const{graph:s,model:o}=this.context,{add:l}=e;ln(s,new Qt(ye.BEFORE_LAYOUT,{type:"pre"}));const u=yield(t=this.context.layout)===null||t===void 0?void 0:t.simulate();(n=u==null?void 0:u.nodes)===null||n===void 0||n.forEach(c=>{const h=J(c),d=l.nodes.get(h);o.syncNodeLikeDatum(c),d&&Object.assign(d.style,c.style)}),(i=u==null?void 0:u.edges)===null||i===void 0||i.forEach(c=>{const h=J(c),d=l.edges.get(h);o.syncEdgeDatum(c),d&&Object.assign(d.style,c.style)}),(a=u==null?void 0:u.combos)===null||a===void 0||a.forEach(c=>{const h=J(c),d=l.combos.get(h);o.syncNodeLikeDatum(c),d&&Object.assign(d.style,c.style)}),ln(s,new Qt(ye.AFTER_LAYOUT,{type:"pre"})),this.transformDataAfterLayout("pre",e)})}postLayout(){return xs(this,arguments,void 0,function*(e=this.options){if(!e)return;const t=Array.isArray(e)?e:[e],{graph:n}=this.context;ln(n,new Qt(ye.BEFORE_LAYOUT,{type:"post"}));for(const i of t){const a=t.indexOf(i),s=this.getLayoutData(i),o=Object.assign(Object.assign({},this.presetOptions),i);ln(n,new Qt(ye.BEFORE_STAGE_LAYOUT,{options:o,index:a}));const l=yield this.stepLayout(s,o,a);ln(n,new Qt(ye.AFTER_STAGE_LAYOUT,{options:o,index:a})),i.animation||this.updateElementPosition(l,!1)}ln(n,new Qt(ye.AFTER_LAYOUT,{type:"post"})),this.transformDataAfterLayout("post")})}transformDataAfterLayout(e,t){const n=this.context.transform.getTransformInstance();Object.values(n).forEach(i=>i.afterLayout(e,t))}simulate(){return xs(this,void 0,void 0,function*(){if(!this.options)return{};const e=Array.isArray(this.options)?this.options:[this.options];let t={};for(const n of e){const i=e.indexOf(n),a=this.getLayoutData(n);t=yield this.stepLayout(a,Object.assign(Object.assign(Object.assign({},this.presetOptions),n),{animation:!1}),i)}return t})}stepLayout(e,t,n){return xs(this,void 0,void 0,function*(){return Yz(t)?yield this.treeLayout(e,t,n):yield this.graphLayout(e,t,n)})}graphLayout(e,t,n){return xs(this,void 0,void 0,function*(){const{animation:i,enableWorker:a,iterations:s=300}=t,o=this.initGraphLayout(t);if(!o)return{};if(this.instances[n]=o,this.instance=o,a){const u=o;return this.supervisor=new DV(u.graphData2LayoutModel(e),u.instance,{iterations:s}),Iu(yield this.supervisor.execute())}if(Km(o))return i?yield o.execute(e,{onTick:u=>{this.updateElementPosition(u,!1)}}):(o.execute(e),o.stop(),o.tick(s));const l=yield o.execute(e);if(i){const u=this.updateElementPosition(l,i);yield u==null?void 0:u.finished}return l})}treeLayout(e,t,n){return xs(this,void 0,void 0,function*(){const{type:i,animation:a}=t,s=Ri("layout",i);if(!s)return{};const{nodes:o=[],edges:l=[]}=e,u=new dn({nodes:o.map(g=>({id:J(g),data:g.data||{}})),edges:l.map(g=>({id:J(g),source:g.source,target:g.target,data:g.data||{}}))});FX(u);const c={nodes:[],edges:[]},h={nodes:[],edges:[]};u.getRoots(lr).forEach(g=>{za(g,w=>{w.children=u.getSuccessors(w.id)},w=>u.getSuccessors(w.id),"TB");const v=s(g,t),{x:p,y,z:m=0}=v;za(v,w=>{const{id:S,x:_,y:O,z:T=0}=w;c.nodes.push({id:S,style:{x:p,y,z:m}}),h.nodes.push({id:S,style:{x:_,y:O,z:T}})},w=>w.children,"TB")});const f=this.inferTreeLayoutOffset(h);if(eT(h,f),a){eT(c,f),this.updateElementPosition(c,!1);const g=this.updateElementPosition(h,a);yield g==null?void 0:g.finished}return h})}inferTreeLayoutOffset(e){var t;let[n,i]=[1/0,-1/0],[a,s]=[1/0,-1/0];(t=e.nodes)===null||t===void 0||t.forEach(v=>{const{x:p=0,y=0}=v.style||{};n=Math.min(n,p),i=Math.max(i,p),a=Math.min(a,y),s=Math.max(s,y)});const{canvas:o}=this.context,l=o.getSize(),[u,c]=o.getCanvasByViewport([0,0]),[h,d]=o.getCanvasByViewport(l);if(n>=u&&i<=h&&a>=c&&s<=d)return[0,0];const f=(u+h)/2,g=(c+d)/2;return[f-(n+i)/2,g-(a+s)/2]}stopLayout(){this.instance&&Km(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(e){const{nodeFilter:t=()=>!0,preLayout:n=!1,isLayoutInvisibleNodes:i=!1}=e,{nodes:a,edges:s,combos:o}=this.context.model.getData(),{element:l,model:u}=this.context,c=v=>l.getElement(v),h=n?v=>{var p;return!i&&(((p=v.style)===null||p===void 0?void 0:p.visibility)==="hidden"||u.getAncestorsData(v.id,lr).some(Jn)||u.getAncestorsData(v.id,ct).some(Jn))?!1:t(v)}:v=>{const p=J(v),y=c(p);return!y||Xc(y)?!1:t(v)},d=a.filter(h),f=new Map(d.map(v=>[J(v),v]));o.forEach(v=>f.set(J(v),v));const g=s.filter(({source:v,target:p})=>f.has(v)&&f.has(p));return{nodes:d,edges:g,combos:o}}initGraphLayout(e){var t;const{element:n,viewport:i}=this.context,{type:a,enableWorker:s,animation:o,iterations:l}=e,u=jX(e,["type","enableWorker","animation","iterations"]),[c,h]=i.getCanvasSize(),d=[c/2,h/2],f=(t=e==null?void 0:e.nodeSize)!==null&&t!==void 0?t:m=>{const w=n==null?void 0:n.getElement(m.id);return w?w.attributes.size:n==null?void 0:n.getElementComputedStyle("node",m).size},g=Ri("layout",a);if(!g)return gi.warn(`The layout of ${a} is not registered.`);const v=Object.getPrototypeOf(g.prototype)===eh.prototype?g:Kz(g,this.context),p=new v(this.context),y={nodeSize:f,width:c,height:h,center:d};switch(p.id){case"d3-force":case"d3-force-3d":Object.assign(y,{center:{x:c/2,y:h/2,z:0}});break}return $n(p.options,y,u),p}updateElementPosition(e,t){const{model:n,element:i}=this.context;return i?(n.updateData(e),i.draw({animation:t,silence:!0})):null}destroy(){var e;this.stopLayout(),this.context={},(e=this.supervisor)===null||e===void 0||e.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}const eT=(r,e)=>{var t;const[n,i]=e;(t=r.nodes)===null||t===void 0||t.forEach(a=>{if(a.style){const{x:s=0,y:o=0}=a.style;a.style.x=s+n,a.style.y=o+i}else a.style={x:n,y:i}})};function $X(r){return[GX].reduce((t,n)=>n(t),r)}function GX(r){return!r.layout||Array.isArray(r.layout)||"preLayout"in r.layout||["antv-dagre","combo-combined","compact-box","circular","concentric","dagre","fishbone","grid","indented","mds","radial","random","snake","dendrogram","mindmap"].includes(r.layout.type)&&(r.layout.preLayout=!0),r}class WX extends j1{constructor(e){super(e),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}setPlugins(e){this.setExtensions(e)}getPluginInstance(e){const t=this.extensionMap[e];if(t)return t;gi.warn(`Cannot find the plugin ${e}, will try to find it by type.`);const n=this.extensions.find(i=>i.type===e);if(n)return this.extensionMap[n.key]}}const Pu=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class VX extends j1{constructor(e){super(e),this.category="transform",this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(e){this.setExtensions([...Pu.slice(0,Pu.length-1),...e,Pu[Pu.length-1]])}getTransformInstance(e){return e?this.extensionMap[e]:this.extensionMap}}var vo=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class UX{get padding(){return pi(this.context.options.padding)}get paddingOffset(){const[e,t,n,i]=this.padding,[a,s,o]=[(i-t)/2,(e-n)/2,0];return[a,s,o]}constructor(e){this.landmarkCounter=0,this.context=e;const[t,n]=this.paddingOffset,{zoom:i,rotation:a,x:s=t,y:o=n}=e.options;this.transform({mode:"absolute",scale:i,translate:[s,o],rotate:a},!1)}get camera(){const{canvas:e}=this.context;return new Proxy(e.getCamera(),{get:(t,n)=>{const a=Object.entries(e.getLayers()).filter(([o])=>!["main"].includes(o)).map(([,o])=>o.getCamera()),s=t[n];if(typeof s=="function")return(...o)=>{const l=s.apply(t,o);return a.forEach(u=>{u[n].apply(u,o)}),l}}})}createLandmark(e){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,e)}getAnimation(e){const t=YA(this.context.options,e);return t?Ga(Object.assign({},t),["easing","duration"]):!1}getCanvasSize(){const{canvas:e}=this.context,{width:t=0,height:n=0}=e.getConfig();return[t,n]}getCanvasCenter(){const{canvas:e}=this.context,{width:t=0,height:n=0}=e.getConfig();return[t/2,n/2,0]}getViewportCenter(){const[e,t]=this.camera.getPosition();return[e,t,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(e){const{camera:t}=this,{mode:n,translate:i=[]}=e,a=this.getZoom(),s=t.getPosition(),o=t.getFocalPoint(),[l,u]=this.getCanvasCenter(),[c=0,h=0,d=0]=i,f=Gr([-c,-h,-d],a);return n==="relative"?{position:$e(s,f),focalPoint:$e(o,f)}:{position:$e([l,u,s[2]],f),focalPoint:$e([l,u,o[2]],f)}}getRotateOptions(e){const{mode:t,rotate:n=0}=e;return{roll:t==="relative"?this.camera.getRoll()+n:n}}getZoomOptions(e){const{zoomRange:t}=this.context.options,n=this.camera.getZoom(),{mode:i,scale:a=1}=e;return Bt(i==="relative"?n*a:a,...t)}transform(e,t){return vo(this,void 0,void 0,function*(){const{graph:n}=this.context,{translate:i,rotate:a,scale:s,origin:o}=e;this.cancelAnimation();const l=this.getAnimation(t);if(ln(n,new Au(ye.BEFORE_TRANSFORM,e)),!a&&s&&!i&&o&&!l){this.camera.setZoomByViewportPoint(this.getZoomOptions(e),o),ln(n,new Au(ye.AFTER_TRANSFORM,e));return}const u={};if(i&&Object.assign(u,this.getTranslateOptions(e)),_e(a)&&Object.assign(u,this.getRotateOptions(e)),_e(s)&&Object.assign(u,{zoom:this.getZoomOptions(e)}),l)return ln(n,new Or(ye.BEFORE_ANIMATE,Yn.TRANSFORM,null,e)),new Promise(c=>{this.transformResolver=c,this.camera.gotoLandmark(this.createLandmark(u),Object.assign(Object.assign({},l),{onfinish:()=>{ln(n,new Or(ye.AFTER_ANIMATE,Yn.TRANSFORM,null,e)),ln(n,new Au(ye.AFTER_TRANSFORM,e)),this.transformResolver=void 0,c()}}))});this.camera.gotoLandmark(this.createLandmark(u),{duration:0}),ln(n,new Au(ye.AFTER_TRANSFORM,e))})}fitView(e,t){return vo(this,void 0,void 0,function*(){const[n,i,a,s]=this.padding,{when:o="always",direction:l="both"}=e||{},[u,c]=this.context.canvas.getSize(),h=u-s-i,d=c-n-a,f=this.context.canvas.getBounds(),g=this.getBBoxInViewport(f),[v,p]=pa(g),y=l==="x"&&v>=h||l==="y"&&p>=d||l==="both"&&v>=h&&p>=d;if(o==="overflow"&&!y)return yield this.fitCenter({animation:t});const m=h/v,w=d/p,S=l==="x"?m:l==="y"?w:Math.min(m,w),_=this.getAnimation(t);yield this.transform({mode:"relative",scale:S,translate:$e(ut(this.getCanvasCenter(),this.getBBoxInViewport(f).center),Gr(this.paddingOffset,S))},_)})}fitCenter(e){return vo(this,void 0,void 0,function*(){const t=this.context.canvas.getBounds();yield this.focus(t,e)})}focusElements(e){return vo(this,arguments,void 0,function*(t,n={}){const{element:i}=this.context;if(!i)return;const a=o=>n.shapes?o.getShape(n.shapes).getRenderBounds():o.getRenderBounds(),s=cl(t.map(o=>a(i.getElement(o))));yield this.focus(s,n)})}focus(e,t){return vo(this,void 0,void 0,function*(){const n=this.context.graph.getViewportByCanvas(e.center),i=t.position||this.getCanvasCenter(),a=ut(i,n);yield this.transform({mode:"relative",translate:$e(a,this.paddingOffset)},t.animation)})}getBBoxInViewport(e){const{min:t,max:n}=e,{graph:i}=this.context,[a,s]=i.getViewportByCanvas(t),[o,l]=i.getViewportByCanvas(n),u=new pt;return u.setMinMax([a,s,0],[o,l,0]),u}isInViewport(e,t=!1,n=0){const{graph:i}=this.context,a=this.getCanvasSize(),[s,o]=i.getCanvasByViewport([0,0]),[l,u]=i.getCanvasByViewport(a);let c=new pt;return c.setMinMax([s,o,0],[l,u,0]),n&&(c=va(c,n)),zs(e)?$r(e,c):t?ZB(e,c):c.intersects(e)}cancelAnimation(){var e,t;!((e=this.camera.landmarks)===null||e===void 0)&&e.length&&this.camera.cancelLandmarkAnimation(),(t=this.transformResolver)===null||t===void 0||t.call(this)}}var ft=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(n.next(c))}catch(h){s(h)}}function l(c){try{u(n.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class nd extends Qc{constructor(e){var t;super(),this.options={},this.rendered=!1,this.destroyed=!1,this.context={model:new BX},this.isCollapsingExpanding=!1,this.onResize=rl(()=>{this.resize()},300),this._setOptions(Object.assign({},nd.defaultOptions,e),!0),this.context.graph=this,this.options.autoResize&&((t=globalThis.addEventListener)===null||t===void 0||t.call(globalThis,"resize",this.onResize))}getOptions(){return this.options}setOptions(e){this._setOptions(e,!1)}_setOptions(e,t){if(this.updateCanvas(e),Object.assign(this.options,$X(e)),t){const{data:d}=e;d&&this.addData(d);return}const{behaviors:n,combo:i,data:a,edge:s,layout:o,node:l,plugins:u,theme:c,transforms:h}=e;n&&this.setBehaviors(n),a&&this.setData(a),l&&this.setNode(l),s&&this.setEdge(s),i&&this.setCombo(i),o&&this.setLayout(o),c&&this.setTheme(c),u&&this.setPlugins(u),h&&this.setTransforms(h)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(e,t){e&&(this.options.width=e),t&&(this.options.height=t),this.resize(e,t)}setZoomRange(e){this.options.zoomRange=e}getZoomRange(){return this.options.zoomRange}setNode(e){this.options.node=e,this.context.model.refreshData()}setEdge(e){this.options.edge=e,this.context.model.refreshData()}setCombo(e){this.options.combo=e,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(e){this.options.theme=Te(e)?e(this.getTheme()):e}setLayout(e){this.options.layout=Te(e)?e(this.getLayout()):e}getLayout(){return this.options.layout}setBehaviors(e){var t;this.options.behaviors=Te(e)?e(this.getBehaviors()):e,(t=this.context.behavior)===null||t===void 0||t.setBehaviors(this.options.behaviors)}updateBehavior(e){this.setBehaviors(t=>t.map(n=>typeof n=="object"&&n.key===e.key?Object.assign(Object.assign({},n),e):n))}getBehaviors(){return this.options.behaviors||[]}setPlugins(e){var t;this.options.plugins=Te(e)?e(this.getPlugins()):e,(t=this.context.plugin)===null||t===void 0||t.setPlugins(this.options.plugins)}updatePlugin(e){this.setPlugins(t=>t.map(n=>typeof n=="object"&&n.key===e.key?Object.assign(Object.assign({},n),e):n))}getPlugins(){return this.options.plugins||[]}getPluginInstance(e){return this.context.plugin.getPluginInstance(e)}setTransforms(e){var t;this.options.transforms=Te(e)?e(this.getTransforms()):e,(t=this.context.transform)===null||t===void 0||t.setTransforms(this.options.transforms)}updateTransform(e){this.setTransforms(t=>t.map(n=>typeof n=="object"&&n.key===e.key?Object.assign(Object.assign({},n),e):n)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(e){return Array.isArray(e)?e.map(t=>this.context.model.getElementDataById(t)):this.context.model.getElementDataById(e)}getNodeData(e){return e===void 0?this.context.model.getNodeData():Array.isArray(e)?this.context.model.getNodeData(e):this.context.model.getNodeLikeDatum(e)}getEdgeData(e){return e===void 0?this.context.model.getEdgeData():Array.isArray(e)?this.context.model.getEdgeData(e):this.context.model.getEdgeDatum(e)}getComboData(e){return e===void 0?this.context.model.getComboData():Array.isArray(e)?this.context.model.getComboData(e):this.context.model.getNodeLikeDatum(e)}setData(e){this.context.model.setData(Te(e)?e(this.getData()):e)}addData(e){this.context.model.addData(Te(e)?e(this.getData()):e)}addNodeData(e){this.context.model.addNodeData(Te(e)?e(this.getNodeData()):e)}addEdgeData(e){this.context.model.addEdgeData(Te(e)?e(this.getEdgeData()):e)}addComboData(e){this.context.model.addComboData(Te(e)?e(this.getComboData()):e)}addChildrenData(e,t){this.context.model.addChildrenData(e,t)}updateData(e){this.context.model.updateData(Te(e)?e(this.getData()):e)}updateNodeData(e){this.context.model.updateNodeData(Te(e)?e(this.getNodeData()):e)}updateEdgeData(e){this.context.model.updateEdgeData(Te(e)?e(this.getEdgeData()):e)}updateComboData(e){this.context.model.updateComboData(Te(e)?e(this.getComboData()):e)}removeData(e){this.context.model.removeData(Te(e)?e(this.getData()):e)}removeNodeData(e){this.context.model.removeNodeData(Te(e)?e(this.getNodeData()):e)}removeEdgeData(e){this.context.model.removeEdgeData(Te(e)?e(this.getEdgeData()):e)}removeComboData(e){this.context.model.removeComboData(Te(e)?e(this.getComboData()):e)}getElementType(e){return this.context.model.getElementType(e)}getRelatedEdgesData(e,t="both"){return this.context.model.getRelatedEdgesData(e,t)}getNeighborNodesData(e){return this.context.model.getNeighborNodesData(e)}getAncestorsData(e,t){return this.context.model.getAncestorsData(e,t)}getParentData(e,t){return this.context.model.getParentData(e,t)}getChildrenData(e){return this.context.model.getChildrenData(e)}getDescendantsData(e){return this.context.model.getDescendantsData(e)}getElementDataByState(e,t){return this.context.model.getElementDataByState(e,t)}initCanvas(){return ft(this,void 0,void 0,function*(){var e;if(this.context.canvas)return yield this.context.canvas.ready;const{container:t="container",width:n,height:i,renderer:a,cursor:s,background:o,canvas:l,devicePixelRatio:u=(e=globalThis.devicePixelRatio)!==null&&e!==void 0?e:1}=this.options;if(t instanceof Yk)this.context.canvas=t,s&&t.setCursor(s),a&&t.setRenderer(a),yield t.ready;else{const c=rt(t)?document.getElementById(t):t,h=Zk(c);this.emit(ye.BEFORE_CANVAS_INIT,{container:c,width:n,height:i});const d=Object.assign(Object.assign({},l),{container:c,width:n||h[0],height:i||h[1],background:o,renderer:a,cursor:s,devicePixelRatio:u}),f=new Yk(d);this.context.canvas=f,yield f.ready,this.emit(ye.AFTER_CANVAS_INIT,{canvas:f})}})}updateCanvas(e){var t,n;const{renderer:i,cursor:a,height:s,width:o}=e,l=this.context.canvas;l&&(i&&(this.emit(ye.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),l.setRenderer(i),this.emit(ye.AFTER_RENDERER_CHANGE,{renderer:i})),a&&l.setCursor(a),(_e(o)||_e(s))&&this.setSize((t=o??this.options.width)!==null&&t!==void 0?t:0,(n=s??this.options.height)!==null&&n!==void 0?n:0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new LX(this.context)),this.context.plugin||(this.context.plugin=new WX(this.context)),this.context.viewport||(this.context.viewport=new UX(this.context)),this.context.transform||(this.context.transform=new VX(this.context)),this.context.element||(this.context.element=new zX(this.context)),this.context.animation||(this.context.animation=new RX(this.context)),this.context.layout||(this.context.layout=new qX(this.context)),this.context.behavior||(this.context.behavior=new IX(this.context))}prepare(){return ft(this,void 0,void 0,function*(){if(yield Promise.resolve(),this.destroyed)throw new Error(Ai("The graph instance has been destroyed"));yield this.initCanvas(),this.initRuntime()})}render(){return ft(this,void 0,void 0,function*(){if(yield this.prepare(),ln(this,new Qt(ye.BEFORE_RENDER)),this.options.layout)if(!this.rendered&&Xz(this.options.layout)){const e=yield this.context.element.preLayoutDraw({type:"render"});yield Promise.all([e==null?void 0:e.finished,this.autoFit()])}else{const e=this.context.element.draw({type:"render"});yield Promise.all([e==null?void 0:e.finished,this.context.layout.postLayout()]),yield this.autoFit()}else{const e=this.context.element.draw({type:"render"});yield Promise.all([e==null?void 0:e.finished,this.autoFit()])}this.rendered=!0,ln(this,new Qt(ye.AFTER_RENDER))})}draw(){return ft(this,void 0,void 0,function*(){var e;yield this.prepare(),yield(e=this.context.element.draw())===null||e===void 0?void 0:e.finished})}layout(e){return ft(this,void 0,void 0,function*(){yield this.context.layout.postLayout(e)})}stopLayout(){this.context.layout.stopLayout()}clear(){return ft(this,void 0,void 0,function*(){const{model:e,element:t}=this.context;e.setData({}),e.clearChanges(),t==null||t.clear()})}destroy(){var e;ln(this,new Qt(ye.BEFORE_DESTROY));const{layout:t,animation:n,element:i,model:a,canvas:s,behavior:o,plugin:l}=this.context;l==null||l.destroy(),o==null||o.destroy(),t==null||t.destroy(),n==null||n.destroy(),i==null||i.destroy(),a.destroy(),s==null||s.destroy(),this.options={},this.context={},this.off(),(e=globalThis.removeEventListener)===null||e===void 0||e.call(globalThis,"resize",this.onResize),this.destroyed=!0,ln(this,new Qt(ye.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(e,t){var n;const i=Zk((n=this.context.canvas)===null||n===void 0?void 0:n.getContainer()),a=[e||i[0],t||i[1]];if(!this.context.canvas)return;const s=this.context.canvas.getSize();zt(a,s)||(ln(this,new Qt(ye.BEFORE_SIZE_CHANGE,{size:a})),this.context.canvas.resize(...a),ln(this,new Qt(ye.AFTER_SIZE_CHANGE,{size:a})))}fitView(e,t){return ft(this,void 0,void 0,function*(){var n;yield(n=this.context.viewport)===null||n===void 0?void 0:n.fitView(e,t)})}fitCenter(e){return ft(this,void 0,void 0,function*(){var t;yield(t=this.context.viewport)===null||t===void 0?void 0:t.fitCenter({animation:e})})}autoFit(){return ft(this,void 0,void 0,function*(){const{autoFit:e}=this.context.options;if(e)if(rt(e))e==="view"?yield this.fitView():e==="center"&&(yield this.fitCenter());else{const{type:t,animation:n}=e;t==="view"?yield this.fitView(e.options,n):t==="center"&&(yield this.fitCenter(n))}})}focusElement(e,t){return ft(this,void 0,void 0,function*(){var n;yield(n=this.context.viewport)===null||n===void 0?void 0:n.focusElements(Array.isArray(e)?e:[e],{animation:t})})}zoomBy(e,t,n){return ft(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",scale:e,origin:n},t)})}zoomTo(e,t,n){return ft(this,void 0,void 0,function*(){this.context.viewport.transform({mode:"absolute",scale:e,origin:n},t)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(e,t,n){return ft(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",rotate:e,origin:n},t)})}rotateTo(e,t,n){return ft(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",rotate:e,origin:n},t)})}getRotation(){return this.context.viewport.getRotation()}translateBy(e,t){return ft(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",translate:e},t)})}translateTo(e,t){return ft(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",translate:e},t)})}getPosition(){return ut([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(e,t){return ft(this,arguments,void 0,function*(n,i,a=!0){var s,o;const[l,u]=Yt(n)?[n,(s=i)!==null&&s!==void 0?s:!0]:[{[n]:i},a];Object.entries(l).forEach(([c,h])=>this.context.model.translateNodeLikeBy(c,h)),yield(o=this.context.element.draw({animation:u,stage:"translate"}))===null||o===void 0?void 0:o.finished})}translateElementTo(e,t){return ft(this,arguments,void 0,function*(n,i,a=!0){var s,o;const[l,u]=Yt(n)?[n,(s=i)!==null&&s!==void 0?s:!0]:[{[n]:i},a];Object.entries(l).forEach(([c,h])=>this.context.model.translateNodeLikeTo(c,h)),yield(o=this.context.element.draw({animation:u,stage:"translate"}))===null||o===void 0?void 0:o.finished})}getElementPosition(e){return this.context.model.getElementPosition(e)}getElementRenderStyle(e){return S1(this.context.element.getElement(e).attributes,["context"])}setElementVisibility(e,t){return ft(this,arguments,void 0,function*(n,i,a=!0){var s,o;const[l,u]=Yt(n)?[n,(s=i)!==null&&s!==void 0?s:!0]:[{[n]:i},a],c={nodes:[],edges:[],combos:[]};Object.entries(l).forEach(([f,g])=>{const v=this.getElementType(f);c[`${v}s`].push({id:f,style:{visibility:g}})});const{model:h,element:d}=this.context;h.preventUpdateNodeLikeHierarchy(()=>{h.updateData(c)}),yield(o=d.draw({animation:u,stage:"visibility"}))===null||o===void 0?void 0:o.finished})}showElement(e,t){return ft(this,void 0,void 0,function*(){const n=Array.isArray(e)?e:[e];yield this.setElementVisibility(Object.fromEntries(n.map(i=>[i,"visible"])),t)})}hideElement(e,t){return ft(this,void 0,void 0,function*(){const n=Array.isArray(e)?e:[e];yield this.setElementVisibility(Object.fromEntries(n.map(i=>[i,"hidden"])),t)})}getElementVisibility(e){var t,n;const i=this.context.element.getElement(e);return(n=(t=i==null?void 0:i.style)===null||t===void 0?void 0:t.visibility)!==null&&n!==void 0?n:"visible"}setElementZIndex(e,t){return ft(this,void 0,void 0,function*(){var n;const i={nodes:[],edges:[],combos:[]},a=Yt(e)?e:{[e]:t};Object.entries(a).forEach(([l,u])=>{const c=this.getElementType(l);i[`${c}s`].push({id:l,style:{zIndex:u}})});const{model:s,element:o}=this.context;s.preventUpdateNodeLikeHierarchy(()=>s.updateData(i)),yield(n=o.draw({animation:!1,stage:"zIndex"}))===null||n===void 0?void 0:n.finished})}frontElement(e){return ft(this,void 0,void 0,function*(){const t=Array.isArray(e)?e:[e],{model:n}=this.context,i={};t.map(a=>{const s=n.getFrontZIndex(a);if(n.getElementType(a)==="combo"){const l=n.getAncestorsData(a,ct).at(-1)||this.getComboData(a),u=[l,...n.getDescendantsData(J(l))],c=s-Jk(l);u.forEach(d=>{i[J(d)]=this.getElementZIndex(J(d))+c});const{internal:h}=qm(u.map(J),d=>n.getRelatedEdgesData(d));h.forEach(d=>{const f=J(d);i[f]=this.getElementZIndex(f)+c})}else i[a]=s}),yield this.setElementZIndex(i)})}getElementZIndex(e){return Jk(this.context.model.getElementDataById(e))}setElementState(e,t){return ft(this,arguments,void 0,function*(n,i,a=!0){var s,o;const[l,u]=Yt(n)?[n,(s=i)!==null&&s!==void 0?s:!0]:[{[n]:i},a],c=d=>d?Array.isArray(d)?d:[d]:[],h={nodes:[],edges:[],combos:[]};Object.entries(l).forEach(([d,f])=>{const g=this.getElementType(d);h[`${g}s`].push({id:d,states:c(f)})}),this.updateData(h),yield(o=this.context.element.draw({animation:u,stage:"state"}))===null||o===void 0?void 0:o.finished})}getElementState(e){return this.context.model.getElementState(e)}getElementRenderBounds(e){return this.context.element.getElement(e).getRenderBounds()}collapseElement(e){return ft(this,arguments,void 0,function*(t,n=!0){const{model:i,element:a}=this.context;if(Jn(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;typeof n=="boolean"&&(n={animation:n,align:!0});const s=i.getElementType(t);yield this.frontElement(t),this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!0),s==="node"?yield a.collapseNode(t,n):s==="combo"&&(yield a.collapseCombo(t,!!n.animation)),this.isCollapsingExpanding=!1})}expandElement(e){return ft(this,arguments,void 0,function*(t,n=!0){const{model:i,element:a}=this.context;if(!Jn(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;typeof n=="boolean"&&(n={animation:n,align:!0});const s=i.getElementType(t);this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!1),s==="node"?yield a.expandNode(t,n):s==="combo"&&(yield a.expandCombo(t,!!n.animation)),this.isCollapsingExpanding=!1})}setElementCollapsibility(e,t){const n=this.getElementType(e);n==="node"?this.updateNodeData([{id:e,style:{collapsed:t}}]):n==="combo"&&this.updateComboData([{id:e,style:{collapsed:t}}])}toDataURL(){return ft(this,arguments,void 0,function*(e={}){return this.context.canvas.toDataURL(e)})}getCanvasByViewport(e){return this.context.canvas.getCanvasByViewport(e)}getViewportByCanvas(e){return this.context.canvas.getViewportByCanvas(e)}getClientByCanvas(e){return this.context.canvas.getClientByCanvas(e)}getCanvasByClient(e){return this.context.canvas.getCanvasByClient(e)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(e,t,n){return super.on(e,t,n)}once(e,t){return super.once(e,t)}off(e,t){return super.off(e,t)}}nd.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};var HX=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function YX(r,e){const{getNodeData:t=(o,l)=>{if(o.depth=l,!o.children)return o;const{children:u}=o,c=HX(o,["children"]);return Object.assign(Object.assign({},c),{children:u.map(h=>h.id)})},getEdgeData:n=(o,l)=>({source:o.id,target:l.id}),getChildren:i=o=>o.children||[]}={},a=[],s=[];return za(r,(o,l)=>{a.push(t(o,l));const u=i(o);for(const c of u)s.push(n(o,c))},o=>i(o),"TB"),{nodes:a,edges:s}}class XX extends xa{beforeDraw(e){const{add:t,update:n}=e,{model:i}=this.context;return[...t.edges.entries(),...n.edges.entries()].forEach(([,a])=>{_R(i,a)}),e}}const _R=(r,e)=>{const{source:t,target:n}=e,i=r.getElementDataById(t),a=r.getElementDataById(n),s=gx(i,h=>r.getParentData(h,ct)),o=gx(a,h=>r.getParentData(h,ct)),l=J(s),u=J(o),c={sourceNode:l,targetNode:u};return e.style?Object.assign(e.style,c):e.style=c,e},KX=(r,e,t)=>{const[n,i]=e,[a,s]=t;if(i===n)return a;const o=(r-n)/(i-n);return a+o*(s-a)},ZX=(r,e,t)=>{const[n,i]=e,[a,s]=t,o=Math.log(r-n+1)/Math.log(i-n+1);return a+o*(s-a)},JX=(r,e,t,n=2)=>{const[i,a]=e,[s,o]=t,l=Math.pow((r-i)/(a-i),n);return s+l*(o-s)},QX=(r,e,t)=>{const[n,i]=e,[a,s]=t,o=Math.sqrt((r-n)/(i-n));return a+o*(s-a)};class rd extends xa{constructor(e,t){super(e,$n({},rd.defaultOptions,t)),this.assignSizeByCentrality=(n,i,a,s,o,l)=>{const u=[i,a],c=[s[0],o[0]],h=[s[1],o[1]],d=[s[2],o[2]],f=(g,v)=>{if(typeof l=="function")return l(g,u,v);switch(l){case"linear":return KX(g,u,v);case"log":return ZX(g,u,v);case"pow":return JX(g,u,v,2);case"sqrt":return QX(g,u,v);default:return v[0]}};return[f(n,c),f(n,h),f(n,d)]}}beforeDraw(e){const{model:t}=this.context,n=t.getNodeData(),i=dr(this.options.maxSize),a=dr(this.options.minSize),s=this.getCentralities(this.options.centrality),o=s.size>0?Math.max(...s.values()):0,l=s.size>0?Math.min(...s.values()):0;return n.forEach(u=>{var c;const h=this.assignSizeByCentrality(s.get(J(u))||0,l,o,a,i,this.options.scale),d=(c=this.context.element)===null||c===void 0?void 0:c.getElement(J(u)),f={size:h};this.assignLabelStyle(f,h,u,d),(!d||!ju(f,d.attributes))&&hr(e,d?"update":"add","node",$n(u,{style:f}),!0)}),e}assignLabelStyle(e,t,n,i){var a;const s=i?i.config.style:(a=this.context.element)===null||a===void 0?void 0:a.getElementComputedStyle("node",n);if(Object.assign(e,Ga(s,["labelFontSize","labelLineHeight"])),this.options.mapLabelSize){const o=this.getLabelSizeByNodeSize(t,1/0,Number(e.labelFontSize));Object.assign(e,{labelFontSize:o,labelLineHeight:o+KB(e.labelPadding)})}return e}getLabelSizeByNodeSize(e,t,n){const i=Math.min(...e)/2,[a,s]=Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[n,t];return Math.min(s,Math.max(i,a))}getCentralities(e){const{model:t}=this.context,n=t.getData();if(typeof e=="function")return e(n);const i=t.getRelatedEdgesData.bind(t);return aP(n,i,e)}}rd.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"linear",mapLabelSize:!1};class id extends xa{constructor(e,t){super(e,Object.assign({},id.defaultOptions,t))}get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var e;const t=un(this.ref),{graph:n,model:i}=this.context;(e=i.getData().nodes)===null||e===void 0||e.forEach(s=>{var o;if(J(s)===J(this.ref))return;const l=oP(ut(un(s),t)),u=Math.abs(l)>Math.PI/2,c=!s.children||s.children.length===0,h=J(s),d=(o=this.context.element)===null||o===void 0?void 0:o.getElement(h);if(!d||!d.isVisible())return;const f=dr(n.getElementRenderStyle(h).size)[0]/2,g=(c?1:-1)*(f+this.options.offset),v=[["translate",g*Math.cos(l),g*Math.sin(l)],["rotate",u?Kn(l)+180:Kn(l)]];i.updateNodeData([{id:J(s),style:{labelTextAlign:u===c?"right":"left",labelTextBaseline:"middle",labelTransform:v}}])}),n.draw()}}id.defaultOptions={offset:5};const eK="quadratic",tT=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class ad extends xa{constructor(e,t){super(e,Object.assign({},ad.defaultOptions,t)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=n=>{const{add:{edges:i},update:{nodes:a,edges:s,combos:o},remove:{edges:l}}=n,{model:u}=this.context,c=new Map,h=(g,v)=>{u.getRelatedEdgesData(v).forEach(y=>!c.has(J(y))&&c.set(J(y),y))};a.forEach(h),o.forEach(h);const d=g=>{const v=u.getEdgeData().map(y=>_R(u,y));tK(g,v).forEach(y=>!c.has(J(y))&&c.set(J(y),y))};if(l.size&&l.forEach(d),i.size&&i.forEach(d),s.size){const g=FN(Ob(u.getChanges())).update.edges;s.forEach(v=>{var p;d(v);const y=(p=g.find(m=>J(m.value)===J(v)))===null||p===void 0?void 0:p.original;y&&!qb(v,y)&&d(y)})}ai(this.options.edges)||c.forEach((g,v)=>!this.options.edges.includes(v)&&c.delete(v));const f=u.getEdgeData().map(J);return new Map([...c].sort((g,v)=>f.indexOf(g[0])-f.indexOf(v[0])))},this.applyBundlingStyle=(n,i,a)=>{const{edgeMap:s,reverses:o}=nT(i);s.forEach(l=>{l.forEach((u,c,h)=>{var d;const f=h.length,g=u.style||{};if(u.source===u.target){const y=tT.length;g.loopPlacement=tT[c%y],g.loopDist=Math.floor(c/y)*a+50}else if(f===1)g.curveOffset=0;else{const y=(c%2===0?1:-1)*(o[`${u.source}|${u.target}|${c}`]?-1:1);g.curveOffset=f%2===1?y*Math.ceil(c/2)*a*2:y*(Math.floor(c/2)*a*2+a)}const v=Object.assign(u,{type:eK,style:g}),p=(d=this.context.element)===null||d===void 0?void 0:d.getElement(J(u));(!p||!ju(v.style,p.attributes))&&hr(n,p?"update":"add","edge",v,!0)})})},this.resetEdgeStyle=n=>{const i=n.style||{},a=this.cacheMergeStyle.get(J(n))||{};return Object.keys(a).forEach(s=>{zt(i[s],a[s])&&(n[s]?i[s]=n[s]:delete i[s])}),Object.assign(n,{style:i})},this.applyMergingStyle=(n,i)=>{const{edgeMap:a,reverses:s}=nT(i);a.forEach(o=>{var l;if(o.length===1){const c=o[0],h=(l=this.context.element)===null||l===void 0?void 0:l.getElement(J(c)),d=this.resetEdgeStyle(c);(!h||!ju(d,h.attributes))&&hr(n,h?"update":"add","edge",d);return}const u=o.map(({source:c,target:h,style:d={}},f)=>{const{startArrow:g,endArrow:v}=d,p={},[y,m]=s[`${c}|${h}|${f}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return Zu(g)&&(p[y]=g),Zu(v)&&(p[m]=v),p}).reduce((c,h)=>Object.assign(Object.assign({},c),h),{});o.forEach((c,h,d)=>{var f;if(h!==0){hr(n,"remove","edge",c);return}const g=Object.assign({},Te(this.options.style)?this.options.style(d):this.options.style,{childrenData:d});this.cacheMergeStyle.set(J(c),g);const v=Object.assign(Object.assign({},c),{type:"line",style:Object.assign(Object.assign(Object.assign({},c.style),u),g)}),p=(f=this.context.element)===null||f===void 0?void 0:f.getElement(J(c));(!p||!ju(v.style,p.attributes))&&hr(n,p?"update":"add","edge",v,!0)})})}}beforeDraw(e){const t=this.getAffectedParallelEdges(e);return t.size===0||(this.options.mode==="bundle"?this.applyBundlingStyle(e,t,this.options.distance):this.applyMergingStyle(e,t)),e}}ad.defaultOptions={mode:"bundle",distance:15};const nT=r=>{const e=new Map,t=new Set,n={};for(const[i,a]of r){if(t.has(i))continue;const{source:s,target:o}=a,l=`${s}-${o}`;e.has(l)||e.set(l,[]),e.get(l).push(a),t.add(i);for(const[u,c]of r)t.has(u)||qb(a,c)&&(e.get(l).push(c),t.add(u),s===c.target&&o===c.source&&(n[`${c.source}|${c.target}|${e.get(l).length-1}`]=!0))}return{edgeMap:e,reverses:n}},tK=(r,e,t)=>e.filter(n=>qb(n,r)),qb=(r,e)=>{const{sourceNode:t,targetNode:n}=r.style||{},{sourceNode:i,targetNode:a}=e.style||{};return t===i&&n===a||t===a&&n===i};class nK extends xa{beforeDraw(e,t){const{stage:n}=t;if(n==="visibility")return e;const{model:i}=this.context,{update:{nodes:a,edges:s,combos:o}}=e,l=(u,c)=>{i.getRelatedEdgesData(c).forEach(d=>!s.has(J(d))&&s.set(J(d),d))};return a.forEach(l),o.forEach(l),e}}const rK={animation:{"combo-collapse":JA,"combo-expand":HB,"node-collapse":KA,"node-expand":VB,"path-in":ZA,"path-out":UB,fade:GB,translate:WB},behavior:{"brush-select":hl,"click-select":Bc,"collapse-expand":Kc,"create-edge":Zc,"drag-canvas":Jc,"drag-element-force":Jz,"drag-element":vl,"fix-element-size":th,"focus-element":nh,"hover-activate":rh,"lasso-select":ej,"auto-adapt-label":Ic,"optimize-viewport-transform":ih,"scroll-canvas":ah,"zoom-canvas":sh},combo:{circle:Z4,rect:J4},edge:{cubic:ns,line:zP,polyline:Hc,quadratic:Yc,"cubic-horizontal":Wc,"cubic-radial":Vc,"cubic-vertical":Uc},layout:{"antv-dagre":n9,"combo-combined":fq,"compact-box":mu.compactBox,"d3-force":zq,"force-atlas2":rV,circular:a9,concentric:Ym,dagre:Th,dendrogram:mu.dendrogram,fishbone:Ah,force:fC,fruchterman:sV,grid:lV,indented:mu.indented,mds:pC,mindmap:mu.mindmap,radial:yV,random:_V,snake:Ph},node:{circle:gl,diamond:e4,ellipse:qc,hexagon:a4,html:$c,image:NP,rect:X4,star:K4,donut:jc,triangle:Gc},palette:{spectral:jV,tableau:qV,oranges:$V,greens:GV,blues:WV},theme:{dark:wX,light:EX},plugin:{"bubble-sets":Rh,"edge-bundling":Ih,"edge-filter-lens":Dh,"grid-line":zh,background:Ch,contextmenu:Lh,fisheye:Fh,fullscreen:Bh,history:jh,hull:qh,legend:Yh,minimap:Xh,snapline:Kh,timebar:Zh,toolbar:Jh,tooltip:Qh,watermark:ed},transform:{"arrange-draw-order":SX,"collapse-expand-combo":_X,"collapse-expand-node":MX,"get-edge-actual-ends":XX,"map-node-size":rd,"place-radial-labels":id,"process-parallel-edges":ad,"update-related-edges":nK},shape:{circle:Fi,ellipse:ol,group:hn,html:ll,image:V1,line:Ua,path:ur,polygon:es,polyline:Rc,rect:Mn,text:ts,label:ya,badge:Ws}};function iK(){Object.entries(rK).forEach(([r,e])=>{Object.entries(e).forEach(([t,n])=>{OX(r,t,n)})})}iK();function MR(r,e){return function(){return r.apply(e,arguments)}}const{toString:aK}=Object.prototype,{getPrototypeOf:$b}=Object,sd=(r=>e=>{const t=aK.call(e);return r[t]||(r[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Xr=r=>(r=r.toLowerCase(),e=>sd(e)===r),od=r=>e=>typeof e===r,{isArray:to}=Array,tl=od("undefined");function sK(r){return r!==null&&!tl(r)&&r.constructor!==null&&!tl(r.constructor)&&gr(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const OR=Xr("ArrayBuffer");function oK(r){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&OR(r.buffer),e}const lK=od("string"),gr=od("function"),kR=od("number"),ld=r=>r!==null&&typeof r=="object",uK=r=>r===!0||r===!1,qu=r=>{if(sd(r)!=="object")return!1;const e=$b(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},cK=Xr("Date"),hK=Xr("File"),dK=Xr("Blob"),fK=Xr("FileList"),gK=r=>ld(r)&&gr(r.pipe),pK=r=>{let e;return r&&(typeof FormData=="function"&&r instanceof FormData||gr(r.append)&&((e=sd(r))==="formdata"||e==="object"&&gr(r.toString)&&r.toString()==="[object FormData]"))},vK=Xr("URLSearchParams"),[yK,mK,bK,wK]=["ReadableStream","Request","Response","Headers"].map(Xr),xK=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ml(r,e,{allOwnKeys:t=!1}={}){if(r===null||typeof r>"u")return;let n,i;if(typeof r!="object"&&(r=[r]),to(r))for(n=0,i=r.length;n<i;n++)e.call(null,r[n],n,r);else{const a=t?Object.getOwnPropertyNames(r):Object.keys(r),s=a.length;let o;for(n=0;n<s;n++)o=a[n],e.call(null,r[o],o,r)}}function TR(r,e){e=e.toLowerCase();const t=Object.keys(r);let n=t.length,i;for(;n-- >0;)if(i=t[n],e===i.toLowerCase())return i;return null}const Ia=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,AR=r=>!tl(r)&&r!==Ia;function g1(){const{caseless:r}=AR(this)&&this||{},e={},t=(n,i)=>{const a=r&&TR(e,i)||i;qu(e[a])&&qu(n)?e[a]=g1(e[a],n):qu(n)?e[a]=g1({},n):to(n)?e[a]=n.slice():e[a]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Ml(arguments[n],t);return e}const EK=(r,e,t,{allOwnKeys:n}={})=>(Ml(e,(i,a)=>{t&&gr(i)?r[a]=MR(i,t):r[a]=i},{allOwnKeys:n}),r),SK=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),_K=(r,e,t,n)=>{r.prototype=Object.create(e.prototype,n),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:e.prototype}),t&&Object.assign(r.prototype,t)},MK=(r,e,t,n)=>{let i,a,s;const o={};if(e=e||{},r==null)return e;do{for(i=Object.getOwnPropertyNames(r),a=i.length;a-- >0;)s=i[a],(!n||n(s,r,e))&&!o[s]&&(e[s]=r[s],o[s]=!0);r=t!==!1&&$b(r)}while(r&&(!t||t(r,e))&&r!==Object.prototype);return e},OK=(r,e,t)=>{r=String(r),(t===void 0||t>r.length)&&(t=r.length),t-=e.length;const n=r.indexOf(e,t);return n!==-1&&n===t},kK=r=>{if(!r)return null;if(to(r))return r;let e=r.length;if(!kR(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=r[e];return t},TK=(r=>e=>r&&e instanceof r)(typeof Uint8Array<"u"&&$b(Uint8Array)),AK=(r,e)=>{const n=(r&&r[Symbol.iterator]).call(r);let i;for(;(i=n.next())&&!i.done;){const a=i.value;e.call(r,a[0],a[1])}},PK=(r,e)=>{let t;const n=[];for(;(t=r.exec(e))!==null;)n.push(t);return n},CK=Xr("HTMLFormElement"),NK=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,i){return n.toUpperCase()+i}),rT=(({hasOwnProperty:r})=>(e,t)=>r.call(e,t))(Object.prototype),RK=Xr("RegExp"),PR=(r,e)=>{const t=Object.getOwnPropertyDescriptors(r),n={};Ml(t,(i,a)=>{let s;(s=e(i,a,r))!==!1&&(n[a]=s||i)}),Object.defineProperties(r,n)},LK=r=>{PR(r,(e,t)=>{if(gr(r)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const n=r[t];if(gr(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},IK=(r,e)=>{const t={},n=i=>{i.forEach(a=>{t[a]=!0})};return to(r)?n(r):n(String(r).split(e)),t},DK=()=>{},FK=(r,e)=>r!=null&&Number.isFinite(r=+r)?r:e;function BK(r){return!!(r&&gr(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}const zK=r=>{const e=new Array(10),t=(n,i)=>{if(ld(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[i]=n;const a=to(n)?[]:{};return Ml(n,(s,o)=>{const l=t(s,i+1);!tl(l)&&(a[o]=l)}),e[i]=void 0,a}}return n};return t(r,0)},jK=Xr("AsyncFunction"),qK=r=>r&&(ld(r)||gr(r))&&gr(r.then)&&gr(r.catch),CR=((r,e)=>r?setImmediate:e?((t,n)=>(Ia.addEventListener("message",({source:i,data:a})=>{i===Ia&&a===t&&n.length&&n.shift()()},!1),i=>{n.push(i),Ia.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",gr(Ia.postMessage)),$K=typeof queueMicrotask<"u"?queueMicrotask.bind(Ia):typeof process<"u"&&process.nextTick||CR,ae={isArray:to,isArrayBuffer:OR,isBuffer:sK,isFormData:pK,isArrayBufferView:oK,isString:lK,isNumber:kR,isBoolean:uK,isObject:ld,isPlainObject:qu,isReadableStream:yK,isRequest:mK,isResponse:bK,isHeaders:wK,isUndefined:tl,isDate:cK,isFile:hK,isBlob:dK,isRegExp:RK,isFunction:gr,isStream:gK,isURLSearchParams:vK,isTypedArray:TK,isFileList:fK,forEach:Ml,merge:g1,extend:EK,trim:xK,stripBOM:SK,inherits:_K,toFlatObject:MK,kindOf:sd,kindOfTest:Xr,endsWith:OK,toArray:kK,forEachEntry:AK,matchAll:PK,isHTMLForm:CK,hasOwnProperty:rT,hasOwnProp:rT,reduceDescriptors:PR,freezeMethods:LK,toObjectSet:IK,toCamelCase:NK,noop:DK,toFiniteNumber:FK,findKey:TR,global:Ia,isContextDefined:AR,isSpecCompliantForm:BK,toJSONObject:zK,isAsyncFn:jK,isThenable:qK,setImmediate:CR,asap:$K};function He(r,e,t,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}ae.inherits(He,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ae.toJSONObject(this.config),code:this.code,status:this.status}}});const NR=He.prototype,RR={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{RR[r]={value:r}});Object.defineProperties(He,RR);Object.defineProperty(NR,"isAxiosError",{value:!0});He.from=(r,e,t,n,i,a)=>{const s=Object.create(NR);return ae.toFlatObject(r,s,function(l){return l!==Error.prototype},o=>o!=="isAxiosError"),He.call(s,r.message,e,t,n,i),s.cause=r,s.name=r.name,a&&Object.assign(s,a),s};const GK=null;function p1(r){return ae.isPlainObject(r)||ae.isArray(r)}function LR(r){return ae.endsWith(r,"[]")?r.slice(0,-2):r}function iT(r,e,t){return r?r.concat(e).map(function(i,a){return i=LR(i),!t&&a?"["+i+"]":i}).join(t?".":""):e}function WK(r){return ae.isArray(r)&&!r.some(p1)}const VK=ae.toFlatObject(ae,{},null,function(e){return/^is[A-Z]/.test(e)});function ud(r,e,t){if(!ae.isObject(r))throw new TypeError("target must be an object");e=e||new FormData,t=ae.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,p){return!ae.isUndefined(p[v])});const n=t.metaTokens,i=t.visitor||c,a=t.dots,s=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&ae.isSpecCompliantForm(e);if(!ae.isFunction(i))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(ae.isDate(g))return g.toISOString();if(!l&&ae.isBlob(g))throw new He("Blob is not supported. Use a Buffer instead.");return ae.isArrayBuffer(g)||ae.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function c(g,v,p){let y=g;if(g&&!p&&typeof g=="object"){if(ae.endsWith(v,"{}"))v=n?v:v.slice(0,-2),g=JSON.stringify(g);else if(ae.isArray(g)&&WK(g)||(ae.isFileList(g)||ae.endsWith(v,"[]"))&&(y=ae.toArray(g)))return v=LR(v),y.forEach(function(w,S){!(ae.isUndefined(w)||w===null)&&e.append(s===!0?iT([v],S,a):s===null?v:v+"[]",u(w))}),!1}return p1(g)?!0:(e.append(iT(p,v,a),u(g)),!1)}const h=[],d=Object.assign(VK,{defaultVisitor:c,convertValue:u,isVisitable:p1});function f(g,v){if(!ae.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+v.join("."));h.push(g),ae.forEach(g,function(y,m){(!(ae.isUndefined(y)||y===null)&&i.call(e,y,ae.isString(m)?m.trim():m,v,d))===!0&&f(y,v?v.concat(m):[m])}),h.pop()}}if(!ae.isObject(r))throw new TypeError("data must be an object");return f(r),e}function aT(r){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function Gb(r,e){this._pairs=[],r&&ud(r,this,e)}const IR=Gb.prototype;IR.append=function(e,t){this._pairs.push([e,t])};IR.toString=function(e){const t=e?function(n){return e.call(this,n,aT)}:aT;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function UK(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function DR(r,e,t){if(!e)return r;const n=t&&t.encode||UK;ae.isFunction(t)&&(t={serialize:t});const i=t&&t.serialize;let a;if(i?a=i(e,t):a=ae.isURLSearchParams(e)?e.toString():new Gb(e,t).toString(n),a){const s=r.indexOf("#");s!==-1&&(r=r.slice(0,s)),r+=(r.indexOf("?")===-1?"?":"&")+a}return r}class sT{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ae.forEach(this.handlers,function(n){n!==null&&e(n)})}}const FR={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},HK=typeof URLSearchParams<"u"?URLSearchParams:Gb,YK=typeof FormData<"u"?FormData:null,XK=typeof Blob<"u"?Blob:null,KK={isBrowser:!0,classes:{URLSearchParams:HK,FormData:YK,Blob:XK},protocols:["http","https","file","blob","url","data"]},Wb=typeof window<"u"&&typeof document<"u",v1=typeof navigator=="object"&&navigator||void 0,ZK=Wb&&(!v1||["ReactNative","NativeScript","NS"].indexOf(v1.product)<0),JK=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",QK=Wb&&window.location.href||"http://localhost",eZ=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Wb,hasStandardBrowserEnv:ZK,hasStandardBrowserWebWorkerEnv:JK,navigator:v1,origin:QK},Symbol.toStringTag,{value:"Module"})),Rn={...eZ,...KK};function tZ(r,e){return ud(r,new Rn.classes.URLSearchParams,Object.assign({visitor:function(t,n,i,a){return Rn.isNode&&ae.isBuffer(t)?(this.append(n,t.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},e))}function nZ(r){return ae.matchAll(/\w+|\[(\w*)]/g,r).map(e=>e[0]==="[]"?"":e[1]||e[0])}function rZ(r){const e={},t=Object.keys(r);let n;const i=t.length;let a;for(n=0;n<i;n++)a=t[n],e[a]=r[a];return e}function BR(r){function e(t,n,i,a){let s=t[a++];if(s==="__proto__")return!0;const o=Number.isFinite(+s),l=a>=t.length;return s=!s&&ae.isArray(i)?i.length:s,l?(ae.hasOwnProp(i,s)?i[s]=[i[s],n]:i[s]=n,!o):((!i[s]||!ae.isObject(i[s]))&&(i[s]=[]),e(t,n,i[s],a)&&ae.isArray(i[s])&&(i[s]=rZ(i[s])),!o)}if(ae.isFormData(r)&&ae.isFunction(r.entries)){const t={};return ae.forEachEntry(r,(n,i)=>{e(nZ(n),i,t,0)}),t}return null}function iZ(r,e,t){if(ae.isString(r))try{return(e||JSON.parse)(r),ae.trim(r)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(r)}const Ol={transitional:FR,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,a=ae.isObject(e);if(a&&ae.isHTMLForm(e)&&(e=new FormData(e)),ae.isFormData(e))return i?JSON.stringify(BR(e)):e;if(ae.isArrayBuffer(e)||ae.isBuffer(e)||ae.isStream(e)||ae.isFile(e)||ae.isBlob(e)||ae.isReadableStream(e))return e;if(ae.isArrayBufferView(e))return e.buffer;if(ae.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return tZ(e,this.formSerializer).toString();if((o=ae.isFileList(e))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return ud(o?{"files[]":e}:e,l&&new l,this.formSerializer)}}return a||i?(t.setContentType("application/json",!1),iZ(e)):e}],transformResponse:[function(e){const t=this.transitional||Ol.transitional,n=t&&t.forcedJSONParsing,i=this.responseType==="json";if(ae.isResponse(e)||ae.isReadableStream(e))return e;if(e&&ae.isString(e)&&(n&&!this.responseType||i)){const s=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(o){if(s)throw o.name==="SyntaxError"?He.from(o,He.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Rn.classes.FormData,Blob:Rn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ae.forEach(["delete","get","head","post","put","patch"],r=>{Ol.headers[r]={}});const aZ=ae.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),sZ=r=>{const e={};let t,n,i;return r&&r.split(`
`).forEach(function(s){i=s.indexOf(":"),t=s.substring(0,i).trim().toLowerCase(),n=s.substring(i+1).trim(),!(!t||e[t]&&aZ[t])&&(t==="set-cookie"?e[t]?e[t].push(n):e[t]=[n]:e[t]=e[t]?e[t]+", "+n:n)}),e},oT=Symbol("internals");function yo(r){return r&&String(r).trim().toLowerCase()}function $u(r){return r===!1||r==null?r:ae.isArray(r)?r.map($u):String(r)}function oZ(r){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=t.exec(r);)e[n[1]]=n[2];return e}const lZ=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function em(r,e,t,n,i){if(ae.isFunction(n))return n.call(this,e,t);if(i&&(e=t),!!ae.isString(e)){if(ae.isString(n))return e.indexOf(n)!==-1;if(ae.isRegExp(n))return n.test(e)}}function uZ(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}function cZ(r,e){const t=ae.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(r,n+t,{value:function(i,a,s){return this[n].call(this,e,i,a,s)},configurable:!0})})}let tr=class{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function a(o,l,u){const c=yo(l);if(!c)throw new Error("header name must be a non-empty string");const h=ae.findKey(i,c);(!h||i[h]===void 0||u===!0||u===void 0&&i[h]!==!1)&&(i[h||l]=$u(o))}const s=(o,l)=>ae.forEach(o,(u,c)=>a(u,c,l));if(ae.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(ae.isString(e)&&(e=e.trim())&&!lZ(e))s(sZ(e),t);else if(ae.isHeaders(e))for(const[o,l]of e.entries())a(l,o,n);else e!=null&&a(t,e,n);return this}get(e,t){if(e=yo(e),e){const n=ae.findKey(this,e);if(n){const i=this[n];if(!t)return i;if(t===!0)return oZ(i);if(ae.isFunction(t))return t.call(this,i,n);if(ae.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=yo(e),e){const n=ae.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||em(this,this[n],n,t)))}return!1}delete(e,t){const n=this;let i=!1;function a(s){if(s=yo(s),s){const o=ae.findKey(n,s);o&&(!t||em(n,n[o],o,t))&&(delete n[o],i=!0)}}return ae.isArray(e)?e.forEach(a):a(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;for(;n--;){const a=t[n];(!e||em(this,this[a],a,e,!0))&&(delete this[a],i=!0)}return i}normalize(e){const t=this,n={};return ae.forEach(this,(i,a)=>{const s=ae.findKey(n,a);if(s){t[s]=$u(i),delete t[a];return}const o=e?uZ(a):String(a).trim();o!==a&&delete t[a],t[o]=$u(i),n[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return ae.forEach(this,(n,i)=>{n!=null&&n!==!1&&(t[i]=e&&ae.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(i=>n.set(i)),n}static accessor(e){const n=(this[oT]=this[oT]={accessors:{}}).accessors,i=this.prototype;function a(s){const o=yo(s);n[o]||(cZ(i,s),n[o]=!0)}return ae.isArray(e)?e.forEach(a):a(e),this}};tr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ae.reduceDescriptors(tr.prototype,({value:r},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>r,set(n){this[t]=n}}});ae.freezeMethods(tr);function tm(r,e){const t=this||Ol,n=e||t,i=tr.from(n.headers);let a=n.data;return ae.forEach(r,function(o){a=o.call(t,a,i.normalize(),e?e.status:void 0)}),i.normalize(),a}function zR(r){return!!(r&&r.__CANCEL__)}function no(r,e,t){He.call(this,r??"canceled",He.ERR_CANCELED,e,t),this.name="CanceledError"}ae.inherits(no,He,{__CANCEL__:!0});function jR(r,e,t){const n=t.config.validateStatus;!t.status||!n||n(t.status)?r(t):e(new He("Request failed with status code "+t.status,[He.ERR_BAD_REQUEST,He.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function hZ(r){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return e&&e[1]||""}function dZ(r,e){r=r||10;const t=new Array(r),n=new Array(r);let i=0,a=0,s;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),c=n[a];s||(s=u),t[i]=l,n[i]=u;let h=a,d=0;for(;h!==i;)d+=t[h++],h=h%r;if(i=(i+1)%r,i===a&&(a=(a+1)%r),u-s<e)return;const f=c&&u-c;return f?Math.round(d*1e3/f):void 0}}function fZ(r,e){let t=0,n=1e3/e,i,a;const s=(u,c=Date.now())=>{t=c,i=null,a&&(clearTimeout(a),a=null),r.apply(null,u)};return[(...u)=>{const c=Date.now(),h=c-t;h>=n?s(u,c):(i=u,a||(a=setTimeout(()=>{a=null,s(i)},n-h)))},()=>i&&s(i)]}const kc=(r,e,t=3)=>{let n=0;const i=dZ(50,250);return fZ(a=>{const s=a.loaded,o=a.lengthComputable?a.total:void 0,l=s-n,u=i(l),c=s<=o;n=s;const h={loaded:s,total:o,progress:o?s/o:void 0,bytes:l,rate:u||void 0,estimated:u&&o&&c?(o-s)/u:void 0,event:a,lengthComputable:o!=null,[e?"download":"upload"]:!0};r(h)},t)},lT=(r,e)=>{const t=r!=null;return[n=>e[0]({lengthComputable:t,total:r,loaded:n}),e[1]]},uT=r=>(...e)=>ae.asap(()=>r(...e)),gZ=Rn.hasStandardBrowserEnv?((r,e)=>t=>(t=new URL(t,Rn.origin),r.protocol===t.protocol&&r.host===t.host&&(e||r.port===t.port)))(new URL(Rn.origin),Rn.navigator&&/(msie|trident)/i.test(Rn.navigator.userAgent)):()=>!0,pZ=Rn.hasStandardBrowserEnv?{write(r,e,t,n,i,a){const s=[r+"="+encodeURIComponent(e)];ae.isNumber(t)&&s.push("expires="+new Date(t).toGMTString()),ae.isString(n)&&s.push("path="+n),ae.isString(i)&&s.push("domain="+i),a===!0&&s.push("secure"),document.cookie=s.join("; ")},read(r){const e=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function vZ(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function yZ(r,e){return e?r.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):r}function qR(r,e,t){let n=!vZ(e);return r&&(n||t==!1)?yZ(r,e):e}const cT=r=>r instanceof tr?{...r}:r;function Za(r,e){e=e||{};const t={};function n(u,c,h,d){return ae.isPlainObject(u)&&ae.isPlainObject(c)?ae.merge.call({caseless:d},u,c):ae.isPlainObject(c)?ae.merge({},c):ae.isArray(c)?c.slice():c}function i(u,c,h,d){if(ae.isUndefined(c)){if(!ae.isUndefined(u))return n(void 0,u,h,d)}else return n(u,c,h,d)}function a(u,c){if(!ae.isUndefined(c))return n(void 0,c)}function s(u,c){if(ae.isUndefined(c)){if(!ae.isUndefined(u))return n(void 0,u)}else return n(void 0,c)}function o(u,c,h){if(h in e)return n(u,c);if(h in r)return n(void 0,u)}const l={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:o,headers:(u,c,h)=>i(cT(u),cT(c),h,!0)};return ae.forEach(Object.keys(Object.assign({},r,e)),function(c){const h=l[c]||i,d=h(r[c],e[c],c);ae.isUndefined(d)&&h!==o||(t[c]=d)}),t}const $R=r=>{const e=Za({},r);let{data:t,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:a,headers:s,auth:o}=e;e.headers=s=tr.from(s),e.url=DR(qR(e.baseURL,e.url,e.allowAbsoluteUrls),r.params,r.paramsSerializer),o&&s.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let l;if(ae.isFormData(t)){if(Rn.hasStandardBrowserEnv||Rn.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if((l=s.getContentType())!==!1){const[u,...c]=l?l.split(";").map(h=>h.trim()).filter(Boolean):[];s.setContentType([u||"multipart/form-data",...c].join("; "))}}if(Rn.hasStandardBrowserEnv&&(n&&ae.isFunction(n)&&(n=n(e)),n||n!==!1&&gZ(e.url))){const u=i&&a&&pZ.read(a);u&&s.set(i,u)}return e},mZ=typeof XMLHttpRequest<"u",bZ=mZ&&function(r){return new Promise(function(t,n){const i=$R(r);let a=i.data;const s=tr.from(i.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:u}=i,c,h,d,f,g;function v(){f&&f(),g&&g(),i.cancelToken&&i.cancelToken.unsubscribe(c),i.signal&&i.signal.removeEventListener("abort",c)}let p=new XMLHttpRequest;p.open(i.method.toUpperCase(),i.url,!0),p.timeout=i.timeout;function y(){if(!p)return;const w=tr.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders()),_={data:!o||o==="text"||o==="json"?p.responseText:p.response,status:p.status,statusText:p.statusText,headers:w,config:r,request:p};jR(function(T){t(T),v()},function(T){n(T),v()},_),p=null}"onloadend"in p?p.onloadend=y:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(y)},p.onabort=function(){p&&(n(new He("Request aborted",He.ECONNABORTED,r,p)),p=null)},p.onerror=function(){n(new He("Network Error",He.ERR_NETWORK,r,p)),p=null},p.ontimeout=function(){let S=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const _=i.transitional||FR;i.timeoutErrorMessage&&(S=i.timeoutErrorMessage),n(new He(S,_.clarifyTimeoutError?He.ETIMEDOUT:He.ECONNABORTED,r,p)),p=null},a===void 0&&s.setContentType(null),"setRequestHeader"in p&&ae.forEach(s.toJSON(),function(S,_){p.setRequestHeader(_,S)}),ae.isUndefined(i.withCredentials)||(p.withCredentials=!!i.withCredentials),o&&o!=="json"&&(p.responseType=i.responseType),u&&([d,g]=kc(u,!0),p.addEventListener("progress",d)),l&&p.upload&&([h,f]=kc(l),p.upload.addEventListener("progress",h),p.upload.addEventListener("loadend",f)),(i.cancelToken||i.signal)&&(c=w=>{p&&(n(!w||w.type?new no(null,r,p):w),p.abort(),p=null)},i.cancelToken&&i.cancelToken.subscribe(c),i.signal&&(i.signal.aborted?c():i.signal.addEventListener("abort",c)));const m=hZ(i.url);if(m&&Rn.protocols.indexOf(m)===-1){n(new He("Unsupported protocol "+m+":",He.ERR_BAD_REQUEST,r));return}p.send(a||null)})},wZ=(r,e)=>{const{length:t}=r=r?r.filter(Boolean):[];if(e||t){let n=new AbortController,i;const a=function(u){if(!i){i=!0,o();const c=u instanceof Error?u:this.reason;n.abort(c instanceof He?c:new no(c instanceof Error?c.message:c))}};let s=e&&setTimeout(()=>{s=null,a(new He(`timeout ${e} of ms exceeded`,He.ETIMEDOUT))},e);const o=()=>{r&&(s&&clearTimeout(s),s=null,r.forEach(u=>{u.unsubscribe?u.unsubscribe(a):u.removeEventListener("abort",a)}),r=null)};r.forEach(u=>u.addEventListener("abort",a));const{signal:l}=n;return l.unsubscribe=()=>ae.asap(o),l}},xZ=function*(r,e){let t=r.byteLength;if(t<e){yield r;return}let n=0,i;for(;n<t;)i=n+e,yield r.slice(n,i),n=i},EZ=async function*(r,e){for await(const t of SZ(r))yield*xZ(t,e)},SZ=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const e=r.getReader();try{for(;;){const{done:t,value:n}=await e.read();if(t)break;yield n}}finally{await e.cancel()}},hT=(r,e,t,n)=>{const i=EZ(r,e);let a=0,s,o=l=>{s||(s=!0,n&&n(l))};return new ReadableStream({async pull(l){try{const{done:u,value:c}=await i.next();if(u){o(),l.close();return}let h=c.byteLength;if(t){let d=a+=h;t(d)}l.enqueue(new Uint8Array(c))}catch(u){throw o(u),u}},cancel(l){return o(l),i.return()}},{highWaterMark:2})},cd=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",GR=cd&&typeof ReadableStream=="function",_Z=cd&&(typeof TextEncoder=="function"?(r=>e=>r.encode(e))(new TextEncoder):async r=>new Uint8Array(await new Response(r).arrayBuffer())),WR=(r,...e)=>{try{return!!r(...e)}catch{return!1}},MZ=GR&&WR(()=>{let r=!1;const e=new Request(Rn.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!e}),dT=64*1024,y1=GR&&WR(()=>ae.isReadableStream(new Response("").body)),Tc={stream:y1&&(r=>r.body)};cd&&(r=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Tc[e]&&(Tc[e]=ae.isFunction(r[e])?t=>t[e]():(t,n)=>{throw new He(`Response type '${e}' is not supported`,He.ERR_NOT_SUPPORT,n)})})})(new Response);const OZ=async r=>{if(r==null)return 0;if(ae.isBlob(r))return r.size;if(ae.isSpecCompliantForm(r))return(await new Request(Rn.origin,{method:"POST",body:r}).arrayBuffer()).byteLength;if(ae.isArrayBufferView(r)||ae.isArrayBuffer(r))return r.byteLength;if(ae.isURLSearchParams(r)&&(r=r+""),ae.isString(r))return(await _Z(r)).byteLength},kZ=async(r,e)=>{const t=ae.toFiniteNumber(r.getContentLength());return t??OZ(e)},TZ=cd&&(async r=>{let{url:e,method:t,data:n,signal:i,cancelToken:a,timeout:s,onDownloadProgress:o,onUploadProgress:l,responseType:u,headers:c,withCredentials:h="same-origin",fetchOptions:d}=$R(r);u=u?(u+"").toLowerCase():"text";let f=wZ([i,a&&a.toAbortSignal()],s),g;const v=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let p;try{if(l&&MZ&&t!=="get"&&t!=="head"&&(p=await kZ(c,n))!==0){let _=new Request(e,{method:"POST",body:n,duplex:"half"}),O;if(ae.isFormData(n)&&(O=_.headers.get("content-type"))&&c.setContentType(O),_.body){const[T,k]=lT(p,kc(uT(l)));n=hT(_.body,dT,T,k)}}ae.isString(h)||(h=h?"include":"omit");const y="credentials"in Request.prototype;g=new Request(e,{...d,signal:f,method:t.toUpperCase(),headers:c.normalize().toJSON(),body:n,duplex:"half",credentials:y?h:void 0});let m=await fetch(g);const w=y1&&(u==="stream"||u==="response");if(y1&&(o||w&&v)){const _={};["status","statusText","headers"].forEach(P=>{_[P]=m[P]});const O=ae.toFiniteNumber(m.headers.get("content-length")),[T,k]=o&&lT(O,kc(uT(o),!0))||[];m=new Response(hT(m.body,dT,T,()=>{k&&k(),v&&v()}),_)}u=u||"text";let S=await Tc[ae.findKey(Tc,u)||"text"](m,r);return!w&&v&&v(),await new Promise((_,O)=>{jR(_,O,{data:S,headers:tr.from(m.headers),status:m.status,statusText:m.statusText,config:r,request:g})})}catch(y){throw v&&v(),y&&y.name==="TypeError"&&/fetch/i.test(y.message)?Object.assign(new He("Network Error",He.ERR_NETWORK,r,g),{cause:y.cause||y}):He.from(y,y&&y.code,r,g)}}),m1={http:GK,xhr:bZ,fetch:TZ};ae.forEach(m1,(r,e)=>{if(r){try{Object.defineProperty(r,"name",{value:e})}catch{}Object.defineProperty(r,"adapterName",{value:e})}});const fT=r=>`- ${r}`,AZ=r=>ae.isFunction(r)||r===null||r===!1,VR={getAdapter:r=>{r=ae.isArray(r)?r:[r];const{length:e}=r;let t,n;const i={};for(let a=0;a<e;a++){t=r[a];let s;if(n=t,!AZ(t)&&(n=m1[(s=String(t)).toLowerCase()],n===void 0))throw new He(`Unknown adapter '${s}'`);if(n)break;i[s||"#"+a]=n}if(!n){const a=Object.entries(i).map(([o,l])=>`adapter ${o} `+(l===!1?"is not supported by the environment":"is not available in the build"));let s=e?a.length>1?`since :
`+a.map(fT).join(`
`):" "+fT(a[0]):"as no adapter specified";throw new He("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return n},adapters:m1};function nm(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new no(null,r)}function gT(r){return nm(r),r.headers=tr.from(r.headers),r.data=tm.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),VR.getAdapter(r.adapter||Ol.adapter)(r).then(function(n){return nm(r),n.data=tm.call(r,r.transformResponse,n),n.headers=tr.from(n.headers),n},function(n){return zR(n)||(nm(r),n&&n.response&&(n.response.data=tm.call(r,r.transformResponse,n.response),n.response.headers=tr.from(n.response.headers))),Promise.reject(n)})}const UR="1.8.4",hd={};["object","boolean","number","function","string","symbol"].forEach((r,e)=>{hd[r]=function(n){return typeof n===r||"a"+(e<1?"n ":" ")+r}});const pT={};hd.transitional=function(e,t,n){function i(a,s){return"[Axios v"+UR+"] Transitional option '"+a+"'"+s+(n?". "+n:"")}return(a,s,o)=>{if(e===!1)throw new He(i(s," has been removed"+(t?" in "+t:"")),He.ERR_DEPRECATED);return t&&!pT[s]&&(pT[s]=!0,console.warn(i(s," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(a,s,o):!0}};hd.spelling=function(e){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function PZ(r,e,t){if(typeof r!="object")throw new He("options must be an object",He.ERR_BAD_OPTION_VALUE);const n=Object.keys(r);let i=n.length;for(;i-- >0;){const a=n[i],s=e[a];if(s){const o=r[a],l=o===void 0||s(o,a,r);if(l!==!0)throw new He("option "+a+" must be "+l,He.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new He("Unknown option "+a,He.ERR_BAD_OPTION)}}const Gu={assertOptions:PZ,validators:hd},ri=Gu.validators;let $a=class{constructor(e){this.defaults=e,this.interceptors={request:new sT,response:new sT}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const a=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Za(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:a}=t;n!==void 0&&Gu.assertOptions(n,{silentJSONParsing:ri.transitional(ri.boolean),forcedJSONParsing:ri.transitional(ri.boolean),clarifyTimeoutError:ri.transitional(ri.boolean)},!1),i!=null&&(ae.isFunction(i)?t.paramsSerializer={serialize:i}:Gu.assertOptions(i,{encode:ri.function,serialize:ri.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Gu.assertOptions(t,{baseUrl:ri.spelling("baseURL"),withXsrfToken:ri.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=a&&ae.merge(a.common,a[t.method]);a&&ae.forEach(["delete","get","head","post","put","patch","common"],g=>{delete a[g]}),t.headers=tr.concat(s,a);const o=[];let l=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(t)===!1||(l=l&&v.synchronous,o.unshift(v.fulfilled,v.rejected))});const u=[];this.interceptors.response.forEach(function(v){u.push(v.fulfilled,v.rejected)});let c,h=0,d;if(!l){const g=[gT.bind(this),void 0];for(g.unshift.apply(g,o),g.push.apply(g,u),d=g.length,c=Promise.resolve(t);h<d;)c=c.then(g[h++],g[h++]);return c}d=o.length;let f=t;for(h=0;h<d;){const g=o[h++],v=o[h++];try{f=g(f)}catch(p){v.call(this,p);break}}try{c=gT.call(this,f)}catch(g){return Promise.reject(g)}for(h=0,d=u.length;h<d;)c=c.then(u[h++],u[h++]);return c}getUri(e){e=Za(this.defaults,e);const t=qR(e.baseURL,e.url,e.allowAbsoluteUrls);return DR(t,e.params,e.paramsSerializer)}};ae.forEach(["delete","get","head","options"],function(e){$a.prototype[e]=function(t,n){return this.request(Za(n||{},{method:e,url:t,data:(n||{}).data}))}});ae.forEach(["post","put","patch"],function(e){function t(n){return function(a,s,o){return this.request(Za(o||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:s}))}}$a.prototype[e]=t(),$a.prototype[e+"Form"]=t(!0)});let CZ=class HR{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(a){t=a});const n=this;this.promise.then(i=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](i);n._listeners=null}),this.promise.then=i=>{let a;const s=new Promise(o=>{n.subscribe(o),a=o}).then(i);return s.cancel=function(){n.unsubscribe(a)},s},e(function(a,s,o){n.reason||(n.reason=new no(a,s,o),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=n=>{e.abort(n)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new HR(function(i){e=i}),cancel:e}}};function NZ(r){return function(t){return r.apply(null,t)}}function RZ(r){return ae.isObject(r)&&r.isAxiosError===!0}const b1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(b1).forEach(([r,e])=>{b1[e]=r});function YR(r){const e=new $a(r),t=MR($a.prototype.request,e);return ae.extend(t,$a.prototype,e,{allOwnKeys:!0}),ae.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return YR(Za(r,i))},t}const Xt=YR(Ol);Xt.Axios=$a;Xt.CanceledError=no;Xt.CancelToken=CZ;Xt.isCancel=zR;Xt.VERSION=UR;Xt.toFormData=ud;Xt.AxiosError=He;Xt.Cancel=Xt.CanceledError;Xt.all=function(e){return Promise.all(e)};Xt.spread=NZ;Xt.isAxiosError=RZ;Xt.mergeConfig=Za;Xt.AxiosHeaders=tr;Xt.formToJSON=r=>BR(ae.isHTMLForm(r)?new FormData(r):r);Xt.getAdapter=VR.getAdapter;Xt.HttpStatusCode=b1;Xt.default=Xt;const{Axios:$Z,AxiosError:GZ,CanceledError:WZ,isCancel:VZ,CancelToken:UZ,VERSION:HZ,all:YZ,Cancel:XZ,isAxiosError:KZ,spread:ZZ,toFormData:JZ,AxiosHeaders:QZ,HttpStatusCode:eJ,formToJSON:tJ,getAdapter:nJ,mergeConfig:rJ}=Xt;let vT;async function LZ(){try{await Xt.get(".././public/datasrc/treeData.json").then(r=>{vT=r.data,IZ(vT)})}catch{}}function IZ(r){const e=new nd({container:"container",data:YX(r),autoFit:{type:"view",options:{direction:"both"}},node:{style:{size:t=>t.size,fill:t=>t.grade===1?"#0050b3":t.grade===2?"#096dd9":t.grade===3?"#40a9ff":"#69c0ff",cursor:"pointer",haloStroke:"#cccccc",labelText:t=>t.id,labelPlacement:"bottom",labelBackground:!0,labelOffsetX:4,labelBackgroundShadowColor:"black",labelBackgroundRadius:2,badge:!0,badges:t=>{if(t.isPass==null)return[{text:"",placement:"right-center"}];if(t.isPass==1)return[{text:"",placement:"right-center"}];if(t.isPass==2)return[{text:"",placement:"right-center"}]},badgePalette:t=>{if(t.isPass==null)return["#F4664A"];if(t.isPass==1)return["#00af57ff"];if(t.isPass==2)return["#F6BD16"]},badgeFontSize:t=>{if(t.grade==1)return 10;if(t.grade==2)return 8;if(t.grade==3)return 7;if(t.grade==4)return 6}},animation:{enter:!1},state:{selected:{lineWidth:2,stroke:"black"}}},edge:{type:"polyline",style:{stroke:"white",radius:4,router:{type:"orth"}},animation:{enter:!1}},layout:{type:"indented",direction:"LR",indent:40,getHeight:()=>20,getWidth:()=>32},behaviors:[{type:"click-select",degree:0,unselectedState:"inactive"},"collapse-expand","drag-canvas"],plugins:[{type:"tooltip",trigger:"click",enterable:!0,getContent:(t,n)=>`<p  style="font-weight: bolder;font-size:0.8rem">:<span style="font-weight:bolder;font-size:1rem">${n[0].depth+1}</span></p>
          <p><span style="color:orange;font-size:1rem">${n[0].id}</span></p><p class="enterIn" onclick="enterTeachPage()"></p>`},{type:"toolbar",position:"top-right",style:{height:"30px",width:"55px",marginRight:"20px",backgroundColor:"#ffffff"},getItems:()=>[{id:"auto-fit",value:"auto-fit"},{id:"zoom-in",value:"zoom-in"}],onClick:t=>{t==="auto-fit"?e.fitView():t==="zoom-in"&&e.zoomBy(1.1)}},{type:"watermark",text:"AI agent",width:400,opacity:.05,rotate:Math.PI/12,backgroundRepeat:"repeat",backgroundPosition:"middle"}]});e.render()}LZ();
